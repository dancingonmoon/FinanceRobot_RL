
Search: Running Trial #1

default configuration

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4314.000000   4315.000000
mean      0.000441    20062.255222  ...   20122.295285  20118.633889
std       0.027818    16039.874230  ...   16077.162832  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7691.585083   7690.540039
50%       0.000642    11554.824463  ...   11724.320312  11715.610352
75%       0.011655    29873.081836  ...   29925.802734  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
2023-07-28 22:28:44.493526: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-28 22:28:44.829701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5454 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6
2023-07-28 22:28:45.111261: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-07-28 22:28:47.399707: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
2023-07-28 22:28:47.958817: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
step_num: 200 | loss: 0.8311 | profit rate:    0.7 | accuracy: 0.29
step_num: 400 | loss: 0.4019 | profit rate:    1.2 | accuracy: 0.34
step_num: 600 | loss: 0.3381 | profit rate:    2.1 | accuracy: 0.37
step_num: 800 | loss: 0.3462 | profit rate:   11.6 | accuracy: 0.40
step_num: 1000 | loss: 0.2965 | profit rate:   15.5 | accuracy: 0.40
step_num: 1200 | loss: 0.2706 | profit rate:  313.0 | accuracy: 0.43
step_num: 1400 | loss: 0.3370 | profit rate: 1848.0 | accuracy: 0.46
step_num: 1600 | loss: 0.2021 | profit rate: 12507.7 | accuracy: 0.49
step_num: 1800 | loss: 0.2513 | profit rate: 747457.5 | accuracy: 0.52
step_num: 2000 | loss: 0.2461 | profit rate: 4024746.3 | accuracy: 0.54
step_num: 2200 | loss: 0.3232 | profit rate: 50989304.1 | accuracy: 0.57
step_num: 2400 | loss: 0.0829 | profit rate: 4464113340.6 | accuracy: 0.59
step_num: 2600 | loss: 0.1759 | profit rate: 437267657791.3 | accuracy: 0.61
step_num: 2800 | loss: 0.1972 | profit rate: 13472189037069.9 | accuracy: 0.63
step_num: 3000 | loss: 0.1143 | profit rate: 389979363267987.5 | accuracy: 0.64
step_num: 3200 | loss: 0.2328 | profit rate: 7937607519173181.0 | accuracy: 0.65
step_num: 3400 | loss: 0.1384 | profit rate: 278742020805086464.0 | accuracy: 0.66
step_num: 3600 | loss: 0.2022 | profit rate: 3755940380025743872.0 | accuracy: 0.67
episode:   1/5,耗时:0.56分/0.56分,训练集: | step: 3679 | average_treward: 2109.5 | max_treward: 2109.5404 | average profit rate: 6433715740391185408.000
model saved @ step:3679,performance:6433715740391185408.000,accuracy:0.67
step_num: 3800 | loss: 0.1235 | profit rate:  179.8 | accuracy: 0.93
step_num: 4000 | loss: 0.1264 | profit rate: 14025.2 | accuracy: 0.92
step_num: 4200 | loss: 0.1233 | profit rate: 287799.1 | accuracy: 0.89
step_num: 4400 | loss: 0.1983 | profit rate: 3815206.2 | accuracy: 0.88
step_num: 4600 | loss: 0.2892 | profit rate: 34453760.0 | accuracy: 0.87
step_num: 4800 | loss: 0.1538 | profit rate: 951332739.8 | accuracy: 0.87
step_num: 5000 | loss: 0.1037 | profit rate: 29838539520.8 | accuracy: 0.86
step_num: 5200 | loss: 0.1526 | profit rate: 376241575894.7 | accuracy: 0.86
step_num: 5400 | loss: 0.1383 | profit rate: 23270204133409.8 | accuracy: 0.86
step_num: 5600 | loss: 0.1398 | profit rate: 272794780693749.0 | accuracy: 0.86
step_num: 5800 | loss: 0.0492 | profit rate: 2795458865053761.0 | accuracy: 0.86
step_num: 6000 | loss: 0.1300 | profit rate: 279670581884610272.0 | accuracy: 0.86
step_num: 6200 | loss: 0.0527 | profit rate: 40951476642790539264.0 | accuracy: 0.87
step_num: 6400 | loss: 0.2562 | profit rate: 2029910853955690168320.0 | accuracy: 0.87
step_num: 6600 | loss: 0.1477 | profit rate: 75466339717787538161664.0 | accuracy: 0.87
step_num: 6800 | loss: 0.0744 | profit rate: 2229886065552224587612160.0 | accuracy: 0.87
step_num: 7000 | loss: 0.1839 | profit rate: 84600557673954904417239040.0 | accuracy: 0.87
step_num: 7200 | loss: 0.1769 | profit rate: 1733608137178042576958128128.0 | accuracy: 0.87
model saved @ step:7358,performance:7712879641115379659305910272.000,accuracy:0.87
step_num: 7400 | loss: 0.0859 | profit rate:    5.9 | accuracy: 0.88
step_num: 7600 | loss: 0.1339 | profit rate: 3131.3 | accuracy: 0.92
step_num: 7800 | loss: 0.1463 | profit rate: 77377.3 | accuracy: 0.90
step_num: 8000 | loss: 0.2921 | profit rate: 723277.7 | accuracy: 0.88
step_num: 8200 | loss: 0.1398 | profit rate: 18235822.1 | accuracy: 0.88
step_num: 8400 | loss: 0.1740 | profit rate: 175494617.6 | accuracy: 0.87
step_num: 8600 | loss: 0.0265 | profit rate: 11213984496.3 | accuracy: 0.87
step_num: 8800 | loss: 0.1974 | profit rate: 134166762362.1 | accuracy: 0.86
step_num: 9000 | loss: 0.0743 | profit rate: 4298856073649.0 | accuracy: 0.86
step_num: 9200 | loss: 0.0787 | profit rate: 130415623768950.8 | accuracy: 0.86
step_num: 9400 | loss: 0.1019 | profit rate: 969867854482128.2 | accuracy: 0.86
step_num: 9600 | loss: 0.0936 | profit rate: 33088386602996668.0 | accuracy: 0.86
step_num: 9800 | loss: 0.0845 | profit rate: 3724455043270539264.0 | accuracy: 0.86
step_num: 10000 | loss: 0.0969 | profit rate: 532554802196000079872.0 | accuracy: 0.87
step_num: 10200 | loss: 0.1344 | profit rate: 19472646539908386652160.0 | accuracy: 0.87
step_num: 10400 | loss: 0.1445 | profit rate: 509905695930093160890368.0 | accuracy: 0.87
step_num: 10600 | loss: 0.2858 | profit rate: 17026213012406811572043776.0 | accuracy: 0.87
step_num: 10800 | loss: 0.1464 | profit rate: 485685001439576045595394048.0 | accuracy: 0.87
step_num: 11000 | loss: 0.2562 | profit rate: 5472785384589075946911301632.0 | accuracy: 0.86
episode:   3/5,耗时:0.95分/2.24分,训练集: | step: 11037 | average_treward: 2866.0 | max_treward: 3260.0634 | average profit rate: 4824987860782509534163763200.000
step_num: 11200 | loss: 0.1427 | profit rate:  451.6 | accuracy: 0.90
step_num: 11400 | loss: 0.0842 | profit rate: 23105.8 | accuracy: 0.91
step_num: 11600 | loss: 0.0697 | profit rate: 395555.7 | accuracy: 0.89
step_num: 11800 | loss: 0.0938 | profit rate: 8433909.9 | accuracy: 0.88
step_num: 12000 | loss: 0.2060 | profit rate: 53726632.0 | accuracy: 0.87
step_num: 12200 | loss: 0.1214 | profit rate: 3325014044.5 | accuracy: 0.88
step_num: 12400 | loss: 0.1764 | profit rate: 46614419377.3 | accuracy: 0.87
step_num: 12600 | loss: 0.0554 | profit rate: 453307095578.6 | accuracy: 0.87
step_num: 12800 | loss: 0.0674 | profit rate: 46147545946486.5 | accuracy: 0.87
step_num: 13000 | loss: 0.1179 | profit rate: 353342862055675.7 | accuracy: 0.87
step_num: 13200 | loss: 0.0661 | profit rate: 5085080932314355.0 | accuracy: 0.87
step_num: 13400 | loss: 0.0995 | profit rate: 597358170384326912.0 | accuracy: 0.87
step_num: 13600 | loss: 0.1431 | profit rate: 83117002420031569920.0 | accuracy: 0.87
step_num: 13800 | loss: 0.0691 | profit rate: 3602791875980241141760.0 | accuracy: 0.88
step_num: 14000 | loss: 0.0376 | profit rate: 121912446284383513477120.0 | accuracy: 0.88
step_num: 14200 | loss: 0.0907 | profit rate: 3104974216802168458969088.0 | accuracy: 0.88
step_num: 14400 | loss: 0.0620 | profit rate: 162356797039652746091823104.0 | accuracy: 0.88
step_num: 14600 | loss: 0.2370 | profit rate: 2065194579393763331884974080.0 | accuracy: 0.88
model saved @ step:14716,performance:6745223140959865321209987072.000,accuracy:0.87
step_num: 14800 | loss: 0.1028 | profit rate:   34.4 | accuracy: 0.92
step_num: 15000 | loss: 0.0968 | profit rate: 6849.5 | accuracy: 0.89
step_num: 15200 | loss: 0.0850 | profit rate: 175393.3 | accuracy: 0.88
step_num: 15400 | loss: 0.1404 | profit rate: 1606939.7 | accuracy: 0.88
step_num: 15600 | loss: 0.0972 | profit rate: 26157062.4 | accuracy: 0.88
step_num: 15800 | loss: 0.1034 | profit rate: 367193416.4 | accuracy: 0.88
step_num: 16000 | loss: 0.0404 | profit rate: 19920413041.0 | accuracy: 0.89
step_num: 16200 | loss: 0.2043 | profit rate: 227490476399.1 | accuracy: 0.88
step_num: 16400 | loss: 0.0438 | profit rate: 14988052388719.0 | accuracy: 0.88
step_num: 16600 | loss: 0.1238 | profit rate: 194186985322607.7 | accuracy: 0.88
step_num: 16800 | loss: 0.0461 | profit rate: 1555786219168692.2 | accuracy: 0.88
step_num: 17000 | loss: 0.0934 | profit rate: 130981092157362432.0 | accuracy: 0.88
step_num: 17200 | loss: 0.0320 | profit rate: 9649126052470181888.0 | accuracy: 0.88
step_num: 17400 | loss: 0.1124 | profit rate: 1281375092577212301312.0 | accuracy: 0.88
step_num: 17600 | loss: 0.0996 | profit rate: 38258623924577398423552.0 | accuracy: 0.88
step_num: 17800 | loss: 0.0917 | profit rate: 1272561209818194437472256.0 | accuracy: 0.89
step_num: 18000 | loss: 0.1749 | profit rate: 46916817020650989935394816.0 | accuracy: 0.88
step_num: 18200 | loss: 0.2034 | profit rate: 1184447366882838973035577344.0 | accuracy: 0.88
episode:   5/5,耗时:1.33分/4.94分,训练集: | step: 18395 | average_treward: 3047.7 | max_treward: 3332.2352 | average profit rate: 5840528106143645252997611520.000
model saved @ step:18395,performance:7982453807410833990554222592.000,accuracy:0.88
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 12%|        | 50/408 [00:00<00:00, 499.88it/s] 29%|       | 117/408 [00:00<00:00, 597.35it/s] 45%|     | 184/408 [00:00<00:00, 623.32it/s] 62%|   | 253/408 [00:00<00:00, 642.26it/s] 79%|  | 322/408 [00:00<00:00, 650.03it/s] 95%|| 387/408 [00:00<00:00, 576.76it/s]100%|| 408/408 [00:00<00:00, 591.43it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 8864.53
2023-07-24T12:00:00 | net performance [%] = 786.4535
2023-07-24T12:00:00 | number of trades [#] = 232
==================================================
Trial 1 Complete [00h 05m 02s]
net_wealth: 8864.534520422041

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 00h 05m 02s

Search: Running Trial #2

Value             |Best Value So Far |Hyperparameter
5                 |1                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
5                 |3                 |lags
0.6               |0.5               |gamma
0.001             |0.001             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4310.000000   4315.000000
mean      0.000441    20062.255222  ...   20136.939364  20118.633889
std       0.027818    16039.874230  ...   16077.430342  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7696.969971   7690.540039
50%       0.000642    11554.824463  ...   11742.710449  11715.610352
75%       0.011655    29873.081836  ...   29945.211914  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9397 | profit rate:    1.8 | accuracy: 0.34
step_num: 1200 | loss: 0.2775 | profit rate:    4.6 | accuracy: 0.35
step_num: 1400 | loss: 0.2564 | profit rate:   89.3 | accuracy: 0.36
step_num: 1600 | loss: 0.2454 | profit rate: 9900.7 | accuracy: 0.39
step_num: 1800 | loss: 0.2376 | profit rate: 194860.5 | accuracy: 0.41
step_num: 2000 | loss: 0.2332 | profit rate: 6088927.3 | accuracy: 0.43
step_num: 2200 | loss: 0.2361 | profit rate: 78283674782.0 | accuracy: 0.46
step_num: 2400 | loss: 0.2389 | profit rate: 321736596544535.4 | accuracy: 0.48
step_num: 2600 | loss: 0.2473 | profit rate: 162612188971394720.0 | accuracy: 0.50
step_num: 2800 | loss: 0.2635 | profit rate: 187761265094464339968.0 | accuracy: 0.52
step_num: 3000 | loss: 0.2460 | profit rate: 216306139586157535559680.0 | accuracy: 0.54
step_num: 3200 | loss: 0.2370 | profit rate: 151708084463248916552351744.0 | accuracy: 0.55
step_num: 3400 | loss: 0.2256 | profit rate: 23579726347244105234106023936.0 | accuracy: 0.56
episode:   1/5,耗时:4.67分/4.67分,训练集: | step: 3537 | average_treward: 1558.9 | max_treward: 1558.9190 | average profit rate: 610328574119713766926555545600.000
model saved @ step:3537,performance:610328574119713766926555545600.000,accuracy:0.57
step_num: 3600 | loss: 0.2445 | profit rate:   42.4 | accuracy: 0.81
step_num: 3800 | loss: 0.2369 | profit rate: 43707.0 | accuracy: 0.80
step_num: 4000 | loss: 0.2350 | profit rate: 15476776.8 | accuracy: 0.78
step_num: 4200 | loss: 0.2733 | profit rate: 10217415703.1 | accuracy: 0.77
step_num: 4400 | loss: 0.2581 | profit rate: 691345220651.4 | accuracy: 0.78
step_num: 4600 | loss: 0.2547 | profit rate: 15587131909593194.0 | accuracy: 0.78
step_num: 4800 | loss: 0.2538 | profit rate: 8934228068678609920.0 | accuracy: 0.78
step_num: 5000 | loss: 0.2465 | profit rate: 2360858596515808018432.0 | accuracy: 0.78
step_num: 5200 | loss: 0.2530 | profit rate: 24934427972888138415603712.0 | accuracy: 0.78
step_num: 5400 | loss: 0.2644 | profit rate: 1288770800038932724303527936.0 | accuracy: 0.78
step_num: 5600 | loss: 0.2500 | profit rate: 551354527343768241167247867904.0 | accuracy: 0.78
step_num: 5800 | loss: 0.2421 | profit rate: 17877747479834851159544268909969408.0 | accuracy: 0.79
step_num: 6000 | loss: 0.2364 | profit rate: 298733737560134313461729576870479921152.0 | accuracy: 0.79
step_num: 6200 | loss: 0.2308 | profit rate: 608182847866347899541680672567648684343296.0 | accuracy: 0.80
step_num: 6400 | loss: 0.2387 | profit rate: 654581013621674604208246835354923231348785152.0 | accuracy: 0.80
step_num: 6600 | loss: 0.2390 | profit rate: 640419939381623462472890112241564356757256404992.0 | accuracy: 0.80
step_num: 6800 | loss: 0.2476 | profit rate: 1018571181342001752320641392761271452908628870168576.0 | accuracy: 0.80
step_num: 7000 | loss: 0.2397 | profit rate: 274882626718647265205165049012868064919786926456700928.0 | accuracy: 0.80
model saved @ step:7074,performance:751977307995259316524608693678044461803032925299539968.000,accuracy:0.80
step_num: 7200 | loss: 0.2479 | profit rate:  596.5 | accuracy: 0.80
step_num: 7400 | loss: 0.2444 | profit rate: 1310275.3 | accuracy: 0.81
step_num: 7600 | loss: 0.2372 | profit rate: 131006915.1 | accuracy: 0.81
step_num: 7800 | loss: 0.2522 | profit rate: 205566693220.0 | accuracy: 0.81
step_num: 8000 | loss: 0.2540 | profit rate: 99432099946488.7 | accuracy: 0.80
step_num: 8200 | loss: 0.2409 | profit rate: 667062804317900800.0 | accuracy: 0.80
step_num: 8400 | loss: 0.2406 | profit rate: 392076331089203494912.0 | accuracy: 0.80
step_num: 8600 | loss: 0.2380 | profit rate: 2310170850617883201896448.0 | accuracy: 0.80
step_num: 8800 | loss: 0.2281 | profit rate: 845969886544918540722372608.0 | accuracy: 0.80
step_num: 9000 | loss: 0.2399 | profit rate: 58817611289394240624296722432.0 | accuracy: 0.80
step_num: 9200 | loss: 0.2309 | profit rate: 1114858169923746999708636051144704.0 | accuracy: 0.80
step_num: 9400 | loss: 0.2041 | profit rate: 9025934027720353735357597918980734976.0 | accuracy: 0.80
step_num: 9600 | loss: 0.2143 | profit rate: 279440434311979887588793182518068343996416.0 | accuracy: 0.81
step_num: 9800 | loss: 0.2158 | profit rate: 253989652514971303263873378939708517193351168.0 | accuracy: 0.81
step_num: 10000 | loss: 0.2000 | profit rate: 441098291008911314143641676437753932808896643072.0 | accuracy: 0.81
step_num: 10200 | loss: 0.2064 | profit rate: 175987397021308128218890538931874541767520373702656.0 | accuracy: 0.81
step_num: 10400 | loss: 0.1996 | profit rate: 536703745449302086936450408428047676931566959081816064.0 | accuracy: 0.81
step_num: 10600 | loss: 0.2082 | profit rate: 47477644132396976235695887355411846009373235099539079168.0 | accuracy: 0.81
episode:   3/5,耗时:6.31分/17.62分,训练集: | step: 10611 | average_treward: 2494.6 | max_treward: 3029.4724 | average profit rate: 17647313813025295359646065569156958517596603684331978752.000
model saved @ step:10611,performance:52189964131080626337060629362619751761768518837986131968.000,accuracy:0.81
step_num: 10800 | loss: 0.2080 | profit rate: 5388.5 | accuracy: 0.82
step_num: 11000 | loss: 0.2110 | profit rate: 8045629.2 | accuracy: 0.83
step_num: 11200 | loss: 0.2301 | profit rate: 4732558325.5 | accuracy: 0.81
step_num: 11400 | loss: 0.2257 | profit rate: 354875992397.6 | accuracy: 0.81
step_num: 11600 | loss: 0.2196 | profit rate: 2837397862477763.5 | accuracy: 0.81
step_num: 11800 | loss: 0.2135 | profit rate: 4938909430108822528.0 | accuracy: 0.81
step_num: 12000 | loss: 0.2056 | profit rate: 2487173732652010700800.0 | accuracy: 0.81
step_num: 12200 | loss: 0.2208 | profit rate: 44295222665850599369605120.0 | accuracy: 0.81
step_num: 12400 | loss: 0.2106 | profit rate: 7101265376899600501648130048.0 | accuracy: 0.81
step_num: 12600 | loss: 0.2192 | profit rate: 821795329830760308945551622144.0 | accuracy: 0.81
step_num: 12800 | loss: 0.2125 | profit rate: 45686458972611984026441615644033024.0 | accuracy: 0.81
step_num: 13000 | loss: 0.2019 | profit rate: 473575736871455180289531606171163557888.0 | accuracy: 0.81
step_num: 13200 | loss: 0.2089 | profit rate: 1776357274010192515263195521073938088067072.0 | accuracy: 0.81
step_num: 13400 | loss: 0.1922 | profit rate: 3637020063253627874360989505673423961955762176.0 | accuracy: 0.81
step_num: 13600 | loss: 0.2095 | profit rate: 5562476940600112371897629698498250712166652968960.0 | accuracy: 0.81
step_num: 13800 | loss: 0.1890 | profit rate: 12896756835668440121145142157273671151698164016218112.0 | accuracy: 0.81
step_num: 14000 | loss: 0.1952 | profit rate: 3185676688285792487897009618028559926733048093643636736.0 | accuracy: 0.81
model saved @ step:14148,performance:96351464909501009537331463805711838759334406001325506560.000,accuracy:0.81
step_num: 14200 | loss: 0.1975 | profit rate:   20.5 | accuracy: 0.81
step_num: 14400 | loss: 0.1991 | profit rate: 60560.9 | accuracy: 0.83
step_num: 14600 | loss: 0.1830 | profit rate: 32254282.4 | accuracy: 0.83
step_num: 14800 | loss: 0.2008 | profit rate: 55341646679.3 | accuracy: 0.82
step_num: 15000 | loss: 0.1983 | profit rate: 3270453297421.6 | accuracy: 0.81
step_num: 15200 | loss: 0.2081 | profit rate: 209466454971167200.0 | accuracy: 0.81
step_num: 15400 | loss: 0.1888 | profit rate: 102573160114375327744.0 | accuracy: 0.81
step_num: 15600 | loss: 0.2180 | profit rate: 23551918101225195700224.0 | accuracy: 0.81
step_num: 15800 | loss: 0.2007 | profit rate: 1364548631309261010035015680.0 | accuracy: 0.81
step_num: 16000 | loss: 0.1804 | profit rate: 64290214722987380680716976128.0 | accuracy: 0.81
step_num: 16200 | loss: 0.1957 | profit rate: 24398936193840991230462389125120.0 | accuracy: 0.80
step_num: 16400 | loss: 0.1863 | profit rate: 1173326046415808473337655897188466688.0 | accuracy: 0.80
step_num: 16600 | loss: 0.1737 | profit rate: 22994071079072223631025801512557551288320.0 | accuracy: 0.81
step_num: 16800 | loss: 0.1740 | profit rate: 71744362224585120984201167516701016140546048.0 | accuracy: 0.82
step_num: 17000 | loss: 0.1776 | profit rate: 111596001103039251665650793758216070989480984576.0 | accuracy: 0.82
step_num: 17200 | loss: 0.1901 | profit rate: 84073456865460233589544595121078999321599908249600.0 | accuracy: 0.82
step_num: 17400 | loss: 0.1816 | profit rate: 203673059967437986476930648015849943798855906522824704.0 | accuracy: 0.81
step_num: 17600 | loss: 0.1935 | profit rate: 78189748512501167314800952104826216478936173282276147200.0 | accuracy: 0.82
episode:   5/5,耗时:6.81分/31.28分,训练集: | step: 17685 | average_treward: 2727.3 | max_treward: 3102.1563 | average profit rate: 89135597620681995758793191890222573550790742044326232064.000
model saved @ step:17685,performance:296384581754833107678026717245499522804801228254620942336.000,accuracy:0.81
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 10%|         | 41/406 [00:00<00:00, 374.85it/s] 25%|       | 101/406 [00:00<00:00, 477.04it/s] 40%|      | 161/406 [00:00<00:00, 509.70it/s] 55%|    | 222/406 [00:00<00:00, 528.66it/s] 69%|   | 282/406 [00:00<00:00, 535.84it/s] 84%| | 342/406 [00:00<00:00, 540.17it/s] 99%|| 400/406 [00:00<00:00, 536.94it/s]100%|| 406/406 [00:00<00:00, 530.29it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3630.10
2023-07-24T12:00:00 | net performance [%] = 263.0097
2023-07-24T12:00:00 | number of trades [#] = 104
==================================================
Trial 2 Complete [00h 31m 23s]
net_wealth: 3630.097471782462

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 00h 36m 25s

Search: Running Trial #3

Value             |Best Value So Far |Hyperparameter
10                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
10                |3                 |lags
0.8               |0.5               |gamma
0.0005            |0.001             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4305.000000   4315.000000
mean      0.000441    20062.255222  ...   20154.979356  20118.633889
std       0.027818    16039.874230  ...   16078.042379  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7717.890137   7690.540039
50%       0.000642    11554.824463  ...   11748.200195  11715.610352
75%       0.011655    29873.081836  ...   29993.890625  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.4489 | profit rate:    1.1 | accuracy: 0.32
step_num: 400 | loss: 0.3450 | profit rate:    1.0 | accuracy: 0.34
step_num: 600 | loss: 0.4166 | profit rate:   19.3 | accuracy: 0.36
step_num: 800 | loss: 0.4054 | profit rate: 3519.0 | accuracy: 0.39
step_num: 1000 | loss: 0.3583 | profit rate: 307157.0 | accuracy: 0.42
step_num: 1200 | loss: 0.4851 | profit rate: 9873667173.7 | accuracy: 0.46
step_num: 1400 | loss: 0.2605 | profit rate: 5801103845717.0 | accuracy: 0.50
step_num: 1600 | loss: 0.2594 | profit rate: 973723314820760.8 | accuracy: 0.53
step_num: 1800 | loss: 0.3545 | profit rate: 489063288532609269760.0 | accuracy: 0.56
step_num: 2000 | loss: 0.3555 | profit rate: 105189606856203986861555712.0 | accuracy: 0.58
step_num: 2200 | loss: 0.2757 | profit rate: 2620711963234850820943951953920.0 | accuracy: 0.60
step_num: 2400 | loss: 0.2491 | profit rate: 100678954153542076972727430237126656.0 | accuracy: 0.62
step_num: 2600 | loss: 0.2564 | profit rate: 4667119185593174212893259071592555610112.0 | accuracy: 0.64
step_num: 2800 | loss: 0.3289 | profit rate: 292498799234526490827194143923505191354105856.0 | accuracy: 0.65
step_num: 3000 | loss: 0.3133 | profit rate: 3396655124988700448357555211754557495975956447232.0 | accuracy: 0.66
episode:   1/5,耗时:0.98分/0.98分,训练集: | step: 3167 | average_treward: 2097.1 | max_treward: 2097.1319 | average profit rate: 446879162789264678562138736255715823774324892893184.000
model saved @ step:3167,performance:446879162789264678562138736255715823774324892893184.000,accuracy:0.67
step_num: 3200 | loss: 0.3235 | profit rate:    4.5 | accuracy: 0.76
step_num: 3400 | loss: 0.1981 | profit rate: 301794.7 | accuracy: 0.84
step_num: 3600 | loss: 0.2671 | profit rate: 172197558.2 | accuracy: 0.82
step_num: 3800 | loss: 0.3422 | profit rate: 93041377960367.8 | accuracy: 0.84
step_num: 4000 | loss: 0.2933 | profit rate: 7146551575177022464.0 | accuracy: 0.84
step_num: 4200 | loss: 0.2453 | profit rate: 90952353724671765512192.0 | accuracy: 0.85
step_num: 4400 | loss: 0.3495 | profit rate: 837329413752909959695884615680.0 | accuracy: 0.85
step_num: 4600 | loss: 0.3219 | profit rate: 269747108320657193444205964296192.0 | accuracy: 0.84
step_num: 4800 | loss: 0.2093 | profit rate: 902930607203736746066529837574520832.0 | accuracy: 0.84
step_num: 5000 | loss: 0.3493 | profit rate: 12202164229921702139130078996407996173516800.0 | accuracy: 0.84
step_num: 5200 | loss: 0.3838 | profit rate: 6684227012569978064979737158020956326058736484352.0 | accuracy: 0.84
step_num: 5400 | loss: 0.2520 | profit rate: 510390909654745453102435420638272581072980144189079552.0 | accuracy: 0.84
step_num: 5600 | loss: 0.2595 | profit rate: 10191685424844547427389407006904254640257271065813805170688.0 | accuracy: 0.84
step_num: 5800 | loss: 0.2479 | profit rate: 1156718363079109817265133603569584637332282848440840838621167616.0 | accuracy: 0.85
step_num: 6000 | loss: 0.3233 | profit rate: 252114774933853054137113884079553387313347225708012488124172360220672.0 | accuracy: 0.85
step_num: 6200 | loss: 0.3104 | profit rate: 926472371895039786400719653559591062808126153124338663519560739560882176.0 | accuracy: 0.84
model saved @ step:6334,performance:77290330180308887259991926379113149087677284411395822195020876555153833984.000,accuracy:0.84
step_num: 6400 | loss: 0.3248 | profit rate:   10.4 | accuracy: 0.82
step_num: 6600 | loss: 0.2939 | profit rate: 1524481.4 | accuracy: 0.84
step_num: 6800 | loss: 0.2608 | profit rate: 1269315302.2 | accuracy: 0.83
step_num: 7000 | loss: 0.3262 | profit rate: 3098021166960133.5 | accuracy: 0.85
step_num: 7200 | loss: 0.2905 | profit rate: 119690550243730079744.0 | accuracy: 0.85
step_num: 7400 | loss: 0.1803 | profit rate: 682206160525860817338368.0 | accuracy: 0.85
step_num: 7600 | loss: 0.2694 | profit rate: 5053089781157150411394989948928.0 | accuracy: 0.85
step_num: 7800 | loss: 0.3150 | profit rate: 491166138797456641374921364078592.0 | accuracy: 0.84
step_num: 8000 | loss: 0.2351 | profit rate: 7035912999213559444512108133136465920.0 | accuracy: 0.84
step_num: 8200 | loss: 0.2974 | profit rate: 479997778451226074374766517525317862463373312.0 | accuracy: 0.85
step_num: 8400 | loss: 0.4269 | profit rate: 653596370202428615456623167980162571024299590680576.0 | accuracy: 0.85
step_num: 8600 | loss: 0.2797 | profit rate: 76099603990430218467065721707277969514394287644547743744.0 | accuracy: 0.85
step_num: 8800 | loss: 0.2829 | profit rate: 516759406291253326654748675135697382669251200154772229324800.0 | accuracy: 0.85
step_num: 9000 | loss: 0.2018 | profit rate: 28178881693410371238685763850525430318901917047662972133152129024.0 | accuracy: 0.85
step_num: 9200 | loss: 0.3068 | profit rate: 17914587497727968468390093932878345330243299306548016996551403956600832.0 | accuracy: 0.85
step_num: 9400 | loss: 0.3298 | profit rate: 76719889979688997290241722668411784128903475521233968411975463875601498112.0 | accuracy: 0.85
episode:   3/5,耗时:1.24分/3.27分,训练集: | step: 9501 | average_treward: 2797.0 | max_treward: 3175.2793 | average profit rate: 240868359580836285665696970803968376096669464115792565375147328945227038720.000
model saved @ step:9501,performance:645314748562199906966081632165984340844436875859317712906866665640182153216.000,accuracy:0.85
step_num: 9600 | loss: 0.3011 | profit rate:   19.4 | accuracy: 0.76
step_num: 9800 | loss: 0.2740 | profit rate: 4518968.9 | accuracy: 0.84
step_num: 10000 | loss: 0.2504 | profit rate: 6007718891.7 | accuracy: 0.85
step_num: 10200 | loss: 0.4263 | profit rate: 72564213011514448.0 | accuracy: 0.85
step_num: 10400 | loss: 0.2068 | profit rate: 1241618549746246090752.0 | accuracy: 0.85
step_num: 10600 | loss: 0.2369 | profit rate: 3615484485383224991678464.0 | accuracy: 0.85
step_num: 10800 | loss: 0.2834 | profit rate: 31516077411423470963570233049088.0 | accuracy: 0.86
step_num: 11000 | loss: 0.3058 | profit rate: 5180611372871029521052903583776768.0 | accuracy: 0.84
step_num: 11200 | loss: 0.2212 | profit rate: 306188898926921456791842532727864688640.0 | accuracy: 0.85
step_num: 11400 | loss: 0.3282 | profit rate: 3493947761195527616220136279566044434157010944.0 | accuracy: 0.85
step_num: 11600 | loss: 0.4233 | profit rate: 2044351397511613871370603467786287786339621236899840.0 | accuracy: 0.85
step_num: 11800 | loss: 0.3136 | profit rate: 653648497920667297088502911191769736032911995638651027456.0 | accuracy: 0.85
step_num: 12000 | loss: 0.2991 | profit rate: 6603363857831736475417614002562783563855172507078655888850944.0 | accuracy: 0.85
step_num: 12200 | loss: 0.2720 | profit rate: 676538229591278021919130140761207254786895414559033462398482644992.0 | accuracy: 0.85
step_num: 12400 | loss: 0.3663 | profit rate: 88323486014865021459174714654450476245915471110722881437453827799252992.0 | accuracy: 0.85
step_num: 12600 | loss: 0.3281 | profit rate: 289812641791719784636412889554808147199369488899569355909306675514130300928.0 | accuracy: 0.85
step_num: 12800 | loss: 0.2890 | profit rate:   31.9 | accuracy: 0.80
step_num: 13000 | loss: 0.2486 | profit rate: 12683938.2 | accuracy: 0.86
step_num: 13200 | loss: 0.2451 | profit rate: 192560713345.9 | accuracy: 0.87
step_num: 13400 | loss: 0.4388 | profit rate: 485534251217494976.0 | accuracy: 0.87
step_num: 13600 | loss: 0.2288 | profit rate: 10414894936690492702720.0 | accuracy: 0.88
step_num: 13800 | loss: 0.3799 | profit rate: 3429008262071146125568507904.0 | accuracy: 0.87
step_num: 14000 | loss: 0.3630 | profit rate: 135769200986881529503355376762880.0 | accuracy: 0.87
step_num: 14200 | loss: 0.2478 | profit rate: 35530285896033787558141077936406528.0 | accuracy: 0.86
step_num: 14400 | loss: 0.2745 | profit rate: 105674720271376896289771739102352865492992.0 | accuracy: 0.86
step_num: 14600 | loss: 0.2977 | profit rate: 144611434552542798107560534234731123443568214016.0 | accuracy: 0.86
step_num: 14800 | loss: 0.3335 | profit rate: 95144408694727034440662277780660268651615995853537280.0 | accuracy: 0.86
step_num: 15000 | loss: 0.3337 | profit rate: 3010118010990897207162659044028003311575796746834512183296.0 | accuracy: 0.86
step_num: 15200 | loss: 0.2510 | profit rate: 92709482805993896635073448662331650527904096950758522864271360.0 | accuracy: 0.86
step_num: 15400 | loss: 0.2689 | profit rate: 2843800040113584490498321699855173840915561515286485015989850210304.0 | accuracy: 0.86
step_num: 15600 | loss: 0.3092 | profit rate: 732769593391138465718954291560656564797135823841567262042514288271163392.0 | accuracy: 0.86
step_num: 15800 | loss: 0.3393 | profit rate: 1201364268902876682199585792537884606863386418233872339576492130845434314752.0 | accuracy: 0.85
episode:   5/5,耗时:1.15分/5.60分,训练集: | step: 15835 | average_treward: 2946.5 | max_treward: 3187.0759 | average profit rate: 710025101515534415739435330298791884026119915477299146769518341586142887936.000
model saved @ step:15835,performance:2057099365454345154208059372199773452267013465025622981758879459563232296960.000,accuracy:0.85
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 28%|       | 111/401 [00:00<00:00, 1099.11it/s] 55%|    | 221/401 [00:00<00:00, 1001.94it/s] 80%|  | 322/401 [00:00<00:00, 873.20it/s] 100%|| 401/401 [00:00<00:00, 893.07it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2578.70
2023-07-24T12:00:00 | net performance [%] = 157.8701
2023-07-24T12:00:00 | number of trades [#] = 56
==================================================
Trial 3 Complete [00h 05m 41s]
net_wealth: 2578.7014630676204

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 00h 42m 06s

Search: Running Trial #4

Value             |Best Value So Far |Hyperparameter
12                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
7                 |3                 |lags
0.98              |0.5               |gamma
0.001             |0.001             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 0.9483 | profit rate:    5.7 | accuracy: 0.33
step_num: 1200 | loss: 0.6705 | profit rate:  176.2 | accuracy: 0.34
step_num: 1400 | loss: 0.6424 | profit rate: 1677.3 | accuracy: 0.35
step_num: 1600 | loss: 0.7608 | profit rate: 29246.7 | accuracy: 0.37
step_num: 1800 | loss: 0.6978 | profit rate: 153703949.6 | accuracy: 0.39
step_num: 2000 | loss: 0.6544 | profit rate: 220973759328.5 | accuracy: 0.40
step_num: 2200 | loss: 0.7572 | profit rate: 132635750147743.6 | accuracy: 0.41
step_num: 2400 | loss: 0.6712 | profit rate: 23942683223067340.0 | accuracy: 0.43
step_num: 2600 | loss: 0.6638 | profit rate: 48911017609120808960.0 | accuracy: 0.44
step_num: 2800 | loss: 0.6460 | profit rate: 332356844115869745283072.0 | accuracy: 0.45
step_num: 3000 | loss: 0.8012 | profit rate: 19645840308526011706769408.0 | accuracy: 0.46
episode:   1/5,耗时:3.42分/3.42分,训练集: | step: 3156 | average_treward:  861.1 | max_treward: 861.1374 | average profit rate: 213882997292177679255076864.000
model saved @ step:3156,performance:213882997292177679255076864.000,accuracy:0.46
step_num: 3200 | loss: 0.7860 | profit rate:    2.6 | accuracy: 0.62
step_num: 3400 | loss: 0.8271 | profit rate: 36050.8 | accuracy: 0.62
step_num: 3600 | loss: 0.9787 | profit rate: 845201.0 | accuracy: 0.56
step_num: 3800 | loss: 1.0171 | profit rate: 43806751783.9 | accuracy: 0.58
step_num: 4000 | loss: 0.8665 | profit rate: 22774188328406.1 | accuracy: 0.57
step_num: 4200 | loss: 0.8065 | profit rate: 12809413812584796.0 | accuracy: 0.59
step_num: 4400 | loss: 0.7520 | profit rate: 90800439130418872320.0 | accuracy: 0.57
step_num: 4600 | loss: 0.7344 | profit rate: 6955529742290948980736.0 | accuracy: 0.58
step_num: 4800 | loss: 1.0471 | profit rate: 8555665379459147279368192.0 | accuracy: 0.59
step_num: 5000 | loss: 0.8142 | profit rate: 12332138503630472319447513169920.0 | accuracy: 0.60
step_num: 5200 | loss: 0.8282 | profit rate: 79496067922703484989301257742057472.0 | accuracy: 0.59
step_num: 5400 | loss: 0.7067 | profit rate: 472148056928186994162710429714446548992.0 | accuracy: 0.60
step_num: 5600 | loss: 0.9732 | profit rate: 1852754780012636722562258510886407640186880.0 | accuracy: 0.61
step_num: 5800 | loss: 0.8176 | profit rate: 2551664933192251967803351388741132946442813440.0 | accuracy: 0.60
step_num: 6000 | loss: 0.8319 | profit rate: 61501782070327115156756724868514011373131897241600.0 | accuracy: 0.61
step_num: 6200 | loss: 0.7463 | profit rate: 3860252588923087991468925762983734029014830696890368.0 | accuracy: 0.60
model saved @ step:6312,performance:30547828264026217925179262756569632743305170569396224.000,accuracy:0.60
step_num: 6400 | loss: 0.7880 | profit rate:    3.5 | accuracy: 0.54
step_num: 6600 | loss: 0.9359 | profit rate: 123980.1 | accuracy: 0.64
step_num: 6800 | loss: 0.8948 | profit rate: 14419641.0 | accuracy: 0.63
step_num: 7000 | loss: 0.8640 | profit rate: 854864394265.4 | accuracy: 0.61
step_num: 7200 | loss: 0.8247 | profit rate: 489230254342295.7 | accuracy: 0.60
step_num: 7400 | loss: 0.7953 | profit rate: 45831377585652824.0 | accuracy: 0.60
step_num: 7600 | loss: 0.9094 | profit rate: 280890435263122472960.0 | accuracy: 0.59
step_num: 7800 | loss: 0.7608 | profit rate: 24803549980573688659968.0 | accuracy: 0.59
step_num: 8000 | loss: 0.8563 | profit rate: 826483208339918810710540288.0 | accuracy: 0.61
step_num: 8200 | loss: 0.8051 | profit rate: 42992636659235813148135484555264.0 | accuracy: 0.61
step_num: 8400 | loss: 0.9358 | profit rate: 252786292761185147310458018509881344.0 | accuracy: 0.60
step_num: 8600 | loss: 0.8073 | profit rate: 15551218290322326736890830492488611921920.0 | accuracy: 0.61
step_num: 8800 | loss: 0.6970 | profit rate: 2627661388539011032752413564193974150758400.0 | accuracy: 0.61
step_num: 9000 | loss: 0.7473 | profit rate: 24043291821399698678832873486403519091694370816.0 | accuracy: 0.62
step_num: 9200 | loss: 0.8213 | profit rate: 35517151908437093900139083644897060567861895888896.0 | accuracy: 0.61
step_num: 9400 | loss: 0.7687 | profit rate: 5684652498531313400880603607678067765325085955588096.0 | accuracy: 0.60
episode:   3/5,耗时:5.50分/14.44分,训练集: | step: 9468 | average_treward: 1519.3 | max_treward: 1886.5985 | average profit rate: 12871842208573244054593294532331457388434591982813184.000
model saved @ step:9468,performance:8067698361693515567828616625340612325805665659387904.000,accuracy:0.60
step_num: 9600 | loss: 0.8282 | profit rate:    7.3 | accuracy: 0.53
step_num: 9800 | loss: 0.8801 | profit rate: 234726.3 | accuracy: 0.57
step_num: 10000 | loss: 0.9328 | profit rate: 551976941.4 | accuracy: 0.60
step_num: 10200 | loss: 0.7708 | profit rate: 12277418145903.4 | accuracy: 0.59
step_num: 10400 | loss: 0.8241 | profit rate: 8875166808122115.0 | accuracy: 0.58
step_num: 10600 | loss: 0.8872 | profit rate: 34675720465076916224.0 | accuracy: 0.58
step_num: 10800 | loss: 0.7728 | profit rate: 20398804385917984309248.0 | accuracy: 0.59
step_num: 11000 | loss: 0.6994 | profit rate: 2230763520032236950781952.0 | accuracy: 0.59
step_num: 11200 | loss: 0.8089 | profit rate: 1079615209517778094763355930624.0 | accuracy: 0.61
step_num: 11400 | loss: 0.8922 | profit rate: 23430804366629935682917982080598016.0 | accuracy: 0.61
step_num: 11600 | loss: 0.8203 | profit rate: 410250149818646938415121624424740028416.0 | accuracy: 0.61
step_num: 11800 | loss: 0.7635 | profit rate: 1278467450413429552794067503164169799073792.0 | accuracy: 0.62
step_num: 12000 | loss: 0.6962 | profit rate: 1526539121884761905700744552329135006530142208.0 | accuracy: 0.62
step_num: 12200 | loss: 0.7137 | profit rate: 2057071191420546503218700555212662428569402605568.0 | accuracy: 0.62
step_num: 12400 | loss: 0.6105 | profit rate: 16524803494677689658558047417609870102479574025633792.0 | accuracy: 0.62
step_num: 12600 | loss: 0.6943 | profit rate: 1221698972483399683230003822188227645758824552274591744.0 | accuracy: 0.61
model saved @ step:12624,performance:1385194906501363390034164680422083647583365720195465216.000,accuracy:0.61
step_num: 12800 | loss: 0.6719 | profit rate: 1873.0 | accuracy: 0.64
step_num: 13000 | loss: 0.6137 | profit rate: 558152.7 | accuracy: 0.61
step_num: 13200 | loss: 0.6675 | profit rate: 5111960026.6 | accuracy: 0.62
step_num: 13400 | loss: 0.6162 | profit rate: 95396409525217.3 | accuracy: 0.61
step_num: 13600 | loss: 0.6059 | profit rate: 10050161689113320.0 | accuracy: 0.59
step_num: 13800 | loss: 0.8853 | profit rate: 331607293157582766080.0 | accuracy: 0.59
step_num: 14000 | loss: 0.6714 | profit rate: 115861800642093474906112.0 | accuracy: 0.60
step_num: 14200 | loss: 0.7610 | profit rate: 53834678942679157817999360.0 | accuracy: 0.60
step_num: 14400 | loss: 0.9061 | profit rate: 24213137479573733592889271779328.0 | accuracy: 0.61
step_num: 14600 | loss: 0.6934 | profit rate: 3680959318178831475005684693589819392.0 | accuracy: 0.62
step_num: 14800 | loss: 0.8071 | profit rate: 6663923798358879712564325207047952924672.0 | accuracy: 0.61
step_num: 15000 | loss: 0.6211 | profit rate: 27030989962660394974873438288960120309153792.0 | accuracy: 0.62
step_num: 15200 | loss: 0.7194 | profit rate: 152803520326934607184363405808340860607672614912.0 | accuracy: 0.63
step_num: 15400 | loss: 0.7030 | profit rate: 3799481240823825770756799792602561898542709807775744.0 | accuracy: 0.63
step_num: 15600 | loss: 0.6853 | profit rate: 776124570375891692845909245100738352054467512011587584.0 | accuracy: 0.62
episode:   5/5,耗时:5.56分/25.58分,训练集: | step: 15780 | average_treward: 1699.0 | max_treward: 2003.7153 | average profit rate: 6298326200544274708066650931473483342805727080037220352.000
model saved @ step:15780,performance:30067820569594289546161744858443526069382534360136155136.000,accuracy:0.62
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 14%|        | 56/404 [00:00<00:00, 552.30it/s] 30%|       | 120/404 [00:00<00:00, 603.59it/s] 46%|     | 187/404 [00:00<00:00, 630.95it/s] 63%|   | 255/404 [00:00<00:00, 647.68it/s] 80%|  | 323/404 [00:00<00:00, 656.91it/s] 97%|| 391/404 [00:00<00:00, 662.48it/s]==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
100%|| 404/404 [00:00<00:00, 644.96it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2511.09
2023-07-24T12:00:00 | net performance [%] = 151.1092
2023-07-24T12:00:00 | number of trades [#] = 76
==================================================
Trial 4 Complete [00h 25m 39s]
net_wealth: 2513.605582303308

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 07m 45s

Search: Running Trial #5

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
5                 |3                 |lags
0.9               |0.5               |gamma
5e-05             |0.001             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 1.4702 | profit rate:    0.5 | accuracy: 0.34
step_num: 600 | loss: 1.4427 | profit rate:    0.0 | accuracy: 0.33
step_num: 800 | loss: 1.2108 | profit rate:    0.1 | accuracy: 0.37
step_num: 1000 | loss: 1.0981 | profit rate:    0.0 | accuracy: 0.37
step_num: 1200 | loss: 0.7878 | profit rate:    0.0 | accuracy: 0.35
step_num: 1400 | loss: 0.6465 | profit rate:    0.0 | accuracy: 0.37
step_num: 1600 | loss: 0.7140 | profit rate:    0.0 | accuracy: 0.36
step_num: 1800 | loss: 0.9893 | profit rate:    0.0 | accuracy: 0.35
step_num: 2000 | loss: 1.2415 | profit rate:    0.0 | accuracy: 0.36
step_num: 2200 | loss: 0.9660 | profit rate:    0.0 | accuracy: 0.36
step_num: 2400 | loss: 0.8209 | profit rate:    0.0 | accuracy: 0.37
step_num: 2600 | loss: 0.5245 | profit rate:    0.0 | accuracy: 0.35
step_num: 2800 | loss: 0.3461 | profit rate:    0.0 | accuracy: 0.33
step_num: 3000 | loss: 0.0825 | profit rate:    0.0 | accuracy: 0.31
episode:   1/5,耗时:0.80分/0.80分,训练集: | step: 3172 | average_treward: -182.7 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3200 | loss: 0.0541 | profit rate:    1.1 | accuracy: 0.03
step_num: 3400 | loss: 0.0632 | profit rate:    1.2 | accuracy: 0.03
step_num: 3600 | loss: 0.0376 | profit rate:    1.1 | accuracy: 0.03
step_num: 3800 | loss: 0.2250 | profit rate:    1.6 | accuracy: 0.12
step_num: 4000 | loss: 0.5111 | profit rate:   44.7 | accuracy: 0.21
step_num: 4200 | loss: 0.7819 | profit rate:   11.6 | accuracy: 0.23
step_num: 4400 | loss: 0.5736 | profit rate:   75.4 | accuracy: 0.25
step_num: 4600 | loss: 0.5804 | profit rate:  467.9 | accuracy: 0.27
step_num: 4800 | loss: 0.6272 | profit rate:   27.4 | accuracy: 0.29
step_num: 5000 | loss: 0.8657 | profit rate:    0.0 | accuracy: 0.30
step_num: 5200 | loss: 0.7204 | profit rate:    0.4 | accuracy: 0.33
step_num: 5400 | loss: 0.7616 | profit rate:   55.4 | accuracy: 0.34
step_num: 5600 | loss: 0.7619 | profit rate:  221.4 | accuracy: 0.35
step_num: 5800 | loss: 0.5254 | profit rate:  147.6 | accuracy: 0.34
step_num: 6000 | loss: 0.3670 | profit rate:  114.6 | accuracy: 0.33
step_num: 6200 | loss: 0.1213 | profit rate:  114.4 | accuracy: 0.31
model saved @ step:6344,performance:143.079,accuracy:0.29
step_num: 6400 | loss: 0.0640 | profit rate:    1.1 | accuracy: 0.12
step_num: 6600 | loss: 0.0684 | profit rate:    4.7 | accuracy: 0.10
step_num: 6800 | loss: 0.0424 | profit rate:    7.9 | accuracy: 0.07
step_num: 7000 | loss: 0.3635 | profit rate: 79175.2 | accuracy: 0.22
step_num: 7200 | loss: 0.6029 | profit rate: 208311.9 | accuracy: 0.27
step_num: 7400 | loss: 0.7662 | profit rate: 652384.7 | accuracy: 0.31
step_num: 7600 | loss: 0.6619 | profit rate: 43347498.6 | accuracy: 0.32
step_num: 7800 | loss: 0.6401 | profit rate: 3417549054.1 | accuracy: 0.36
step_num: 8000 | loss: 0.5681 | profit rate: 165318181291.8 | accuracy: 0.39
step_num: 8200 | loss: 0.7440 | profit rate: 185541367906150784.0 | accuracy: 0.42
step_num: 8400 | loss: 0.8341 | profit rate: 223226018662111543296.0 | accuracy: 0.44
step_num: 8600 | loss: 0.8404 | profit rate: 68769101726734333509632.0 | accuracy: 0.45
step_num: 8800 | loss: 0.8543 | profit rate: 7243601449328078814707712.0 | accuracy: 0.47
step_num: 9000 | loss: 0.7394 | profit rate: 271443874709210670242463744.0 | accuracy: 0.47
step_num: 9200 | loss: 0.7047 | profit rate: 68962473337948506640762273792.0 | accuracy: 0.47
step_num: 9400 | loss: 0.5482 | profit rate: 847794903732913736838109200384.0 | accuracy: 0.46
episode:   3/5,耗时:1.39分/3.13分,训练集: | step: 9516 | average_treward:  280.8 | max_treward: 945.3009 | average profit rate: 2956539541255619685079568089088.000
model saved @ step:9516,performance:8869618623766858492288750845952.000,accuracy:0.46
step_num: 9600 | loss: 0.3906 | profit rate:    4.2 | accuracy: 0.61
step_num: 9800 | loss: 0.5917 | profit rate: 35786.5 | accuracy: 0.58
step_num: 10000 | loss: 0.5412 | profit rate: 79491.3 | accuracy: 0.47
step_num: 10200 | loss: 0.6994 | profit rate: 18745882965.5 | accuracy: 0.54
step_num: 10400 | loss: 0.8306 | profit rate: 2389030572359.7 | accuracy: 0.56
step_num: 10600 | loss: 0.7648 | profit rate: 262069968141478.7 | accuracy: 0.58
step_num: 10800 | loss: 0.8597 | profit rate: 2827432666747242496.0 | accuracy: 0.58
step_num: 11000 | loss: 0.8393 | profit rate: 120782605496337072128.0 | accuracy: 0.59
step_num: 11200 | loss: 0.7069 | profit rate: 25931440465680487415808.0 | accuracy: 0.59
step_num: 11400 | loss: 0.6635 | profit rate: 107071957599564081992881405952.0 | accuracy: 0.61
step_num: 11600 | loss: 0.8521 | profit rate: 68148025564730772599480608882688.0 | accuracy: 0.60
step_num: 11800 | loss: 0.8559 | profit rate: 496505472449145906725756371529105408.0 | accuracy: 0.61
step_num: 12000 | loss: 0.7773 | profit rate: 6293621093097150826717308380474507264.0 | accuracy: 0.61
step_num: 12200 | loss: 0.7559 | profit rate: 501566930047414535368108757478251954176.0 | accuracy: 0.61
step_num: 12400 | loss: 0.7073 | profit rate: 743965570913852340307429885415644073033728.0 | accuracy: 0.60
step_num: 12600 | loss: 0.6137 | profit rate: 50934763561483704322445743341054960318021632.0 | accuracy: 0.60
model saved @ step:12688,performance:79392792716550499143491006404566495021498368.000,accuracy:0.59
step_num: 12800 | loss: 0.5678 | profit rate:    3.1 | accuracy: 0.53
step_num: 13000 | loss: 0.6551 | profit rate: 46675.4 | accuracy: 0.57
step_num: 13200 | loss: 0.6393 | profit rate: 4320826.5 | accuracy: 0.53
step_num: 13400 | loss: 0.6841 | profit rate: 41227409593.3 | accuracy: 0.57
step_num: 13600 | loss: 0.7239 | profit rate: 24840242051575.1 | accuracy: 0.60
step_num: 13800 | loss: 0.6697 | profit rate: 1627469292302192.0 | accuracy: 0.60
step_num: 14000 | loss: 0.7576 | profit rate: 315266386796097306624.0 | accuracy: 0.62
step_num: 14200 | loss: 0.6863 | profit rate: 17240663193045644083200.0 | accuracy: 0.62
step_num: 14400 | loss: 0.7250 | profit rate: 77929734405148009163653120.0 | accuracy: 0.62
step_num: 14600 | loss: 0.7252 | profit rate: 84816037230051139340107295752192.0 | accuracy: 0.63
step_num: 14800 | loss: 0.7996 | profit rate: 6790805324314893001859528570961920.0 | accuracy: 0.63
step_num: 15000 | loss: 0.8574 | profit rate: 247981104722606169162985416932563353600.0 | accuracy: 0.63
step_num: 15200 | loss: 0.6945 | profit rate: 875802450146182382172388162325390032896.0 | accuracy: 0.63
step_num: 15400 | loss: 0.6889 | profit rate: 229851298736320670308069334655788633817088.0 | accuracy: 0.63
step_num: 15600 | loss: 0.7833 | profit rate: 196495702775999217471462866422375821395099648.0 | accuracy: 0.62
step_num: 15800 | loss: 0.6878 | profit rate: 6832906152629292834582152157510519102887690240.0 | accuracy: 0.62
episode:   5/5,耗时:0.94分/5.05分,训练集: | step: 15860 | average_treward:  720.8 | max_treward: 1426.9037 | average profit rate: 2143422480564601661696407308871192526404452352.000
model saved @ step:15860,performance:10637719610106448846652661111798205867341381632.000,accuracy:0.62
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 13%|        | 51/406 [00:00<00:00, 500.00it/s] 29%|       | 119/406 [00:00<00:00, 598.04it/s] 46%|     | 187/406 [00:00<00:00, 629.38it/s] 63%|   | 255/406 [00:00<00:00, 644.10it/s] 80%|  | 323/406 [00:00<00:00, 653.64it/s] 96%|| 390/406 [00:00<00:00, 657.91it/s]100%|| 406/406 [00:00<00:00, 639.43it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2924.33
2023-07-24T12:00:00 | net performance [%] = 192.4329
2023-07-24T12:00:00 | number of trades [#] = 98
==================================================
Trial 5 Complete [00h 05m 31s]
net_wealth: 2927.255969668893

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 13m 17s

Search: Running Trial #6

Value             |Best Value So Far |Hyperparameter
12                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.9               |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.5613 | profit rate:    1.1 | accuracy: 0.35
step_num: 600 | loss: 0.4269 | profit rate:    3.9 | accuracy: 0.36
step_num: 800 | loss: 0.3526 | profit rate:   86.7 | accuracy: 0.40
step_num: 1000 | loss: 0.5397 | profit rate: 533529.1 | accuracy: 0.43
step_num: 1200 | loss: 0.4398 | profit rate: 2453937655.0 | accuracy: 0.47
step_num: 1400 | loss: 0.3101 | profit rate: 1876339489286.1 | accuracy: 0.50
step_num: 1600 | loss: 0.4210 | profit rate: 452938558575283072.0 | accuracy: 0.53
step_num: 1800 | loss: 0.3294 | profit rate: 204295785561766985728.0 | accuracy: 0.56
step_num: 2000 | loss: 0.3169 | profit rate: 2825520962927437912473600.0 | accuracy: 0.59
step_num: 2200 | loss: 0.3641 | profit rate: 155711245584438786062662087213056.0 | accuracy: 0.60
step_num: 2400 | loss: 0.3782 | profit rate: 52307308749408825120085799430879444992.0 | accuracy: 0.61
step_num: 2600 | loss: 0.2669 | profit rate: 4639632796270342340206446175420113624236032.0 | accuracy: 0.63
step_num: 2800 | loss: 0.2974 | profit rate: 382390671826365571059768940966385526974814617600.0 | accuracy: 0.64
step_num: 3000 | loss: 0.2835 | profit rate: 64563321941904579885227041069766633178710705820401664.0 | accuracy: 0.66
step_num: 3200 | loss: 0.4106 | profit rate: 25491045612166582426920337652795261011779773481289361915904.0 | accuracy: 0.66
step_num: 3400 | loss: 0.3218 | profit rate: 52658985243508579665001077270785294676697647075106123113562112.0 | accuracy: 0.67
episode:   1/5,耗时:1.04分/1.04分,训练集: | step: 3514 | average_treward: 2507.2 | max_treward: 2507.1809 | average profit rate: 3948402065682759756593669278121146525899911387775644636884762624.000
model saved @ step:3514,performance:3948402065682759756593669278121146525899911387775644636884762624.000,accuracy:0.67
step_num: 3600 | loss: 0.3327 | profit rate: 4807.9 | accuracy: 0.89
step_num: 3800 | loss: 0.3645 | profit rate: 734483334.9 | accuracy: 0.88
step_num: 4000 | loss: 0.2505 | profit rate: 3830577473579.5 | accuracy: 0.88
step_num: 4200 | loss: 0.2773 | profit rate: 3668564566636832256.0 | accuracy: 0.88
step_num: 4400 | loss: 0.1923 | profit rate: 256891543420089877397504.0 | accuracy: 0.87
step_num: 4600 | loss: 0.2924 | profit rate: 2922637359823744309431409573888.0 | accuracy: 0.88
step_num: 4800 | loss: 0.2790 | profit rate: 118427209633258422042639947616223232.0 | accuracy: 0.87
step_num: 5000 | loss: 0.3740 | profit rate: 122679851841814791933677793262049469399040.0 | accuracy: 0.86
step_num: 5200 | loss: 0.3044 | profit rate: 2761717946946741175502071972906759285750366208.0 | accuracy: 0.86
step_num: 5400 | loss: 0.3002 | profit rate: 3288779452092925106602851803282301665755558576128.0 | accuracy: 0.86
step_num: 5600 | loss: 0.3583 | profit rate: 73552526080847380529029771685244393951221175231117787136.0 | accuracy: 0.86
step_num: 5800 | loss: 0.3658 | profit rate: 344674298877349480785536068219441673938845622244962649637912576.0 | accuracy: 0.85
step_num: 6000 | loss: 0.3148 | profit rate: 1360166716401256342060328367352652948198697006191635526966664862105600.0 | accuracy: 0.85
step_num: 6200 | loss: 0.3284 | profit rate: 138259730990231802017443886850996406938328076741752663069900990202828029952.0 | accuracy: 0.85
step_num: 6400 | loss: 0.4078 | profit rate: 19251108311953497838702008968791267814483980478275627867519504384319054732591104.0 | accuracy: 0.85
step_num: 6600 | loss: 0.3084 | profit rate: 1153483792607721458907454520517508252128647785545703427892092127625588655289326895104.0 | accuracy: 0.85
step_num: 6800 | loss: 0.3381 | profit rate: 682754189220904305085447616984942744558680088328315530793666594527833477124381026495234048.0 | accuracy: 0.85
step_num: 7000 | loss: 0.3095 | profit rate: 1878708170168280615576542339632955324725644140157878648945131975110532018849240374073263915008.0 | accuracy: 0.85
model saved @ step:7028,performance:3158166176626033693542321916527640842983166646521540834408801556353316338757689073448098201600.000,accuracy:0.85
step_num: 7200 | loss: 0.2980 | profit rate: 165139.0 | accuracy: 0.82
step_num: 7400 | loss: 0.2371 | profit rate: 194145431618.7 | accuracy: 0.88
step_num: 7600 | loss: 0.2923 | profit rate: 25103789307567868.0 | accuracy: 0.86
step_num: 7800 | loss: 0.2465 | profit rate: 27786486840079712256.0 | accuracy: 0.86
step_num: 8000 | loss: 0.3190 | profit rate: 737956325104039658367483904.0 | accuracy: 0.87
step_num: 8200 | loss: 0.3402 | profit rate: 258001158804193677158583482974208.0 | accuracy: 0.87
step_num: 8400 | loss: 0.3205 | profit rate: 3631950722795659682543168842373267456.0 | accuracy: 0.86
step_num: 8600 | loss: 0.3940 | profit rate: 3569973978537129358271490861535283680116736.0 | accuracy: 0.85
step_num: 8800 | loss: 0.2570 | profit rate: 5929114218435689574565972793582916107186995200.0 | accuracy: 0.85
step_num: 9000 | loss: 0.2241 | profit rate: 91362645382025634094425035740540587791364441243648.0 | accuracy: 0.85
step_num: 9200 | loss: 0.2682 | profit rate: 107379656988573967951039311528139907717913945982292751024128.0 | accuracy: 0.86
step_num: 9400 | loss: 0.3264 | profit rate: 66960028053593186733601600024448417161727691622233210483621494784.0 | accuracy: 0.85
step_num: 9600 | loss: 0.2613 | profit rate: 17364513608066317262916939543407451244954221648641515842259877973983232.0 | accuracy: 0.85
step_num: 9800 | loss: 0.2768 | profit rate: 1846017009107350494675688541635026057827718562983833871400194581113000165376.0 | accuracy: 0.85
step_num: 10000 | loss: 0.2543 | profit rate: 437767211517727371129821456127107967051661154104634784224009746637940767506563072.0 | accuracy: 0.85
step_num: 10200 | loss: 0.2645 | profit rate: 253992942604973836848730498545187768360263725749750387204409031052782369727033993330688.0 | accuracy: 0.85
step_num: 10400 | loss: 0.2911 | profit rate: 1955187594423289385354018252310973945748011041617068158644218838363794224354348699649835008.0 | accuracy: 0.85
episode:   3/5,耗时:1.36分/3.58分,训练集: | step: 10542 | average_treward: 3298.1 | max_treward: 3696.5688 | average profit rate: 1150479095680259037370496189161478830221823177446351737092113373160743795564025764857413369856.000
model saved @ step:10542,performance:293271110414743765945434362905381918395257911881237936677492560050607166307140244863530827776.000,accuracy:0.84
step_num: 10600 | loss: 0.2909 | profit rate:  432.9 | accuracy: 0.93
step_num: 10800 | loss: 0.2671 | profit rate: 34438179.9 | accuracy: 0.87
step_num: 11000 | loss: 0.2844 | profit rate: 1517292860884.8 | accuracy: 0.86
step_num: 11200 | loss: 0.2638 | profit rate: 1073178474317698048.0 | accuracy: 0.84
step_num: 11400 | loss: 0.2564 | profit rate: 11719556118140826943488.0 | accuracy: 0.84
step_num: 11600 | loss: 0.2532 | profit rate: 418841742584667498726601785344.0 | accuracy: 0.86
step_num: 11800 | loss: 0.2381 | profit rate: 32850601892209160895795395376971776.0 | accuracy: 0.86
step_num: 12000 | loss: 0.2704 | profit rate: 142798910294188210241603470661844467712.0 | accuracy: 0.85
step_num: 12200 | loss: 0.2557 | profit rate: 5510234705847704012430726112985472395345133568.0 | accuracy: 0.85
step_num: 12400 | loss: 0.2163 | profit rate: 8322276243055008941515836561965750295015630831616.0 | accuracy: 0.86
step_num: 12600 | loss: 0.2670 | profit rate: 9001153908431990322873441059157267849076946345788440576.0 | accuracy: 0.86
step_num: 12800 | loss: 0.2699 | profit rate: 145597331030031424768986650853930733905951790510129597292478464.0 | accuracy: 0.86
step_num: 13000 | loss: 0.2546 | profit rate: 328750680951953608572785025592832456560399912273011311995831401316352.0 | accuracy: 0.85
step_num: 13200 | loss: 0.2659 | profit rate: 372528849792083104479518529723119878079314486077024887208138128275361759232.0 | accuracy: 0.86
step_num: 13400 | loss: 0.2275 | profit rate: 18795741497784335527601737859581696537931445960727936883397024790747802140409856.0 | accuracy: 0.86
step_num: 13600 | loss: 0.2704 | profit rate: 5252628073223006580847933249910385470863331474805994174576143601780097294632465989632.0 | accuracy: 0.86
step_num: 13800 | loss: 0.2909 | profit rate: 2190487267535166499752744542092314530082905778838609501517288824222969328437836746458136576.0 | accuracy: 0.86
step_num: 14000 | loss: 0.2256 | profit rate: 9476695820516613922588140361783620745093092821050332096732304716655955862017847079933164126208.0 | accuracy: 0.86
model saved @ step:14056,performance:27811967617060639124724605243489170017035500525552022912952665927442932925948849153673112059904.000,accuracy:0.86
step_num: 14200 | loss: 0.2918 | profit rate: 60616.0 | accuracy: 0.85
step_num: 14400 | loss: 0.2553 | profit rate: 46471383184.3 | accuracy: 0.89
step_num: 14600 | loss: 0.2597 | profit rate: 2814582672967445.5 | accuracy: 0.87
step_num: 14800 | loss: 0.2073 | profit rate: 25691111469014839296.0 | accuracy: 0.86
step_num: 15000 | loss: 0.2572 | profit rate: 56008169290168077792575488.0 | accuracy: 0.87
step_num: 15200 | loss: 0.2549 | profit rate: 125109059102008168618319797026816.0 | accuracy: 0.87
step_num: 15400 | loss: 0.2068 | profit rate: 797441124351915795892038053207736320.0 | accuracy: 0.86
step_num: 15600 | loss: 0.3246 | profit rate: 12075543953007806547647412073276083804307456.0 | accuracy: 0.86
step_num: 15800 | loss: 0.2486 | profit rate: 65749862418432126765528523526565287753104228352.0 | accuracy: 0.86
step_num: 16000 | loss: 0.2191 | profit rate: 543328644625589386863316565411186625064764765634560.0 | accuracy: 0.87
step_num: 16200 | loss: 0.2543 | profit rate: 295934332608743301881089656685019444997172908661190344835072.0 | accuracy: 0.87
step_num: 16400 | loss: 0.2434 | profit rate: 5075495342972331233515643873214308520715163642087997881115153006592.0 | accuracy: 0.88
step_num: 16600 | loss: 0.2501 | profit rate: 988465968183499469948999478057092538032851889184891900861909198908162048.0 | accuracy: 0.87
step_num: 16800 | loss: 0.2752 | profit rate: 261182652798874162958665374314864662784890424597334717479126245322889206169600.0 | accuracy: 0.87
step_num: 17000 | loss: 0.2304 | profit rate: 30640434988443527119898958671453682228670409288095148130485848381357307656298037248.0 | accuracy: 0.87
step_num: 17200 | loss: 0.2439 | profit rate: 10207321447613555229404606667725480112721215745552807249974998970705399746951944605794304.0 | accuracy: 0.87
step_num: 17400 | loss: 0.2375 | profit rate: 121871775632355578868762902688474546702771979314446151391490338489955800034976845303669325824.0 | accuracy: 0.87
episode:   5/5,耗时:1.18分/6.16分,训练集: | step: 17570 | average_treward: 3495.8 | max_treward: 3814.3462 | average profit rate: 14578669680561624356043846507586590602106187304970371803125822703451514191641609725845430075392.000
model saved @ step:17570,performance:41629943498706700680115390759679138712848596102068651054060751513428716988348593848630353330176.000,accuracy:0.86
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 51/397 [00:00<00:00, 509.97it/s] 29%|       | 115/397 [00:00<00:00, 579.64it/s] 45%|     | 179/397 [00:00<00:00, 607.02it/s] 62%|   | 245/397 [00:00<00:00, 626.17it/s] 79%|  | 312/397 [00:00<00:00, 638.46it/s] 95%|| 377/397 [00:00<00:00, 642.35it/s]100%|| 397/397 [00:00<00:00, 623.04it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2258.25
2023-07-24T12:00:00 | net performance [%] = 125.8253
2023-07-24T12:00:00 | number of trades [#] = 34
==================================================
Trial 6 Complete [00h 06m 16s]
net_wealth: 2258.252996454235

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 19m 33s

Search: Running Trial #7

Value             |Best Value So Far |Hyperparameter
6                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.5               |0.5               |gamma
0.0001            |0.001             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4295.000000   4301.000000
mean      0.000435    20113.607657  ...   20191.527960  20169.373185
std       0.027833    16040.642334  ...   16078.872271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7755.915039   7730.930176
50%       0.000642    11571.842969  ...   11757.219727  11751.469727
75%       0.011590    29894.706152  ...   30018.430664  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.3687 | profit rate:    0.9 | accuracy: 0.34
step_num: 400 | loss: 0.7238 | profit rate:    0.2 | accuracy: 0.31
step_num: 600 | loss: 0.6409 | profit rate:    0.2 | accuracy: 0.33
step_num: 800 | loss: 0.5689 | profit rate:    0.7 | accuracy: 0.33
step_num: 1000 | loss: 0.5081 | profit rate:    2.1 | accuracy: 0.34
step_num: 1200 | loss: 0.5125 | profit rate:   40.2 | accuracy: 0.35
step_num: 1400 | loss: 0.3074 | profit rate:   82.0 | accuracy: 0.34
step_num: 1600 | loss: 0.4364 | profit rate:  616.9 | accuracy: 0.36
step_num: 1800 | loss: 0.4425 | profit rate: 21684.6 | accuracy: 0.38
step_num: 2000 | loss: 0.4568 | profit rate: 192149.8 | accuracy: 0.39
step_num: 2200 | loss: 0.4975 | profit rate: 22471568.5 | accuracy: 0.41
step_num: 2400 | loss: 0.5421 | profit rate: 34344161866.7 | accuracy: 0.43
step_num: 2600 | loss: 0.5217 | profit rate: 316938820102.0 | accuracy: 0.43
step_num: 2800 | loss: 0.5322 | profit rate: 47580124346227.8 | accuracy: 0.45
step_num: 3000 | loss: 0.4639 | profit rate: 1129991522879839.8 | accuracy: 0.46
step_num: 3200 | loss: 0.5685 | profit rate: 103954249304980928.0 | accuracy: 0.47
step_num: 3400 | loss: 0.5600 | profit rate: 20178991343858421760.0 | accuracy: 0.48
step_num: 3600 | loss: 0.5164 | profit rate: 318223449548444008448.0 | accuracy: 0.48
episode:   1/5,耗时:1.01分/1.01分,训练集: | step: 3665 | average_treward:  894.1 | max_treward: 894.1413 | average profit rate: 590953870073930055680.000
model saved @ step:3665,performance:590953870073930055680.000,accuracy:0.49
step_num: 3800 | loss: 0.6049 | profit rate: 1646.0 | accuracy: 0.65
step_num: 4000 | loss: 0.5298 | profit rate: 1110433.2 | accuracy: 0.65
step_num: 4200 | loss: 0.4248 | profit rate: 87773368.5 | accuracy: 0.64
step_num: 4400 | loss: 0.4720 | profit rate: 8049033929.9 | accuracy: 0.64
step_num: 4600 | loss: 0.5250 | profit rate: 84225043987.7 | accuracy: 0.64
step_num: 4800 | loss: 0.5347 | profit rate: 40717776156185.8 | accuracy: 0.64
step_num: 5000 | loss: 0.5383 | profit rate: 2394376468715376.0 | accuracy: 0.63
step_num: 5200 | loss: 0.5061 | profit rate: 81685324625420960.0 | accuracy: 0.63
step_num: 5400 | loss: 0.5961 | profit rate: 50569594024767913984.0 | accuracy: 0.64
step_num: 5600 | loss: 0.4638 | profit rate: 575634739969069416448.0 | accuracy: 0.64
step_num: 5800 | loss: 0.3512 | profit rate: 26143774970671995551744.0 | accuracy: 0.64
step_num: 6000 | loss: 0.5447 | profit rate: 58945708343553307799715840.0 | accuracy: 0.64
step_num: 6200 | loss: 0.6023 | profit rate: 7118189718164855106719186944.0 | accuracy: 0.64
step_num: 6400 | loss: 0.5846 | profit rate: 684597938693658558836663910400.0 | accuracy: 0.64
step_num: 6600 | loss: 0.4718 | profit rate: 43349084464011995058342855704576.0 | accuracy: 0.64
step_num: 6800 | loss: 0.5373 | profit rate: 5810572422167771514957011171147776.0 | accuracy: 0.64
step_num: 7000 | loss: 0.4739 | profit rate: 4958079321374205940358658924405063680.0 | accuracy: 0.64
step_num: 7200 | loss: 0.5355 | profit rate: 88027890571351876328177856047516483584.0 | accuracy: 0.64
model saved @ step:7330,performance:957153778156007900451127618734781366272.000,accuracy:0.64
step_num: 7400 | loss: 0.4767 | profit rate:   28.9 | accuracy: 0.62
step_num: 7600 | loss: 0.5668 | profit rate: 469897.3 | accuracy: 0.69
step_num: 7800 | loss: 0.4762 | profit rate: 69328306.0 | accuracy: 0.67
step_num: 8000 | loss: 0.3841 | profit rate: 2694413684.6 | accuracy: 0.68
step_num: 8200 | loss: 0.4662 | profit rate: 149815418008.4 | accuracy: 0.67
step_num: 8400 | loss: 0.5174 | profit rate: 7355285888773.0 | accuracy: 0.66
step_num: 8600 | loss: 0.5077 | profit rate: 3852308402118475.0 | accuracy: 0.66
step_num: 8800 | loss: 0.4295 | profit rate: 152857480581011904.0 | accuracy: 0.65
step_num: 9000 | loss: 0.5753 | profit rate: 75818195149126713344.0 | accuracy: 0.65
step_num: 9200 | loss: 0.4232 | profit rate: 2599550447476196507648.0 | accuracy: 0.65
step_num: 9400 | loss: 0.3783 | profit rate: 113618686749506690613248.0 | accuracy: 0.65
step_num: 9600 | loss: 0.4231 | profit rate: 138200024608227746012725248.0 | accuracy: 0.65
step_num: 9800 | loss: 0.5931 | profit rate: 32140529795324105950612160512.0 | accuracy: 0.65
step_num: 10000 | loss: 0.5483 | profit rate: 4715647748163793230702657404928.0 | accuracy: 0.65
step_num: 10200 | loss: 0.4307 | profit rate: 437287574618900078477392253812736.0 | accuracy: 0.65
step_num: 10400 | loss: 0.4638 | profit rate: 25322141148730527717231647868846080.0 | accuracy: 0.64
step_num: 10600 | loss: 0.4550 | profit rate: 12172377869917461640854265740174295040.0 | accuracy: 0.64
step_num: 10800 | loss: 0.4064 | profit rate: 867432971326796898813610232654304641024.0 | accuracy: 0.65
episode:   3/5,耗时:1.40分/3.52分,训练集: | step: 10995 | average_treward: 1448.2 | max_treward: 1747.5363 | average profit rate: 6416263293381621025588538486449783177216.000
model saved @ step:10995,performance:18291636101988854420735850581471333974016.000,accuracy:0.64
step_num: 11000 | loss: 0.4962 | profit rate:    1.3 | accuracy: 0.50
step_num: 11200 | loss: 0.5818 | profit rate: 60191.6 | accuracy: 0.69
step_num: 11400 | loss: 0.5306 | profit rate: 9339799.0 | accuracy: 0.67
step_num: 11600 | loss: 0.4378 | profit rate: 738444620.4 | accuracy: 0.68
step_num: 11800 | loss: 0.4605 | profit rate: 103557852002.0 | accuracy: 0.68
step_num: 12000 | loss: 0.5005 | profit rate: 2818955867238.0 | accuracy: 0.66
step_num: 12200 | loss: 0.5318 | profit rate: 3102191406578076.0 | accuracy: 0.67
step_num: 12400 | loss: 0.4180 | profit rate: 213879809307097920.0 | accuracy: 0.67
step_num: 12600 | loss: 0.4050 | profit rate: 5503704043082512384.0 | accuracy: 0.66
step_num: 12800 | loss: 0.5214 | profit rate: 4502158619065678036992.0 | accuracy: 0.66
step_num: 13000 | loss: 0.4023 | profit rate: 88563988225590875389952.0 | accuracy: 0.66
step_num: 13200 | loss: 0.3758 | profit rate: 29260486849940934629523456.0 | accuracy: 0.66
step_num: 13400 | loss: 0.5039 | profit rate: 17666126269146786542963916800.0 | accuracy: 0.66
step_num: 13600 | loss: 0.6142 | profit rate: 960294035799519398221492256768.0 | accuracy: 0.65
step_num: 13800 | loss: 0.4993 | profit rate: 469414197149702710979046739542016.0 | accuracy: 0.65
step_num: 14000 | loss: 0.4491 | profit rate: 10928865420394398434877692601958400.0 | accuracy: 0.65
step_num: 14200 | loss: 0.3926 | profit rate: 1103257839630287613006195012680024064.0 | accuracy: 0.65
step_num: 14400 | loss: 0.4293 | profit rate: 919879962174847611585031503809622310912.0 | accuracy: 0.65
step_num: 14600 | loss: 0.4594 | profit rate: 25765172652002750852195399198948303306752.0 | accuracy: 0.65
model saved @ step:14660,performance:40915356406140031217483832909343706054656.000,accuracy:0.65
step_num: 14800 | loss: 0.5386 | profit rate: 1872.7 | accuracy: 0.68
step_num: 15000 | loss: 0.4647 | profit rate: 1456876.7 | accuracy: 0.67
step_num: 15200 | loss: 0.3743 | profit rate: 266445479.2 | accuracy: 0.68
step_num: 15400 | loss: 0.4639 | profit rate: 41814455298.3 | accuracy: 0.69
step_num: 15600 | loss: 0.5301 | profit rate: 636452896639.7 | accuracy: 0.67
step_num: 15800 | loss: 0.4785 | profit rate: 868665722461882.5 | accuracy: 0.67
step_num: 16000 | loss: 0.4252 | profit rate: 84246134395290848.0 | accuracy: 0.67
step_num: 16200 | loss: 0.4355 | profit rate: 2044946834407487232.0 | accuracy: 0.66
step_num: 16400 | loss: 0.5374 | profit rate: 5922648643742785863680.0 | accuracy: 0.66
step_num: 16600 | loss: 0.4404 | profit rate: 79333179765359258894336.0 | accuracy: 0.66
step_num: 16800 | loss: 0.3885 | profit rate: 6074585089814228411351040.0 | accuracy: 0.66
step_num: 17000 | loss: 0.4535 | profit rate: 24995294133776556603612332032.0 | accuracy: 0.66
step_num: 17200 | loss: 0.5159 | profit rate: 2408100692151140235498341007360.0 | accuracy: 0.66
step_num: 17400 | loss: 0.5438 | profit rate: 241837139526216068194099758366720.0 | accuracy: 0.65
step_num: 17600 | loss: 0.4363 | profit rate: 14170188860597687473971235731275776.0 | accuracy: 0.65
step_num: 17800 | loss: 0.4459 | profit rate: 1293848877184085989076548372777664512.0 | accuracy: 0.65
step_num: 18000 | loss: 0.4886 | profit rate: 1049053987232221888230600680924969435136.0 | accuracy: 0.65
step_num: 18200 | loss: 0.5033 | profit rate: 29573314609778710073433658898533062803456.0 | accuracy: 0.65
episode:   5/5,耗时:1.08分/5.70分,训练集: | step: 18325 | average_treward: 1589.1 | max_treward: 1827.6753 | average profit rate: 73888855895122621449221971659364153425920.000
model saved @ step:18325,performance:309280133189328212951860409928127711543296.000,accuracy:0.65
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 12%|        | 50/408 [00:00<00:00, 499.98it/s] 29%|       | 117/408 [00:00<00:00, 596.47it/s] 45%|     | 182/408 [00:00<00:00, 619.89it/s] 61%|    | 247/408 [00:00<00:00, 631.73it/s] 76%|  | 312/408 [00:00<00:00, 638.29it/s] 93%|| 378/408 [00:00<00:00, 645.65it/s]100%|| 408/408 [00:00<00:00, 628.31it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 6408.91
2023-07-24T12:00:00 | net performance [%] = 540.8912
2023-07-24T12:00:00 | number of trades [#] = 122
==================================================
Trial 7 Complete [00h 06m 02s]
net_wealth: 6408.912017471113

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 25m 35s

Search: Running Trial #8

Value             |Best Value So Far |Hyperparameter
15                |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.85              |0.5               |gamma
0.001             |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4286.000000   4301.000000
mean      0.000435    20113.607657  ...   20224.573864  20169.373185
std       0.027833    16040.642334  ...   16079.545659  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7778.380005   7730.930176
50%       0.000642    11571.842969  ...   11768.989746  11751.469727
75%       0.011590    29894.706152  ...   30071.020508  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.0146 | profit rate:    2.0 | accuracy: 0.36
step_num: 400 | loss: 0.5054 | profit rate:   14.7 | accuracy: 0.39
step_num: 600 | loss: 0.4256 | profit rate:  156.5 | accuracy: 0.41
step_num: 800 | loss: 0.3451 | profit rate: 701979.0 | accuracy: 0.45
step_num: 1000 | loss: 0.3592 | profit rate: 4997467691.7 | accuracy: 0.50
step_num: 1200 | loss: 0.5902 | profit rate: 1045178535018038.0 | accuracy: 0.53
step_num: 1400 | loss: 0.3467 | profit rate: 32986165644241403904.0 | accuracy: 0.55
step_num: 1600 | loss: 0.2365 | profit rate: 89368865957657110904832.0 | accuracy: 0.58
step_num: 1800 | loss: 0.3539 | profit rate: 5799134856973363772866990964736.0 | accuracy: 0.60
step_num: 2000 | loss: 0.2947 | profit rate: 5880904957017908757142202688208896.0 | accuracy: 0.61
step_num: 2200 | loss: 0.3685 | profit rate: 29676336922517700877930513821776608231424.0 | accuracy: 0.64
step_num: 2400 | loss: 0.2714 | profit rate: 1294257199382557420179585955322844801872909303808.0 | accuracy: 0.65
step_num: 2600 | loss: 0.3546 | profit rate: 2259561212833467588505510065208319555093509909736587264.0 | accuracy: 0.65
step_num: 2800 | loss: 0.1799 | profit rate: 6830077593804397548956894243387903158194662161925618456854528.0 | accuracy: 0.67
step_num: 3000 | loss: 0.2508 | profit rate: 454494751784707813914426505362007402406853174618405133960110669824.0 | accuracy: 0.67
step_num: 3200 | loss: 0.2033 | profit rate: 226817326048978486210649531934308521386803081402741332113615210302930944.0 | accuracy: 0.68
step_num: 3400 | loss: 0.3043 | profit rate: 114053522444788379550703312340373169276954746303512174966227513682707110428672.0 | accuracy: 0.68
step_num: 3600 | loss: 0.3137 | profit rate: 255436017627618066532680269950930125022955144308810511085983529378583608341561344.0 | accuracy: 0.68
episode:   1/5,耗时:0.96分/0.96分,训练集: | step: 3648 | average_treward: 2817.8 | max_treward: 2817.7502 | average profit rate: 698131391269336538585435164456795907577527388033834873045492771308417409861287936.000
model saved @ step:3648,performance:698131391269336538585435164456795907577527388033834873045492771308417409861287936.000,accuracy:0.68
step_num: 3800 | loss: 0.2695 | profit rate: 768241346.3 | accuracy: 0.84
step_num: 4000 | loss: 0.1828 | profit rate: 7571616502388106.0 | accuracy: 0.87
step_num: 4200 | loss: 0.1817 | profit rate: 12058340607601099669504.0 | accuracy: 0.89
step_num: 4400 | loss: 0.2052 | profit rate: 37292900785070473884437839872.0 | accuracy: 0.87
step_num: 4600 | loss: 0.3077 | profit rate: 162801427648706898655622025183232.0 | accuracy: 0.87
step_num: 4800 | loss: 0.2180 | profit rate: 41561337844781021012561725586091693572096.0 | accuracy: 0.87
step_num: 5000 | loss: 0.2802 | profit rate: 12515509806355223779341985042338266434955640832.0 | accuracy: 0.86
step_num: 5200 | loss: 0.1991 | profit rate: 404741489765775106481963868650169543966843841019904.0 | accuracy: 0.86
step_num: 5400 | loss: 0.2852 | profit rate: 159732671969266236639592874376293920399783494743651889709056.0 | accuracy: 0.85
step_num: 5600 | loss: 0.1748 | profit rate: 149510574272931797913211423188591467746618435693962721004355584.0 | accuracy: 0.85
step_num: 5800 | loss: 0.1644 | profit rate: 62463509241919238152929624936539789418926191055344061588574448910336.0 | accuracy: 0.86
step_num: 6000 | loss: 0.3230 | profit rate: 2278986902559474293280121019758764620652042617242637284134179148463176899624960.0 | accuracy: 0.85
step_num: 6200 | loss: 0.1764 | profit rate: 45579178536682625183774017079926433230292966070845756371648212972633202653970940559360.0 | accuracy: 0.85
step_num: 6400 | loss: 0.3980 | profit rate: 10890528432065572537563117661923668208946076406936707730560899347566970575647058393779142656.0 | accuracy: 0.85
step_num: 6600 | loss: 0.1812 | profit rate: 1259083540360084424811295289765325316405589500444409641518093101622316005960173037797743798517760.0 | accuracy: 0.84
step_num: 6800 | loss: 0.1763 | profit rate: 716572071433953876380454927242756033523943695420396704570503239038336266556002836992664601052036726784.0 | accuracy: 0.84
step_num: 7000 | loss: 0.2493 | profit rate: 4245480766699555638852792981021231426881742795414798068764460509101330499971258925604562819129883041313325056.0 | accuracy: 0.84
step_num: 7200 | loss: 0.2642 | profit rate: 24397500890083084691825995811239442732974832755324832356790129526511998037675461624490145692770286042255598813184.0 | accuracy: 0.83
model saved @ step:7296,performance:745339058403112662197804173170758398047929147351353818847004312049538553799845456085190282935924432636938813440000.000,accuracy:0.83
step_num: 7400 | loss: 0.2271 | profit rate: 6327632.6 | accuracy: 0.88
step_num: 7600 | loss: 0.1829 | profit rate: 505834519573509.7 | accuracy: 0.88
step_num: 7800 | loss: 0.1680 | profit rate: 3165756276755918225408.0 | accuracy: 0.89
step_num: 8000 | loss: 0.1634 | profit rate: 1010290364904207587540467712.0 | accuracy: 0.85
step_num: 8200 | loss: 0.2151 | profit rate: 1818507915389910496381358833664.0 | accuracy: 0.83
step_num: 8400 | loss: 0.2226 | profit rate: 582205739200785996242619332346716880896.0 | accuracy: 0.84
step_num: 8600 | loss: 0.2350 | profit rate: 422847364559651270898106052935292976067772416.0 | accuracy: 0.84
step_num: 8800 | loss: 0.2493 | profit rate: 9927063886184159120012251918035811970130296963072.0 | accuracy: 0.83
step_num: 9000 | loss: 0.3063 | profit rate: 297071640787217303774276255099864116379980089080550522880.0 | accuracy: 0.83
step_num: 9200 | loss: 0.1897 | profit rate: 3392419891276124389994544447151779498067456956477232384049152.0 | accuracy: 0.84
step_num: 9400 | loss: 0.1423 | profit rate: 90022692390378117012686213656922861869959909587515087305096298496.0 | accuracy: 0.84
step_num: 9600 | loss: 0.2076 | profit rate: 693084076106169367115241117920360954969399733292959334912148701582727315456.0 | accuracy: 0.84
step_num: 9800 | loss: 0.1906 | profit rate: 18472134620764471967019391646260900797810923065868742273943142049653292591220785152.0 | accuracy: 0.84
step_num: 10000 | loss: 0.2427 | profit rate: 6439127789841280130683375855222948365592223994190312258969366984407660498677488941006848.0 | accuracy: 0.84
step_num: 10200 | loss: 0.2319 | profit rate: 2008341285081739926703238202562468008193917471618098939534010032195587042160935010875515863040.0 | accuracy: 0.83
step_num: 10400 | loss: 0.2252 | profit rate: 1494184703264987279743305213576923213751084278019036194038136740185790778452673232428187199284969472.0 | accuracy: 0.83
step_num: 10600 | loss: 0.2040 | profit rate: 17227525388809371191636068667711691032722431347933082434011219498497512751438884274051520626427378297470976.0 | accuracy: 0.83
step_num: 10800 | loss: 0.2352 | profit rate: 74123970175425895032922671279770222193187788846646562519803671261108978960777548993455985161750966759959035904.0 | accuracy: 0.83
episode:   3/5,耗时:1.04分/3.05分,训练集: | step: 10944 | average_treward: 3553.8 | max_treward: 3947.0039 | average profit rate: 256329742772613405828887380390202635300948940485467546816217283192411982396827564357002834716721773022195493109760.000
step_num: 11000 | loss: 0.2244 | profit rate:  532.4 | accuracy: 0.88
step_num: 11200 | loss: 0.2717 | profit rate: 2707124973208.5 | accuracy: 0.82
step_num: 11400 | loss: 0.2500 | profit rate: 21872115295609495552.0 | accuracy: 0.85
step_num: 11600 | loss: 0.1906 | profit rate: 551891711584732908093440.0 | accuracy: 0.82
step_num: 11800 | loss: 0.1452 | profit rate: 70119401997405834440907685888.0 | accuracy: 0.81
step_num: 12000 | loss: 0.1743 | profit rate: 31238562343311713518965278422073344.0 | accuracy: 0.81
step_num: 12200 | loss: 0.2310 | profit rate: 282148651529296669826504265831915106336768.0 | accuracy: 0.82
step_num: 12400 | loss: 0.1973 | profit rate: 27201276206769654576859456606317333926987694080.0 | accuracy: 0.81
step_num: 12600 | loss: 0.2070 | profit rate: 3208069418434443510957604809295406335178712808364703744.0 | accuracy: 0.82
step_num: 12800 | loss: 0.1702 | profit rate: 21613351830847992701760306015025555167034933613203485097984.0 | accuracy: 0.82
step_num: 13000 | loss: 0.1764 | profit rate: 284481957246436427919015296745040031503617114943837404800221184.0 | accuracy: 0.82
step_num: 13200 | loss: 0.2224 | profit rate: 181163463732102282932402675249755557360100983268379362659113791513427968.0 | accuracy: 0.82
step_num: 13400 | loss: 0.1837 | profit rate: 4840404419424872081185603268952670963252344430462657421960173568065364100644864.0 | accuracy: 0.83
step_num: 13600 | loss: 0.3437 | profit rate: 149889384813277372837629839952475224615298583605551268588663806988846669409397512339456.0 | accuracy: 0.83
step_num: 13800 | loss: 0.1631 | profit rate: 36379186608491591830551160807045695184466073512574524194415325270824356155047970850102837248.0 | accuracy: 0.83
step_num: 14000 | loss: 0.2226 | profit rate: 24181447049389705701977291439441509874815024361817783618955523826357253263754267226422866662653952.0 | accuracy: 0.82
step_num: 14200 | loss: 0.1585 | profit rate: 32579403553912613860617839070092588013251356929284093199166913045300399364930980652137762970979650240512.0 | accuracy: 0.83
step_num: 14400 | loss: 0.1631 | profit rate: 6281133034116371526899935467865966440888014863241665994191617244765609906156913784344819919414774877818716160.0 | accuracy: 0.82
step_num: 14600 | loss: 0.2188 | profit rate:    1.6 | accuracy: 1.00
step_num: 14800 | loss: 0.2997 | profit rate: 286416515183.5 | accuracy: 0.87
step_num: 15000 | loss: 0.1098 | profit rate: 1211241885739096576.0 | accuracy: 0.88
step_num: 15200 | loss: 0.1862 | profit rate: 37851494005259152392192.0 | accuracy: 0.86
step_num: 15400 | loss: 0.1705 | profit rate: 85482568252488161718440034304.0 | accuracy: 0.84
step_num: 15600 | loss: 0.2171 | profit rate: 24011106771027157836426048165642240.0 | accuracy: 0.84
step_num: 15800 | loss: 0.1761 | profit rate: 827285239759231435420196200747642990362624.0 | accuracy: 0.85
step_num: 16000 | loss: 0.1963 | profit rate: 59372548788194853946305170628109686567684014080.0 | accuracy: 0.83
step_num: 16200 | loss: 0.1940 | profit rate: 45269010798716733876358821577493046699126808354226176.0 | accuracy: 0.84
step_num: 16400 | loss: 0.2465 | profit rate: 78428534060741275931740448719868870692018426784521849405440.0 | accuracy: 0.83
step_num: 16600 | loss: 0.1601 | profit rate: 313809012656085876991000968708673632358787166448205538040741888.0 | accuracy: 0.84
step_num: 16800 | loss: 0.2559 | profit rate: 39561731493814533878101584956344072187701251109626704811848552459272192.0 | accuracy: 0.84
step_num: 17000 | loss: 0.1944 | profit rate: 1955825903606825386633457355329220376631957178958969106459272650271559153352704.0 | accuracy: 0.85
step_num: 17200 | loss: 0.2322 | profit rate: 30109998681865871213906792607154055619083582564719878266318213658775423752367138406400.0 | accuracy: 0.84
step_num: 17400 | loss: 0.2387 | profit rate: 21930716742042144859786567080114833107079383419023051249221074324150245997466716557866434560.0 | accuracy: 0.84
step_num: 17600 | loss: 0.2104 | profit rate: 12792522262512763987521595523264729718287783894261719170967171491785286704794408998422281965273088.0 | accuracy: 0.84
step_num: 17800 | loss: 0.1917 | profit rate: 7788302099403797903634626149241308031220348404644828817848767688342933132475664386404889077381949554688.0 | accuracy: 0.84
step_num: 18000 | loss: 0.1517 | profit rate: 8132137731674146697846297097473127729653055927567453421435410353155274855887737751815019189162901467341783040.0 | accuracy: 0.84
step_num: 18200 | loss: 0.2200 | profit rate: 32550425003130870046601448036384129145961618524828485940362652140875982067354724197100761785342013278687017828352.0 | accuracy: 0.83
episode:   5/5,耗时:1.37分/5.79分,训练集: | step: 18240 | average_treward: 3689.7 | max_treward: 3947.0039 | average profit rate: 168778219682386528053346420474183028374044231298641201630739032597641771006037001822038742778745289523988990525440.000
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 51/391 [00:00<00:00, 507.78it/s] 29%|       | 113/391 [00:00<00:00, 570.31it/s] 45%|     | 176/391 [00:00<00:00, 594.73it/s] 62%|   | 241/391 [00:00<00:00, 614.01it/s] 78%|  | 304/391 [00:00<00:00, 619.73it/s] 95%|| 370/391 [00:00<00:00, 630.46it/s]100%|| 391/391 [00:00<00:00, 611.11it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1712.39
2023-07-24T12:00:00 | net performance [%] = 71.2395
2023-07-24T12:00:00 | number of trades [#] = 26
==================================================
Trial 8 Complete [00h 06m 10s]
net_wealth: 1712.3948958467538

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 31m 45s

Search: Running Trial #9

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.6               |0.5               |gamma
1e-05             |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.7019 | profit rate:    1.1 | accuracy: 0.31
step_num: 400 | loss: 0.6351 | profit rate:    1.4 | accuracy: 0.31
step_num: 600 | loss: 0.6626 | profit rate:    1.6 | accuracy: 0.32
step_num: 800 | loss: 0.8621 | profit rate:    1.3 | accuracy: 0.34
step_num: 1000 | loss: 0.6138 | profit rate:    1.3 | accuracy: 0.33
step_num: 1200 | loss: 0.6257 | profit rate:    1.2 | accuracy: 0.31
step_num: 1400 | loss: 0.5551 | profit rate:    1.2 | accuracy: 0.31
step_num: 1600 | loss: 0.5569 | profit rate:    1.4 | accuracy: 0.31
step_num: 1800 | loss: 0.5654 | profit rate:    3.3 | accuracy: 0.31
step_num: 2000 | loss: 0.3045 | profit rate:    3.5 | accuracy: 0.31
step_num: 2200 | loss: 0.4600 | profit rate:    5.9 | accuracy: 0.30
step_num: 2400 | loss: 0.4780 | profit rate:    8.9 | accuracy: 0.30
step_num: 2600 | loss: 0.4836 | profit rate:   14.9 | accuracy: 0.31
step_num: 2800 | loss: 0.4055 | profit rate:   13.8 | accuracy: 0.30
step_num: 3000 | loss: 0.4966 | profit rate:   22.3 | accuracy: 0.31
step_num: 3200 | loss: 0.5969 | profit rate:   43.2 | accuracy: 0.31
step_num: 3400 | loss: 0.6279 | profit rate:   82.0 | accuracy: 0.32
step_num: 3600 | loss: 0.5324 | profit rate:  119.2 | accuracy: 0.32
episode:   1/5,耗时:0.94分/0.94分,训练集: | step: 3648 | average_treward:  168.0 | max_treward: 168.0300 | average profit rate: 122.243
model saved @ step:3648,performance:122.243,accuracy:0.32
step_num: 3800 | loss: 0.5064 | profit rate:    4.2 | accuracy: 0.41
step_num: 4000 | loss: 0.4220 | profit rate:    7.7 | accuracy: 0.40
step_num: 4200 | loss: 0.4706 | profit rate:    8.9 | accuracy: 0.39
step_num: 4400 | loss: 0.4653 | profit rate:   19.9 | accuracy: 0.40
step_num: 4600 | loss: 0.3650 | profit rate:   30.9 | accuracy: 0.39
step_num: 4800 | loss: 0.3748 | profit rate:   93.3 | accuracy: 0.38
step_num: 5000 | loss: 0.3059 | profit rate:  245.3 | accuracy: 0.38
step_num: 5200 | loss: 0.3608 | profit rate:  341.7 | accuracy: 0.38
step_num: 5400 | loss: 0.4247 | profit rate: 1766.5 | accuracy: 0.38
step_num: 5600 | loss: 0.2495 | profit rate: 2231.3 | accuracy: 0.37
step_num: 5800 | loss: 0.3197 | profit rate: 6045.6 | accuracy: 0.37
step_num: 6000 | loss: 0.4423 | profit rate: 22599.9 | accuracy: 0.38
step_num: 6200 | loss: 0.4523 | profit rate: 91668.3 | accuracy: 0.38
step_num: 6400 | loss: 0.4013 | profit rate: 223545.1 | accuracy: 0.38
step_num: 6600 | loss: 0.3863 | profit rate: 565109.7 | accuracy: 0.38
step_num: 6800 | loss: 0.4709 | profit rate: 1946224.4 | accuracy: 0.38
step_num: 7000 | loss: 0.5579 | profit rate: 5636495.3 | accuracy: 0.39
step_num: 7200 | loss: 0.5480 | profit rate: 7078611.4 | accuracy: 0.39
model saved @ step:7296,performance:10635131.867,accuracy:0.39
step_num: 7400 | loss: 0.4331 | profit rate:    3.5 | accuracy: 0.46
step_num: 7600 | loss: 0.3707 | profit rate:   13.1 | accuracy: 0.44
step_num: 7800 | loss: 0.4269 | profit rate:   28.6 | accuracy: 0.45
step_num: 8000 | loss: 0.4098 | profit rate:   85.8 | accuracy: 0.43
step_num: 8200 | loss: 0.4589 | profit rate:  211.0 | accuracy: 0.44
step_num: 8400 | loss: 0.3439 | profit rate:  608.8 | accuracy: 0.45
step_num: 8600 | loss: 0.3399 | profit rate: 2275.9 | accuracy: 0.44
step_num: 8800 | loss: 0.4099 | profit rate: 6464.2 | accuracy: 0.44
step_num: 9000 | loss: 0.3890 | profit rate: 46327.6 | accuracy: 0.44
step_num: 9200 | loss: 0.2461 | profit rate: 112626.9 | accuracy: 0.44
step_num: 9400 | loss: 0.3982 | profit rate: 265161.0 | accuracy: 0.44
step_num: 9600 | loss: 0.4360 | profit rate: 1785186.7 | accuracy: 0.45
step_num: 9800 | loss: 0.4586 | profit rate: 8413058.8 | accuracy: 0.45
step_num: 10000 | loss: 0.4832 | profit rate: 42042399.9 | accuracy: 0.45
step_num: 10200 | loss: 0.3851 | profit rate: 117209731.8 | accuracy: 0.45
step_num: 10400 | loss: 0.4348 | profit rate: 532631932.1 | accuracy: 0.45
step_num: 10600 | loss: 0.4194 | profit rate: 1762909698.4 | accuracy: 0.45
step_num: 10800 | loss: 0.4142 | profit rate: 3760716549.3 | accuracy: 0.45
episode:   3/5,耗时:1.03分/3.02分,训练集: | step: 10944 | average_treward:  495.8 | max_treward: 786.5019 | average profit rate: 2410815949.708
model saved @ step:10944,performance:7221812595.013,accuracy:0.45
step_num: 11000 | loss: 0.4060 | profit rate:    1.8 | accuracy: 0.40
step_num: 11200 | loss: 0.4373 | profit rate:   21.8 | accuracy: 0.50
step_num: 11400 | loss: 0.4036 | profit rate:   75.9 | accuracy: 0.49
step_num: 11600 | loss: 0.4311 | profit rate:  140.2 | accuracy: 0.48
step_num: 11800 | loss: 0.4483 | profit rate:  891.1 | accuracy: 0.49
step_num: 12000 | loss: 0.3243 | profit rate: 1811.8 | accuracy: 0.49
step_num: 12200 | loss: 0.3157 | profit rate: 9241.6 | accuracy: 0.48
step_num: 12400 | loss: 0.4146 | profit rate: 41754.2 | accuracy: 0.48
step_num: 12600 | loss: 0.4197 | profit rate: 237226.9 | accuracy: 0.49
step_num: 12800 | loss: 0.3582 | profit rate: 641209.3 | accuracy: 0.48
step_num: 13000 | loss: 0.3624 | profit rate: 1389123.3 | accuracy: 0.48
step_num: 13200 | loss: 0.3527 | profit rate: 10771423.6 | accuracy: 0.49
step_num: 13400 | loss: 0.3156 | profit rate: 95625873.0 | accuracy: 0.49
step_num: 13600 | loss: 0.3181 | profit rate: 771062551.2 | accuracy: 0.49
step_num: 13800 | loss: 0.3791 | profit rate: 1790400744.3 | accuracy: 0.49
step_num: 14000 | loss: 0.5027 | profit rate: 11364312733.1 | accuracy: 0.49
step_num: 14200 | loss: 0.4321 | profit rate: 39390859352.3 | accuracy: 0.49
step_num: 14400 | loss: 0.4391 | profit rate: 135465757536.7 | accuracy: 0.49
model saved @ step:14592,performance:309986544517.013,accuracy:0.49
step_num: 14600 | loss: 0.3963 | profit rate:    1.0 | accuracy: 0.33
step_num: 14800 | loss: 0.3774 | profit rate:   25.9 | accuracy: 0.53
step_num: 15000 | loss: 0.4440 | profit rate:  105.9 | accuracy: 0.54
step_num: 15200 | loss: 0.3817 | profit rate:  351.4 | accuracy: 0.53
step_num: 15400 | loss: 0.4154 | profit rate: 2555.8 | accuracy: 0.54
step_num: 15600 | loss: 0.3635 | profit rate: 6352.0 | accuracy: 0.54
step_num: 15800 | loss: 0.3362 | profit rate: 54055.7 | accuracy: 0.53
step_num: 16000 | loss: 0.3566 | profit rate: 224531.2 | accuracy: 0.53
step_num: 16200 | loss: 0.3515 | profit rate: 633644.6 | accuracy: 0.52
step_num: 16400 | loss: 0.3668 | profit rate: 6693984.9 | accuracy: 0.53
step_num: 16600 | loss: 0.3462 | profit rate: 14569425.6 | accuracy: 0.53
step_num: 16800 | loss: 0.3257 | profit rate: 59142965.8 | accuracy: 0.53
step_num: 17000 | loss: 0.4059 | profit rate: 844505359.7 | accuracy: 0.52
step_num: 17200 | loss: 0.3745 | profit rate: 9620483761.0 | accuracy: 0.53
step_num: 17400 | loss: 0.3256 | profit rate: 41520435999.9 | accuracy: 0.53
step_num: 17600 | loss: 0.4340 | profit rate: 258951446626.8 | accuracy: 0.53
step_num: 17800 | loss: 0.4406 | profit rate: 1862120865787.2 | accuracy: 0.53
step_num: 18000 | loss: 0.4497 | profit rate: 12183463885579.6 | accuracy: 0.53
step_num: 18200 | loss: 0.3943 | profit rate: 44737017812585.2 | accuracy: 0.53
episode:   5/5,耗时:1.02分/5.08分,训练集: | step: 18240 | average_treward:  717.0 | max_treward: 1161.3002 | average profit rate: 11304578779448.533
model saved @ step:18240,performance:56205674904876.531,accuracy:0.53
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 12%|        | 45/391 [00:00<00:00, 445.39it/s] 28%|       | 111/391 [00:00<00:00, 567.76it/s] 45%|     | 177/391 [00:00<00:00, 606.88it/s] 62%|   | 244/391 [00:00<00:00, 629.17it/s] 80%|  | 311/391 [00:00<00:00, 641.49it/s] 97%|| 378/391 [00:00<00:00, 648.92it/s]==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
100%|| 391/391 [00:00<00:00, 623.55it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 4220.72
2023-07-24T12:00:00 | net performance [%] = 322.0723
2023-07-24T12:00:00 | number of trades [#] = 54
==================================================
Trial 9 Complete [00h 05m 11s]
net_wealth: 4224.947569917831

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 36m 56s

Search: Running Trial #10

Value             |Best Value So Far |Hyperparameter
6                 |1                 |horizon
225               |225               |lookback
False             |False             |MarketFactor
8                 |3                 |lags
0.95              |0.5               |gamma
5e-05             |0.001             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4309.000000   4315.000000
mean      0.000441    20062.255222  ...   20140.547965  20118.633889
std       0.027818    16039.874230  ...   16077.550480  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7699.189941   7690.540039
50%       0.000642    11554.824463  ...   11743.940430  11715.610352
75%       0.011655    29873.081836  ...   29950.949219  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.6867 | profit rate:    2.0 | accuracy: 0.32
step_num: 400 | loss: 0.9847 | profit rate:    2.7 | accuracy: 0.35
step_num: 600 | loss: 0.8929 | profit rate:    2.6 | accuracy: 0.36
step_num: 800 | loss: 1.1594 | profit rate:   74.0 | accuracy: 0.39
step_num: 1000 | loss: 2.4596 | profit rate:  167.7 | accuracy: 0.39
step_num: 1200 | loss: 0.7055 | profit rate:  212.0 | accuracy: 0.35
step_num: 1400 | loss: 0.9584 | profit rate:  359.0 | accuracy: 0.35
step_num: 1600 | loss: 0.4783 | profit rate:  540.7 | accuracy: 0.34
step_num: 1800 | loss: 0.2472 | profit rate: 11295.3 | accuracy: 0.34
step_num: 2000 | loss: 0.9117 | profit rate: 15792.6 | accuracy: 0.32
step_num: 2200 | loss: 0.8173 | profit rate: 36373.8 | accuracy: 0.31
step_num: 2400 | loss: 0.6055 | profit rate: 77705.7 | accuracy: 0.29
step_num: 2600 | loss: 0.8742 | profit rate: 945860.9 | accuracy: 0.30
step_num: 2800 | loss: 0.6180 | profit rate: 15750057.2 | accuracy: 0.30
step_num: 3000 | loss: 0.5391 | profit rate: 166459902.5 | accuracy: 0.30
step_num: 3200 | loss: 0.5325 | profit rate: 1891532904.8 | accuracy: 0.32
step_num: 3400 | loss: 0.7573 | profit rate: 503372856159.0 | accuracy: 0.34
step_num: 3600 | loss: 0.6108 | profit rate: 15423631592642.1 | accuracy: 0.35
episode:   1/5,耗时:0.73分/0.73分,训练集: | step: 3674 | average_treward:  519.1 | max_treward: 519.0843 | average profit rate: 19803082023353.840
model saved @ step:3674,performance:19803082023353.840,accuracy:0.35
step_num: 3800 | loss: 0.9704 | profit rate:    6.8 | accuracy: 0.34
step_num: 4000 | loss: 0.5745 | profit rate:   66.4 | accuracy: 0.43
step_num: 4200 | loss: 0.8108 | profit rate: 2034.3 | accuracy: 0.47
step_num: 4400 | loss: 1.3488 | profit rate: 110060.1 | accuracy: 0.51
step_num: 4600 | loss: 0.4469 | profit rate: 508114.9 | accuracy: 0.50
step_num: 4800 | loss: 0.2608 | profit rate: 2030286.2 | accuracy: 0.43
step_num: 5000 | loss: 0.6738 | profit rate: 19885600.6 | accuracy: 0.42
step_num: 5200 | loss: 0.4924 | profit rate: 119687723.0 | accuracy: 0.43
step_num: 5400 | loss: 0.6745 | profit rate: 8223133749.0 | accuracy: 0.43
step_num: 5600 | loss: 0.1981 | profit rate: 30024540801.5 | accuracy: 0.40
step_num: 5800 | loss: 0.4143 | profit rate: 130731980194.9 | accuracy: 0.39
step_num: 6000 | loss: 0.2863 | profit rate: 1642310687169.4 | accuracy: 0.36
step_num: 6200 | loss: 0.4246 | profit rate: 23375066925381.8 | accuracy: 0.35
step_num: 6400 | loss: 0.3189 | profit rate: 1091517937299248.8 | accuracy: 0.37
step_num: 6600 | loss: 0.5114 | profit rate: 13810801326709832.0 | accuracy: 0.36
step_num: 6800 | loss: 0.7833 | profit rate: 1862735619509265664.0 | accuracy: 0.38
step_num: 7000 | loss: 0.8249 | profit rate: 330812727161955221504.0 | accuracy: 0.39
step_num: 7200 | loss: 0.5782 | profit rate: 15988110947273781805056.0 | accuracy: 0.40
model saved @ step:7348,performance:186312438081706052812800.000,accuracy:0.41
step_num: 7400 | loss: 0.3102 | profit rate:    1.9 | accuracy: 0.13
step_num: 7600 | loss: 0.8327 | profit rate: 1122.7 | accuracy: 0.50
step_num: 7800 | loss: 0.6096 | profit rate: 20192.6 | accuracy: 0.51
step_num: 8000 | loss: 0.5374 | profit rate: 119882.8 | accuracy: 0.52
step_num: 8200 | loss: 0.5871 | profit rate: 35560731.8 | accuracy: 0.54
step_num: 8400 | loss: 0.4358 | profit rate: 413134434.6 | accuracy: 0.49
step_num: 8600 | loss: 0.1696 | profit rate: 9282801386.2 | accuracy: 0.46
step_num: 8800 | loss: 0.7861 | profit rate: 458518813623.5 | accuracy: 0.48
step_num: 9000 | loss: 0.6107 | profit rate: 21058812501802.3 | accuracy: 0.47
step_num: 9200 | loss: 0.0078 | profit rate: 721665721010110.0 | accuracy: 0.46
step_num: 9400 | loss: 0.3284 | profit rate: 4847082067905323.0 | accuracy: 0.44
step_num: 9600 | loss: 0.3503 | profit rate: 255511803606606368.0 | accuracy: 0.42
step_num: 9800 | loss: 0.2515 | profit rate: 3045175528795125248.0 | accuracy: 0.40
step_num: 10000 | loss: 0.6289 | profit rate: 675762273067152179200.0 | accuracy: 0.42
step_num: 10200 | loss: 0.1831 | profit rate: 22053894875550614290432.0 | accuracy: 0.41
step_num: 10400 | loss: 0.7770 | profit rate: 3930484160724482173960192.0 | accuracy: 0.43
step_num: 10600 | loss: 0.6850 | profit rate: 530668813665369792998014976.0 | accuracy: 0.44
step_num: 10800 | loss: 0.5826 | profit rate: 211663124137338262984486551552.0 | accuracy: 0.45
step_num: 11000 | loss: 0.5120 | profit rate: 9393182257364242588809373417472.0 | accuracy: 0.46
episode:   3/5,耗时:0.80分/2.36分,训练集: | step: 11022 | average_treward:  913.7 | max_treward: 1281.0848 | average profit rate: 2831478719088808781262767521792.000
model saved @ step:11022,performance:8494435970953988066048567410688.000,accuracy:0.46
step_num: 11200 | loss: 0.8487 | profit rate:  444.8 | accuracy: 0.48
step_num: 11400 | loss: 0.6976 | profit rate: 83242.5 | accuracy: 0.53
step_num: 11600 | loss: 0.5820 | profit rate: 4345156.7 | accuracy: 0.57
step_num: 11800 | loss: 0.5628 | profit rate: 2355204855.0 | accuracy: 0.60
step_num: 12000 | loss: 0.3054 | profit rate: 34894772977.9 | accuracy: 0.57
step_num: 12200 | loss: 0.2467 | profit rate: 3653738091830.5 | accuracy: 0.53
step_num: 12400 | loss: 0.6878 | profit rate: 249306746641131.7 | accuracy: 0.52
step_num: 12600 | loss: 0.3671 | profit rate: 12047447345262332.0 | accuracy: 0.54
step_num: 12800 | loss: 0.4560 | profit rate: 4458867081768813056.0 | accuracy: 0.53
step_num: 13000 | loss: 0.1457 | profit rate: 47206671881681715200.0 | accuracy: 0.51
step_num: 13200 | loss: 0.2786 | profit rate: 2404853358761838903296.0 | accuracy: 0.51
step_num: 13400 | loss: 0.3650 | profit rate: 15765128361214566884966400.0 | accuracy: 0.51
step_num: 13600 | loss: 0.8227 | profit rate: 2272124611973730704939810816.0 | accuracy: 0.51
step_num: 13800 | loss: 0.5374 | profit rate: 1021444511473119540054465708032.0 | accuracy: 0.52
step_num: 14000 | loss: 0.6845 | profit rate: 66467270968986597804179793641472.0 | accuracy: 0.52
step_num: 14200 | loss: 0.5480 | profit rate: 14385390271386247728633310607310848.0 | accuracy: 0.53
step_num: 14400 | loss: 0.7597 | profit rate: 27385105264132567969530687631430516736.0 | accuracy: 0.54
step_num: 14600 | loss: 0.6288 | profit rate: 6158476595151304160201332846632359690240.0 | accuracy: 0.55
model saved @ step:14696,performance:23332014837857943029441089089245873700864.000,accuracy:0.56
step_num: 14800 | loss: 1.0337 | profit rate:  329.3 | accuracy: 0.52
step_num: 15000 | loss: 0.5445 | profit rate: 541406.9 | accuracy: 0.63
step_num: 15200 | loss: 0.6659 | profit rate: 246091001.5 | accuracy: 0.67
step_num: 15400 | loss: 1.0786 | profit rate: 48231894873.2 | accuracy: 0.67
step_num: 15600 | loss: 0.6250 | profit rate: 4933373231820.5 | accuracy: 0.68
step_num: 15800 | loss: 0.7182 | profit rate: 7039143419581088.0 | accuracy: 0.67
step_num: 16000 | loss: 0.7279 | profit rate: 5636860762616690688.0 | accuracy: 0.66
step_num: 16200 | loss: 0.7272 | profit rate: 274459874899849641984.0 | accuracy: 0.66
step_num: 16400 | loss: 0.8685 | profit rate: 108187868944768610336768.0 | accuracy: 0.66
step_num: 16600 | loss: 0.6055 | profit rate: 5807805440334763676139520.0 | accuracy: 0.65
step_num: 16800 | loss: 0.5704 | profit rate: 385274412842341936270409728.0 | accuracy: 0.65
step_num: 17000 | loss: 0.6643 | profit rate: 34801705650728831484356615733248.0 | accuracy: 0.66
step_num: 17200 | loss: 0.8640 | profit rate: 99575108751027113036074992395091968.0 | accuracy: 0.67
step_num: 17400 | loss: 0.7546 | profit rate: 35398919819051514046197825875352748032.0 | accuracy: 0.67
step_num: 17600 | loss: 0.6927 | profit rate: 17636517889560788591969794882676168065024.0 | accuracy: 0.67
step_num: 17800 | loss: 0.5891 | profit rate: 11441263863809813917407180539301178984366080.0 | accuracy: 0.68
step_num: 18000 | loss: 0.8512 | profit rate: 20330884206497748263878198074086188216416731136.0 | accuracy: 0.68
step_num: 18200 | loss: 0.4918 | profit rate: 11097828285098404128115658340867351345746841436160.0 | accuracy: 0.68
episode:   5/5,耗时:1.36分/4.53分,训练集: | step: 18370 | average_treward: 1335.6 | max_treward: 2185.2101 | average profit rate: 90784943722496831833349380473592975800631281319936.000
model saved @ step:18370,performance:453924718589152126695390820423987040125121592295424.000,accuracy:0.69
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 54/403 [00:00<00:00, 534.68it/s] 29%|       | 117/403 [00:00<00:00, 587.06it/s] 45%|     | 182/403 [00:00<00:00, 615.64it/s] 62%|   | 248/403 [00:00<00:00, 633.08it/s] 78%|  | 313/403 [00:00<00:00, 639.16it/s] 94%|| 379/403 [00:00<00:00, 646.04it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 628.60it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2812.10
2023-07-24T12:00:00 | net performance [%] = 181.2105
2023-07-24T12:00:00 | number of trades [#] = 30
==================================================
Trial 10 Complete [00h 04m 38s]
net_wealth: 2814.919431841794

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 41m 34s

Search: Running Trial #11

Value             |Best Value So Far |Hyperparameter
7                 |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
7                 |3                 |lags
0.7               |0.5               |gamma
0.0005            |0.001             |DQN_lr
64                |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4308.000000   4315.000000
mean      0.000441    20062.255222  ...   20144.178930  20118.633889
std       0.027818    16039.874230  ...   16077.649782  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7710.492310   7690.540039
50%       0.000642    11554.824463  ...   11744.425293  11715.610352
75%       0.011655    29873.081836  ...   29961.684570  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.6690 | profit rate:    3.3 | accuracy: 0.38
step_num: 400 | loss: 0.4067 | profit rate:    8.0 | accuracy: 0.39
step_num: 600 | loss: 0.3428 | profit rate:  454.7 | accuracy: 0.40
step_num: 800 | loss: 0.4731 | profit rate: 6229.3 | accuracy: 0.38
step_num: 1000 | loss: 0.4122 | profit rate: 92550.9 | accuracy: 0.38
step_num: 1200 | loss: 1.0030 | profit rate: 124481158.0 | accuracy: 0.42
step_num: 1400 | loss: 0.4821 | profit rate: 12798926218.0 | accuracy: 0.45
step_num: 1600 | loss: 0.3985 | profit rate: 637747200978.0 | accuracy: 0.47
step_num: 1800 | loss: 0.6684 | profit rate: 32834460803138720.0 | accuracy: 0.51
step_num: 2000 | loss: 0.6488 | profit rate: 558009635360328450048.0 | accuracy: 0.53
step_num: 2200 | loss: 0.3025 | profit rate: 1092698114063554886762496.0 | accuracy: 0.55
step_num: 2400 | loss: 0.2396 | profit rate: 2494687036309415446364291072.0 | accuracy: 0.57
step_num: 2600 | loss: 0.5343 | profit rate: 4178943606132544565716665237504.0 | accuracy: 0.58
step_num: 2800 | loss: 0.4925 | profit rate: 17865219991473182991945879940759552.0 | accuracy: 0.60
step_num: 3000 | loss: 0.2602 | profit rate: 20616524035387448686090780038290997248.0 | accuracy: 0.61
episode:   1/5,耗时:0.64分/0.64分,训练集: | step: 3170 | average_treward: 1689.4 | max_treward: 1689.4209 | average profit rate: 1086944382628944584547607830674418958336.000
model saved @ step:3170,performance:1086944382628944584547607830674418958336.000,accuracy:0.61
step_num: 3200 | loss: 0.2050 | profit rate:    3.3 | accuracy: 0.81
step_num: 3400 | loss: 0.3802 | profit rate: 17747.2 | accuracy: 0.77
step_num: 3600 | loss: 0.2049 | profit rate: 1532187.2 | accuracy: 0.76
step_num: 3800 | loss: 0.5750 | profit rate: 42740769337.8 | accuracy: 0.77
step_num: 4000 | loss: 0.3407 | profit rate: 152433186908051.5 | accuracy: 0.77
step_num: 4200 | loss: 0.2943 | profit rate: 162355420114083904.0 | accuracy: 0.78
step_num: 4400 | loss: 0.3120 | profit rate: 20792284655653914411008.0 | accuracy: 0.79
step_num: 4600 | loss: 0.2855 | profit rate: 3680002195567800884396032.0 | accuracy: 0.78
step_num: 4800 | loss: 0.2612 | profit rate: 837229222492270894856011776.0 | accuracy: 0.77
step_num: 5000 | loss: 0.2176 | profit rate: 1028102500632867831340770103656448.0 | accuracy: 0.78
step_num: 5200 | loss: 0.2561 | profit rate: 34781585989080808316707349064061026304.0 | accuracy: 0.78
step_num: 5400 | loss: 0.2781 | profit rate: 276983862490369262366184537815683361144832.0 | accuracy: 0.79
step_num: 5600 | loss: 0.3943 | profit rate: 699576182927462230858247297964347759125331968.0 | accuracy: 0.79
step_num: 5800 | loss: 0.2811 | profit rate: 3918093355502798224902055357729276725970572673024.0 | accuracy: 0.79
step_num: 6000 | loss: 0.2984 | profit rate: 83943568601501553082470034407303537587757942638116864.0 | accuracy: 0.79
step_num: 6200 | loss: 0.2635 | profit rate: 43860196258181285958405846331945121642879650736652681216.0 | accuracy: 0.79
model saved @ step:6340,performance:1751363129967060767166647084017057213550251773237263335424.000,accuracy:0.79
step_num: 6400 | loss: 0.2938 | profit rate:    8.4 | accuracy: 0.85
step_num: 6600 | loss: 0.4311 | profit rate: 62544.9 | accuracy: 0.82
step_num: 6800 | loss: 0.3146 | profit rate: 14943466.7 | accuracy: 0.82
step_num: 7000 | loss: 0.4050 | profit rate: 2530577797082.7 | accuracy: 0.82
step_num: 7200 | loss: 0.3055 | profit rate: 4074632286733433.5 | accuracy: 0.81
step_num: 7400 | loss: 0.4542 | profit rate: 3097028947967561728.0 | accuracy: 0.82
step_num: 7600 | loss: 0.3695 | profit rate: 1008896639105873771233280.0 | accuracy: 0.82
step_num: 7800 | loss: 0.2057 | profit rate: 88308242123062480627302400.0 | accuracy: 0.82
step_num: 8000 | loss: 0.3876 | profit rate: 78145155245222358755351461888.0 | accuracy: 0.81
step_num: 8200 | loss: 0.3235 | profit rate: 234301744277678890554285448493006848.0 | accuracy: 0.82
step_num: 8400 | loss: 0.3602 | profit rate: 15083709499637981368668040970703227322368.0 | accuracy: 0.82
step_num: 8600 | loss: 0.1617 | profit rate: 117540454893504740363664836071678975548588032.0 | accuracy: 0.82
step_num: 8800 | loss: 0.3364 | profit rate: 201213757419150439707892442833467104805410308096.0 | accuracy: 0.82
step_num: 9000 | loss: 0.2007 | profit rate: 1447753182357826314275925880430853071984016266100736.0 | accuracy: 0.82
step_num: 9200 | loss: 0.1888 | profit rate: 61315936733348332626835924455162347907235503759693971456.0 | accuracy: 0.82
step_num: 9400 | loss: 0.3009 | profit rate: 13105507646218815531461727659008975215558382068827328348160.0 | accuracy: 0.82
episode:   3/5,耗时:0.70分/2.05分,训练集: | step: 9510 | average_treward: 2355.6 | max_treward: 2780.3653 | average profit rate: 93073490947235447883051929335777669102836379325039145648128.000
model saved @ step:9510,performance:277469109711739278700599416198824111057011710080312391237632.000,accuracy:0.82
step_num: 9600 | loss: 0.3678 | profit rate:   12.3 | accuracy: 0.76
step_num: 9800 | loss: 0.4098 | profit rate: 210063.0 | accuracy: 0.82
step_num: 10000 | loss: 0.2090 | profit rate: 23855911.7 | accuracy: 0.82
step_num: 10200 | loss: 0.4587 | profit rate: 17010428576364.9 | accuracy: 0.83
step_num: 10400 | loss: 0.1700 | profit rate: 45643499361356320.0 | accuracy: 0.83
step_num: 10600 | loss: 0.3827 | profit rate: 43272115998766743552.0 | accuracy: 0.84
step_num: 10800 | loss: 0.0935 | profit rate: 30759453811548368016506880.0 | accuracy: 0.85
step_num: 11000 | loss: 0.4566 | profit rate: 1824629685375718524868100096.0 | accuracy: 0.83
step_num: 11200 | loss: 0.3879 | profit rate: 3941077811718614817418571153408.0 | accuracy: 0.82
step_num: 11400 | loss: 0.2382 | profit rate: 1972438864734969250146960598519250944.0 | accuracy: 0.83
step_num: 11600 | loss: 0.4652 | profit rate: 116582856357546085737704477870865680171008.0 | accuracy: 0.83
step_num: 11800 | loss: 0.2921 | profit rate: 1931504877529472220271394577271576375353933824.0 | accuracy: 0.83
step_num: 12000 | loss: 0.3488 | profit rate: 4114674243122982519771659711790074540859169177600.0 | accuracy: 0.83
step_num: 12200 | loss: 0.2452 | profit rate: 13678416606877289134033432763524465505339549868359680.0 | accuracy: 0.83
step_num: 12400 | loss: 0.4434 | profit rate: 521838499627842367237985491751764080876781117789985308672.0 | accuracy: 0.83
step_num: 12600 | loss: 0.4163 | profit rate: 510012342265127206226988863168256272147283356670800517136384.0 | accuracy: 0.83
model saved @ step:12680,performance:1800804695606454966803854894924618770715979741211852737085440.000,accuracy:0.83
step_num: 12800 | loss: 0.2581 | profit rate:   29.2 | accuracy: 0.80
step_num: 13000 | loss: 0.3960 | profit rate: 369529.7 | accuracy: 0.82
step_num: 13200 | loss: 0.1946 | profit rate: 434229901.2 | accuracy: 0.82
step_num: 13400 | loss: 0.3752 | profit rate: 72890822616488.2 | accuracy: 0.83
step_num: 13600 | loss: 0.1274 | profit rate: 237903391711917824.0 | accuracy: 0.83
step_num: 13800 | loss: 0.1938 | profit rate: 477483849680821485568.0 | accuracy: 0.84
step_num: 14000 | loss: 0.1711 | profit rate: 37470307279356180295581696.0 | accuracy: 0.84
step_num: 14200 | loss: 0.3292 | profit rate: 5716857860859287323319205888.0 | accuracy: 0.84
step_num: 14400 | loss: 0.3790 | profit rate: 78763975627679529628083647676416.0 | accuracy: 0.83
step_num: 14600 | loss: 0.4601 | profit rate: 30170806389894391799951017786082328576.0 | accuracy: 0.84
step_num: 14800 | loss: 0.3900 | profit rate: 1894112294361907014696429239319023176384512.0 | accuracy: 0.83
step_num: 15000 | loss: 0.3019 | profit rate: 15506738925167715890420955533925013212001992704.0 | accuracy: 0.84
step_num: 15200 | loss: 0.3333 | profit rate: 41662972188896624488842326770601876947643660238848.0 | accuracy: 0.83
step_num: 15400 | loss: 0.2409 | profit rate: 315799377218381710715170952015337251907275871488049152.0 | accuracy: 0.84
step_num: 15600 | loss: 0.3471 | profit rate: 6304688722341538856045695575119749751468145528534051323904.0 | accuracy: 0.84
step_num: 15800 | loss: 0.2622 | profit rate: 2854035232035869223372660492959538653154594181152223042469888.0 | accuracy: 0.84
episode:   5/5,耗时:0.68分/3.43分,训练集: | step: 15850 | average_treward: 2567.6 | max_treward: 2921.3610 | average profit rate: 1776236408329813949313102309978777826915365257748819281444864.000
model saved @ step:15850,performance:6801156873200908714871815848594726625748815817661645057949696.000,accuracy:0.84
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 12%|        | 47/404 [00:00<00:00, 465.33it/s] 28%|       | 114/404 [00:00<00:00, 583.59it/s] 45%|     | 180/404 [00:00<00:00, 617.59it/s] 61%|    | 247/404 [00:00<00:00, 638.21it/s] 78%|  | 314/404 [00:00<00:00, 649.65it/s] 94%|| 381/404 [00:00<00:00, 654.33it/s]100%|| 404/404 [00:00<00:00, 632.47it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2756.95
2023-07-24T12:00:00 | net performance [%] = 175.6954
2023-07-24T12:00:00 | number of trades [#] = 52
==================================================
Trial 11 Complete [00h 04m 10s]
net_wealth: 2756.9544006798105

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 45m 44s

Search: Running Trial #12

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.95              |0.5               |gamma
1e-05             |0.001             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.4221 | profit rate:    3.3 | accuracy: 0.34
step_num: 1200 | loss: 1.0065 | profit rate:    0.9 | accuracy: 0.35
step_num: 1400 | loss: 0.8254 | profit rate:    1.4 | accuracy: 0.34
step_num: 1600 | loss: 0.6940 | profit rate:    2.3 | accuracy: 0.34
step_num: 1800 | loss: 0.6274 | profit rate:  520.0 | accuracy: 0.35
step_num: 2000 | loss: 0.5893 | profit rate: 24437.0 | accuracy: 0.37
step_num: 2200 | loss: 0.6241 | profit rate: 222628422.4 | accuracy: 0.39
step_num: 2400 | loss: 0.6824 | profit rate: 35676297658882.8 | accuracy: 0.41
step_num: 2600 | loss: 0.7659 | profit rate: 957626452520349952.0 | accuracy: 0.43
step_num: 2800 | loss: 0.7696 | profit rate: 202454159207588069113856.0 | accuracy: 0.45
step_num: 3000 | loss: 0.7665 | profit rate: 2740929803488070522294501376.0 | accuracy: 0.47
step_num: 3200 | loss: 0.7569 | profit rate: 68606470314565189892395746983936.0 | accuracy: 0.48
step_num: 3400 | loss: 0.8405 | profit rate: 6718674381216409551028969813890301952.0 | accuracy: 0.50
step_num: 3600 | loss: 0.8779 | profit rate: 6122864986276796600121212084999187070976.0 | accuracy: 0.51
episode:   1/5,耗时:1.66分/1.66分,训练集: | step: 3654 | average_treward: 1330.4 | max_treward: 1330.3509 | average profit rate: 11814929967808051999089390473197794623488.000
model saved @ step:3654,performance:11814929967808051999089390473197794623488.000,accuracy:0.51
step_num: 3800 | loss: 0.9122 | profit rate: 81808460.0 | accuracy: 0.78
step_num: 4000 | loss: 0.9178 | profit rate: 182204280379901.8 | accuracy: 0.82
step_num: 4200 | loss: 0.8257 | profit rate: 71403009957128462336.0 | accuracy: 0.82
step_num: 4400 | loss: 0.8515 | profit rate: 80473343109888508120006656.0 | accuracy: 0.81
step_num: 4600 | loss: 0.8750 | profit rate: 58723254850327896637080338432.0 | accuracy: 0.80
step_num: 4800 | loss: 0.8855 | profit rate: 1203911669573619435867254802473811968.0 | accuracy: 0.81
step_num: 5000 | loss: 0.8561 | profit rate: 142380915331531263510973537273225465036800.0 | accuracy: 0.81
step_num: 5200 | loss: 0.8312 | profit rate: 3351876278210666647545317489069416567055319040.0 | accuracy: 0.81
step_num: 5400 | loss: 0.8760 | profit rate: 320222101037444600683454341020308320564077029318721536.0 | accuracy: 0.81
step_num: 5600 | loss: 0.7830 | profit rate: 142885074132022110753702353179376175184919972939145674752.0 | accuracy: 0.81
step_num: 5800 | loss: 0.8526 | profit rate: 19232522398884647894625300539650378991203738560113533830299648.0 | accuracy: 0.81
step_num: 6000 | loss: 0.7982 | profit rate: 65210407496419401745909736393536500666391317344678207385581035454464000.0 | accuracy: 0.82
step_num: 6200 | loss: 0.8495 | profit rate: 235878980014555007249561269902262161768497305002057587376313057469802188111872.0 | accuracy: 0.81
step_num: 6400 | loss: 0.8246 | profit rate: 25669732885259697455384431513434514979907881764714723347068454019194812972505497600.0 | accuracy: 0.81
step_num: 6600 | loss: 0.8132 | profit rate: 6259657733110601684648543339447222344051467761262276286745444136805066993169584588062720.0 | accuracy: 0.81
step_num: 6800 | loss: 0.7391 | profit rate: 276791001971646855786556013189656278551681453835834474913989337888287652077196441252062560256.0 | accuracy: 0.81
step_num: 7000 | loss: 0.7353 | profit rate: 283841119490270898049707950452440554364444731187754041910202356805647117018041175494029518672232448.0 | accuracy: 0.81
step_num: 7200 | loss: 0.7428 | profit rate: 403730769151070197943309997389833743384459712919366049547302121502008970740563708948749711960143036416.0 | accuracy: 0.81
model saved @ step:7308,performance:25008140282579726592521092602275920877453364130227012116317671420735124107045872690876824157749243805696.000,accuracy:0.80
step_num: 7400 | loss: 0.7158 | profit rate: 31302.9 | accuracy: 0.69
step_num: 7600 | loss: 0.7527 | profit rate: 3956044696516.0 | accuracy: 0.82
step_num: 7800 | loss: 0.7143 | profit rate: 10826959750603563008.0 | accuracy: 0.85
step_num: 8000 | loss: 0.6808 | profit rate: 2820760999911299483697152.0 | accuracy: 0.84
step_num: 8200 | loss: 0.6635 | profit rate: 12768921263845287854470070272.0 | accuracy: 0.83
step_num: 8400 | loss: 0.7070 | profit rate: 213647752070900471368777948385509376.0 | accuracy: 0.83
step_num: 8600 | loss: 0.6842 | profit rate: 246126139871826948890828725920924574941184.0 | accuracy: 0.84
step_num: 8800 | loss: 0.7538 | profit rate: 3374011772282940129638344043671944681024913408.0 | accuracy: 0.83
step_num: 9000 | loss: 0.6800 | profit rate: 119694659238254400744511175290254449084343656367783936.0 | accuracy: 0.83
step_num: 9200 | loss: 0.6980 | profit rate: 1800462421197683918499479648858581919963247924028691709952.0 | accuracy: 0.83
step_num: 9400 | loss: 0.6337 | profit rate: 27866845577352032866911516626663672411579817053980377521061888.0 | accuracy: 0.84
step_num: 9600 | loss: 0.6142 | profit rate: 141590299292659891974359867148807981605760245690369202713800071333281792.0 | accuracy: 0.85
step_num: 9800 | loss: 0.6855 | profit rate: 4673623213826392174402083431565264613744951189370757688651660723338506718412800.0 | accuracy: 0.85
step_num: 10000 | loss: 0.6536 | profit rate: 752525635235612176753152728815854223339024045315558168856544630179957745117724409856.0 | accuracy: 0.84
step_num: 10200 | loss: 0.6316 | profit rate: 773573576805670450778366977344227786762298837942294362263881460221038251972801548649496576.0 | accuracy: 0.85
step_num: 10400 | loss: 0.6083 | profit rate: 109567713008133273794180542251240767906755678894032063716362087988354594913826867737847471800320.0 | accuracy: 0.84
step_num: 10600 | loss: 0.6367 | profit rate: 334721046645697956592608844552163785078731895941042837988222676247588753903932217557991287799272177664.0 | accuracy: 0.85
step_num: 10800 | loss: 0.6176 | profit rate: 6684131499936886324506946167079629012586699123085644512673267094217919829961223508035344434183139372302336.0 | accuracy: 0.85
episode:   3/5,耗时:2.36分/6.37分,训练集: | step: 10962 | average_treward: 2905.3 | max_treward: 3839.0596 | average profit rate: 693596792991232742313338415033279677064888768816726788975910353456756615994295479231088873553773152450904064.000
model saved @ step:10962,performance:2080765370833415675930855687253956619894181390076072730676354714340895708740931273539177739328888944889692160.000,accuracy:0.84
step_num: 11000 | loss: 0.6205 | profit rate:  158.1 | accuracy: 0.87
step_num: 11200 | loss: 0.5811 | profit rate: 4451451909715.5 | accuracy: 0.92
step_num: 11400 | loss: 0.6190 | profit rate: 7127375651095474176.0 | accuracy: 0.92
step_num: 11600 | loss: 0.6003 | profit rate: 12900770941663004590080.0 | accuracy: 0.88
step_num: 11800 | loss: 0.5691 | profit rate: 82997872300855735070194925568.0 | accuracy: 0.87
step_num: 12000 | loss: 0.5851 | profit rate: 15416411034679170598619534462025728.0 | accuracy: 0.87
step_num: 12200 | loss: 0.6163 | profit rate: 512742244537484982415288313942633072295936.0 | accuracy: 0.88
step_num: 12400 | loss: 0.5547 | profit rate: 46330380664213860267279254606271451989496823808.0 | accuracy: 0.88
step_num: 12600 | loss: 0.6208 | profit rate: 2856326635467355405814432514670583896335980495229681664.0 | accuracy: 0.87
step_num: 12800 | loss: 0.5806 | profit rate: 23850300601561421869902480166541299337014654225825115668480.0 | accuracy: 0.87
step_num: 13000 | loss: 0.5627 | profit rate: 95037828223662760690385873385653729859822099956939889005559808.0 | accuracy: 0.87
step_num: 13200 | loss: 0.6047 | profit rate: 29378559505065317862473686950405908160269804885851314868996224030081024.0 | accuracy: 0.87
step_num: 13400 | loss: 0.5407 | profit rate: 1679447735642732408138580345478200526784285025498820704338553727449670896058368.0 | accuracy: 0.87
step_num: 13600 | loss: 0.5689 | profit rate: 23996503823821465541544991820675277080723136311440778883275939272960423068599083597824.0 | accuracy: 0.87
step_num: 13800 | loss: 0.5827 | profit rate: 5178089288180474059131041792517193377289103028035209241132251813819431533121579353248890880.0 | accuracy: 0.87
step_num: 14000 | loss: 0.5861 | profit rate: 1951679663454069618875209542104207019924823786799434741843422067640360618130416819924693023719424.0 | accuracy: 0.87
step_num: 14200 | loss: 0.5995 | profit rate: 88158296844318725639998061891618484197930195721741099898169680624126991971155868346279882517616001024.0 | accuracy: 0.86
step_num: 14400 | loss: 0.5919 | profit rate: 252980743693060249196265857119529999402188468991438408159813128315216169602880485644020110824719328699482112.0 | accuracy: 0.86
step_num: 14600 | loss: 0.6079 | profit rate: 358119645211707669052342539155233747165350316006417545514759571436151759764442730142094086915163105813824798720.0 | accuracy: 0.86
model saved @ step:14616,performance:411132048956158356108439015924836029893780104863478527723942875787177716860375205319545739735398025668778262528.000,accuracy:0.86
step_num: 14800 | loss: 0.6254 | profit rate: 44721978656.6 | accuracy: 0.91
step_num: 15000 | loss: 0.6435 | profit rate: 23765711555310076.0 | accuracy: 0.90
step_num: 15200 | loss: 0.6286 | profit rate: 4030622521615632039936.0 | accuracy: 0.88
step_num: 15400 | loss: 0.6331 | profit rate: 13076279710369305565618765824.0 | accuracy: 0.87
step_num: 15600 | loss: 0.6109 | profit rate: 58532220671013339948529764794368.0 | accuracy: 0.86
step_num: 15800 | loss: 0.5706 | profit rate: 23874272011103368148638321798425752895488.0 | accuracy: 0.87
step_num: 16000 | loss: 0.6249 | profit rate: 2169946658754588264583222527757846066487099392.0 | accuracy: 0.87
step_num: 16200 | loss: 0.5553 | profit rate: 45030115737443606993007845135473209995941826789376.0 | accuracy: 0.87
step_num: 16400 | loss: 0.5928 | profit rate: 5307965972793075403424211799468209299874936724357927403520.0 | accuracy: 0.87
step_num: 16600 | loss: 0.5360 | profit rate: 6959849528510111934354796432132303917565019836081032463908864.0 | accuracy: 0.86
step_num: 16800 | loss: 0.6088 | profit rate: 4637985659034820882297096340007548999958315761071153980765512925184.0 | accuracy: 0.86
step_num: 17000 | loss: 0.5808 | profit rate: 9042281643376927250494512947043799243434528623175228848784754540705765916672.0 | accuracy: 0.86
step_num: 17200 | loss: 0.5932 | profit rate: 30121541052342637658309520705991984782372696891041863705889831005444473492367998976.0 | accuracy: 0.86
step_num: 17400 | loss: 0.6015 | profit rate: 151232560601825786099307067983914658726904940340655675077534486305446089509593678629306368.0 | accuracy: 0.86
step_num: 17600 | loss: 0.6142 | profit rate: 22853801487749847800398265241341345518882744730290190978785778356206535354623072176730582024192.0 | accuracy: 0.86
step_num: 17800 | loss: 0.5624 | profit rate: 3064109043030659886713621029701908642893871164376942489485735896014796949692683643571890423362224128.0 | accuracy: 0.86
step_num: 18000 | loss: 0.6053 | profit rate: 2266883124348742910136601885810207336201181240817411012158076472413873855775063068309677877340283907080192.0 | accuracy: 0.86
step_num: 18200 | loss: 0.5869 | profit rate: 42410665667032829731722599725026270526783117592840557923656573643282755812077857184219046156144243239360135168.0 | accuracy: 0.85
episode:   5/5,耗时:2.38分/11.09分,训练集: | step: 18270 | average_treward: 3324.8 | max_treward: 3963.4905 | average profit rate: 113281430677962689283303863797468185464499295554284021338624106184953257303330861405363592392486256652096372736.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 53/397 [00:00<00:00, 529.98it/s] 30%|       | 118/397 [00:00<00:00, 600.57it/s] 46%|     | 184/397 [00:00<00:00, 624.85it/s] 63%|   | 251/397 [00:00<00:00, 642.61it/s] 80%|  | 317/397 [00:00<00:00, 648.87it/s] 97%|| 384/397 [00:00<00:00, 656.04it/s]==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
100%|| 397/397 [00:00<00:00, 638.25it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2036.37
2023-07-24T12:00:00 | net performance [%] = 103.6368
2023-07-24T12:00:00 | number of trades [#] = 42
==================================================
Trial 12 Complete [00h 12m 09s]
net_wealth: 2036.3677662630987

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 01h 57m 53s

Search: Running Trial #13

Value             |Best Value So Far |Hyperparameter
12                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.85              |0.5               |gamma
5e-05             |0.001             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.7018 | profit rate:    0.4 | accuracy: 0.34
step_num: 600 | loss: 0.6113 | profit rate:   59.1 | accuracy: 0.38
step_num: 800 | loss: 0.5491 | profit rate: 9106.8 | accuracy: 0.42
step_num: 1000 | loss: 0.5708 | profit rate: 706365.6 | accuracy: 0.44
step_num: 1200 | loss: 0.4133 | profit rate: 392457469193.6 | accuracy: 0.48
step_num: 1400 | loss: 0.3366 | profit rate: 92002127542662.0 | accuracy: 0.51
step_num: 1600 | loss: 0.2641 | profit rate: 143088992851363008.0 | accuracy: 0.54
step_num: 1800 | loss: 0.2924 | profit rate: 2143668713151078374309888.0 | accuracy: 0.57
step_num: 2000 | loss: 0.3310 | profit rate: 1756196853380906139753704849408.0 | accuracy: 0.59
step_num: 2200 | loss: 0.3080 | profit rate: 242115109207078401739048329515368448.0 | accuracy: 0.60
step_num: 2400 | loss: 0.3233 | profit rate: 10083257826243637065835322941550909980672.0 | accuracy: 0.62
step_num: 2600 | loss: 0.2106 | profit rate: 2701284192534890613799273567693412876356157440.0 | accuracy: 0.64
step_num: 2800 | loss: 0.2446 | profit rate: 2036425993885100009158243596320108957200903869300736.0 | accuracy: 0.65
step_num: 3000 | loss: 0.2242 | profit rate: 24069708735733047110061179436338566150559654971611021312.0 | accuracy: 0.67
episode:   1/5,耗时:1.18分/1.18分,训练集: | step: 3143 | average_treward: 2212.6 | max_treward: 2212.6456 | average profit rate: 3602981400878720742650723404338898223770916418484158070784.000
model saved @ step:3143,performance:3602981400878720742650723404338898223770916418484158070784.000,accuracy:0.67
step_num: 3200 | loss: 0.2375 | profit rate:    4.3 | accuracy: 0.72
step_num: 3400 | loss: 0.2446 | profit rate: 6669120.4 | accuracy: 0.84
step_num: 3600 | loss: 0.1995 | profit rate: 12448693034.3 | accuracy: 0.85
step_num: 3800 | loss: 0.1875 | profit rate: 173507159315466240.0 | accuracy: 0.85
step_num: 4000 | loss: 0.1907 | profit rate: 20134788764986454835200.0 | accuracy: 0.84
step_num: 4200 | loss: 0.2099 | profit rate: 295033700307180407800987648.0 | accuracy: 0.85
step_num: 4400 | loss: 0.2493 | profit rate: 13108288643801810923862160197025792.0 | accuracy: 0.85
step_num: 4600 | loss: 0.2391 | profit rate: 7549898604885722615044991549981065216.0 | accuracy: 0.84
step_num: 4800 | loss: 0.1850 | profit rate: 187523147048868265789328145345138325979136.0 | accuracy: 0.84
step_num: 5000 | loss: 0.1801 | profit rate: 238853559705105149999234161101955287365737626206208.0 | accuracy: 0.85
step_num: 5200 | loss: 0.2118 | profit rate: 607552394306261155679281076224835303738797552821638004736.0 | accuracy: 0.85
step_num: 5400 | loss: 0.1935 | profit rate: 398455695464689404031404109061652308485280153090138991105146880.0 | accuracy: 0.85
step_num: 5600 | loss: 0.1934 | profit rate: 8814768006893307405284299311271786255982130016721951056530728026112.0 | accuracy: 0.85
step_num: 5800 | loss: 0.1547 | profit rate: 1009670875929152868213539950246303009091979933159772662946275683689562112.0 | accuracy: 0.85
step_num: 6000 | loss: 0.2166 | profit rate: 482855441082483706260461095949684168018974130564930512604584723874213577883648.0 | accuracy: 0.84
step_num: 6200 | loss: 0.2752 | profit rate: 6925879170576658308180480152279904371854155590571055546767481613377152464017424384.0 | accuracy: 0.84
model saved @ step:6286,performance:32372920486658354682949620463305779705053825801702899260451723486092519520316948480.000,accuracy:0.84
step_num: 6400 | loss: 0.2610 | profit rate:   14.1 | accuracy: 0.77
step_num: 6600 | loss: 0.1900 | profit rate: 15630392.8 | accuracy: 0.84
step_num: 6800 | loss: 0.2215 | profit rate: 698116650169.8 | accuracy: 0.85
step_num: 7000 | loss: 0.1635 | profit rate: 8105159092629738496.0 | accuracy: 0.86
step_num: 7200 | loss: 0.2344 | profit rate: 353044920668130864267264.0 | accuracy: 0.84
step_num: 7400 | loss: 0.2474 | profit rate: 661480950714130665781814362112.0 | accuracy: 0.84
step_num: 7600 | loss: 0.2242 | profit rate: 43269673398944013282015773691215872.0 | accuracy: 0.85
step_num: 7800 | loss: 0.1586 | profit rate: 63762648024923253649267922260631486464.0 | accuracy: 0.85
step_num: 8000 | loss: 0.1529 | profit rate: 1141545797488564257518733208337583106089287680.0 | accuracy: 0.85
step_num: 8200 | loss: 0.1873 | profit rate: 6218828922618523198547157500986691132983235160571904.0 | accuracy: 0.85
step_num: 8400 | loss: 0.1799 | profit rate: 33209251182080797459195752825892586774387320674798316552192.0 | accuracy: 0.85
step_num: 8600 | loss: 0.2069 | profit rate: 2384353248646011642047531280571284470156102276907467266624323584.0 | accuracy: 0.85
step_num: 8800 | loss: 0.1817 | profit rate: 310604553971649419320711791874812918421901799414734948226570572005376.0 | accuracy: 0.85
step_num: 9000 | loss: 0.1612 | profit rate: 22338033051667319436888581134862911402150553935431539035766856372212203520.0 | accuracy: 0.85
step_num: 9200 | loss: 0.1986 | profit rate: 8506544820477900676604134379513318230062769650520017630577257066516667734949888.0 | accuracy: 0.85
step_num: 9400 | loss: 0.2100 | profit rate: 13024557144451749029699739360049810555934216562903212781288298584027898239606849536.0 | accuracy: 0.84
episode:   3/5,耗时:2.37分/4.91分,训练集: | step: 9429 | average_treward: 2866.5 | max_treward: 3197.9336 | average profit rate: 18225368099221629864320726763548944019080207593732337102723430184934472301181665280.000
step_num: 9600 | loss: 0.2412 | profit rate: 3008.9 | accuracy: 0.78
step_num: 9800 | loss: 0.1946 | profit rate: 65160677.0 | accuracy: 0.82
step_num: 10000 | loss: 0.1700 | profit rate: 35948162333796.7 | accuracy: 0.83
step_num: 10200 | loss: 0.1774 | profit rate: 204451255522017804288.0 | accuracy: 0.84
step_num: 10400 | loss: 0.1933 | profit rate: 767049610188188479913984.0 | accuracy: 0.82
step_num: 10600 | loss: 0.2234 | profit rate: 19548881275149414495366544359424.0 | accuracy: 0.83
step_num: 10800 | loss: 0.2120 | profit rate: 39427276250295929641104416371113984.0 | accuracy: 0.83
step_num: 11000 | loss: 0.1790 | profit rate: 306368512961796617427158194360256823296.0 | accuracy: 0.83
step_num: 11200 | loss: 0.1804 | profit rate: 45743424418990259358136162159902900254610030592.0 | accuracy: 0.83
step_num: 11400 | loss: 0.1706 | profit rate: 429748059826825062009528604438164534340775329799340032.0 | accuracy: 0.84
step_num: 11600 | loss: 0.1976 | profit rate: 75565203025144058614065359491778332558301019262156615450624.0 | accuracy: 0.83
step_num: 11800 | loss: 0.2285 | profit rate: 9638017552847671047595273319419977879236167757622177004940951552.0 | accuracy: 0.83
step_num: 12000 | loss: 0.1932 | profit rate: 1126530008023217333640115200211147111188143508070002741671031914627072.0 | accuracy: 0.84
step_num: 12200 | loss: 0.2165 | profit rate: 815948190816997428209710677529038114822540525576399874553397851806433804288.0 | accuracy: 0.84
step_num: 12400 | loss: 0.1756 | profit rate: 14673763117148556230206903526531138389167396422720055372991000092206227943063552.0 | accuracy: 0.83
step_num: 12600 | loss: 0.2407 | profit rate:    3.3 | accuracy: 0.86
step_num: 12800 | loss: 0.1568 | profit rate: 705186.5 | accuracy: 0.82
step_num: 13000 | loss: 0.1891 | profit rate: 2605045392.7 | accuracy: 0.83
step_num: 13200 | loss: 0.1582 | profit rate: 33567264253118864.0 | accuracy: 0.85
step_num: 13400 | loss: 0.1686 | profit rate: 2535075010596368809984.0 | accuracy: 0.85
step_num: 13600 | loss: 0.1952 | profit rate: 31419293493463612617916416.0 | accuracy: 0.84
step_num: 13800 | loss: 0.2162 | profit rate: 940635412776247468228371374145536.0 | accuracy: 0.84
step_num: 14000 | loss: 0.1797 | profit rate: 710511625388207039544819514834157568.0 | accuracy: 0.83
step_num: 14200 | loss: 0.1526 | profit rate: 14405287753095447561157351419459791749120.0 | accuracy: 0.83
step_num: 14400 | loss: 0.1669 | profit rate: 6636463883119299871556028945183176778677678505984.0 | accuracy: 0.84
step_num: 14600 | loss: 0.1524 | profit rate: 7933518131141263542882245630650356617139516579468279808.0 | accuracy: 0.84
step_num: 14800 | loss: 0.1569 | profit rate: 2159941642553275918169889326270054516267201673119804887662592.0 | accuracy: 0.84
step_num: 15000 | loss: 0.1527 | profit rate: 190311048275385120763798187273984124708863184525531805596516352000.0 | accuracy: 0.84
step_num: 15200 | loss: 0.1652 | profit rate: 63466628673788461653647983751875609664742144820323406310312473486426112.0 | accuracy: 0.85
step_num: 15400 | loss: 0.1696 | profit rate: 39215272220877322061826349386906609591232710999187567353283248388357562040320.0 | accuracy: 0.84
step_num: 15600 | loss: 0.1513 | profit rate: 144442093859051165982016847288559465372555968923042666399360886703434191645704192.0 | accuracy: 0.84
episode:   5/5,耗时:1.37分/7.64分,训练集: | step: 15715 | average_treward: 2989.0 | max_treward: 3206.0560 | average profit rate: 13228916103653142239154836141221152952938639726177057437751439687875189864344322048.000
model saved @ step:15715,performance:8180871840465887152951368964001485368513021152813705594411018629803772669623009280.000,accuracy:0.84
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 51/391 [00:00<00:00, 504.92it/s] 30%|       | 116/391 [00:00<00:00, 583.08it/s] 46%|     | 181/391 [00:00<00:00, 610.60it/s] 63%|   | 247/391 [00:00<00:00, 629.94it/s] 80%|  | 312/391 [00:00<00:00, 637.14it/s] 97%|| 378/391 [00:00<00:00, 644.88it/s]100%|| 391/391 [00:00<00:00, 624.58it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2329.95
2023-07-24T12:00:00 | net performance [%] = 132.9951
2023-07-24T12:00:00 | number of trades [#] = 32
==================================================
Trial 13 Complete [00h 08m 41s]
net_wealth: 2329.951260580495

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 06m 35s

Search: Running Trial #14

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
7                 |3                 |lags
0.95              |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.7251 | profit rate:   59.4 | accuracy: 0.38
step_num: 600 | loss: 0.6947 | profit rate:  660.9 | accuracy: 0.38
step_num: 800 | loss: 0.7351 | profit rate: 1046.6 | accuracy: 0.38
step_num: 1000 | loss: 0.7891 | profit rate:  652.4 | accuracy: 0.38
step_num: 1200 | loss: 0.7547 | profit rate: 41099.5 | accuracy: 0.40
step_num: 1400 | loss: 0.6388 | profit rate: 2194116.4 | accuracy: 0.42
step_num: 1600 | loss: 0.7906 | profit rate: 6445608533.2 | accuracy: 0.44
step_num: 1800 | loss: 0.9029 | profit rate: 18747036486.4 | accuracy: 0.44
step_num: 2000 | loss: 0.7037 | profit rate: 506134677948.2 | accuracy: 0.45
step_num: 2200 | loss: 0.8410 | profit rate: 7609807825681271808.0 | accuracy: 0.47
step_num: 2400 | loss: 0.8448 | profit rate: 11612427684263281819648.0 | accuracy: 0.48
step_num: 2600 | loss: 0.8186 | profit rate: 1119107384754932878934016.0 | accuracy: 0.48
step_num: 2800 | loss: 0.7181 | profit rate: 884564428678310188218843136.0 | accuracy: 0.49
step_num: 3000 | loss: 0.6657 | profit rate: 8728053508601865172569252954112.0 | accuracy: 0.50
step_num: 3200 | loss: 0.7482 | profit rate: 42554782937271383916513724641312768.0 | accuracy: 0.51
step_num: 3400 | loss: 0.6631 | profit rate: 1427790214432360757215525134672068608.0 | accuracy: 0.51
episode:   1/5,耗时:0.95分/0.95分,训练集: | step: 3535 | average_treward: 1065.3 | max_treward: 1065.3427 | average profit rate: 13137473911873834028925019856331341824.000
model saved @ step:3535,performance:13137473911873834028925019856331341824.000,accuracy:0.51
step_num: 3600 | loss: 0.7622 | profit rate:  564.6 | accuracy: 0.80
step_num: 3800 | loss: 0.6397 | profit rate: 138783.1 | accuracy: 0.69
step_num: 4000 | loss: 0.7184 | profit rate: 1049328217.6 | accuracy: 0.72
step_num: 4200 | loss: 0.6992 | profit rate: 1984254087447.7 | accuracy: 0.68
step_num: 4400 | loss: 0.6734 | profit rate: 23852874059409.1 | accuracy: 0.64
step_num: 4600 | loss: 0.8183 | profit rate: 13996773886777061376.0 | accuracy: 0.65
step_num: 4800 | loss: 0.6964 | profit rate: 1448963597560612126720.0 | accuracy: 0.63
step_num: 5000 | loss: 0.6967 | profit rate: 157786748156458592894976.0 | accuracy: 0.62
step_num: 5200 | loss: 0.6856 | profit rate: 3469364922245246136914804736.0 | accuracy: 0.62
step_num: 5400 | loss: 0.7532 | profit rate: 41020547060417405161199108096.0 | accuracy: 0.61
step_num: 5600 | loss: 0.6938 | profit rate: 20956501694901110158415926132736.0 | accuracy: 0.61
step_num: 5800 | loss: 0.8791 | profit rate: 541785152363953743645421380722329911296.0 | accuracy: 0.62
step_num: 6000 | loss: 0.7507 | profit rate: 3097014162478970736176335427951715881582592.0 | accuracy: 0.62
step_num: 6200 | loss: 0.6856 | profit rate: 108991536900441306132459983574826663913392701440.0 | accuracy: 0.62
step_num: 6400 | loss: 0.6862 | profit rate: 15984076478258524604791942813662832375566270726144.0 | accuracy: 0.63
step_num: 6600 | loss: 0.7167 | profit rate: 66248780146721520326476816288363010922282057855926272.0 | accuracy: 0.63
step_num: 6800 | loss: 0.7238 | profit rate: 325572308686888090637126888299564234165843648004677959680.0 | accuracy: 0.63
step_num: 7000 | loss: 0.7300 | profit rate: 8769212910900727838162872013805061851439305957728048906240.0 | accuracy: 0.62
model saved @ step:7070,performance:14228944369270530252031198596466312187200868248701724786688.000,accuracy:0.62
step_num: 7200 | loss: 0.7220 | profit rate: 1472.7 | accuracy: 0.65
step_num: 7400 | loss: 0.6867 | profit rate: 120498961.0 | accuracy: 0.70
step_num: 7600 | loss: 0.6367 | profit rate: 14289560160.8 | accuracy: 0.68
step_num: 7800 | loss: 0.7080 | profit rate: 3257556633316.3 | accuracy: 0.65
step_num: 8000 | loss: 0.6428 | profit rate: 1259905107613274.2 | accuracy: 0.64
step_num: 8200 | loss: 0.7593 | profit rate: 33052966649477287936.0 | accuracy: 0.64
step_num: 8400 | loss: 0.7503 | profit rate: 13453578037232855416832.0 | accuracy: 0.64
step_num: 8600 | loss: 0.7434 | profit rate: 489064607310037909000683520.0 | accuracy: 0.63
step_num: 8800 | loss: 0.6594 | profit rate: 24951257966874848395515658240.0 | accuracy: 0.62
step_num: 9000 | loss: 0.7195 | profit rate: 3003633426584197323704435212288.0 | accuracy: 0.62
step_num: 9200 | loss: 0.7489 | profit rate: 517244825415064215342279825622564864.0 | accuracy: 0.62
step_num: 9400 | loss: 0.8873 | profit rate: 47816265763622740378869484994674529665024.0 | accuracy: 0.63
step_num: 9600 | loss: 0.7439 | profit rate: 2668107876190418082957099956547382621683843072.0 | accuracy: 0.62
step_num: 9800 | loss: 0.6533 | profit rate: 6311476890894085326143897083024594233098934157312.0 | accuracy: 0.63
step_num: 10000 | loss: 0.6798 | profit rate: 13800036192354643286469499949167264516895284748353536.0 | accuracy: 0.63
step_num: 10200 | loss: 0.7173 | profit rate: 17524001042836566635002864390413784629185960512206143488.0 | accuracy: 0.63
step_num: 10400 | loss: 0.7403 | profit rate: 74651703428659028686294223593064862779641144668221213769728.0 | accuracy: 0.63
step_num: 10600 | loss: 0.6701 | profit rate: 550046873723605259447671799014396423903851349259339765383168.0 | accuracy: 0.63
episode:   3/5,耗时:1.41分/3.83分,训练集: | step: 10605 | average_treward: 1550.6 | max_treward: 1828.7976 | average profit rate: 188491298141817935649263128987944839627411983675307965022208.000
model saved @ step:10605,performance:551244950056183287846130787632679777462894219101402923270144.000,accuracy:0.63
step_num: 10800 | loss: 0.7050 | profit rate: 33741.7 | accuracy: 0.66
step_num: 11000 | loss: 0.6972 | profit rate: 234347821.8 | accuracy: 0.64
step_num: 11200 | loss: 0.6751 | profit rate: 168156643062.9 | accuracy: 0.64
step_num: 11400 | loss: 0.6710 | profit rate: 5182034602945.3 | accuracy: 0.62
step_num: 11600 | loss: 0.8504 | profit rate: 3238747729862400.0 | accuracy: 0.61
step_num: 11800 | loss: 0.6549 | profit rate: 43055836141317906432.0 | accuracy: 0.62
step_num: 12000 | loss: 0.6956 | profit rate: 30616438354655766904832.0 | accuracy: 0.62
step_num: 12200 | loss: 0.6246 | profit rate: 1043819487007650188833587200.0 | accuracy: 0.61
step_num: 12400 | loss: 0.6504 | profit rate: 23862211643685315766881615872.0 | accuracy: 0.61
step_num: 12600 | loss: 0.6147 | profit rate: 965913647027079176820042498048.0 | accuracy: 0.60
step_num: 12800 | loss: 0.6921 | profit rate: 5765363665716514407267918995557187584.0 | accuracy: 0.61
step_num: 13000 | loss: 0.7338 | profit rate: 309431576194024739648544084151391999754240.0 | accuracy: 0.61
step_num: 13200 | loss: 0.6947 | profit rate: 1493389509702038394560592861425776138794303488.0 | accuracy: 0.61
step_num: 13400 | loss: 0.6372 | profit rate: 2727417125321852142009434112107395268456040366080.0 | accuracy: 0.61
step_num: 13600 | loss: 0.5882 | profit rate: 33252129561705418233657776513669526963056806591463424.0 | accuracy: 0.62
step_num: 13800 | loss: 0.7183 | profit rate: 200200265542304442852098068067871388072406778444293079040.0 | accuracy: 0.62
step_num: 14000 | loss: 0.5959 | profit rate: 12701315686301314628000610439007741094172430057062526877696.0 | accuracy: 0.62
step_num: 14200 | loss: 0.6801 | profit rate:  409.3 | accuracy: 0.79
step_num: 14400 | loss: 0.6597 | profit rate: 236390.8 | accuracy: 0.66
step_num: 14600 | loss: 0.7342 | profit rate: 392412185.6 | accuracy: 0.66
step_num: 14800 | loss: 0.7079 | profit rate: 410460025971.2 | accuracy: 0.63
step_num: 15000 | loss: 0.7402 | profit rate: 22175201135862.5 | accuracy: 0.61
step_num: 15200 | loss: 0.7569 | profit rate: 2660768073677221376.0 | accuracy: 0.63
step_num: 15400 | loss: 0.7038 | profit rate: 792491823238095962112.0 | accuracy: 0.63
step_num: 15600 | loss: 0.6705 | profit rate: 403039034913141848801280.0 | accuracy: 0.63
step_num: 15800 | loss: 0.7089 | profit rate: 54175603420905228902368018432.0 | accuracy: 0.62
step_num: 16000 | loss: 0.6842 | profit rate: 1942162028412734501059448274944.0 | accuracy: 0.62
step_num: 16200 | loss: 0.6640 | profit rate: 472409947984440206724031668289536.0 | accuracy: 0.62
step_num: 16400 | loss: 0.7606 | profit rate: 2581322984724754346231635670581936914432.0 | accuracy: 0.62
step_num: 16600 | loss: 0.8415 | profit rate: 73699415670001809869109258205122752902332416.0 | accuracy: 0.62
step_num: 16800 | loss: 0.7188 | profit rate: 2750101752906591965695339743268514857196005097472.0 | accuracy: 0.63
step_num: 17000 | loss: 0.6045 | profit rate: 7826290989315631811209872212101275534363572477886464.0 | accuracy: 0.63
step_num: 17200 | loss: 0.6101 | profit rate: 8134320497030882257730512660763203186373118411312988160.0 | accuracy: 0.63
step_num: 17400 | loss: 0.7232 | profit rate: 36043084565003817796262975050895238012365295279906242953216.0 | accuracy: 0.63
step_num: 17600 | loss: 0.6713 | profit rate: 2653518122737338214715565571139209606494251576182008962875392.0 | accuracy: 0.63
episode:   5/5,耗时:1.34分/6.26分,训练集: | step: 17675 | average_treward: 1665.9 | max_treward: 1875.8133 | average profit rate: 948654437873327030330055877570370410262446502410434604171264.000
model saved @ step:17675,performance:4085972222086657101299790860413608737042081828388058081263616.000,accuracy:0.63
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 12%|        | 47/404 [00:00<00:00, 460.79it/s] 27%|       | 111/404 [00:00<00:00, 562.08it/s] 44%|     | 176/404 [00:00<00:00, 599.10it/s] 60%|    | 243/404 [00:00<00:00, 624.43it/s] 77%|  | 310/404 [00:00<00:00, 640.75it/s] 93%|| 377/404 [00:00<00:00, 648.44it/s]==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
100%|| 404/404 [00:00<00:00, 623.42it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2624.22
2023-07-24T12:00:00 | net performance [%] = 162.4220
2023-07-24T12:00:00 | number of trades [#] = 38
==================================================
Trial 14 Complete [00h 06m 37s]
net_wealth: 2624.2198513766075

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 13m 12s

Search: Running Trial #15

Value             |Best Value So Far |Hyperparameter
13                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.92              |0.5               |gamma
5e-05             |0.001             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4288.000000   4301.000000
mean      0.000435    20113.607657  ...   20217.089827  20169.373185
std       0.027833    16040.642334  ...   16079.528271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7773.282593   7730.930176
50%       0.000642    11571.842969  ...   11761.935059  11751.469727
75%       0.011590    29894.706152  ...   30060.440430  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.6714 | profit rate:    0.2 | accuracy: 0.33
step_num: 800 | loss: 0.5810 | profit rate:    0.7 | accuracy: 0.35
step_num: 1000 | loss: 0.6507 | profit rate: 2826.5 | accuracy: 0.38
step_num: 1200 | loss: 0.5109 | profit rate: 1721003.8 | accuracy: 0.42
step_num: 1400 | loss: 0.4977 | profit rate: 663142611.2 | accuracy: 0.45
step_num: 1600 | loss: 0.4207 | profit rate: 167636877486995.4 | accuracy: 0.47
step_num: 1800 | loss: 0.3905 | profit rate: 20036985333451148.0 | accuracy: 0.50
step_num: 2000 | loss: 0.3402 | profit rate: 274508568581208670208.0 | accuracy: 0.53
step_num: 2200 | loss: 0.3541 | profit rate: 8165507657221870449162452992.0 | accuracy: 0.55
step_num: 2400 | loss: 0.3736 | profit rate: 905872641375713167927547841740800.0 | accuracy: 0.56
step_num: 2600 | loss: 0.3312 | profit rate: 150492901583829517908772048399258091520.0 | accuracy: 0.58
step_num: 2800 | loss: 0.3175 | profit rate: 23085909469303780572530021599050433470398464.0 | accuracy: 0.60
step_num: 3000 | loss: 0.3629 | profit rate: 5801569649820583233835454204728910914185341173760.0 | accuracy: 0.62
step_num: 3200 | loss: 0.3497 | profit rate: 4456598296872761738452236075809337504054324462761279488.0 | accuracy: 0.63
step_num: 3400 | loss: 0.3394 | profit rate: 13627655364785233393792124286829042260972488640727674257408.0 | accuracy: 0.64
episode:   1/5,耗时:1.83分/1.83分,训练集: | step: 3508 | average_treward: 2260.1 | max_treward: 2260.1232 | average profit rate: 877688996132783266287916745938464404651445467418859105419264.000
model saved @ step:3508,performance:877688996132783266287916745938464404651445467418859105419264.000,accuracy:0.64
step_num: 3600 | loss: 0.3157 | profit rate: 14477.9 | accuracy: 0.91
step_num: 3800 | loss: 0.3057 | profit rate: 5010026561.5 | accuracy: 0.88
step_num: 4000 | loss: 0.2987 | profit rate: 6027697298718.6 | accuracy: 0.85
step_num: 4200 | loss: 0.2635 | profit rate: 19005380408254767104.0 | accuracy: 0.85
step_num: 4400 | loss: 0.2992 | profit rate: 3393487714002357274542080.0 | accuracy: 0.86
step_num: 4600 | loss: 0.2908 | profit rate: 46580259667743222747359654969344.0 | accuracy: 0.86
step_num: 4800 | loss: 0.2908 | profit rate: 1474704104692427915854456861015146496.0 | accuracy: 0.85
step_num: 5000 | loss: 0.2824 | profit rate: 18830788514617394049566909794372391842873344.0 | accuracy: 0.85
step_num: 5200 | loss: 0.3079 | profit rate: 119209703456880830235081795399352502943997755392.0 | accuracy: 0.84
step_num: 5400 | loss: 0.2997 | profit rate: 216681982266311472726779823167060824407601460543488.0 | accuracy: 0.84
step_num: 5600 | loss: 0.2394 | profit rate: 11229918630304719276273038019085010005940008936864630177792.0 | accuracy: 0.85
step_num: 5800 | loss: 0.2961 | profit rate: 160142881365880065094718124384937254013690549285577614204401090560.0 | accuracy: 0.84
step_num: 6000 | loss: 0.2891 | profit rate: 286325740069146025016043327506917900728656301131276650368868399156559872.0 | accuracy: 0.84
step_num: 6200 | loss: 0.2795 | profit rate: 39361712429542163208530130126146309281927452582645218368295530876189716512768.0 | accuracy: 0.84
step_num: 6400 | loss: 0.2983 | profit rate: 10648040751806873236491568704737051844700357875016535293413708379954317120717717504.0 | accuracy: 0.84
step_num: 6600 | loss: 0.2968 | profit rate: 302889973626352719652835652417457076383833559469740762006635011287344686652122288095232.0 | accuracy: 0.84
step_num: 6800 | loss: 0.2808 | profit rate: 96737762448566537764249465465436471689730831320558850748995345322465929387214838875065155584.0 | accuracy: 0.83
step_num: 7000 | loss: 0.2825 | profit rate: 131037885018004901137325553031635155549962406554726426910463354655783759155686681299014081576960.0 | accuracy: 0.83
Traceback (most recent call last):
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\keras_tuner\engine\base_tuner.py", line 270, in _try_run_and_update_trial
    self._run_and_update_trial(trial, *fit_args, **fit_kwargs)
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\keras_tuner\engine\base_tuner.py", line 235, in _run_and_update_trial
    results = self.run_trial(trial, *fit_args, **fit_kwargs)
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_KerasTuner.py", line 262, in run_trial
    Backtest_wealth = FinRobotSearchSpace(
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_KerasTuner.py", line 185, in FinRobotSearchSpace
    FinR_Agent_DDQN.learn(episodes=DDQN_episode)
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_DDQNModel_lib.py", line 1076, in learn
    self.ckpt_manager.save()
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\training\checkpoint_management.py", line 835, in save
    self._record_state()
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\training\checkpoint_management.py", line 728, in _record_state
    update_checkpoint_state_internal(
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\training\checkpoint_management.py", line 248, in update_checkpoint_state_internal
    file_io.atomic_write_string_to_file(coord_checkpoint_filename,
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\lib\io\file_io.py", line 648, in atomic_write_string_to_file
    rename(temp_pathname, filename, overwrite)
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\lib\io\file_io.py", line 607, in rename
    rename_v2(oldname, newname, overwrite)
  File "C:\Users\shoub\anaconda3\envs\DataScience\lib\site-packages\tensorflow\python\lib\io\file_io.py", line 623, in rename_v2
    _pywrap_file_io.RenameFile(
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xbe in position 110: invalid start byte
Trial 15 Complete [00h 04m 04s]

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 17m 16s

Search: Running Trial #16

Value             |Best Value So Far |Hyperparameter
13                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.7               |0.5               |gamma
0.0001            |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4288.000000   4301.000000
mean      0.000435    20113.607657  ...   20217.089827  20169.373185
std       0.027833    16040.642334  ...   16079.528271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7773.282593   7730.930176
50%       0.000642    11571.842969  ...   11761.935059  11751.469727
75%       0.011590    29894.706152  ...   30060.440430  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8827 | profit rate:    0.2 | accuracy: 0.29
step_num: 400 | loss: 0.5152 | profit rate:    0.7 | accuracy: 0.31
step_num: 600 | loss: 0.7243 | profit rate:   12.8 | accuracy: 0.33
step_num: 800 | loss: 0.4345 | profit rate:  178.3 | accuracy: 0.35
step_num: 1000 | loss: 0.5567 | profit rate: 1687370.7 | accuracy: 0.39
step_num: 1200 | loss: 0.3413 | profit rate: 8853309607.5 | accuracy: 0.43
step_num: 1400 | loss: 0.3168 | profit rate: 18494292871757.3 | accuracy: 0.47
step_num: 1600 | loss: 0.4428 | profit rate: 205115149572239065088.0 | accuracy: 0.51
step_num: 1800 | loss: 0.3042 | profit rate: 73366934249897952542720.0 | accuracy: 0.54
step_num: 2000 | loss: 0.3451 | profit rate: 570834824861031221312880640.0 | accuracy: 0.57
step_num: 2200 | loss: 0.3562 | profit rate: 56017343091037112908481362017648640.0 | accuracy: 0.59
step_num: 2400 | loss: 0.3125 | profit rate: 31881927860306188565499021333926470746112.0 | accuracy: 0.60
step_num: 2600 | loss: 0.2921 | profit rate: 5712519864957489142138919241129858188026314752.0 | accuracy: 0.62
step_num: 2800 | loss: 0.1691 | profit rate: 2740943590179684028360719671684827192060804935450624.0 | accuracy: 0.64
step_num: 3000 | loss: 0.1934 | profit rate: 954423060245138594024828521058314169443566162335896698880.0 | accuracy: 0.66
step_num: 3200 | loss: 0.2320 | profit rate: 2008716799003855210842704313432084916297782348727053642239049728.0 | accuracy: 0.67
step_num: 3400 | loss: 0.2408 | profit rate: 7216985373780945113674994861346810977877854306484545344243828260864.0 | accuracy: 0.68
episode:   1/5,耗时:0.82分/0.82分,训练集: | step: 3514 | average_treward: 2613.3 | max_treward: 2613.2623 | average profit rate: 653170515416939390183428468305009745193121426854353040387491753885696.000
model saved @ step:3514,performance:653170515416939390183428468305009745193121426854353040387491753885696.000,accuracy:0.69
step_num: 3600 | loss: 0.2278 | profit rate: 7117.9 | accuracy: 0.90
step_num: 3800 | loss: 0.2166 | profit rate: 3365535247.7 | accuracy: 0.88
step_num: 4000 | loss: 0.1878 | profit rate: 26374581097081.5 | accuracy: 0.89
step_num: 4200 | loss: 0.1712 | profit rate: 106082878714834731008.0 | accuracy: 0.90
step_num: 4400 | loss: 0.1526 | profit rate: 16025047039467624710799360.0 | accuracy: 0.90
step_num: 4600 | loss: 0.1680 | profit rate: 326415791287444020057630587224064.0 | accuracy: 0.90
step_num: 4800 | loss: 0.1931 | profit rate: 31301611562670208112020513830907936768.0 | accuracy: 0.89
step_num: 5000 | loss: 0.2729 | profit rate: 267302041218846828301096219910218074462093312.0 | accuracy: 0.89
step_num: 5200 | loss: 0.1978 | profit rate: 14850667324641331382763928987488192781973582774272.0 | accuracy: 0.89
step_num: 5400 | loss: 0.1600 | profit rate: 36565848840107134951781596059249022919841388727107584.0 | accuracy: 0.89
step_num: 5600 | loss: 0.2158 | profit rate: 3683924928209540444708620110138732027723042506147159544430592.0 | accuracy: 0.90
step_num: 5800 | loss: 0.2114 | profit rate: 135575656889576349843431535695807771327826142703857525104336563077120.0 | accuracy: 0.90
step_num: 6000 | loss: 0.2121 | profit rate: 1319525070565564261286928929049293144122086029260219821402074782899279757312.0 | accuracy: 0.90
step_num: 6200 | loss: 0.1654 | profit rate: 240187023423844121122979459588175790214590203756360394435937428276035970421227520.0 | accuracy: 0.89
step_num: 6400 | loss: 0.1665 | profit rate: 122594274176355043238271814211980134407931447000529152364099657528016802947157341503488.0 | accuracy: 0.89
step_num: 6600 | loss: 0.1860 | profit rate: 18462760028402597168336463256071812431639162837035311139943635446333003761862054879388762112.0 | accuracy: 0.89
step_num: 6800 | loss: 0.1441 | profit rate: 22258058142133334506801850892889702824159949396995224392335316497237758083823397681228118572924928.0 | accuracy: 0.89
step_num: 7000 | loss: 0.1974 | profit rate: 149953935684999245903661863592378101660767245755592202671443861727963073029710092940116233687616454656.0 | accuracy: 0.90
model saved @ step:7028,performance:250506047665222988440466168177646950821803152698431427373766806255544294381655349593837357540143267840.000,accuracy:0.89
step_num: 7200 | loss: 0.2435 | profit rate: 494911.1 | accuracy: 0.82
step_num: 7400 | loss: 0.1662 | profit rate: 1543133067762.7 | accuracy: 0.88
step_num: 7600 | loss: 0.1406 | profit rate: 807176484427364736.0 | accuracy: 0.90
step_num: 7800 | loss: 0.1279 | profit rate: 1138914645508319084544.0 | accuracy: 0.90
step_num: 8000 | loss: 0.1877 | profit rate: 99151845163836031004529655808.0 | accuracy: 0.91
step_num: 8200 | loss: 0.1433 | profit rate: 38474914277796626218226285149159424.0 | accuracy: 0.90
step_num: 8400 | loss: 0.1912 | profit rate: 1216798643550216032349099607455342526464.0 | accuracy: 0.89
step_num: 8600 | loss: 0.2004 | profit rate: 232607671805044574368593240816364532182955327488.0 | accuracy: 0.89
step_num: 8800 | loss: 0.1129 | profit rate: 567297553862182791729629004773388987642411109842944.0 | accuracy: 0.90
step_num: 9000 | loss: 0.1212 | profit rate: 18329554714770476039646451569030040984645302234172620800.0 | accuracy: 0.90
step_num: 9200 | loss: 0.1462 | profit rate: 146146171329250053703131333994969247224867484729647568086617817088.0 | accuracy: 0.91
step_num: 9400 | loss: 0.2020 | profit rate: 835595895824080933816324767616797315658011316859806330322065582819639296.0 | accuracy: 0.90
step_num: 9600 | loss: 0.2824 | profit rate: 412980891632721031155765374604813787731187607326256933534744844529365996797952.0 | accuracy: 0.90
step_num: 9800 | loss: 0.1817 | profit rate: 163613430436883220665628106179359709740080333725763442824773112576227569853978902528.0 | accuracy: 0.90
step_num: 10000 | loss: 0.1624 | profit rate: 59155821922673934051526286972280508044538216892173119011845378303514403784057494603563008.0 | accuracy: 0.90
step_num: 10200 | loss: 0.1404 | profit rate: 160516372522943345832913113200853126848060569750282216057193931658904847895901948621923840688128.0 | accuracy: 0.90
step_num: 10400 | loss: 0.1202 | profit rate: 3369617333470671569182800015583931564939097986280556587608703992953485282986863110535987633380655104.0 | accuracy: 0.90
episode:   3/5,耗时:0.91分/3.19分,训练集: | step: 10542 | average_treward: 3556.3 | max_treward: 4048.2468 | average profit rate: 412097447575138189958302672081214919456137536683255220213245453291220710091997601274412509408973029376.000
model saved @ step:10542,performance:985786295060191394938228194396006999278266402293519195594913004612723795720346119294588790986759995392.000,accuracy:0.90
step_num: 10600 | loss: 0.1795 | profit rate:  515.0 | accuracy: 0.92
step_num: 10800 | loss: 0.1866 | profit rate: 158537139.9 | accuracy: 0.87
step_num: 11000 | loss: 0.1110 | profit rate: 11935804003222.2 | accuracy: 0.88
step_num: 11200 | loss: 0.1133 | profit rate: 37857960266885349376.0 | accuracy: 0.90
step_num: 11400 | loss: 0.1143 | profit rate: 1355743191155835435745280.0 | accuracy: 0.91
step_num: 11600 | loss: 0.2008 | profit rate: 158229370451552222695661194182656.0 | accuracy: 0.91
step_num: 11800 | loss: 0.1652 | profit rate: 25933078902588332543322221273455525888.0 | accuracy: 0.90
step_num: 12000 | loss: 0.1755 | profit rate: 265103790037397592432956938676801504280576.0 | accuracy: 0.90
step_num: 12200 | loss: 0.1826 | profit rate: 25651351540341966355675969936947750610221194543104.0 | accuracy: 0.90
step_num: 12400 | loss: 0.0834 | profit rate: 63511263340871337696764544375841965404567944063614976.0 | accuracy: 0.90
step_num: 12600 | loss: 0.1581 | profit rate: 234364129612391165005739838093472047334291124949801506963456.0 | accuracy: 0.91
step_num: 12800 | loss: 0.1218 | profit rate: 59752773869569116843212776402177164491411768259293035844925017554944.0 | accuracy: 0.91
step_num: 13000 | loss: 0.2328 | profit rate: 419484375271732340945406810299253860967721619864852303696532966206181736448.0 | accuracy: 0.91
step_num: 13200 | loss: 0.1864 | profit rate: 736257176023714495634825810720197473175530265786065059487189144783173368527454208.0 | accuracy: 0.90
step_num: 13400 | loss: 0.1479 | profit rate: 129586723206261274629105491784046508406174513871649229312734806629332651225948841050112.0 | accuracy: 0.90
step_num: 13600 | loss: 0.1436 | profit rate: 76138137712182820186533335242527030977933455426625904184650667517081065185447354470403932160.0 | accuracy: 0.90
step_num: 13800 | loss: 0.1621 | profit rate: 96263176391918474357193107046839202356665926121596578549041755129460253832556442151952438001664000.0 | accuracy: 0.91
step_num: 14000 | loss: 0.1556 | profit rate: 1051231322558835710655515748113579683358110281574026792577459154095647956125790545117197174992569106432.0 | accuracy: 0.91
model saved @ step:14056,performance:3335850341581016109649275254669000671968404449417747954187334791790311318109163274753365613500134588416.000,accuracy:0.90
step_num: 14200 | loss: 0.2801 | profit rate: 132932.0 | accuracy: 0.83
step_num: 14400 | loss: 0.1885 | profit rate: 337680018677.0 | accuracy: 0.89
step_num: 14600 | loss: 0.1117 | profit rate: 72144621802892048.0 | accuracy: 0.91
step_num: 14800 | loss: 0.1123 | profit rate: 1060612059900468396032.0 | accuracy: 0.90
step_num: 15000 | loss: 0.1708 | profit rate: 7039476660901928343005298688.0 | accuracy: 0.91
step_num: 15200 | loss: 0.1414 | profit rate: 26723125264167510996011996516712448.0 | accuracy: 0.90
step_num: 15400 | loss: 0.1607 | profit rate: 516945583281347853983395870656755138560.0 | accuracy: 0.90
step_num: 15600 | loss: 0.1816 | profit rate: 32207668829043341885462149133346615077629853696.0 | accuracy: 0.90
step_num: 15800 | loss: 0.1074 | profit rate: 364724288455560478595308900913772532245250908880896.0 | accuracy: 0.90
step_num: 16000 | loss: 0.1513 | profit rate: 4451352844956314559939251460989479729427250883313270784.0 | accuracy: 0.91
step_num: 16200 | loss: 0.1952 | profit rate: 7087352891281588805945546405891047021327181532436213759112904704.0 | accuracy: 0.91
step_num: 16400 | loss: 0.1587 | profit rate: 216622221467968531932375839839343280196623397296802095222031537349328896.0 | accuracy: 0.91
step_num: 16600 | loss: 0.1875 | profit rate: 72288680141757203430939930111680139300114459843535734086471861663017719562240.0 | accuracy: 0.91
step_num: 16800 | loss: 0.1289 | profit rate: 51315285572548380812562566837246377642641714736098681429205316392613698281639247872.0 | accuracy: 0.90
step_num: 17000 | loss: 0.1699 | profit rate: 17169895706600095007310281452900229858287658178510297108665426443450498101904778295508992.0 | accuracy: 0.90
step_num: 17200 | loss: 0.1234 | profit rate: 33281539090161449206261870616756374619242086432558041356589338388779727817128961678472044871680.0 | accuracy: 0.90
step_num: 17400 | loss: 0.0838 | profit rate: 2393862491232133183241829647312057270722801777215584711993838204292652437451784155072568738925510656.0 | accuracy: 0.91
episode:   5/5,耗时:0.91分/5.02分,训练集: | step: 17570 | average_treward: 3770.7 | max_treward: 4098.3420 | average profit rate: 1155520161978866616367501562434268385907155493157169547360445907315165757318188705372142553379054288896.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 12%|        | 49/397 [00:00<00:00, 488.66it/s] 28%|       | 112/397 [00:00<00:00, 568.36it/s] 44%|     | 174/397 [00:00<00:00, 589.17it/s] 60%|    | 239/397 [00:00<00:00, 610.66it/s] 77%|  | 304/397 [00:00<00:00, 624.76it/s] 93%|| 370/397 [00:00<00:00, 634.54it/s]==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
100%|| 397/397 [00:00<00:00, 612.85it/s]
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2305.98
2023-07-24T12:00:00 | net performance [%] = 130.5979
2023-07-24T12:00:00 | number of trades [#] = 46
==================================================
Trial 16 Complete [00h 05m 31s]
net_wealth: 2305.9789122220295

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 22m 47s

Search: Running Trial #17

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
3                 |3                 |lags
0.7               |0.5               |gamma
0.0005            |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4314.000000   4315.000000
mean      0.000441    20062.255222  ...   20122.295285  20118.633889
std       0.027818    16039.874230  ...   16077.162832  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7691.585083   7690.540039
50%       0.000642    11554.824463  ...   11724.320312  11715.610352
75%       0.011655    29873.081836  ...   29925.802734  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.5248 | profit rate:    1.0 | accuracy: 0.38
step_num: 400 | loss: 0.5436 | profit rate:    1.2 | accuracy: 0.37
step_num: 600 | loss: 0.3903 | profit rate:    1.4 | accuracy: 0.38
step_num: 800 | loss: 0.3703 | profit rate:    2.6 | accuracy: 0.37
step_num: 1000 | loss: 0.3391 | profit rate:    7.3 | accuracy: 0.38
step_num: 1200 | loss: 0.3499 | profit rate:   39.8 | accuracy: 0.38
step_num: 1400 | loss: 0.1887 | profit rate:   85.5 | accuracy: 0.37
step_num: 1600 | loss: 0.2078 | profit rate:  203.9 | accuracy: 0.38
step_num: 1800 | loss: 0.2863 | profit rate: 5290.0 | accuracy: 0.40
step_num: 2000 | loss: 0.2132 | profit rate: 108352.4 | accuracy: 0.42
step_num: 2200 | loss: 0.2079 | profit rate: 3359991.0 | accuracy: 0.44
step_num: 2400 | loss: 0.1681 | profit rate: 64624852.2 | accuracy: 0.47
step_num: 2600 | loss: 0.2521 | profit rate: 1352288424.7 | accuracy: 0.49
step_num: 2800 | loss: 0.1699 | profit rate: 51185039808.3 | accuracy: 0.52
step_num: 3000 | loss: 0.1215 | profit rate: 1149279950360.4 | accuracy: 0.54
episode:   1/5,耗时:0.69分/0.69分,训练集: | step: 3174 | average_treward: 1362.0 | max_treward: 1361.9516 | average profit rate: 5808390128393.224
model saved @ step:3174,performance:5808390128393.224,accuracy:0.55
step_num: 3200 | loss: 0.1147 | profit rate:    1.6 | accuracy: 0.93
step_num: 3400 | loss: 0.2102 | profit rate:   19.3 | accuracy: 0.83
step_num: 3600 | loss: 0.1808 | profit rate:  150.9 | accuracy: 0.83
step_num: 3800 | loss: 0.1222 | profit rate: 6316.9 | accuracy: 0.85
step_num: 4000 | loss: 0.0959 | profit rate: 157841.9 | accuracy: 0.86
step_num: 4200 | loss: 0.1094 | profit rate: 2098988.0 | accuracy: 0.86
step_num: 4400 | loss: 0.1356 | profit rate: 137236878.5 | accuracy: 0.86
step_num: 4600 | loss: 0.0865 | profit rate: 1496456720.4 | accuracy: 0.86
step_num: 4800 | loss: 0.0735 | profit rate: 16245479731.2 | accuracy: 0.87
step_num: 5000 | loss: 0.0791 | profit rate: 2355542247730.2 | accuracy: 0.87
step_num: 5200 | loss: 0.0680 | profit rate: 283504174771691.7 | accuracy: 0.88
step_num: 5400 | loss: 0.0411 | profit rate: 15275360543638530.0 | accuracy: 0.88
step_num: 5600 | loss: 0.0847 | profit rate: 580999089579747968.0 | accuracy: 0.88
step_num: 5800 | loss: 0.0933 | profit rate: 16301063561829347328.0 | accuracy: 0.88
step_num: 6000 | loss: 0.0830 | profit rate: 773941986393877512192.0 | accuracy: 0.89
step_num: 6200 | loss: 0.0882 | profit rate: 16240591463115862835200.0 | accuracy: 0.89
model saved @ step:6348,performance:71058495054624604553216.000,accuracy:0.89
step_num: 6400 | loss: 0.1013 | profit rate:    1.9 | accuracy: 0.91
step_num: 6600 | loss: 0.1002 | profit rate:   41.7 | accuracy: 0.88
step_num: 6800 | loss: 0.1218 | profit rate:  233.5 | accuracy: 0.86
step_num: 7000 | loss: 0.0857 | profit rate: 17016.4 | accuracy: 0.88
step_num: 7200 | loss: 0.0922 | profit rate: 280601.6 | accuracy: 0.88
step_num: 7400 | loss: 0.1073 | profit rate: 2983092.1 | accuracy: 0.88
step_num: 7600 | loss: 0.0995 | profit rate: 275279950.8 | accuracy: 0.88
step_num: 7800 | loss: 0.1105 | profit rate: 2144791857.8 | accuracy: 0.87
step_num: 8000 | loss: 0.1068 | profit rate: 32629571544.8 | accuracy: 0.88
step_num: 8200 | loss: 0.1164 | profit rate: 4717623944630.9 | accuracy: 0.88
step_num: 8400 | loss: 0.0926 | profit rate: 572716387024025.9 | accuracy: 0.89
step_num: 8600 | loss: 0.0992 | profit rate: 25289806268137476.0 | accuracy: 0.89
step_num: 8800 | loss: 0.1238 | profit rate: 827304558945891968.0 | accuracy: 0.89
step_num: 9000 | loss: 0.0743 | profit rate: 24015245195620220928.0 | accuracy: 0.89
step_num: 9200 | loss: 0.0734 | profit rate: 1348873995593455501312.0 | accuracy: 0.89
step_num: 9400 | loss: 0.0725 | profit rate: 19546081478661472518144.0 | accuracy: 0.89
episode:   3/5,耗时:0.75分/2.22分,训练集: | step: 9522 | average_treward: 2414.6 | max_treward: 2942.7394 | average profit rate: 45773156395287482204160.000
model saved @ step:9522,performance:66260974125429452439552.000,accuracy:0.89
step_num: 9600 | loss: 0.0688 | profit rate:    2.4 | accuracy: 0.91
step_num: 9800 | loss: 0.1038 | profit rate:   60.2 | accuracy: 0.90
step_num: 10000 | loss: 0.0890 | profit rate:  340.3 | accuracy: 0.88
step_num: 10200 | loss: 0.1143 | profit rate: 25305.5 | accuracy: 0.89
step_num: 10400 | loss: 0.1003 | profit rate: 381813.9 | accuracy: 0.88
step_num: 10600 | loss: 0.1032 | profit rate: 4251715.7 | accuracy: 0.87
step_num: 10800 | loss: 0.1055 | profit rate: 433366031.4 | accuracy: 0.87
step_num: 11000 | loss: 0.0963 | profit rate: 3475172177.8 | accuracy: 0.88
step_num: 11200 | loss: 0.0401 | profit rate: 54588997225.2 | accuracy: 0.88
step_num: 11400 | loss: 0.0817 | profit rate: 8790050074156.1 | accuracy: 0.89
step_num: 11600 | loss: 0.0560 | profit rate: 1367492910418536.0 | accuracy: 0.89
step_num: 11800 | loss: 0.0642 | profit rate: 52051763572443768.0 | accuracy: 0.89
step_num: 12000 | loss: 0.1107 | profit rate: 1300079296018715904.0 | accuracy: 0.90
step_num: 12200 | loss: 0.0825 | profit rate: 42241077136904773632.0 | accuracy: 0.90
step_num: 12400 | loss: 0.0671 | profit rate: 2016858596582420119552.0 | accuracy: 0.90
step_num: 12600 | loss: 0.0812 | profit rate: 32130402039997231267840.0 | accuracy: 0.90
model saved @ step:12696,performance:64243394933431921016832.000,accuracy:0.90
step_num: 12800 | loss: 0.0864 | profit rate:    3.2 | accuracy: 0.91
step_num: 13000 | loss: 0.0568 | profit rate:   70.0 | accuracy: 0.92
step_num: 13200 | loss: 0.0680 | profit rate:  427.3 | accuracy: 0.91
step_num: 13400 | loss: 0.0479 | profit rate: 43670.5 | accuracy: 0.91
step_num: 13600 | loss: 0.1122 | profit rate: 567585.9 | accuracy: 0.90
step_num: 13800 | loss: 0.1340 | profit rate: 6098806.1 | accuracy: 0.89
step_num: 14000 | loss: 0.1030 | profit rate: 623582989.0 | accuracy: 0.89
step_num: 14200 | loss: 0.0843 | profit rate: 4619727896.5 | accuracy: 0.89
step_num: 14400 | loss: 0.0972 | profit rate: 82110335144.8 | accuracy: 0.89
step_num: 14600 | loss: 0.0888 | profit rate: 13723270949737.0 | accuracy: 0.89
step_num: 14800 | loss: 0.0562 | profit rate: 1656821683236879.2 | accuracy: 0.89
step_num: 15000 | loss: 0.1257 | profit rate: 72864912898784672.0 | accuracy: 0.89
step_num: 15200 | loss: 0.0733 | profit rate: 2160775346944342784.0 | accuracy: 0.89
step_num: 15400 | loss: 0.0752 | profit rate: 66352395820318744576.0 | accuracy: 0.90
step_num: 15600 | loss: 0.0796 | profit rate: 3158875350988105449472.0 | accuracy: 0.90
step_num: 15800 | loss: 0.0289 | profit rate: 48933582967304192262144.0 | accuracy: 0.90
episode:   5/5,耗时:0.78分/3.78分,训练集: | step: 15870 | average_treward: 2644.6 | max_treward: 2994.5959 | average profit rate: 56040920383925566570496.000
model saved @ step:15870,performance:78641737800333440057344.000,accuracy:0.90
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 52/408 [00:00<00:00, 509.83it/s] 28%|       | 113/408 [00:00<00:00, 564.98it/s] 43%|     | 177/408 [00:00<00:00, 598.96it/s] 59%|    | 242/408 [00:00<00:00, 619.01it/s] 75%|  | 307/408 [00:00<00:00, 630.15it/s] 91%| | 372/408 [00:00<00:00, 636.88it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 617.88it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 8707.06
2023-07-24T12:00:00 | net performance [%] = 770.7059
2023-07-24T12:00:00 | number of trades [#] = 234
==================================================
Trial 17 Complete [00h 04m 25s]
net_wealth: 8707.05854011483

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 27m 12s

Search: Running Trial #18

Value             |Best Value So Far |Hyperparameter
9                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.9               |0.5               |gamma
0.001             |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4292.000000   4301.000000
mean      0.000435    20113.607657  ...   20202.430277  20169.373185
std       0.027833    16040.642334  ...   16079.200001  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7761.477417   7730.930176
50%       0.000642    11571.842969  ...   11760.674805  11751.469727
75%       0.011590    29894.706152  ...   30029.208008  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.6207 | profit rate:    2.4 | accuracy: 0.29
step_num: 400 | loss: 0.5493 | profit rate:   24.7 | accuracy: 0.36
step_num: 600 | loss: 0.4734 | profit rate:   51.7 | accuracy: 0.40
step_num: 800 | loss: 0.4051 | profit rate: 8482.9 | accuracy: 0.42
step_num: 1000 | loss: 0.4829 | profit rate: 1034934.5 | accuracy: 0.46
step_num: 1200 | loss: 0.6251 | profit rate: 4273514439.8 | accuracy: 0.49
step_num: 1400 | loss: 0.3959 | profit rate: 3312976839882.8 | accuracy: 0.51
step_num: 1600 | loss: 0.2910 | profit rate: 1231352794696698.2 | accuracy: 0.54
step_num: 1800 | loss: 0.3129 | profit rate: 503609750809216024576.0 | accuracy: 0.57
step_num: 2000 | loss: 0.2843 | profit rate: 63417147897159994048512.0 | accuracy: 0.58
step_num: 2200 | loss: 0.2942 | profit rate: 413780972226075402119938048.0 | accuracy: 0.60
step_num: 2400 | loss: 0.6767 | profit rate: 93797455524279189515261001596928.0 | accuracy: 0.61
step_num: 2600 | loss: 0.4316 | profit rate: 3317395470042739325869946698408656896.0 | accuracy: 0.62
step_num: 2800 | loss: 0.3030 | profit rate: 268043228912330692235311975408814123909120.0 | accuracy: 0.64
step_num: 3000 | loss: 0.2468 | profit rate: 1120188589278632362294481018764699986152128512.0 | accuracy: 0.64
step_num: 3200 | loss: 0.2381 | profit rate: 25914222424861895170277414182781453296449731166208.0 | accuracy: 0.66
step_num: 3400 | loss: 0.3646 | profit rate: 837826774244158051203977338290169819763363334735265792.0 | accuracy: 0.66
step_num: 3600 | loss: 0.3832 | profit rate: 1359822353177583392319513765753383975012066119491388440576.0 | accuracy: 0.67
episode:   1/5,耗时:0.86分/0.86分,训练集: | step: 3654 | average_treward: 2456.9 | max_treward: 2456.9122 | average profit rate: 3111449349917994884011979014110165523686763674896405889024.000
model saved @ step:3654,performance:3111449349917994884011979014110165523686763674896405889024.000,accuracy:0.67
step_num: 3800 | loss: 0.2962 | profit rate: 15771876.6 | accuracy: 0.88
step_num: 4000 | loss: 0.1874 | profit rate: 1469344223399.8 | accuracy: 0.84
step_num: 4200 | loss: 0.1984 | profit rate: 32228171294115152.0 | accuracy: 0.84
step_num: 4400 | loss: 0.2820 | profit rate: 2163712528191361646592.0 | accuracy: 0.84
step_num: 4600 | loss: 0.2975 | profit rate: 1231300721506248338440192.0 | accuracy: 0.83
step_num: 4800 | loss: 0.3210 | profit rate: 579547079385801414517010202624.0 | accuracy: 0.83
step_num: 5000 | loss: 0.2764 | profit rate: 14888051828469591300122619846590464.0 | accuracy: 0.82
step_num: 5200 | loss: 0.2397 | profit rate: 26141565701967811386931511480834588672.0 | accuracy: 0.82
step_num: 5400 | loss: 0.2891 | profit rate: 53173355143468660080122703317726492683665408.0 | accuracy: 0.82
step_num: 5600 | loss: 0.2126 | profit rate: 10170874964550111101611543514959038134565732352.0 | accuracy: 0.82
step_num: 5800 | loss: 0.3930 | profit rate: 34696869919516100518318688167363452465798268846080.0 | accuracy: 0.82
step_num: 6000 | loss: 0.4376 | profit rate: 629446177761837315753812379682169810614265904603687026688.0 | accuracy: 0.82
step_num: 6200 | loss: 0.3563 | profit rate: 49341189773263374719546334717883226978980598803658801867128832.0 | accuracy: 0.82
step_num: 6400 | loss: 0.2711 | profit rate: 321614072837133298481365738017271854295706683105223165446438518784.0 | accuracy: 0.81
step_num: 6600 | loss: 0.2231 | profit rate: 3392926597307581552157584324289900812154097395818907743190827650777088.0 | accuracy: 0.81
step_num: 6800 | loss: 0.1588 | profit rate: 102392532139906293182676634559022121467462444076045799974237697964723142656.0 | accuracy: 0.81
step_num: 7000 | loss: 0.2689 | profit rate: 13321523889937329751417696061800803802719750440700741037806496388708378496466944.0 | accuracy: 0.81
step_num: 7200 | loss: 0.1804 | profit rate: 16736477035182353039128758789952380515858979100637251419746087898148404496900816896.0 | accuracy: 0.81
model saved @ step:7308,performance:479440138567156477827674830990211531070118093225600548154391108330487319955215745024.000,accuracy:0.81
step_num: 7400 | loss: 0.4248 | profit rate: 44424.4 | accuracy: 0.84
step_num: 7600 | loss: 0.1855 | profit rate: 80348378377.1 | accuracy: 0.84
step_num: 7800 | loss: 0.2402 | profit rate: 2896893618226873.5 | accuracy: 0.84
step_num: 8000 | loss: 0.2171 | profit rate: 92936039984924524544.0 | accuracy: 0.84
step_num: 8200 | loss: 0.2615 | profit rate: 122126205843163880357888.0 | accuracy: 0.84
step_num: 8400 | loss: 0.2436 | profit rate: 27267363942965288848863526912.0 | accuracy: 0.84
step_num: 8600 | loss: 0.2533 | profit rate: 1578430018708834478470676021772288.0 | accuracy: 0.83
step_num: 8800 | loss: 0.3744 | profit rate: 3207720126710445047353336787122520064.0 | accuracy: 0.82
step_num: 9000 | loss: 0.2525 | profit rate: 2373195259478217537858481533514916760125440.0 | accuracy: 0.82
step_num: 9200 | loss: 0.2452 | profit rate: 5245165090096382192694955076276584593156472832.0 | accuracy: 0.82
step_num: 9400 | loss: 0.2841 | profit rate: 4428730138111481669248962767733555877794560344064.0 | accuracy: 0.82
step_num: 9600 | loss: 0.2505 | profit rate: 23033436670346558416367561420789332239831836277591769088.0 | accuracy: 0.82
step_num: 9800 | loss: 0.1975 | profit rate: 13391539224281147470100105579840541399292505369835049622437888.0 | accuracy: 0.82
step_num: 10000 | loss: 0.2542 | profit rate: 281000956635732653113659136741265810329843067960694632839808811008.0 | accuracy: 0.82
step_num: 10200 | loss: 0.2189 | profit rate: 5020343005122495593259912856234426884775524259682585016885126570704896.0 | accuracy: 0.82
step_num: 10400 | loss: 0.2308 | profit rate: 81588050622945531305659426310719464877596863375344863217701243638383640576.0 | accuracy: 0.82
step_num: 10600 | loss: 0.2476 | profit rate: 8748967484810264348059478605380668459383125591902447571985314422622773605040128.0 | accuracy: 0.82
step_num: 10800 | loss: 0.2287 | profit rate: 43931396626998668826626984504766281103704234922765988868553355815687171978125377536.0 | accuracy: 0.82
episode:   3/5,耗时:0.96分/2.77分,训练集: | step: 10962 | average_treward: 3141.2 | max_treward: 3513.2051 | average profit rate: 1544215098543502823937504030882437165650217563351419090326679189453885261915002765312.000
model saved @ step:10962,performance:4153205157063352641023557273272455037888896685299792890117112601004908012276438532096.000,accuracy:0.81
step_num: 11000 | loss: 0.2026 | profit rate:   47.1 | accuracy: 0.82
step_num: 11200 | loss: 0.2845 | profit rate: 13612281277.6 | accuracy: 0.87
step_num: 11400 | loss: 0.1783 | profit rate: 249955500236053.8 | accuracy: 0.84
step_num: 11600 | loss: 0.1775 | profit rate: 130804318695206416.0 | accuracy: 0.84
step_num: 11800 | loss: 0.2060 | profit rate: 30549079044329360588800.0 | accuracy: 0.84
step_num: 12000 | loss: 0.3241 | profit rate: 308240543774215656091680768.0 | accuracy: 0.85
step_num: 12200 | loss: 0.2399 | profit rate: 134382060803616441459254973431808.0 | accuracy: 0.85
step_num: 12400 | loss: 0.3407 | profit rate: 768615453277444595810265982962761728.0 | accuracy: 0.84
step_num: 12600 | loss: 0.2551 | profit rate: 307017958313099277972849326255711952306176.0 | accuracy: 0.84
step_num: 12800 | loss: 0.2307 | profit rate: 968641900050515026945578628889643681969078272.0 | accuracy: 0.84
step_num: 13000 | loss: 0.2425 | profit rate: 414376160081197250788939968021963522334429020160.0 | accuracy: 0.83
step_num: 13200 | loss: 0.3177 | profit rate: 487974423570136196137422535706224935848881622202974208.0 | accuracy: 0.84
step_num: 13400 | loss: 0.2460 | profit rate: 651699520902357347833429440846373510678572513565140001488896.0 | accuracy: 0.84
step_num: 13600 | loss: 0.2679 | profit rate: 181886994937231328895090609188640736583036775782101683225006964736.0 | accuracy: 0.84
step_num: 13800 | loss: 0.2232 | profit rate: 1736002692454445625356768263613952936901553020184099320976208706928640.0 | accuracy: 0.83
step_num: 14000 | loss: 0.2075 | profit rate: 39918064738633451909342937991019982904425452922470011513353341431177019392.0 | accuracy: 0.83
step_num: 14200 | loss: 0.1694 | profit rate: 346438630328318926680086328762385761581996828341288586162143688401858588573696.0 | accuracy: 0.83
step_num: 14400 | loss: 0.2213 | profit rate: 59862568948273025995095098870693007349847903715853004491015225723858047660944523264.0 | accuracy: 0.83
step_num: 14600 | loss: 0.2220 | profit rate: 36659351109674754869087325662918975621113585432578802900669312877125930903341159677952.0 | accuracy: 0.83
model saved @ step:14616,performance:40014280911071353736176784855365591855341004052474773309090951967385984778317099696128.000,accuracy:0.83
step_num: 14800 | loss: 0.3219 | profit rate: 382543428.7 | accuracy: 0.90
step_num: 15000 | loss: 0.3019 | profit rate: 7397958076743.7 | accuracy: 0.85
step_num: 15200 | loss: 0.1825 | profit rate: 99789045291850688.0 | accuracy: 0.86
step_num: 15400 | loss: 0.2464 | profit rate: 11689016080672105693184.0 | accuracy: 0.86
step_num: 15600 | loss: 0.2026 | profit rate: 8278976362977146001424384.0 | accuracy: 0.86
step_num: 15800 | loss: 0.2555 | profit rate: 22064938726925216640810738515968.0 | accuracy: 0.86
step_num: 16000 | loss: 0.2179 | profit rate: 157904850151482315145346278571900928.0 | accuracy: 0.85
step_num: 16200 | loss: 0.2679 | profit rate: 619431326445551435740498424351357403136.0 | accuracy: 0.84
step_num: 16400 | loss: 0.2080 | profit rate: 1500896179368587768539731128397429949182509056.0 | accuracy: 0.85
step_num: 16600 | loss: 0.2436 | profit rate: 408514961233494874334129909099685825460737933312.0 | accuracy: 0.85
step_num: 16800 | loss: 0.3118 | profit rate: 6431812511757243063724633496736418193742899705806848.0 | accuracy: 0.85
step_num: 17000 | loss: 0.3003 | profit rate: 58716541795999987358191052510017830001304169421291959353344.0 | accuracy: 0.85
step_num: 17200 | loss: 0.3271 | profit rate: 12110573295974803813668011418962590767033482707546256185223020544.0 | accuracy: 0.84
step_num: 17400 | loss: 0.2087 | profit rate: 957917822561132963851292613520646836059285383861384795299507639156736.0 | accuracy: 0.84
step_num: 17600 | loss: 0.2117 | profit rate: 6699772242309335855344281288169154016219445536476866658512308390441517056.0 | accuracy: 0.84
step_num: 17800 | loss: 0.2135 | profit rate: 58202126866157773874136272627334981805977486583501636510720355708461041844224.0 | accuracy: 0.84
step_num: 18000 | loss: 0.2176 | profit rate: 2287188513297520266636922085405352830160455852226073064755058395117292104596848640.0 | accuracy: 0.84
step_num: 18200 | loss: 0.2692 | profit rate: 7774180487982320765865918563442986383637355581512020543133831400495848894769515200512.0 | accuracy: 0.83
episode:   5/5,耗时:1.36分/5.50分,训练集: | step: 18270 | average_treward: 3335.6 | max_treward: 3634.0957 | average profit rate: 13845701769915786994717495053437881348958174993545627511092636756432344684375390027776.000
model saved @ step:18270,performance:24581582642877072549918604981971385035163097529042061586295038866089503008985960153088.000,accuracy:0.83
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 12%|        | 48/397 [00:00<00:00, 479.50it/s] 29%|       | 114/397 [00:00<00:00, 585.61it/s] 45%|     | 178/397 [00:00<00:00, 607.67it/s] 61%|   | 244/397 [00:00<00:00, 628.26it/s] 79%|  | 312/397 [00:00<00:00, 642.27it/s] 96%|| 380/397 [00:00<00:00, 650.62it/s]==================================================
100%|| 397/397 [00:00<00:00, 628.06it/s]
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1954.98
2023-07-24T12:00:00 | net performance [%] = 95.4978
2023-07-24T12:00:00 | number of trades [#] = 38
==================================================
Trial 18 Complete [00h 05m 58s]
net_wealth: 1956.9352933620958

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 33m 10s

Search: Running Trial #19

Value             |Best Value So Far |Hyperparameter
10                |1                 |horizon
225               |225               |lookback
False             |False             |MarketFactor
10                |3                 |lags
0.8               |0.5               |gamma
5e-05             |0.001             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4305.000000   4315.000000
mean      0.000441    20062.255222  ...   20154.979356  20118.633889
std       0.027818    16039.874230  ...   16078.042379  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7717.890137   7690.540039
50%       0.000642    11554.824463  ...   11748.200195  11715.610352
75%       0.011655    29873.081836  ...   29993.890625  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.9331 | profit rate:    0.8 | accuracy: 0.35
step_num: 600 | loss: 0.5339 | profit rate:    2.5 | accuracy: 0.37
step_num: 800 | loss: 0.6052 | profit rate:    2.6 | accuracy: 0.37
step_num: 1000 | loss: 0.4917 | profit rate:   21.3 | accuracy: 0.36
step_num: 1200 | loss: 0.5495 | profit rate: 92169.9 | accuracy: 0.37
step_num: 1400 | loss: 0.3980 | profit rate: 19734609.2 | accuracy: 0.39
step_num: 1600 | loss: 0.3832 | profit rate: 6034025192.3 | accuracy: 0.41
step_num: 1800 | loss: 0.5139 | profit rate: 19308370585455.1 | accuracy: 0.43
step_num: 2000 | loss: 0.4874 | profit rate: 1237558493287695.0 | accuracy: 0.45
step_num: 2200 | loss: 0.4915 | profit rate: 3857808541680671232.0 | accuracy: 0.47
step_num: 2400 | loss: 0.5206 | profit rate: 1020114483864966105399296.0 | accuracy: 0.49
step_num: 2600 | loss: 0.5060 | profit rate: 12760047116585827437893386240.0 | accuracy: 0.50
step_num: 2800 | loss: 0.4872 | profit rate: 2476225520029167959851152493772800.0 | accuracy: 0.52
step_num: 3000 | loss: 0.4463 | profit rate: 5792797903573167064736474607793471488.0 | accuracy: 0.54
step_num: 3200 | loss: 0.3987 | profit rate: 78895513961402080536361803643098780139520.0 | accuracy: 0.55
step_num: 3400 | loss: 0.4133 | profit rate: 3312862807565284541282507284924961922480078848.0 | accuracy: 0.56
step_num: 3600 | loss: 0.4659 | profit rate: 5113429128898120974035725326638636613861604589568.0 | accuracy: 0.57
episode:   1/5,耗时:1.27分/1.27分,训练集: | step: 3672 | average_treward: 1831.5 | max_treward: 1831.4681 | average profit rate: 10692355064429111065032792896233207094707811778560.000
model saved @ step:3672,performance:10692355064429111065032792896233207094707811778560.000,accuracy:0.57
step_num: 3800 | loss: 0.5028 | profit rate: 7247144.7 | accuracy: 0.85
step_num: 4000 | loss: 0.5317 | profit rate: 558728131850.5 | accuracy: 0.80
step_num: 4200 | loss: 0.3856 | profit rate: 54035178985871992.0 | accuracy: 0.83
step_num: 4400 | loss: 0.4369 | profit rate: 432303842893429014528.0 | accuracy: 0.80
step_num: 4600 | loss: 0.3948 | profit rate: 49429229259716248469504.0 | accuracy: 0.78
step_num: 4800 | loss: 0.4295 | profit rate: 14604809962081072059951087616.0 | accuracy: 0.78
step_num: 5000 | loss: 0.4043 | profit rate: 393526706513391390081442230829056.0 | accuracy: 0.78
step_num: 5200 | loss: 0.4673 | profit rate: 1733556672053058522294711240894709760.0 | accuracy: 0.78
step_num: 5400 | loss: 0.4233 | profit rate: 6335080425287745446190103894300869317885952.0 | accuracy: 0.78
step_num: 5600 | loss: 0.4150 | profit rate: 1509607114277062261326332084139603407839166464.0 | accuracy: 0.78
step_num: 5800 | loss: 0.4908 | profit rate: 2229625573132751065525006140403025245817498763264.0 | accuracy: 0.78
step_num: 6000 | loss: 0.4250 | profit rate: 125260923926888301095022306939132309897281328132978114560.0 | accuracy: 0.79
step_num: 6200 | loss: 0.4648 | profit rate: 26954260606819593303128026383436518061060478790812491784912896.0 | accuracy: 0.79
step_num: 6400 | loss: 0.4003 | profit rate: 721441076558718583872032904486451659069317636789407889180212592640.0 | accuracy: 0.79
step_num: 6600 | loss: 0.3794 | profit rate: 13990811300481880145791716082599506239052091209011516988185732412604416.0 | accuracy: 0.79
step_num: 6800 | loss: 0.3719 | profit rate: 1050076114029895006882061900324333367147479059140328741945630867807977603072.0 | accuracy: 0.80
step_num: 7000 | loss: 0.3248 | profit rate: 133052817556422571325970178853375690771361475660159295365593065218033800737456128.0 | accuracy: 0.80
step_num: 7200 | loss: 0.3410 | profit rate: 483308697826052797093581407096181612434475017874571991200530635635510084095436652544.0 | accuracy: 0.80
model saved @ step:7344,performance:25007199933823438303158354709411453654095678746586145600211922675881865460416673480704.000,accuracy:0.80
step_num: 7400 | loss: 0.4607 | profit rate: 3239.7 | accuracy: 0.89
step_num: 7600 | loss: 0.3976 | profit rate: 736782501604.2 | accuracy: 0.89
step_num: 7800 | loss: 0.3558 | profit rate: 55387450074232904.0 | accuracy: 0.88
step_num: 8000 | loss: 0.3223 | profit rate: 44816480582174212096.0 | accuracy: 0.86
step_num: 8200 | loss: 0.2984 | profit rate: 6557664544759029281325056.0 | accuracy: 0.84
step_num: 8400 | loss: 0.3601 | profit rate: 32026335009291465145536479232.0 | accuracy: 0.83
step_num: 8600 | loss: 0.3369 | profit rate: 35656139793365891754302146573500416.0 | accuracy: 0.84
step_num: 8800 | loss: 0.3332 | profit rate: 225314026375559805344674724283066351616.0 | accuracy: 0.83
step_num: 9000 | loss: 0.3644 | profit rate: 313350710197805974504637869200605419434672128.0 | accuracy: 0.83
step_num: 9200 | loss: 0.3737 | profit rate: 1147272206471244187654467300457113666683821621248.0 | accuracy: 0.83
step_num: 9400 | loss: 0.3853 | profit rate: 610473905270329467666363725106691036416471803625472.0 | accuracy: 0.83
step_num: 9600 | loss: 0.3887 | profit rate: 1328048300136164779370412449445206287818896668729634979840.0 | accuracy: 0.83
step_num: 9800 | loss: 0.3356 | profit rate: 2221142872161066590708489067609846361569898696008843176498429952.0 | accuracy: 0.84
step_num: 10000 | loss: 0.3687 | profit rate: 1015493090779604574449923764983835587971073802322172438164704713506816.0 | accuracy: 0.83
step_num: 10200 | loss: 0.3495 | profit rate: 15859374195469704933777025161162185656222580004318059302595564146668863488.0 | accuracy: 0.83
step_num: 10400 | loss: 0.2977 | profit rate: 839733120921906640323983981208427342099733652557117076138937943584314287456256.0 | accuracy: 0.84
step_num: 10600 | loss: 0.2971 | profit rate: 9694761188943647370248782916408781817249258683813654248998690482791970704537419776.0 | accuracy: 0.83
step_num: 10800 | loss: 0.3087 | profit rate: 4808184478146692382891304211360142061582386022258760422220102752035091984165701257527296.0 | accuracy: 0.84
step_num: 11000 | loss: 0.3281 | profit rate: 2334544809465178368096639012685310588378539835716005006818349166382289101080945482136551424.0 | accuracy: 0.83
episode:   3/5,耗时:1.43分/4.13分,训练集: | step: 11016 | average_treward: 2882.6 | max_treward: 3568.1139 | average profit rate: 897197487640596945287354661418648882640195911165766805463718965257040147760982311672217600.000
model saved @ step:11016,performance:2691567455721856979919986405691077079542950904424902461927058979412009079879578686360387584.000,accuracy:0.83
step_num: 11200 | loss: 0.3414 | profit rate: 3505542206.4 | accuracy: 0.92
step_num: 11400 | loss: 0.3850 | profit rate: 318822453336497.6 | accuracy: 0.88
step_num: 11600 | loss: 0.2423 | profit rate: 7232921343811679232.0 | accuracy: 0.88
step_num: 11800 | loss: 0.2771 | profit rate: 2014790865633502306500608.0 | accuracy: 0.87
step_num: 12000 | loss: 0.2511 | profit rate: 1187014713576284001962819584.0 | accuracy: 0.86
step_num: 12200 | loss: 0.2991 | profit rate: 4290694686059064826284177881038848.0 | accuracy: 0.85
step_num: 12400 | loss: 0.3536 | profit rate: 79026538961125605834066522860928630784.0 | accuracy: 0.85
step_num: 12600 | loss: 0.3000 | profit rate: 419764170386007815252203069154319478554624.0 | accuracy: 0.86
step_num: 12800 | loss: 0.2650 | profit rate: 7122106693330501246442260549511133549718285582336.0 | accuracy: 0.86
step_num: 13000 | loss: 0.3027 | profit rate: 1819737168109772057923485339816870666830854389497856.0 | accuracy: 0.85
step_num: 13200 | loss: 0.3140 | profit rate: 19477270117905940162718081286009459195726420605912743936.0 | accuracy: 0.85
step_num: 13400 | loss: 0.2945 | profit rate: 724314890451825045928970718190261786419998272356816460581961728.0 | accuracy: 0.85
step_num: 13600 | loss: 0.3259 | profit rate: 623767259673173322635317191706875581732430562667883460329923827204096.0 | accuracy: 0.85
step_num: 13800 | loss: 0.3660 | profit rate: 66671584793653764764459017969792822484689945644096839954051918738659213312.0 | accuracy: 0.85
step_num: 14000 | loss: 0.2918 | profit rate: 366813721179644374821208448362002141291862863742855922059292525223710451302400.0 | accuracy: 0.85
step_num: 14200 | loss: 0.2789 | profit rate: 15946894431344393255653246668056398108199134522858850131640334887235279222627893248.0 | accuracy: 0.85
step_num: 14400 | loss: 0.2878 | profit rate: 7981542241246431272590766676270164269974558383644068540526552235578217005788756585742336.0 | accuracy: 0.85
step_num: 14600 | loss: 0.2871 | profit rate: 48621554847181326866397178486940774008967060207723179979254865858348030021005344504866144256.0 | accuracy: 0.85
model saved @ step:14688,performance:199322718885951681206368855078502706398871301478295263226040455127342479681738476712234057728.000,accuracy:0.85
step_num: 14800 | loss: 0.3344 | profit rate: 1779654.8 | accuracy: 0.91
step_num: 15000 | loss: 0.3155 | profit rate: 12356664936143.6 | accuracy: 0.91
step_num: 15200 | loss: 0.2823 | profit rate: 705302737775244544.0 | accuracy: 0.90
step_num: 15400 | loss: 0.2430 | profit rate: 42943074418644094025728.0 | accuracy: 0.89
step_num: 15600 | loss: 0.2345 | profit rate: 71392226225878358850273280.0 | accuracy: 0.88
step_num: 15800 | loss: 0.2903 | profit rate: 46747131477360124546367623266304.0 | accuracy: 0.87
step_num: 16000 | loss: 0.2819 | profit rate: 9775135541842939336420558546810175488.0 | accuracy: 0.87
step_num: 16200 | loss: 0.3532 | profit rate: 61994252629228450307376250632426944987136.0 | accuracy: 0.87
step_num: 16400 | loss: 0.2511 | profit rate: 93067148846883932483418112584314969945490325504.0 | accuracy: 0.87
step_num: 16600 | loss: 0.3430 | profit rate: 169059952060165676123045423086965749712666381778944.0 | accuracy: 0.86
step_num: 16800 | loss: 0.3757 | profit rate: 213190650352360299647142842708579488406431829948628992.0 | accuracy: 0.85
step_num: 17000 | loss: 0.3586 | profit rate: 8216486558931377593120458807517883690120126328370289421844480.0 | accuracy: 0.86
step_num: 17200 | loss: 0.3579 | profit rate: 13191254996895836641810721891617506782318531591546252843794424659968.0 | accuracy: 0.86
step_num: 17400 | loss: 0.3367 | profit rate: 444557857621750012913673251527749827127800231557730081346851665638064128.0 | accuracy: 0.85
step_num: 17600 | loss: 0.3366 | profit rate: 14708574450773249015728803908567693725484795365573146312155835270868655669248.0 | accuracy: 0.85
step_num: 17800 | loss: 0.2854 | profit rate: 1621603582316646578698880022854012530723560062379670676091087883322550569123446784.0 | accuracy: 0.86
step_num: 18000 | loss: 0.2956 | profit rate: 261955703405071736162454638968460892247646343678698426199242798641066700396128806895616.0 | accuracy: 0.85
step_num: 18200 | loss: 0.2761 | profit rate: 2970842941009154313003644542113147052150815038650814792761553660222179063001083126973726720.0 | accuracy: 0.85
episode:   5/5,耗时:1.43分/6.99分,训练集: | step: 18360 | average_treward: 3214.6 | max_treward: 3726.4475 | average profit rate: 110326723100520194625435677120954925572114516499703812339295120605866136341998562462390026240.000
model saved @ step:18360,performance:349619304153727559546383145929196672065928397868414349753831170826697167912677377034902568960.000,accuracy:0.85
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 13%|        | 53/401 [00:00<00:00, 529.63it/s] 29%|       | 117/401 [00:00<00:00, 593.40it/s] 45%|     | 180/401 [00:00<00:00, 607.32it/s] 62%|   | 247/401 [00:00<00:00, 631.98it/s] 78%|  | 314/401 [00:00<00:00, 643.34it/s] 95%|| 381/401 [00:00<00:00, 652.37it/s]==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
100%|| 401/401 [00:00<00:00, 633.09it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2502.16
2023-07-24T12:00:00 | net performance [%] = 150.2160
2023-07-24T12:00:00 | number of trades [#] = 46
==================================================
Trial 19 Complete [00h 07m 06s]
net_wealth: 2502.159722137919

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 40m 15s

Search: Running Trial #20

Value             |Best Value So Far |Hyperparameter
8                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
8                 |3                 |lags
0.6               |0.5               |gamma
0.0005            |0.001             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4293.000000   4301.000000
mean      0.000435    20113.607657  ...   20198.799136  20169.373185
std       0.027833    16040.642334  ...   16079.087003  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7760.089844   7730.930176
50%       0.000642    11571.842969  ...   11760.540039  11751.469727
75%       0.011590    29894.706152  ...   30020.560547  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.1341 | profit rate:    1.5 | accuracy: 0.33
step_num: 1200 | loss: 0.2045 | profit rate:    3.8 | accuracy: 0.34
step_num: 1400 | loss: 0.1911 | profit rate:   24.5 | accuracy: 0.36
step_num: 1600 | loss: 0.1890 | profit rate: 14809.8 | accuracy: 0.39
step_num: 1800 | loss: 0.1658 | profit rate: 108197.5 | accuracy: 0.41
step_num: 2000 | loss: 0.1824 | profit rate: 13996153.4 | accuracy: 0.43
step_num: 2200 | loss: 0.1654 | profit rate: 2065795270167.3 | accuracy: 0.46
step_num: 2400 | loss: 0.1657 | profit rate: 81869295881234048.0 | accuracy: 0.49
step_num: 2600 | loss: 0.1760 | profit rate: 194133966494610751488.0 | accuracy: 0.50
step_num: 2800 | loss: 0.1627 | profit rate: 259706103100402284101632.0 | accuracy: 0.52
step_num: 3000 | loss: 0.1505 | profit rate: 3157038827783053286653820928.0 | accuracy: 0.54
step_num: 3200 | loss: 0.1448 | profit rate: 104744986672372655194709872869376.0 | accuracy: 0.55
step_num: 3400 | loss: 0.1542 | profit rate: 52201122385924434046852272410853376.0 | accuracy: 0.57
episode:   1/5,耗时:1.55分/1.55分,训练集: | step: 3520 | average_treward: 1659.2 | max_treward: 1659.2133 | average profit rate: 1418489328702151337622343687522484224.000
model saved @ step:3520,performance:1418489328702151337622343687522484224.000,accuracy:0.57
step_num: 3600 | loss: 0.1629 | profit rate:  310.0 | accuracy: 0.74
step_num: 3800 | loss: 0.1721 | profit rate: 3167302.9 | accuracy: 0.80
step_num: 4000 | loss: 0.1638 | profit rate: 3692846012.2 | accuracy: 0.82
step_num: 4200 | loss: 0.1600 | profit rate: 90738124151355.7 | accuracy: 0.82
step_num: 4400 | loss: 0.1586 | profit rate: 371716577894926656.0 | accuracy: 0.83
step_num: 4600 | loss: 0.1475 | profit rate: 88795847927990275014656.0 | accuracy: 0.83
step_num: 4800 | loss: 0.1318 | profit rate: 659177678270716316863168512.0 | accuracy: 0.83
step_num: 5000 | loss: 0.1512 | profit rate: 24143700951340500609395782057984.0 | accuracy: 0.83
step_num: 5200 | loss: 0.1405 | profit rate: 206016418393631917010729939383615488.0 | accuracy: 0.83
step_num: 5400 | loss: 0.1340 | profit rate: 62703434355215860786015334002809896960.0 | accuracy: 0.83
step_num: 5600 | loss: 0.1387 | profit rate: 8539060504814727209099569737739785339928576.0 | accuracy: 0.83
step_num: 5800 | loss: 0.1247 | profit rate: 4745051933723555791315761983006104277139100532736.0 | accuracy: 0.83
step_num: 6000 | loss: 0.1382 | profit rate: 965066733251030496991738600946660713956741836661850112.0 | accuracy: 0.83
step_num: 6200 | loss: 0.1238 | profit rate: 10069650293508449653742938444932857886197590202345972563968.0 | accuracy: 0.83
step_num: 6400 | loss: 0.1246 | profit rate: 89200930461454286617871531726456530970069557130941928262598656.0 | accuracy: 0.83
step_num: 6600 | loss: 0.1297 | profit rate: 973275255946304289128927652114405471535066522526613035920773873664.0 | accuracy: 0.83
step_num: 6800 | loss: 0.1250 | profit rate: 23624939471455666330014541666242623814987566369443330984591717077876736.0 | accuracy: 0.83
step_num: 7000 | loss: 0.1114 | profit rate: 12370518099175101021360518705639776852466716303032513456492717621687353344.0 | accuracy: 0.83
model saved @ step:7040,performance:25058928557343210220264469669677178459229321758761560020324409845542289408.000,accuracy:0.83
step_num: 7200 | loss: 0.1112 | profit rate: 20745.7 | accuracy: 0.85
step_num: 7400 | loss: 0.1059 | profit rate: 226804941.3 | accuracy: 0.85
step_num: 7600 | loss: 0.1034 | profit rate: 1862750796312.6 | accuracy: 0.85
step_num: 7800 | loss: 0.0925 | profit rate: 839525482771146.9 | accuracy: 0.84
step_num: 8000 | loss: 0.1065 | profit rate: 114919598922247077888.0 | accuracy: 0.84
step_num: 8200 | loss: 0.0828 | profit rate: 7314791643186571033706496.0 | accuracy: 0.85
step_num: 8400 | loss: 0.0965 | profit rate: 26073789636301953254201229312.0 | accuracy: 0.85
step_num: 8600 | loss: 0.0933 | profit rate: 3764628469281660700060895938609152.0 | accuracy: 0.85
step_num: 8800 | loss: 0.0916 | profit rate: 5538080533001433818689533432565858304.0 | accuracy: 0.85
step_num: 9000 | loss: 0.0909 | profit rate: 2915483579599024614044725497236700528640.0 | accuracy: 0.85
step_num: 9200 | loss: 0.0935 | profit rate: 8282640762547067295079981764011589718251667456.0 | accuracy: 0.85
step_num: 9400 | loss: 0.0949 | profit rate: 3135489241684508992061477479591142801532012684378112.0 | accuracy: 0.85
step_num: 9600 | loss: 0.0713 | profit rate: 45511633564673520933995390874914083961837036268125421568.0 | accuracy: 0.85
step_num: 9800 | loss: 0.0736 | profit rate: 552828246875506867840252908680876841097422755550713459245056.0 | accuracy: 0.85
step_num: 10000 | loss: 0.0712 | profit rate: 19818867284971764139084464536447527685412061427851931957910831104.0 | accuracy: 0.86
step_num: 10200 | loss: 0.0682 | profit rate: 367041139966846505145826136998435993509733001896115279137086241767424.0 | accuracy: 0.86
step_num: 10400 | loss: 0.0684 | profit rate: 2927998789426083617345484049719834405413929733678401069965449692121661440.0 | accuracy: 0.86
episode:   3/5,耗时:2.37分/6.92分,训练集: | step: 10560 | average_treward: 2891.4 | max_treward: 3600.8892 | average profit rate: 97750590298158893692412747234644351044371321736988013737624763475720929280.000
model saved @ step:10560,performance:268192842337133458302770301260894347002305797036869648987838991653551472640.000,accuracy:0.86
step_num: 10600 | loss: 0.0657 | profit rate:   34.3 | accuracy: 0.90
step_num: 10800 | loss: 0.0610 | profit rate: 810279.8 | accuracy: 0.89
step_num: 11000 | loss: 0.0511 | profit rate: 5171021086.7 | accuracy: 0.90
step_num: 11200 | loss: 0.0557 | profit rate: 227684389398789.2 | accuracy: 0.88
step_num: 11400 | loss: 0.0555 | profit rate: 52436200006465816.0 | accuracy: 0.88
step_num: 11600 | loss: 0.0568 | profit rate: 111171292582375896121344.0 | accuracy: 0.88
step_num: 11800 | loss: 0.0440 | profit rate: 724575026893351714235088896.0 | accuracy: 0.89
step_num: 12000 | loss: 0.0501 | profit rate: 1753189444806455979224556634112.0 | accuracy: 0.89
step_num: 12200 | loss: 0.0472 | profit rate: 2101352422672800254618981139637862400.0 | accuracy: 0.89
step_num: 12400 | loss: 0.0499 | profit rate: 402524677511668728542876235158989570048.0 | accuracy: 0.89
step_num: 12600 | loss: 0.0660 | profit rate: 2927715618372637678416321104128779107696640.0 | accuracy: 0.88
step_num: 12800 | loss: 0.0612 | profit rate: 12985557212875582495883825592172692049639038255104.0 | accuracy: 0.88
step_num: 13000 | loss: 0.0534 | profit rate: 2868658220126329472326506105708377754612006370699902976.0 | accuracy: 0.89
step_num: 13200 | loss: 0.0607 | profit rate: 178383503153052695599551833110684743785107724705283964928000.0 | accuracy: 0.89
step_num: 13400 | loss: 0.0517 | profit rate: 784905739155208757052045241479910902414195666041837571239051264.0 | accuracy: 0.88
step_num: 13600 | loss: 0.0442 | profit rate: 5212532505709577854164183377774152707361884304119316193512192475136.0 | accuracy: 0.88
step_num: 13800 | loss: 0.0699 | profit rate: 790916414181516585142049005320758761517407340338981712472845284305534976.0 | accuracy: 0.88
step_num: 14000 | loss: 0.0412 | profit rate: 2268006357821673098427113733810236160992399767790040900466463638583362191360.0 | accuracy: 0.88
model saved @ step:14080,performance:8594105968635263389663126337167327496516435660193409651165902514654241882112.000,accuracy:0.88
step_num: 14200 | loss: 0.0388 | profit rate: 3491.3 | accuracy: 0.90
step_num: 14400 | loss: 0.0361 | profit rate: 108559277.6 | accuracy: 0.91
step_num: 14600 | loss: 0.0403 | profit rate: 206211657044.7 | accuracy: 0.91
step_num: 14800 | loss: 0.0358 | profit rate: 1525027882252390.2 | accuracy: 0.89
step_num: 15000 | loss: 0.0397 | profit rate: 11891319900994052096.0 | accuracy: 0.89
step_num: 15200 | loss: 0.0395 | profit rate: 3876538351237097179840512.0 | accuracy: 0.89
step_num: 15400 | loss: 0.0411 | profit rate: 26211911695967514252126715904.0 | accuracy: 0.90
step_num: 15600 | loss: 0.0445 | profit rate: 10179701471990511561598690970828800.0 | accuracy: 0.90
step_num: 15800 | loss: 0.0352 | profit rate: 22656417408089451060100745006002733056.0 | accuracy: 0.90
step_num: 16000 | loss: 0.0334 | profit rate: 16733028998988750330058988542182125731840.0 | accuracy: 0.90
step_num: 16200 | loss: 0.0494 | profit rate: 14845316802130347341337828245784860442589396992.0 | accuracy: 0.90
step_num: 16400 | loss: 0.0414 | profit rate: 7749733393306588237192144037048173970975631991635968.0 | accuracy: 0.90
step_num: 16600 | loss: 0.0379 | profit rate: 3531461823030279664426885634499823442813229051180216221696.0 | accuracy: 0.90
step_num: 16800 | loss: 0.0313 | profit rate: 45933853724477794173173428995348487958478548674872871951007744.0 | accuracy: 0.90
step_num: 17000 | loss: 0.0433 | profit rate: 1587903248723901975634526717827578821834331476465448644813833371648.0 | accuracy: 0.90
step_num: 17200 | loss: 0.0316 | profit rate: 39691992557454047748019001472198066752803654359250608341650126361591808.0 | accuracy: 0.90
step_num: 17400 | loss: 0.0369 | profit rate: 1540624106119777460284180680681906108123611535430710397197979878655162056704.0 | accuracy: 0.90
episode:   5/5,耗时:2.18分/11.47分,训练集: | step: 17600 | average_treward: 3268.4 | max_treward: 3906.4209 | average profit rate: 81684247487615423328123806110438870093954484233549213190321280345018661339136.000
model saved @ step:17600,performance:399533879698547388408492538912603010514421723712000553028269993179180993347584.000,accuracy:0.90
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 11%|         | 43/403 [00:00<00:00, 425.76it/s] 27%|       | 107/403 [00:00<00:00, 551.27it/s] 42%|     | 170/403 [00:00<00:00, 584.47it/s] 58%|    | 235/403 [00:00<00:00, 610.23it/s] 74%|  | 300/403 [00:00<00:00, 622.30it/s] 90%| | 363/403 [00:00<00:00, 622.79it/s]100%|| 403/403 [00:00<00:00, 603.29it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3245.54
2023-07-24T12:00:00 | net performance [%] = 224.5543
2023-07-24T12:00:00 | number of trades [#] = 86
==================================================
Trial 20 Complete [00h 11m 42s]
net_wealth: 3245.54327045992

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 51m 58s

Search: Running Trial #21

Value             |Best Value So Far |Hyperparameter
11                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
8                 |3                 |lags
0.5               |0.5               |gamma
5e-05             |0.001             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4290.000000   4301.000000
mean      0.000435    20113.607657  ...   20209.671704  20169.373185
std       0.027833    16040.642334  ...   16079.448796  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7766.127563   7730.930176
50%       0.000642    11571.842969  ...   11761.109863  11751.469727
75%       0.011590    29894.706152  ...   30046.502930  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.7397 | profit rate:   21.8 | accuracy: 0.35
step_num: 600 | loss: 0.5167 | profit rate:  183.4 | accuracy: 0.35
step_num: 800 | loss: 0.4754 | profit rate:   92.3 | accuracy: 0.35
step_num: 1000 | loss: 0.3828 | profit rate: 1274.0 | accuracy: 0.36
step_num: 1200 | loss: 0.3215 | profit rate: 2139101.7 | accuracy: 0.39
step_num: 1400 | loss: 0.3456 | profit rate: 84953113.4 | accuracy: 0.41
step_num: 1600 | loss: 0.3620 | profit rate: 18135122068.5 | accuracy: 0.44
step_num: 1800 | loss: 0.3503 | profit rate: 32527657371367212.0 | accuracy: 0.47
step_num: 2000 | loss: 0.3921 | profit rate: 3844769643326437064704.0 | accuracy: 0.50
step_num: 2200 | loss: 0.4547 | profit rate: 16318944667117500965584896.0 | accuracy: 0.51
step_num: 2400 | loss: 0.4762 | profit rate: 6485827130714714372409655296.0 | accuracy: 0.52
step_num: 2600 | loss: 0.4145 | profit rate: 126067035523797755621468285173760.0 | accuracy: 0.54
step_num: 2800 | loss: 0.3620 | profit rate: 4373498282574313374172239815923204096.0 | accuracy: 0.55
step_num: 3000 | loss: 0.3706 | profit rate: 2470689639914425065259203052360429469696.0 | accuracy: 0.56
episode:   1/5,耗时:1.09分/1.09分,训练集: | step: 3155 | average_treward: 1461.2 | max_treward: 1461.1629 | average profit rate: 68837989756865953456291325178592177946624.000
model saved @ step:3155,performance:68837989756865953456291325178592177946624.000,accuracy:0.56
step_num: 3200 | loss: 0.3945 | profit rate:    3.6 | accuracy: 0.74
step_num: 3400 | loss: 0.3981 | profit rate: 149447.7 | accuracy: 0.78
step_num: 3600 | loss: 0.3649 | profit rate: 58260815.2 | accuracy: 0.76
step_num: 3800 | loss: 0.3402 | profit rate: 66915400721040.4 | accuracy: 0.77
step_num: 4000 | loss: 0.3643 | profit rate: 512280392491249600.0 | accuracy: 0.77
step_num: 4200 | loss: 0.3085 | profit rate: 1339945557842572869632.0 | accuracy: 0.77
step_num: 4400 | loss: 0.3767 | profit rate: 1263315682279242752581435392.0 | accuracy: 0.77
step_num: 4600 | loss: 0.3739 | profit rate: 249778142393286151240880750592.0 | accuracy: 0.76
step_num: 4800 | loss: 0.3481 | profit rate: 508450884441073637928339949748224.0 | accuracy: 0.76
step_num: 5000 | loss: 0.3272 | profit rate: 37309809042802414057502985349015527227392.0 | accuracy: 0.77
step_num: 5200 | loss: 0.3400 | profit rate: 6953405916567429849523138788185817938260918272.0 | accuracy: 0.77
step_num: 5400 | loss: 0.4141 | profit rate: 17952301684779010395186176034732424626862892777472.0 | accuracy: 0.76
step_num: 5600 | loss: 0.4739 | profit rate: 40070410554489183178009261499605549332159925690826752.0 | accuracy: 0.76
step_num: 5800 | loss: 0.4591 | profit rate: 553090684718385978105463664981402618450430670735186853888.0 | accuracy: 0.76
step_num: 6000 | loss: 0.3351 | profit rate: 224110878170066017421006997130318203653555460063250945838940160.0 | accuracy: 0.77
step_num: 6200 | loss: 0.3868 | profit rate: 66960690216104959590517006192345378751047539803647028733830758400.0 | accuracy: 0.76
model saved @ step:6310,performance:1601693497893337132935516721290364940386839624564002012420259184640.000,accuracy:0.76
step_num: 6400 | loss: 0.3615 | profit rate:    8.0 | accuracy: 0.71
step_num: 6600 | loss: 0.3825 | profit rate: 465722.3 | accuracy: 0.78
step_num: 6800 | loss: 0.3581 | profit rate: 225388423.7 | accuracy: 0.77
step_num: 7000 | loss: 0.3409 | profit rate: 1617866339554318.5 | accuracy: 0.80
step_num: 7200 | loss: 0.3237 | profit rate: 5018468526612781056.0 | accuracy: 0.79
step_num: 7400 | loss: 0.3730 | profit rate: 7601176932298066493440.0 | accuracy: 0.79
step_num: 7600 | loss: 0.3863 | profit rate: 16358791784244189776521986048.0 | accuracy: 0.78
step_num: 7800 | loss: 0.3636 | profit rate: 5071418948333976160830077534208.0 | accuracy: 0.78
step_num: 8000 | loss: 0.3387 | profit rate: 79575695922734424101747375837544448.0 | accuracy: 0.78
step_num: 8200 | loss: 0.3448 | profit rate: 315040891578095977231572276121291674615808.0 | accuracy: 0.78
step_num: 8400 | loss: 0.3534 | profit rate: 23464078644322146521503151382434012346166804480.0 | accuracy: 0.78
step_num: 8600 | loss: 0.4370 | profit rate: 759024134135438647049764333784775931882607917137920.0 | accuracy: 0.78
step_num: 8800 | loss: 0.4549 | profit rate: 789559404156354954120358301556774240993965898962305024.0 | accuracy: 0.77
step_num: 9000 | loss: 0.4524 | profit rate: 11372516530988094611939682356734282519500708176735678496768.0 | accuracy: 0.77
step_num: 9200 | loss: 0.3653 | profit rate: 1340001390856502279865674078567980838990231667279933770345480192.0 | accuracy: 0.77
step_num: 9400 | loss: 0.3902 | profit rate: 832131518324268841829398582885051421774212205959802900862686199808.0 | accuracy: 0.77
episode:   3/5,耗时:1.36分/3.70分,训练集: | step: 9465 | average_treward: 2166.1 | max_treward: 2530.8897 | average profit rate: 1145738427877625039928703608019571253530999488400880606229557149696.000
model saved @ step:9465,performance:1835521785739538173922803681123922350277817428322866322227777765376.000,accuracy:0.77
step_num: 9600 | loss: 0.3609 | profit rate:   14.1 | accuracy: 0.76
step_num: 9800 | loss: 0.3783 | profit rate: 4049459.6 | accuracy: 0.81
step_num: 10000 | loss: 0.3456 | profit rate: 22117160355.0 | accuracy: 0.79
step_num: 10200 | loss: 0.2918 | profit rate: 15128313202041178.0 | accuracy: 0.79
step_num: 10400 | loss: 0.3044 | profit rate: 36281040465668059136.0 | accuracy: 0.78
step_num: 10600 | loss: 0.3395 | profit rate: 11578432844202119962558464.0 | accuracy: 0.78
step_num: 10800 | loss: 0.3919 | profit rate: 25496359773488430216845983744.0 | accuracy: 0.77
step_num: 11000 | loss: 0.3131 | profit rate: 16258984119268836868577791311872.0 | accuracy: 0.77
step_num: 11200 | loss: 0.3054 | profit rate: 10356183621432601716277609394318868480.0 | accuracy: 0.78
step_num: 11400 | loss: 0.3332 | profit rate: 14379170420818865110918252231632651412307968.0 | accuracy: 0.78
step_num: 11600 | loss: 0.3616 | profit rate: 4577492076240508985512728951689253555844052680704.0 | accuracy: 0.78
step_num: 11800 | loss: 0.3672 | profit rate: 7104677378967091626707772290910705343835375986016256.0 | accuracy: 0.77
step_num: 12000 | loss: 0.4303 | profit rate: 32404051015314200738204721171765399893260654950001672192.0 | accuracy: 0.77
step_num: 12200 | loss: 0.3705 | profit rate: 115162177890606047896428617225940009139993449816774116638720.0 | accuracy: 0.77
step_num: 12400 | loss: 0.3442 | profit rate: 25761038720142194663085443005305831394262605891864046856262647808.0 | accuracy: 0.77
step_num: 12600 | loss: 0.3522 | profit rate: 8746465603147282632398966113494188781424474495034415737787696283648.0 | accuracy: 0.77
model saved @ step:12620,performance:10079617544520223460909684937441466379921938530437054116643915956224.000,accuracy:0.77
step_num: 12800 | loss: 0.3489 | profit rate: 8026.3 | accuracy: 0.82
step_num: 13000 | loss: 0.3438 | profit rate: 7129573.1 | accuracy: 0.79
step_num: 13200 | loss: 0.2937 | profit rate: 1019200439057.8 | accuracy: 0.79
step_num: 13400 | loss: 0.2743 | profit rate: 293360166285866560.0 | accuracy: 0.80
step_num: 13600 | loss: 0.3405 | profit rate: 357558918258592317440.0 | accuracy: 0.79
step_num: 13800 | loss: 0.3106 | profit rate: 635038833252871039659016192.0 | accuracy: 0.80
step_num: 14000 | loss: 0.3626 | profit rate: 802201085887806319644744089600.0 | accuracy: 0.78
step_num: 14200 | loss: 0.3768 | profit rate: 711632950826744957155285701492736.0 | accuracy: 0.78
step_num: 14400 | loss: 0.3286 | profit rate: 8782734022037407260675298751678244716544.0 | accuracy: 0.79
step_num: 14600 | loss: 0.3326 | profit rate: 11504670504999184870269451554603983787243077632.0 | accuracy: 0.79
step_num: 14800 | loss: 0.4221 | profit rate: 105057283636220390554031681214828045689220497408000.0 | accuracy: 0.79
step_num: 15000 | loss: 0.4125 | profit rate: 414840937935731957317713750715260556253696484330962944.0 | accuracy: 0.78
step_num: 15200 | loss: 0.4200 | profit rate: 3862109058445298740251309457468293098701474025918741610496.0 | accuracy: 0.78
step_num: 15400 | loss: 0.3859 | profit rate: 244020424105522668007775587974888793477302704251224445740384256.0 | accuracy: 0.78
step_num: 15600 | loss: 0.3298 | profit rate: 1654248512332642999289103443033464520242389118138595593114448035840.0 | accuracy: 0.78
episode:   5/5,耗时:1.23分/6.31分,训练集: | step: 15775 | average_treward: 2334.1 | max_treward: 2612.7761 | average profit rate: 26634151662446614381583813588424689544518909798930461981086922571776.000
model saved @ step:15775,performance:119653925484079967902129194408311635210001512956170045007280425926656.000,accuracy:0.77
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 53/403 [00:00<00:00, 529.99it/s] 29%|       | 118/403 [00:00<00:00, 600.58it/s] 45%|     | 181/403 [00:00<00:00, 614.01it/s] 61%|    | 246/403 [00:00<00:00, 628.22it/s] 77%|  | 312/403 [00:00<00:00, 637.15it/s] 94%|| 378/403 [00:00<00:00, 644.90it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 628.60it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3105.25
2023-07-24T12:00:00 | net performance [%] = 210.5249
2023-07-24T12:00:00 | number of trades [#] = 64
==================================================
Trial 21 Complete [00h 06m 29s]
net_wealth: 3105.248622647338

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 02h 58m 27s

Search: Running Trial #22

Value             |Best Value So Far |Hyperparameter
13                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
3                 |3                 |lags
0.7               |0.5               |gamma
0.001             |0.001             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4302.000000   4315.000000
mean      0.000441    20062.255222  ...   20165.724363  20118.633889
std       0.027818    16039.874230  ...   16078.496018  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7729.197632   7690.540039
50%       0.000642    11554.824463  ...   11751.060059  11715.610352
75%       0.011655    29873.081836  ...   30007.945801  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.5496 | profit rate:   33.4 | accuracy: 0.38
step_num: 800 | loss: 0.4958 | profit rate:   10.4 | accuracy: 0.37
step_num: 1000 | loss: 0.5268 | profit rate:    7.7 | accuracy: 0.38
step_num: 1200 | loss: 0.5200 | profit rate: 8550.1 | accuracy: 0.41
step_num: 1400 | loss: 0.5094 | profit rate: 117326.6 | accuracy: 0.43
step_num: 1600 | loss: 0.6006 | profit rate: 177346.8 | accuracy: 0.43
step_num: 1800 | loss: 0.5662 | profit rate: 34234777.8 | accuracy: 0.44
step_num: 2000 | loss: 0.6067 | profit rate: 490800479.0 | accuracy: 0.44
step_num: 2200 | loss: 0.5681 | profit rate: 52269239980.6 | accuracy: 0.45
step_num: 2400 | loss: 0.6352 | profit rate: 3371527812808.4 | accuracy: 0.46
step_num: 2600 | loss: 0.5957 | profit rate: 49892116829273.0 | accuracy: 0.46
step_num: 2800 | loss: 0.6043 | profit rate: 148661280837336864.0 | accuracy: 0.47
step_num: 3000 | loss: 0.6187 | profit rate: 1344390396532609792.0 | accuracy: 0.48
episode:   1/5,耗时:1.53分/1.53分,训练集: | step: 3174 | average_treward:  653.1 | max_treward: 653.0799 | average profit rate: 10691535820069251072.000
model saved @ step:3174,performance:10691535820069251072.000,accuracy:0.48
step_num: 3200 | loss: 0.5803 | profit rate:    2.8 | accuracy: 0.56
step_num: 3400 | loss: 0.5757 | profit rate: 1690.7 | accuracy: 0.57
step_num: 3600 | loss: 0.5794 | profit rate: 5093.5 | accuracy: 0.51
step_num: 3800 | loss: 0.6427 | profit rate: 9867.0 | accuracy: 0.49
step_num: 4000 | loss: 0.6060 | profit rate: 1742309.9 | accuracy: 0.50
step_num: 4200 | loss: 0.5824 | profit rate: 30637798.6 | accuracy: 0.50
step_num: 4400 | loss: 0.5475 | profit rate: 64356237236.8 | accuracy: 0.50
step_num: 4600 | loss: 0.5501 | profit rate: 5009935080327.0 | accuracy: 0.51
step_num: 4800 | loss: 0.5097 | profit rate: 100358922856430.7 | accuracy: 0.52
step_num: 5000 | loss: 0.5539 | profit rate: 488019467024811264.0 | accuracy: 0.52
step_num: 5200 | loss: 0.5991 | profit rate: 4388832763789708800.0 | accuracy: 0.52
step_num: 5400 | loss: 0.5546 | profit rate: 564964747780356833280.0 | accuracy: 0.53
step_num: 5600 | loss: 0.6015 | profit rate: 12086888514853667864576.0 | accuracy: 0.53
step_num: 5800 | loss: 0.6293 | profit rate: 1283092477307698274107392.0 | accuracy: 0.53
step_num: 6000 | loss: 0.6830 | profit rate: 935744818971630441565519872.0 | accuracy: 0.53
step_num: 6200 | loss: 0.5792 | profit rate: 12988352684416534545828937728.0 | accuracy: 0.53
model saved @ step:6348,performance:53589330826809429594453573632.000,accuracy:0.53
step_num: 6400 | loss: 0.5530 | profit rate:    2.5 | accuracy: 0.43
step_num: 6600 | loss: 0.5339 | profit rate: 2647.7 | accuracy: 0.52
step_num: 6800 | loss: 0.5333 | profit rate: 4500.7 | accuracy: 0.44
step_num: 7000 | loss: 0.5194 | profit rate: 35569.8 | accuracy: 0.43
step_num: 7200 | loss: 0.5051 | profit rate: 847121.7 | accuracy: 0.41
step_num: 7400 | loss: 0.4636 | profit rate: 8552338.3 | accuracy: 0.41
step_num: 7600 | loss: 0.4528 | profit rate: 14227646671.7 | accuracy: 0.42
step_num: 7800 | loss: 0.4090 | profit rate: 503840993858.9 | accuracy: 0.42
step_num: 8000 | loss: 0.4021 | profit rate: 31258057539394.3 | accuracy: 0.42
step_num: 8200 | loss: 0.4357 | profit rate: 125092309418678288.0 | accuracy: 0.43
step_num: 8400 | loss: 0.4729 | profit rate: 6671540340456611840.0 | accuracy: 0.43
step_num: 8600 | loss: 0.4532 | profit rate: 463551392914624741376.0 | accuracy: 0.43
step_num: 8800 | loss: 0.4785 | profit rate: 40993275973227759271936.0 | accuracy: 0.44
step_num: 9000 | loss: 0.5236 | profit rate: 4651841012823419760148480.0 | accuracy: 0.45
step_num: 9200 | loss: 0.5089 | profit rate: 2266840477348485930550296576.0 | accuracy: 0.46
step_num: 9400 | loss: 0.5068 | profit rate: 10876000482683722762400301056.0 | accuracy: 0.46
episode:   3/5,耗时:1.88分/5.27分,训练集: | step: 9522 | average_treward:  856.4 | max_treward: 959.3924 | average profit rate: 48130275773894830813003907072.000
model saved @ step:9522,performance:90801496484183517329180590080.000,accuracy:0.46
step_num: 9600 | loss: 0.5112 | profit rate:    2.8 | accuracy: 0.49
step_num: 9800 | loss: 0.4869 | profit rate:  817.1 | accuracy: 0.48
step_num: 10000 | loss: 0.4954 | profit rate:  993.6 | accuracy: 0.42
step_num: 10200 | loss: 0.4889 | profit rate: 62058.2 | accuracy: 0.41
step_num: 10400 | loss: 0.4532 | profit rate: 648013.5 | accuracy: 0.39
step_num: 10600 | loss: 0.4094 | profit rate: 7838784.0 | accuracy: 0.39
step_num: 10800 | loss: 0.3910 | profit rate: 29981772694.8 | accuracy: 0.40
step_num: 11000 | loss: 0.3903 | profit rate: 464943069560.9 | accuracy: 0.40
step_num: 11200 | loss: 0.3770 | profit rate: 27307062816272.2 | accuracy: 0.40
step_num: 11400 | loss: 0.4116 | profit rate: 8168171464463450.0 | accuracy: 0.40
step_num: 11600 | loss: 0.4158 | profit rate: 502797500762385664.0 | accuracy: 0.39
step_num: 11800 | loss: 0.3986 | profit rate: 51342823461263228928.0 | accuracy: 0.39
step_num: 12000 | loss: 0.4124 | profit rate: 690468972606827790336.0 | accuracy: 0.39
step_num: 12200 | loss: 0.4058 | profit rate: 46154660886513635557376.0 | accuracy: 0.40
step_num: 12400 | loss: 0.3890 | profit rate: 15166286865351862793535488.0 | accuracy: 0.40
step_num: 12600 | loss: 0.4266 | profit rate: 516421882418896379475656704.0 | accuracy: 0.41
step_num: 12800 | loss: 0.4155 | profit rate:    2.7 | accuracy: 0.35
step_num: 13000 | loss: 0.4166 | profit rate:  578.8 | accuracy: 0.37
step_num: 13200 | loss: 0.3911 | profit rate:  420.5 | accuracy: 0.34
step_num: 13400 | loss: 0.3871 | profit rate: 186606.4 | accuracy: 0.37
step_num: 13600 | loss: 0.3583 | profit rate: 1371864.9 | accuracy: 0.35
step_num: 13800 | loss: 0.3132 | profit rate: 11363749.3 | accuracy: 0.35
step_num: 14000 | loss: 0.3522 | profit rate: 35996044809.6 | accuracy: 0.37
step_num: 14200 | loss: 0.3735 | profit rate: 632424771687.1 | accuracy: 0.37
step_num: 14400 | loss: 0.3553 | profit rate: 46610755735468.8 | accuracy: 0.38
step_num: 14600 | loss: 0.3779 | profit rate: 12615967633699260.0 | accuracy: 0.38
step_num: 14800 | loss: 0.3598 | profit rate: 1971459348221756672.0 | accuracy: 0.38
step_num: 15000 | loss: 0.3862 | profit rate: 1216140437934301773824.0 | accuracy: 0.39
step_num: 15200 | loss: 0.4159 | profit rate: 73554202704596848082944.0 | accuracy: 0.40
step_num: 15400 | loss: 0.3790 | profit rate: 11605589505378518827008000.0 | accuracy: 0.41
step_num: 15600 | loss: 0.4598 | profit rate: 4602624145738020445321428992.0 | accuracy: 0.42
step_num: 15800 | loss: 0.4572 | profit rate: 36213987144355892985719685120.0 | accuracy: 0.42
episode:   5/5,耗时:2.42分/9.56分,训练集: | step: 15870 | average_treward:  888.3 | max_treward: 985.9713 | average profit rate: 40218454138765359459589947392.000
model saved @ step:15870,performance:55950047260670389062054445056.000,accuracy:0.42
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 12%|        | 51/408 [00:00<00:00, 504.94it/s] 28%|       | 116/408 [00:00<00:00, 589.92it/s] 44%|     | 180/408 [00:00<00:00, 612.73it/s] 60%|    | 246/408 [00:00<00:00, 631.37it/s] 77%|  | 313/408 [00:00<00:00, 640.67it/s] 93%|| 379/408 [00:00<00:00, 646.17it/s]==================================================
100%|| 408/408 [00:00<00:00, 628.20it/s]
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 4699.89
2023-07-24T12:00:00 | net performance [%] = 369.9886
2023-07-24T12:00:00 | number of trades [#] = 104
==================================================
Trial 22 Complete [00h 10m 03s]
net_wealth: 4699.885727356167

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 03h 08m 30s

Search: Running Trial #23

Value             |Best Value So Far |Hyperparameter
3                 |1                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
3                 |3                 |lags
0.6               |0.5               |gamma
1e-05             |0.001             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4312.000000   4315.000000
mean      0.000441    20062.255222  ...   20129.629835  20118.633889
std       0.027818    16039.874230  ...   16077.282571  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7694.525024   7690.540039
50%       0.000642    11554.824463  ...   11737.255371  11715.610352
75%       0.011655    29873.081836  ...   29933.737305  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.7457 | profit rate:    1.5 | accuracy: 0.37
step_num: 400 | loss: 0.5623 | profit rate:    1.1 | accuracy: 0.36
step_num: 600 | loss: 1.1596 | profit rate:    0.8 | accuracy: 0.36
step_num: 800 | loss: 0.4787 | profit rate:    0.7 | accuracy: 0.36
step_num: 1000 | loss: 1.0628 | profit rate:    0.1 | accuracy: 0.35
step_num: 1200 | loss: 0.6268 | profit rate:    0.2 | accuracy: 0.37
step_num: 1400 | loss: 0.4611 | profit rate:    0.1 | accuracy: 0.36
step_num: 1600 | loss: 0.4264 | profit rate:    0.1 | accuracy: 0.37
step_num: 1800 | loss: 0.7753 | profit rate:    0.0 | accuracy: 0.37
step_num: 2000 | loss: 1.0418 | profit rate:    0.0 | accuracy: 0.37
step_num: 2200 | loss: 0.7162 | profit rate:    0.0 | accuracy: 0.36
step_num: 2400 | loss: 0.5130 | profit rate:    0.0 | accuracy: 0.37
step_num: 2600 | loss: 0.5457 | profit rate:    0.0 | accuracy: 0.37
step_num: 2800 | loss: 0.5149 | profit rate:    0.0 | accuracy: 0.37
step_num: 3000 | loss: 0.4178 | profit rate:    0.0 | accuracy: 0.36
step_num: 3200 | loss: 0.4306 | profit rate:    0.0 | accuracy: 0.36
step_num: 3400 | loss: 0.5763 | profit rate:    0.0 | accuracy: 0.36
episode:   1/5,耗时:0.78分/0.78分,训练集: | step: 3539 | average_treward: -288.7 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3600 | loss: 0.8286 | profit rate:    0.2 | accuracy: 0.29
step_num: 3800 | loss: 0.6494 | profit rate:    0.1 | accuracy: 0.44
step_num: 4000 | loss: 0.6425 | profit rate:    0.1 | accuracy: 0.44
step_num: 4200 | loss: 0.5298 | profit rate:    0.0 | accuracy: 0.39
step_num: 4400 | loss: 0.5359 | profit rate:    0.0 | accuracy: 0.39
step_num: 4600 | loss: 0.7003 | profit rate:    0.0 | accuracy: 0.38
step_num: 4800 | loss: 0.5457 | profit rate:    0.0 | accuracy: 0.39
step_num: 5000 | loss: 0.6151 | profit rate:    0.0 | accuracy: 0.39
step_num: 5200 | loss: 0.6255 | profit rate:    0.0 | accuracy: 0.39
step_num: 5400 | loss: 0.5730 | profit rate:    0.0 | accuracy: 0.39
step_num: 5600 | loss: 0.6576 | profit rate:    0.0 | accuracy: 0.39
step_num: 5800 | loss: 0.7713 | profit rate:    0.0 | accuracy: 0.38
step_num: 6000 | loss: 0.5478 | profit rate:    0.0 | accuracy: 0.38
step_num: 6200 | loss: 0.5821 | profit rate:    0.0 | accuracy: 0.38
step_num: 6400 | loss: 0.7794 | profit rate:    0.0 | accuracy: 0.38
step_num: 6600 | loss: 0.6323 | profit rate:    0.0 | accuracy: 0.38
step_num: 6800 | loss: 0.5717 | profit rate:    0.0 | accuracy: 0.37
step_num: 7000 | loss: 0.4356 | profit rate:    0.0 | accuracy: 0.37
step_num: 7200 | loss: 0.6217 | profit rate:    0.5 | accuracy: 0.48
step_num: 7400 | loss: 0.5969 | profit rate:    0.2 | accuracy: 0.44
step_num: 7600 | loss: 0.4644 | profit rate:    0.1 | accuracy: 0.43
step_num: 7800 | loss: 0.4570 | profit rate:    0.0 | accuracy: 0.40
step_num: 8000 | loss: 0.7873 | profit rate:    0.0 | accuracy: 0.39
step_num: 8200 | loss: 0.5893 | profit rate:    0.0 | accuracy: 0.39
step_num: 8400 | loss: 0.6202 | profit rate:    0.0 | accuracy: 0.39
step_num: 8600 | loss: 0.5150 | profit rate:    0.0 | accuracy: 0.39
step_num: 8800 | loss: 0.5119 | profit rate:    0.0 | accuracy: 0.40
step_num: 9000 | loss: 0.5712 | profit rate:    0.0 | accuracy: 0.40
step_num: 9200 | loss: 0.6909 | profit rate:    0.0 | accuracy: 0.39
step_num: 9400 | loss: 0.6754 | profit rate:    0.0 | accuracy: 0.39
step_num: 9600 | loss: 0.4985 | profit rate:    0.0 | accuracy: 0.38
step_num: 9800 | loss: 0.6329 | profit rate:    0.0 | accuracy: 0.39
step_num: 10000 | loss: 0.4151 | profit rate:    0.0 | accuracy: 0.38
step_num: 10200 | loss: 0.4313 | profit rate:    0.0 | accuracy: 0.38
step_num: 10400 | loss: 0.7160 | profit rate:    0.0 | accuracy: 0.38
step_num: 10600 | loss: 0.5649 | profit rate:    0.0 | accuracy: 0.37
episode:   3/5,耗时:0.86分/3.09分,训练集: | step: 10617 | average_treward: -301.3 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 10800 | loss: 0.7070 | profit rate:    0.2 | accuracy: 0.45
step_num: 11000 | loss: 0.5062 | profit rate:    0.1 | accuracy: 0.45
step_num: 11200 | loss: 0.2163 | profit rate:    0.0 | accuracy: 0.39
step_num: 11400 | loss: 0.3859 | profit rate:    0.0 | accuracy: 0.40
step_num: 11600 | loss: 0.7114 | profit rate:    0.0 | accuracy: 0.38
step_num: 11800 | loss: 0.5885 | profit rate:    0.0 | accuracy: 0.40
step_num: 12000 | loss: 0.3517 | profit rate:    0.0 | accuracy: 0.38
step_num: 12200 | loss: 0.4340 | profit rate:    0.0 | accuracy: 0.39
step_num: 12400 | loss: 0.5257 | profit rate:    0.0 | accuracy: 0.39
step_num: 12600 | loss: 0.6855 | profit rate:    0.0 | accuracy: 0.39
step_num: 12800 | loss: 0.6735 | profit rate:    0.0 | accuracy: 0.38
step_num: 13000 | loss: 0.4799 | profit rate:    0.0 | accuracy: 0.38
step_num: 13200 | loss: 0.5358 | profit rate:    0.0 | accuracy: 0.38
step_num: 13400 | loss: 0.5507 | profit rate:    0.0 | accuracy: 0.38
step_num: 13600 | loss: 0.1881 | profit rate:    0.0 | accuracy: 0.38
step_num: 13800 | loss: 0.4435 | profit rate:    0.0 | accuracy: 0.37
step_num: 14000 | loss: 0.4834 | profit rate:    0.0 | accuracy: 0.37
step_num: 14200 | loss: 0.6514 | profit rate:    0.5 | accuracy: 0.40
step_num: 14400 | loss: 0.6789 | profit rate:    0.1 | accuracy: 0.44
step_num: 14600 | loss: 0.6126 | profit rate:    0.1 | accuracy: 0.44
step_num: 14800 | loss: 0.4258 | profit rate:    0.0 | accuracy: 0.38
step_num: 15000 | loss: 0.4084 | profit rate:    0.1 | accuracy: 0.39
step_num: 15200 | loss: 0.6039 | profit rate:    0.0 | accuracy: 0.38
step_num: 15400 | loss: 0.4694 | profit rate:    0.0 | accuracy: 0.39
step_num: 15600 | loss: 0.5508 | profit rate:    0.0 | accuracy: 0.39
step_num: 15800 | loss: 0.4648 | profit rate:    0.0 | accuracy: 0.38
step_num: 16000 | loss: 0.5591 | profit rate:    0.0 | accuracy: 0.39
step_num: 16200 | loss: 0.6224 | profit rate:    0.0 | accuracy: 0.38
step_num: 16400 | loss: 0.6828 | profit rate:    0.0 | accuracy: 0.38
step_num: 16600 | loss: 0.4682 | profit rate:    0.0 | accuracy: 0.37
step_num: 16800 | loss: 0.5065 | profit rate:    0.0 | accuracy: 0.38
step_num: 17000 | loss: 0.6317 | profit rate:    0.0 | accuracy: 0.38
step_num: 17200 | loss: 0.6214 | profit rate:    0.0 | accuracy: 0.37
step_num: 17400 | loss: 0.4530 | profit rate:    0.0 | accuracy: 0.37
step_num: 17600 | loss: 0.6898 | profit rate:    0.0 | accuracy: 0.36
episode:   5/5,耗时:1.39分/5.82分,训练集: | step: 17695 | average_treward: -280.9 | max_treward: 0.0000 | average profit rate:  0.000
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 52/408 [00:00<00:00, 516.43it/s] 28%|       | 116/408 [00:00<00:00, 582.09it/s] 43%|     | 176/408 [00:00<00:00, 590.20it/s] 59%|    | 241/408 [00:00<00:00, 613.69it/s] 75%|  | 305/408 [00:00<00:00, 621.06it/s] 91%| | 371/408 [00:00<00:00, 632.10it/s]100%|| 408/408 [00:00<00:00, 614.80it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1427.70
2023-07-24T12:00:00 | net performance [%] = 42.7698
2023-07-24T12:00:00 | number of trades [#] = 10
==================================================
Trial 23 Complete [00h 05m 55s]
net_wealth: 1427.698156789423

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 03h 14m 25s

Search: Running Trial #24

Value             |Best Value So Far |Hyperparameter
4                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.9               |0.5               |gamma
0.0005            |0.001             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.2384 | profit rate:    0.4 | accuracy: 0.31
step_num: 1200 | loss: 0.3408 | profit rate:    0.2 | accuracy: 0.32
step_num: 1400 | loss: 0.3322 | profit rate:    0.6 | accuracy: 0.33
step_num: 1600 | loss: 0.3112 | profit rate:    3.1 | accuracy: 0.35
step_num: 1800 | loss: 0.3004 | profit rate:  411.4 | accuracy: 0.37
step_num: 2000 | loss: 0.3343 | profit rate: 9018.8 | accuracy: 0.39
step_num: 2200 | loss: 0.3185 | profit rate: 1409540.4 | accuracy: 0.41
step_num: 2400 | loss: 0.2919 | profit rate: 46404349.2 | accuracy: 0.42
step_num: 2600 | loss: 0.3085 | profit rate: 2446059352.9 | accuracy: 0.43
step_num: 2800 | loss: 0.3187 | profit rate: 103525783438.3 | accuracy: 0.45
step_num: 3000 | loss: 0.3187 | profit rate: 1849483944247.8 | accuracy: 0.45
episode:   1/5,耗时:3.71分/3.71分,训练集: | step: 3160 | average_treward:  746.7 | max_treward: 746.7037 | average profit rate: 15025111346647.818
model saved @ step:3160,performance:15025111346647.818,accuracy:0.46
step_num: 3200 | loss: 0.2902 | profit rate:    2.3 | accuracy: 0.61
step_num: 3400 | loss: 0.2908 | profit rate:  292.8 | accuracy: 0.64
step_num: 3600 | loss: 0.2891 | profit rate: 3861.0 | accuracy: 0.63
step_num: 3800 | loss: 0.3035 | profit rate: 1374754.8 | accuracy: 0.62
step_num: 4000 | loss: 0.2813 | profit rate: 251279572.0 | accuracy: 0.63
step_num: 4200 | loss: 0.2918 | profit rate: 6018780379.6 | accuracy: 0.63
step_num: 4400 | loss: 0.2850 | profit rate: 525131786683.0 | accuracy: 0.62
step_num: 4600 | loss: 0.2841 | profit rate: 6923706241299.1 | accuracy: 0.63
step_num: 4800 | loss: 0.2790 | profit rate: 383250540518398.8 | accuracy: 0.63
step_num: 5000 | loss: 0.3042 | profit rate: 1253572516899652608.0 | accuracy: 0.64
step_num: 5200 | loss: 0.2701 | profit rate: 199227296995969564672.0 | accuracy: 0.64
step_num: 5400 | loss: 0.2693 | profit rate: 49153666572177576558592.0 | accuracy: 0.64
step_num: 5600 | loss: 0.2655 | profit rate: 4695075055355889692180480.0 | accuracy: 0.65
step_num: 5800 | loss: 0.2427 | profit rate: 806623668797780372131676160.0 | accuracy: 0.65
step_num: 6000 | loss: 0.2790 | profit rate: 144035619369818374041835143168.0 | accuracy: 0.65
step_num: 6200 | loss: 0.2423 | profit rate: 2041112775897047768220060090368.0 | accuracy: 0.64
model saved @ step:6320,performance:14550733756849264480703798575104.000,accuracy:0.64
step_num: 6400 | loss: 0.2399 | profit rate:    3.7 | accuracy: 0.68
step_num: 6600 | loss: 0.2305 | profit rate:  402.8 | accuracy: 0.63
step_num: 6800 | loss: 0.2471 | profit rate: 6520.7 | accuracy: 0.63
step_num: 7000 | loss: 0.2508 | profit rate: 7358806.1 | accuracy: 0.64
step_num: 7200 | loss: 0.2398 | profit rate: 607882568.1 | accuracy: 0.64
step_num: 7400 | loss: 0.2194 | profit rate: 20879728215.9 | accuracy: 0.63
step_num: 7600 | loss: 0.2521 | profit rate: 6249166133984.3 | accuracy: 0.63
step_num: 7800 | loss: 0.2283 | profit rate: 63959945475427.4 | accuracy: 0.63
step_num: 8000 | loss: 0.2470 | profit rate: 10438411775255632.0 | accuracy: 0.64
step_num: 8200 | loss: 0.2356 | profit rate: 101847196265268772864.0 | accuracy: 0.65
step_num: 8400 | loss: 0.1962 | profit rate: 35742681180854185623552.0 | accuracy: 0.65
step_num: 8600 | loss: 0.1911 | profit rate: 15256962964473225666363392.0 | accuracy: 0.65
step_num: 8800 | loss: 0.2127 | profit rate: 1529047676025733517804568576.0 | accuracy: 0.66
step_num: 9000 | loss: 0.2167 | profit rate: 272369119571733826239136268288.0 | accuracy: 0.66
step_num: 9200 | loss: 0.2071 | profit rate: 27034670913343316378856605089792.0 | accuracy: 0.65
step_num: 9400 | loss: 0.2155 | profit rate: 847647923307456679774130249138176.0 | accuracy: 0.65
episode:   3/5,耗时:5.53分/14.84分,训练集: | step: 9480 | average_treward: 1520.5 | max_treward: 1983.0887 | average profit rate: 518518065240679930437996027838464.000
model saved @ step:9480,performance:1541003461965190668696672547110912.000,accuracy:0.65
step_num: 9600 | loss: 0.1970 | profit rate:    5.5 | accuracy: 0.63
step_num: 9800 | loss: 0.1872 | profit rate: 1322.9 | accuracy: 0.64
step_num: 10000 | loss: 0.2089 | profit rate: 67232.1 | accuracy: 0.64
step_num: 10200 | loss: 0.2461 | profit rate: 54866179.7 | accuracy: 0.66
step_num: 10400 | loss: 0.1971 | profit rate: 5723673129.0 | accuracy: 0.66
step_num: 10600 | loss: 0.2157 | profit rate: 464794564199.7 | accuracy: 0.65
step_num: 10800 | loss: 0.2124 | profit rate: 48693947284448.7 | accuracy: 0.65
step_num: 11000 | loss: 0.1998 | profit rate: 581061845606685.5 | accuracy: 0.64
step_num: 11200 | loss: 0.1887 | profit rate: 477937675383350592.0 | accuracy: 0.65
step_num: 11400 | loss: 0.1858 | profit rate: 647249186106854342656.0 | accuracy: 0.66
step_num: 11600 | loss: 0.1765 | profit rate: 262533539854674082922496.0 | accuracy: 0.65
step_num: 11800 | loss: 0.2204 | profit rate: 56706400059704569197756416.0 | accuracy: 0.66
step_num: 12000 | loss: 0.1733 | profit rate: 16610109684974308816360308736.0 | accuracy: 0.67
step_num: 12200 | loss: 0.1625 | profit rate: 2820470470178452913705944350720.0 | accuracy: 0.67
step_num: 12400 | loss: 0.1626 | profit rate: 365857807415528574760608514179072.0 | accuracy: 0.66
step_num: 12600 | loss: 0.1410 | profit rate: 14737500450794100774917677988708352.0 | accuracy: 0.66
model saved @ step:12640,performance:23435446840143220674312131380772864.000,accuracy:0.66
step_num: 12800 | loss: 0.1650 | profit rate:   19.2 | accuracy: 0.67
step_num: 13000 | loss: 0.1649 | profit rate: 1692.2 | accuracy: 0.65
step_num: 13200 | loss: 0.1665 | profit rate: 134862.5 | accuracy: 0.65
step_num: 13400 | loss: 0.1902 | profit rate: 92578250.9 | accuracy: 0.67
step_num: 13600 | loss: 0.1818 | profit rate: 9956699695.4 | accuracy: 0.68
step_num: 13800 | loss: 0.2056 | profit rate: 2776710390648.1 | accuracy: 0.67
step_num: 14000 | loss: 0.1575 | profit rate: 110569695017361.5 | accuracy: 0.67
step_num: 14200 | loss: 0.1752 | profit rate: 2817522458926255.5 | accuracy: 0.66
step_num: 14400 | loss: 0.1629 | profit rate: 10855402637834334208.0 | accuracy: 0.68
step_num: 14600 | loss: 0.1695 | profit rate: 9989310454835408011264.0 | accuracy: 0.68
step_num: 14800 | loss: 0.1579 | profit rate: 7049239353263821592461312.0 | accuracy: 0.68
step_num: 15000 | loss: 0.1638 | profit rate: 1719031347816048605446275072.0 | accuracy: 0.68
step_num: 15200 | loss: 0.1752 | profit rate: 708591532217559925730192654336.0 | accuracy: 0.69
step_num: 15400 | loss: 0.1682 | profit rate: 182716831280385496562703060172800.0 | accuracy: 0.69
step_num: 15600 | loss: 0.1848 | profit rate: 9982793724955695470376011773771776.0 | accuracy: 0.68
episode:   5/5,耗时:5.47分/26.70分,训练集: | step: 15800 | average_treward: 1775.2 | max_treward: 2203.5602 | average profit rate: 46151171274258387772082573530890240.000
model saved @ step:15800,performance:205764855335426694175399842496380928.000,accuracy:0.68
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 52/408 [00:00<00:00, 520.00it/s] 28%|       | 116/408 [00:00<00:00, 589.96it/s] 44%|     | 180/408 [00:00<00:00, 610.01it/s] 60%|    | 246/408 [00:00<00:00, 627.22it/s] 76%|  | 312/408 [00:00<00:00, 638.98it/s] 92%|| 377/408 [00:00<00:00, 642.64it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 626.51it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 5412.94
2023-07-24T12:00:00 | net performance [%] = 441.2935
2023-07-24T12:00:00 | number of trades [#] = 156
==================================================
Trial 24 Complete [00h 27m 38s]
net_wealth: 5412.935476077635

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 03h 42m 04s

Search: Running Trial #25

Value             |Best Value So Far |Hyperparameter
15                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
3                 |3                 |lags
0.6               |0.5               |gamma
1e-05             |0.001             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4300.000000   4315.000000
mean      0.000441    20062.255222  ...   20173.020481  20118.633889
std       0.027818    16039.874230  ...   16078.674434  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7736.967529   7690.540039
50%       0.000642    11554.824463  ...   11753.029785  11715.610352
75%       0.011655    29873.081836  ...   30013.548340  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 1.1499 | profit rate:    4.4 | accuracy: 0.40
step_num: 400 | loss: 0.6911 | profit rate:    4.3 | accuracy: 0.37
step_num: 600 | loss: 0.7761 | profit rate: 8618.2 | accuracy: 0.41
step_num: 800 | loss: 0.7871 | profit rate: 2751.9 | accuracy: 0.39
step_num: 1000 | loss: 0.6900 | profit rate: 2040.9 | accuracy: 0.38
step_num: 1200 | loss: 1.0787 | profit rate:   72.1 | accuracy: 0.37
step_num: 1400 | loss: 0.5085 | profit rate:  798.1 | accuracy: 0.37
step_num: 1600 | loss: 0.4493 | profit rate: 19658.4 | accuracy: 0.40
step_num: 1800 | loss: 1.7768 | profit rate: 420769964.2 | accuracy: 0.41
step_num: 2000 | loss: 1.1036 | profit rate: 24285718.0 | accuracy: 0.41
step_num: 2200 | loss: 0.4288 | profit rate: 63957490.9 | accuracy: 0.41
step_num: 2400 | loss: 1.2950 | profit rate: 144642.4 | accuracy: 0.40
step_num: 2600 | loss: 0.6303 | profit rate:  147.1 | accuracy: 0.39
step_num: 2800 | loss: 0.7710 | profit rate: 3350.6 | accuracy: 0.39
step_num: 3000 | loss: 0.6315 | profit rate:  756.7 | accuracy: 0.38
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3174 | average_treward:   76.6 | max_treward: 76.5895 | average profit rate: 203.956
model saved @ step:3174,performance:203.956,accuracy:0.39
step_num: 3200 | loss: 0.7678 | profit rate:    0.2 | accuracy: 0.33
step_num: 3400 | loss: 0.9561 | profit rate:    1.0 | accuracy: 0.51
step_num: 3600 | loss: 0.4647 | profit rate:    5.4 | accuracy: 0.47
step_num: 3800 | loss: 0.9286 | profit rate: 16598.0 | accuracy: 0.44
step_num: 4000 | loss: 1.1038 | profit rate: 3161.7 | accuracy: 0.42
step_num: 4200 | loss: 0.4730 | profit rate: 2792.3 | accuracy: 0.41
step_num: 4400 | loss: 0.7278 | profit rate:   17.3 | accuracy: 0.39
step_num: 4600 | loss: 0.4516 | profit rate:  519.3 | accuracy: 0.40
step_num: 4800 | loss: 0.4303 | profit rate: 304330.5 | accuracy: 0.44
step_num: 5000 | loss: 1.0250 | profit rate: 848957697.8 | accuracy: 0.44
step_num: 5200 | loss: 1.2341 | profit rate: 573151245.7 | accuracy: 0.44
step_num: 5400 | loss: 0.7365 | profit rate: 742143716.0 | accuracy: 0.43
step_num: 5600 | loss: 0.7696 | profit rate: 14902137.1 | accuracy: 0.43
step_num: 5800 | loss: 0.6711 | profit rate: 10564.3 | accuracy: 0.41
step_num: 6000 | loss: 0.8891 | profit rate: 99115.0 | accuracy: 0.41
step_num: 6200 | loss: 0.4702 | profit rate: 42726.2 | accuracy: 0.41
model saved @ step:6348,performance:11756.898,accuracy:0.41
step_num: 6400 | loss: 0.7355 | profit rate:    0.3 | accuracy: 0.55
step_num: 6600 | loss: 0.8488 | profit rate:    1.0 | accuracy: 0.47
step_num: 6800 | loss: 0.7264 | profit rate:   25.7 | accuracy: 0.46
step_num: 7000 | loss: 0.6417 | profit rate: 26995.3 | accuracy: 0.43
step_num: 7200 | loss: 0.7718 | profit rate: 18573.5 | accuracy: 0.42
step_num: 7400 | loss: 0.4685 | profit rate: 19646.2 | accuracy: 0.42
step_num: 7600 | loss: 0.5902 | profit rate:   13.0 | accuracy: 0.38
step_num: 7800 | loss: 0.7064 | profit rate:  332.2 | accuracy: 0.40
step_num: 8000 | loss: 0.6073 | profit rate: 421186.0 | accuracy: 0.43
step_num: 8200 | loss: 0.8687 | profit rate: 4709900959.6 | accuracy: 0.44
step_num: 8400 | loss: 0.7122 | profit rate: 440398961.1 | accuracy: 0.44
step_num: 8600 | loss: 0.9401 | profit rate: 187074191.4 | accuracy: 0.43
step_num: 8800 | loss: 0.8939 | profit rate: 2151492.3 | accuracy: 0.43
step_num: 9000 | loss: 0.9363 | profit rate: 4411.1 | accuracy: 0.41
step_num: 9200 | loss: 0.6057 | profit rate: 75309.0 | accuracy: 0.41
step_num: 9400 | loss: 0.4704 | profit rate: 302874.4 | accuracy: 0.41
episode:   3/5,耗时:0.70分/2.05分,训练集: | step: 9522 | average_treward:  112.7 | max_treward: 131.8610 | average profit rate: 14108.525
step_num: 9600 | loss: 0.5205 | profit rate:    0.3 | accuracy: 0.52
step_num: 9800 | loss: 0.5401 | profit rate:    0.8 | accuracy: 0.47
step_num: 10000 | loss: 0.5023 | profit rate:   27.4 | accuracy: 0.46
step_num: 10200 | loss: 0.7060 | profit rate: 598563.3 | accuracy: 0.45
step_num: 10400 | loss: 0.8509 | profit rate: 11438.3 | accuracy: 0.41
step_num: 10600 | loss: 0.6480 | profit rate: 23850.9 | accuracy: 0.43
step_num: 10800 | loss: 0.4816 | profit rate:   14.1 | accuracy: 0.39
step_num: 11000 | loss: 0.9273 | profit rate:   23.1 | accuracy: 0.40
step_num: 11200 | loss: 0.7060 | profit rate: 631602.9 | accuracy: 0.44
step_num: 11400 | loss: 0.8372 | profit rate: 828298723.4 | accuracy: 0.44
step_num: 11600 | loss: 0.8279 | profit rate: 71983917.1 | accuracy: 0.44
step_num: 11800 | loss: 0.7575 | profit rate: 17717435.6 | accuracy: 0.43
step_num: 12000 | loss: 1.0952 | profit rate: 126430.8 | accuracy: 0.43
step_num: 12200 | loss: 0.9581 | profit rate:  773.4 | accuracy: 0.41
step_num: 12400 | loss: 0.4643 | profit rate: 35414.2 | accuracy: 0.41
step_num: 12600 | loss: 0.8816 | profit rate: 15433.7 | accuracy: 0.41
model saved @ step:12696,performance:22957.603,accuracy:0.42
step_num: 12800 | loss: 0.5686 | profit rate:    0.4 | accuracy: 0.56
step_num: 13000 | loss: 0.6330 | profit rate:    0.7 | accuracy: 0.48
step_num: 13200 | loss: 0.5685 | profit rate:  218.0 | accuracy: 0.47
step_num: 13400 | loss: 0.8707 | profit rate: 167774.1 | accuracy: 0.44
step_num: 13600 | loss: 0.9614 | profit rate:  386.9 | accuracy: 0.40
step_num: 13800 | loss: 0.8370 | profit rate: 2606.8 | accuracy: 0.42
step_num: 14000 | loss: 0.4664 | profit rate:    5.3 | accuracy: 0.39
step_num: 14200 | loss: 0.9676 | profit rate:   17.8 | accuracy: 0.40
step_num: 14400 | loss: 0.8062 | profit rate: 15967710.7 | accuracy: 0.45
step_num: 14600 | loss: 0.7244 | profit rate: 1588316474.2 | accuracy: 0.45
step_num: 14800 | loss: 0.7063 | profit rate: 34845809.7 | accuracy: 0.44
step_num: 15000 | loss: 0.8108 | profit rate: 211231309.5 | accuracy: 0.44
step_num: 15200 | loss: 1.1797 | profit rate: 112140.2 | accuracy: 0.43
step_num: 15400 | loss: 0.9657 | profit rate: 5627.6 | accuracy: 0.42
step_num: 15600 | loss: 0.5379 | profit rate: 72485.8 | accuracy: 0.41
step_num: 15800 | loss: 0.7409 | profit rate: 134907.2 | accuracy: 0.42
episode:   5/5,耗时:1.38分/4.79分,训练集: | step: 15870 | average_treward:  125.4 | max_treward: 150.7001 | average profit rate: 38155.720
model saved @ step:15870,performance:125495.424,accuracy:0.42
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 12%|        | 49/408 [00:00<00:00, 485.15it/s] 27%|       | 110/408 [00:00<00:00, 551.82it/s] 43%|     | 174/408 [00:00<00:00, 591.74it/s] 58%|    | 237/408 [00:00<00:00, 602.04it/s] 74%|  | 300/408 [00:00<00:00, 612.04it/s] 89%| | 363/408 [00:00<00:00, 617.29it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 603.20it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1246.22
2023-07-24T12:00:00 | net performance [%] = 24.6220
2023-07-24T12:00:00 | number of trades [#] = 6
==================================================
Trial 25 Complete [00h 04m 53s]
net_wealth: 1247.4672322170175

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 03h 46m 57s

Search: Running Trial #26

Value             |Best Value So Far |Hyperparameter
15                |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
8                 |3                 |lags
0.5               |0.5               |gamma
0.0005            |0.001             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4286.000000   4301.000000
mean      0.000435    20113.607657  ...   20224.573864  20169.373185
std       0.027833    16040.642334  ...   16079.545659  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7778.380005   7730.930176
50%       0.000642    11571.842969  ...   11768.989746  11751.469727
75%       0.011590    29894.706152  ...   30071.020508  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.5241 | profit rate:    0.4 | accuracy: 0.33
step_num: 800 | loss: 0.3897 | profit rate:    2.1 | accuracy: 0.33
step_num: 1000 | loss: 0.3153 | profit rate:   19.1 | accuracy: 0.34
step_num: 1200 | loss: 0.3360 | profit rate: 219149.7 | accuracy: 0.37
step_num: 1400 | loss: 0.3051 | profit rate: 113845122.5 | accuracy: 0.40
step_num: 1600 | loss: 0.3160 | profit rate: 2135492112.7 | accuracy: 0.41
step_num: 1800 | loss: 0.3531 | profit rate: 56138600339956.1 | accuracy: 0.43
step_num: 2000 | loss: 0.3549 | profit rate: 2779733539674114.0 | accuracy: 0.44
step_num: 2200 | loss: 0.3769 | profit rate: 230184333928982609920.0 | accuracy: 0.46
step_num: 2400 | loss: 0.3503 | profit rate: 11843813270920313146703872.0 | accuracy: 0.47
step_num: 2600 | loss: 0.3463 | profit rate: 45928916660140316063843745792.0 | accuracy: 0.48
step_num: 2800 | loss: 0.3650 | profit rate: 3638267310005633998940095138234368.0 | accuracy: 0.49
step_num: 3000 | loss: 0.3553 | profit rate: 691486171756986221530225923793616896.0 | accuracy: 0.49
step_num: 3200 | loss: 0.3383 | profit rate: 23259182332745362357588338356631285792768.0 | accuracy: 0.50
step_num: 3400 | loss: 0.3907 | profit rate: 13276253211268080325326025050523092987674624.0 | accuracy: 0.50
step_num: 3600 | loss: 0.3321 | profit rate: 498244942196978294656119999180416267975655424.0 | accuracy: 0.51
episode:   1/5,耗时:1.25分/1.25分,训练集: | step: 3660 | average_treward: 1376.4 | max_treward: 1376.3573 | average profit rate: 865139355113962694340296327361337619432603648.000
model saved @ step:3660,performance:865139355113962694340296327361337619432603648.000,accuracy:0.51
step_num: 3800 | loss: 0.2997 | profit rate: 14756.0 | accuracy: 0.58
step_num: 4000 | loss: 0.3029 | profit rate: 560669299.8 | accuracy: 0.62
step_num: 4200 | loss: 0.3053 | profit rate: 2849854499712.8 | accuracy: 0.59
step_num: 4400 | loss: 0.2744 | profit rate: 4693987326123673.0 | accuracy: 0.57
step_num: 4600 | loss: 0.2547 | profit rate: 64941380948960632.0 | accuracy: 0.55
step_num: 4800 | loss: 0.2290 | profit rate: 192708391731453591552.0 | accuracy: 0.53
step_num: 5000 | loss: 0.2386 | profit rate: 722282354666539499651072.0 | accuracy: 0.54
step_num: 5200 | loss: 0.2286 | profit rate: 3255737468625975067952545792.0 | accuracy: 0.56
step_num: 5400 | loss: 0.1919 | profit rate: 1459230348252427058119938131623936.0 | accuracy: 0.57
step_num: 5600 | loss: 0.2963 | profit rate: 47806722056296724026767628432310272.0 | accuracy: 0.56
step_num: 5800 | loss: 0.2549 | profit rate: 341842227314383563979692143304454963200.0 | accuracy: 0.57
step_num: 6000 | loss: 0.2786 | profit rate: 3231405056253024523380241217201490383054307328.0 | accuracy: 0.57
step_num: 6200 | loss: 0.2567 | profit rate: 66045106267909621812377460965369433895770727120896.0 | accuracy: 0.57
step_num: 6400 | loss: 0.2395 | profit rate: 525705659196464111949391864182116227797899922313838592.0 | accuracy: 0.57
step_num: 6600 | loss: 0.2353 | profit rate: 4083155488986835562001763020436052266954688261010424332288.0 | accuracy: 0.57
step_num: 6800 | loss: 0.2096 | profit rate: 116986900478854447420569384569503450295392738030270897117462528.0 | accuracy: 0.58
step_num: 7000 | loss: 0.2170 | profit rate: 334921587663863212942120821224147687659324187896758343356385329152.0 | accuracy: 0.58
step_num: 7200 | loss: 0.1945 | profit rate: 37721165562246790054263513766075763102739250656653832754709854683136.0 | accuracy: 0.58
model saved @ step:7320,performance:344440306337690910098985955481963398006093717225180752693087042535424.000,accuracy:0.57
step_num: 7400 | loss: 0.2180 | profit rate: 6378.5 | accuracy: 0.68
step_num: 7600 | loss: 0.2172 | profit rate: 1144227678.5 | accuracy: 0.67
step_num: 7800 | loss: 0.1889 | profit rate: 29703346228025.9 | accuracy: 0.61
step_num: 8000 | loss: 0.1798 | profit rate: 148204867188610912.0 | accuracy: 0.60
step_num: 8200 | loss: 0.1854 | profit rate: 18072110614210191360.0 | accuracy: 0.58
step_num: 8400 | loss: 0.1841 | profit rate: 185402505686882271100928.0 | accuracy: 0.58
step_num: 8600 | loss: 0.2036 | profit rate: 98977665938384403048106557440.0 | accuracy: 0.60
step_num: 8800 | loss: 0.1800 | profit rate: 145587998762197630632657965547520.0 | accuracy: 0.61
step_num: 9000 | loss: 0.1766 | profit rate: 307010461977656828290481522016805453824.0 | accuracy: 0.62
step_num: 9200 | loss: 0.2251 | profit rate: 98194638091337449784797651240120982962176.0 | accuracy: 0.62
step_num: 9400 | loss: 0.2197 | profit rate: 104511272280499453230490707798591567451652096.0 | accuracy: 0.62
step_num: 9600 | loss: 0.2062 | profit rate: 27821262715070869514158744935806775414853728173293568.0 | accuracy: 0.63
step_num: 9800 | loss: 0.2191 | profit rate: 9963705096702868095194842494112215287933918769126710444032.0 | accuracy: 0.63
step_num: 10000 | loss: 0.1935 | profit rate: 172345828981509398588981891716410202387710947943232578638577664.0 | accuracy: 0.63
step_num: 10200 | loss: 0.1947 | profit rate: 1615065008080888099581729276480039499618907973748755636005489344512.0 | accuracy: 0.63
step_num: 10400 | loss: 0.1730 | profit rate: 18445675167912930572701185833815638657669696010506098046511599287533568.0 | accuracy: 0.63
step_num: 10600 | loss: 0.1709 | profit rate: 2359675227622324499426060713230113462160213784332936314150009276035537829888.0 | accuracy: 0.63
step_num: 10800 | loss: 0.1619 | profit rate: 503378039795460732800592855222682077122384140366062037428120033658805621358592.0 | accuracy: 0.63
episode:   3/5,耗时:2.38分/5.12分,训练集: | step: 10980 | average_treward: 2032.7 | max_treward: 2533.6643 | average profit rate: 4189651074145662226962944147945409724140602119522628418015784907720382065147904.000
model saved @ step:10980,performance:12568953222092547198693521613283287790675127914839141508549135335795220331626496.000,accuracy:0.62
step_num: 11000 | loss: 0.1424 | profit rate:    1.4 | accuracy: 0.62
step_num: 11200 | loss: 0.1479 | profit rate: 328801834.8 | accuracy: 0.70
step_num: 11400 | loss: 0.1671 | profit rate: 20588141629864.8 | accuracy: 0.69
step_num: 11600 | loss: 0.1539 | profit rate: 38000690898497496.0 | accuracy: 0.69
step_num: 11800 | loss: 0.1261 | profit rate: 847521259575474126848.0 | accuracy: 0.66
step_num: 12000 | loss: 0.1366 | profit rate: 666259120885675885330432.0 | accuracy: 0.65
step_num: 12200 | loss: 0.1677 | profit rate: 665568079545486843979325505536.0 | accuracy: 0.66
step_num: 12400 | loss: 0.1665 | profit rate: 5833645422407154411229169334616064.0 | accuracy: 0.67
step_num: 12600 | loss: 0.1470 | profit rate: 4673110301768495361440292060206232240128.0 | accuracy: 0.67
step_num: 12800 | loss: 0.1896 | profit rate: 5691822764209687384366501940089772327305216.0 | accuracy: 0.66
step_num: 13000 | loss: 0.1825 | profit rate: 933270862870965505203640631946535536787718144.0 | accuracy: 0.66
step_num: 13200 | loss: 0.1411 | profit rate: 60296561907876186618582934279263816774411948092555264.0 | accuracy: 0.67
step_num: 13400 | loss: 0.1530 | profit rate: 300503583928085595237187169204542896931590713316139570561024.0 | accuracy: 0.68
step_num: 13600 | loss: 0.1225 | profit rate: 177573320633417756203044671910836444513469971146758895377726832640.0 | accuracy: 0.68
step_num: 13800 | loss: 0.1273 | profit rate: 10711488546539141277544355203405600366547565495377710265788930707161088.0 | accuracy: 0.68
step_num: 14000 | loss: 0.1492 | profit rate: 63563126567911121074674296366693446294850975648519901349019573513992798208.0 | accuracy: 0.68
step_num: 14200 | loss: 0.1250 | profit rate: 2811931423112488009713892042970256661457669181668468816391442772515974828523520.0 | accuracy: 0.68
step_num: 14400 | loss: 0.1201 | profit rate: 31780387172252836961072894620986865967623744886268180722765161107656842794401529856.0 | accuracy: 0.67
step_num: 14600 | loss: 0.1390 | profit rate: 5508282328280253317517000015261817462551583387868471384885468164504728446302469226496.0 | accuracy: 0.67
model saved @ step:14640,performance:7054626951931753311927034957343627874617664990189976918591571421371027904136669560832.000,accuracy:0.67
step_num: 14800 | loss: 0.1300 | profit rate: 21555663.7 | accuracy: 0.74
step_num: 15000 | loss: 0.1304 | profit rate: 3504246271863.5 | accuracy: 0.72
step_num: 15200 | loss: 0.1163 | profit rate: 108236607684968960.0 | accuracy: 0.71
step_num: 15400 | loss: 0.1216 | profit rate: 6007151703871052578816.0 | accuracy: 0.68
step_num: 15600 | loss: 0.1197 | profit rate: 1760578995125953752989696.0 | accuracy: 0.67
step_num: 15800 | loss: 0.1061 | profit rate: 39536968349667490455217986600960.0 | accuracy: 0.69
step_num: 16000 | loss: 0.0974 | profit rate: 363616246608051012089877840655286272.0 | accuracy: 0.69
step_num: 16200 | loss: 0.1114 | profit rate: 7751258787527140898954351670474324312064.0 | accuracy: 0.71
step_num: 16400 | loss: 0.1142 | profit rate: 37615256858253113925998873534431666205490151424.0 | accuracy: 0.71
step_num: 16600 | loss: 0.1422 | profit rate: 3023811622159430154751523302894342116778748936192.0 | accuracy: 0.70
step_num: 16800 | loss: 0.1246 | profit rate: 94508789684320316256168149596303855057826209528283136.0 | accuracy: 0.71
step_num: 17000 | loss: 0.1040 | profit rate: 689004426733024721459407426958390414337408296764452166707445760.0 | accuracy: 0.72
step_num: 17200 | loss: 0.0985 | profit rate: 206582405810783942001018211293461838876381222304636767988384463323136.0 | accuracy: 0.72
step_num: 17400 | loss: 0.1039 | profit rate: 84465767140839168325426685009217024313450214009942217898991593002564059136.0 | accuracy: 0.72
step_num: 17600 | loss: 0.1030 | profit rate: 392683579503882402565823703731683188105677815547812015167381485921753312002048.0 | accuracy: 0.72
step_num: 17800 | loss: 0.1059 | profit rate: 27692836287503931833069446458923066416076708969715395480927660688988009537002799104.0 | accuracy: 0.72
step_num: 18000 | loss: 0.1133 | profit rate: 3855402782460367886947212690281474166385506703473491303633389638564980180109155975036928.0 | accuracy: 0.71
step_num: 18200 | loss: 0.1000 | profit rate: 8955393836567370000100484416985217041421481287309610061358554319504238611257090892384698368.0 | accuracy: 0.71
episode:   5/5,耗时:2.36分/8.98分,训练集: | step: 18300 | average_treward: 2411.0 | max_treward: 3136.9476 | average profit rate: 7010589981836916200673679549259149171203202896341625548968079038578340194508904171378311168.000
model saved @ step:18300,performance:35052942854545061672133296191355317719841382759143089078891265617985998782257404532173570048.000,accuracy:0.71
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 52/403 [00:00<00:00, 510.96it/s] 29%|       | 116/403 [00:00<00:00, 579.54it/s] 45%|     | 180/403 [00:00<00:00, 606.86it/s] 61%|   | 247/403 [00:00<00:00, 626.72it/s] 78%|  | 313/403 [00:00<00:00, 638.61it/s] 94%|| 379/403 [00:00<00:00, 645.84it/s]100%|| 403/403 [00:00<00:00, 626.00it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2823.03
2023-07-24T12:00:00 | net performance [%] = 182.3032
2023-07-24T12:00:00 | number of trades [#] = 56
==================================================
Trial 26 Complete [00h 09m 54s]
net_wealth: 2823.0315735889835

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 03h 56m 52s

Search: Running Trial #27

Value             |Best Value So Far |Hyperparameter
4                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.8               |0.5               |gamma
0.001             |0.001             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.6606 | profit rate:    1.5 | accuracy: 0.33
step_num: 400 | loss: 0.3666 | profit rate:    2.6 | accuracy: 0.33
step_num: 600 | loss: 0.4289 | profit rate:   10.3 | accuracy: 0.36
step_num: 800 | loss: 0.4444 | profit rate:  172.4 | accuracy: 0.40
step_num: 1000 | loss: 0.4137 | profit rate: 2323.5 | accuracy: 0.42
step_num: 1200 | loss: 0.3586 | profit rate: 82544.4 | accuracy: 0.44
step_num: 1400 | loss: 0.3931 | profit rate: 1452764.9 | accuracy: 0.47
step_num: 1600 | loss: 0.3176 | profit rate: 15225046.1 | accuracy: 0.49
step_num: 1800 | loss: 0.3629 | profit rate: 2556154405.7 | accuracy: 0.51
step_num: 2000 | loss: 0.4210 | profit rate: 562305539712.9 | accuracy: 0.52
step_num: 2200 | loss: 0.3719 | profit rate: 110010304998042.3 | accuracy: 0.54
step_num: 2400 | loss: 0.4252 | profit rate: 9082027155433264.0 | accuracy: 0.55
step_num: 2600 | loss: 0.4198 | profit rate: 701926174746425728.0 | accuracy: 0.56
step_num: 2800 | loss: 0.4548 | profit rate: 45347431912834531328.0 | accuracy: 0.56
step_num: 3000 | loss: 0.4428 | profit rate: 1544876086415086059520.0 | accuracy: 0.57
episode:   1/5,耗时:0.86分/0.86分,训练集: | step: 3160 | average_treward: 1245.7 | max_treward: 1245.6685 | average profit rate: 19676192337126817267712.000
model saved @ step:3160,performance:19676192337126817267712.000,accuracy:0.58
step_num: 3200 | loss: 0.3988 | profit rate:    2.4 | accuracy: 0.71
step_num: 3400 | loss: 0.4014 | profit rate:  165.6 | accuracy: 0.71
step_num: 3600 | loss: 0.3812 | profit rate: 2302.4 | accuracy: 0.68
step_num: 3800 | loss: 0.4209 | profit rate: 1596391.8 | accuracy: 0.68
step_num: 4000 | loss: 0.3592 | profit rate: 231764870.8 | accuracy: 0.69
step_num: 4200 | loss: 0.4436 | profit rate: 4833634545.1 | accuracy: 0.68
step_num: 4400 | loss: 0.3554 | profit rate: 1001342157141.6 | accuracy: 0.66
step_num: 4600 | loss: 0.3133 | profit rate: 11035025907014.0 | accuracy: 0.66
step_num: 4800 | loss: 0.3362 | profit rate: 688267882679834.8 | accuracy: 0.66
step_num: 5000 | loss: 0.4968 | profit rate: 791368005645084672.0 | accuracy: 0.67
step_num: 5200 | loss: 0.3960 | profit rate: 112193838314433511424.0 | accuracy: 0.67
step_num: 5400 | loss: 0.4014 | profit rate: 13390108175938778824704.0 | accuracy: 0.67
step_num: 5600 | loss: 0.3659 | profit rate: 1115438127638246796034048.0 | accuracy: 0.67
step_num: 5800 | loss: 0.3679 | profit rate: 152873591766292726693232640.0 | accuracy: 0.67
step_num: 6000 | loss: 0.4193 | profit rate: 9406145529945880916096188416.0 | accuracy: 0.67
step_num: 6200 | loss: 0.3215 | profit rate: 156472357870911901166123089920.0 | accuracy: 0.67
model saved @ step:6320,performance:1280275732495669493776122904576.000,accuracy:0.67
step_num: 6400 | loss: 0.2602 | profit rate:    4.5 | accuracy: 0.78
step_num: 6600 | loss: 0.3273 | profit rate:  264.1 | accuracy: 0.68
step_num: 6800 | loss: 0.3627 | profit rate: 3396.2 | accuracy: 0.65
step_num: 7000 | loss: 0.3699 | profit rate: 2902128.9 | accuracy: 0.65
step_num: 7200 | loss: 0.3528 | profit rate: 217367324.3 | accuracy: 0.66
step_num: 7400 | loss: 0.3157 | profit rate: 6250173333.0 | accuracy: 0.66
step_num: 7600 | loss: 0.3573 | profit rate: 3178026030071.8 | accuracy: 0.66
step_num: 7800 | loss: 0.3707 | profit rate: 32558281490471.8 | accuracy: 0.66
step_num: 8000 | loss: 0.3866 | profit rate: 3234973159717604.5 | accuracy: 0.67
step_num: 8200 | loss: 0.4097 | profit rate: 2607646744299810304.0 | accuracy: 0.67
step_num: 8400 | loss: 0.4005 | profit rate: 487633444783233433600.0 | accuracy: 0.67
step_num: 8600 | loss: 0.3907 | profit rate: 156231898249870174060544.0 | accuracy: 0.68
step_num: 8800 | loss: 0.3609 | profit rate: 17551740340510746503806976.0 | accuracy: 0.68
step_num: 9000 | loss: 0.3939 | profit rate: 1995171109460465850504970240.0 | accuracy: 0.68
step_num: 9200 | loss: 0.3571 | profit rate: 183477503239896915819123179520.0 | accuracy: 0.68
step_num: 9400 | loss: 0.2283 | profit rate: 9127199325678702908796636758016.0 | accuracy: 0.68
episode:   3/5,耗时:0.96分/2.78分,训练集: | step: 9480 | average_treward: 1593.9 | max_treward: 1810.2770 | average profit rate: 6975236105811606306097297620992.000
model saved @ step:9480,performance:19645432565262958681331091898368.000,accuracy:0.68
step_num: 9600 | loss: 0.2762 | profit rate:    7.2 | accuracy: 0.74
step_num: 9800 | loss: 0.3378 | profit rate:  447.2 | accuracy: 0.70
step_num: 10000 | loss: 0.3631 | profit rate: 12020.3 | accuracy: 0.65
step_num: 10200 | loss: 0.3938 | profit rate: 7233990.6 | accuracy: 0.65
step_num: 10400 | loss: 0.3800 | profit rate: 566514901.9 | accuracy: 0.66
step_num: 10600 | loss: 0.3687 | profit rate: 59501143739.4 | accuracy: 0.65
step_num: 10800 | loss: 0.3374 | profit rate: 5515529398107.4 | accuracy: 0.65
step_num: 11000 | loss: 0.3522 | profit rate: 59792428348280.4 | accuracy: 0.64
step_num: 11200 | loss: 0.3746 | profit rate: 50103273330754320.0 | accuracy: 0.66
step_num: 11400 | loss: 0.3229 | profit rate: 6110659987816552448.0 | accuracy: 0.66
step_num: 11600 | loss: 0.3630 | profit rate: 2328020816248555438080.0 | accuracy: 0.66
step_num: 11800 | loss: 0.4169 | profit rate: 436515310348096579305472.0 | accuracy: 0.66
step_num: 12000 | loss: 0.3287 | profit rate: 49678019640528191698763776.0 | accuracy: 0.66
step_num: 12200 | loss: 0.4289 | profit rate: 3365674155706304555405803520.0 | accuracy: 0.66
step_num: 12400 | loss: 0.3181 | profit rate: 478650657081239310096125657088.0 | accuracy: 0.66
step_num: 12600 | loss: 0.3178 | profit rate: 13422888992797070793563850145792.0 | accuracy: 0.66
step_num: 12800 | loss: 0.2207 | profit rate:   14.2 | accuracy: 0.69
step_num: 13000 | loss: 0.3090 | profit rate:  681.9 | accuracy: 0.68
step_num: 13200 | loss: 0.3140 | profit rate: 32784.7 | accuracy: 0.64
step_num: 13400 | loss: 0.2711 | profit rate: 15071592.1 | accuracy: 0.65
step_num: 13600 | loss: 0.2480 | profit rate: 957522933.9 | accuracy: 0.64
step_num: 13800 | loss: 0.3535 | profit rate: 223756612830.5 | accuracy: 0.63
step_num: 14000 | loss: 0.3014 | profit rate: 6772018603308.6 | accuracy: 0.63
step_num: 14200 | loss: 0.2698 | profit rate: 143777974319506.1 | accuracy: 0.63
step_num: 14400 | loss: 0.2936 | profit rate: 127333959012888144.0 | accuracy: 0.64
step_num: 14600 | loss: 0.3155 | profit rate: 19218977590481817600.0 | accuracy: 0.65
step_num: 14800 | loss: 0.3075 | profit rate: 14713607538124523569152.0 | accuracy: 0.66
step_num: 15000 | loss: 0.3637 | profit rate: 928861387273562717421568.0 | accuracy: 0.65
step_num: 15200 | loss: 0.2488 | profit rate: 181188978999386595087351808.0 | accuracy: 0.66
step_num: 15400 | loss: 0.3830 | profit rate: 22678131501240757398915776512.0 | accuracy: 0.66
step_num: 15600 | loss: 0.3125 | profit rate: 1432611355028434204962779561984.0 | accuracy: 0.66
episode:   5/5,耗时:0.96分/5.08分,训练集: | step: 15800 | average_treward: 1673.7 | max_treward: 1810.2770 | average profit rate: 12434372192760761370801724194816.000
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 54/408 [00:00<00:00, 537.35it/s] 29%|       | 118/408 [00:00<00:00, 587.27it/s] 45%|     | 183/408 [00:00<00:00, 612.83it/s] 61%|    | 249/408 [00:00<00:00, 631.06it/s] 77%|  | 314/408 [00:00<00:00, 637.85it/s] 93%|| 380/408 [00:00<00:00, 645.35it/s]100%|| 408/408 [00:00<00:00, 629.06it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 5817.02
2023-07-24T12:00:00 | net performance [%] = 481.7024
2023-07-24T12:00:00 | number of trades [#] = 114
==================================================
Trial 27 Complete [00h 05m 32s]
net_wealth: 5817.023738005965

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 02m 24s

Search: Running Trial #28

Value             |Best Value So Far |Hyperparameter
6                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.85              |0.5               |gamma
0.0001            |0.001             |DQN_lr
64                |64                |memory_size
32                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4295.000000   4301.000000
mean      0.000435    20113.607657  ...   20191.527960  20169.373185
std       0.027833    16040.642334  ...   16078.872271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7755.915039   7730.930176
50%       0.000642    11571.842969  ...   11757.219727  11751.469727
75%       0.011590    29894.706152  ...   30018.430664  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.7059 | profit rate:    1.1 | accuracy: 0.37
step_num: 400 | loss: 0.4580 | profit rate:    4.8 | accuracy: 0.41
step_num: 600 | loss: 1.3714 | profit rate:    5.9 | accuracy: 0.39
step_num: 800 | loss: 0.8026 | profit rate:   13.6 | accuracy: 0.39
step_num: 1000 | loss: 0.9816 | profit rate:   66.1 | accuracy: 0.38
step_num: 1200 | loss: 0.8647 | profit rate: 1711.0 | accuracy: 0.40
step_num: 1400 | loss: 0.6060 | profit rate: 20205.8 | accuracy: 0.42
step_num: 1600 | loss: 0.7097 | profit rate: 4143232.8 | accuracy: 0.44
step_num: 1800 | loss: 0.7976 | profit rate: 58342973.7 | accuracy: 0.45
step_num: 2000 | loss: 1.0298 | profit rate: 17795539422.7 | accuracy: 0.48
step_num: 2200 | loss: 0.5122 | profit rate: 712143383737728.5 | accuracy: 0.51
step_num: 2400 | loss: 0.9590 | profit rate: 1537733972889619456.0 | accuracy: 0.52
step_num: 2600 | loss: 0.6802 | profit rate: 2254277074538029121536.0 | accuracy: 0.54
step_num: 2800 | loss: 0.5895 | profit rate: 1201737209520087898259456.0 | accuracy: 0.56
step_num: 3000 | loss: 0.3664 | profit rate: 2498515457897699559795064832.0 | accuracy: 0.57
step_num: 3200 | loss: 0.7017 | profit rate: 15795359125051563004366159872000.0 | accuracy: 0.59
step_num: 3400 | loss: 0.6543 | profit rate: 1657832737364461630286091058675712.0 | accuracy: 0.59
episode:   1/5,耗时:0.72分/0.72分,训练集: | step: 3514 | average_treward: 1696.8 | max_treward: 1696.7805 | average profit rate: 29101768065220535794018810545045504.000
model saved @ step:3514,performance:29101768065220535794018810545045504.000,accuracy:0.60
step_num: 3600 | loss: 0.3827 | profit rate:  133.6 | accuracy: 0.74
step_num: 3800 | loss: 0.1937 | profit rate: 245771.2 | accuracy: 0.77
step_num: 4000 | loss: 0.4401 | profit rate: 63569844.2 | accuracy: 0.79
step_num: 4200 | loss: 0.2350 | profit rate: 400689837659.4 | accuracy: 0.80
step_num: 4400 | loss: 0.4816 | profit rate: 359723701415633.2 | accuracy: 0.81
step_num: 4600 | loss: 0.3482 | profit rate: 9209599569701710848.0 | accuracy: 0.82
step_num: 4800 | loss: 0.3212 | profit rate: 7203521242052486496256.0 | accuracy: 0.81
step_num: 5000 | loss: 0.4176 | profit rate: 48018586366248495702081536.0 | accuracy: 0.82
step_num: 5200 | loss: 0.2838 | profit rate: 204542118989128567105664319488.0 | accuracy: 0.82
step_num: 5400 | loss: 0.2442 | profit rate: 18478362308252554260375706533888.0 | accuracy: 0.82
step_num: 5600 | loss: 0.5089 | profit rate: 634829930887987091869833893397921792.0 | accuracy: 0.82
step_num: 5800 | loss: 0.2852 | profit rate: 24712124166326716844232305171011796467712.0 | accuracy: 0.82
step_num: 6000 | loss: 0.1872 | profit rate: 1968037434764519726611152717506202058256023552.0 | accuracy: 0.83
step_num: 6200 | loss: 0.3596 | profit rate: 4071217997914422543295145920482504552577991966720.0 | accuracy: 0.82
step_num: 6400 | loss: 0.4136 | profit rate: 7665040255387564729611258042213101602097849113247744.0 | accuracy: 0.82
step_num: 6600 | loss: 0.2671 | profit rate: 20457249910918530362019302048298258233257328962072215552.0 | accuracy: 0.82
step_num: 6800 | loss: 0.2504 | profit rate: 193144278303479008170657849267004265992824060010814234427392.0 | accuracy: 0.83
step_num: 7000 | loss: 0.2000 | profit rate: 54281980629674974115957033196411205902238616940231324384362496.0 | accuracy: 0.82
model saved @ step:7028,performance:73501869645212263641234078721993914521384443704875542154051584.000,accuracy:0.82
step_num: 7200 | loss: 0.3249 | profit rate: 5582.0 | accuracy: 0.80
step_num: 7400 | loss: 0.2887 | profit rate: 17874625.1 | accuracy: 0.80
step_num: 7600 | loss: 0.3807 | profit rate: 36164039312.8 | accuracy: 0.82
step_num: 7800 | loss: 0.1804 | profit rate: 6240531379881.1 | accuracy: 0.82
step_num: 8000 | loss: 0.3783 | profit rate: 180059142039567424.0 | accuracy: 0.83
step_num: 8200 | loss: 0.3087 | profit rate: 893306077778603540480.0 | accuracy: 0.84
step_num: 8400 | loss: 0.1913 | profit rate: 795872939716475512422400.0 | accuracy: 0.84
step_num: 8600 | loss: 0.2030 | profit rate: 55931064574432466994408194048.0 | accuracy: 0.84
step_num: 8800 | loss: 0.1917 | profit rate: 12083015496898255493280022134784.0 | accuracy: 0.84
step_num: 9000 | loss: 0.2612 | profit rate: 2176293774051195855283096393875456.0 | accuracy: 0.83
step_num: 9200 | loss: 0.3018 | profit rate: 1762760323035157474406923809979400978432.0 | accuracy: 0.84
step_num: 9400 | loss: 0.2757 | profit rate: 50734579362590856899251674373461942181298176.0 | accuracy: 0.84
step_num: 9600 | loss: 0.1787 | profit rate: 533391565010906706329365023294773993829702828032.0 | accuracy: 0.84
step_num: 9800 | loss: 0.3944 | profit rate: 1406201092296409406912649326599558625842542745223168.0 | accuracy: 0.84
step_num: 10000 | loss: 0.0897 | profit rate: 8365283824209040571517817756282050636912861754773471232.0 | accuracy: 0.84
step_num: 10200 | loss: 0.2136 | profit rate: 64762381305493610031034661285270947966412474842470464618496.0 | accuracy: 0.84
step_num: 10400 | loss: 0.2572 | profit rate: 57127517064431378152132207718060862890403195291069934169227264.0 | accuracy: 0.84
episode:   3/5,耗时:0.77分/2.29分,训练集: | step: 10542 | average_treward: 2639.0 | max_treward: 3169.1062 | average profit rate: 607110274765810526730777011264677793683087016608888530334121984.000
model saved @ step:10542,performance:1747828954652219259461189246833644224196437828141984593538449408.000,accuracy:0.83
step_num: 10600 | loss: 0.2071 | profit rate:   69.3 | accuracy: 0.88
step_num: 10800 | loss: 0.1348 | profit rate: 137786.7 | accuracy: 0.81
step_num: 11000 | loss: 0.2751 | profit rate: 192336468.5 | accuracy: 0.83
step_num: 11200 | loss: 0.3237 | profit rate: 1041824691412.0 | accuracy: 0.83
step_num: 11400 | loss: 0.3014 | profit rate: 185130437867064.8 | accuracy: 0.83
step_num: 11600 | loss: 0.1146 | profit rate: 35630633622548209664.0 | accuracy: 0.84
step_num: 11800 | loss: 0.2684 | profit rate: 41645436224116239630336.0 | accuracy: 0.84
step_num: 12000 | loss: 0.1509 | profit rate: 17590577557421327399256064.0 | accuracy: 0.84
step_num: 12200 | loss: 0.1819 | profit rate: 2162647555386611603560908980224.0 | accuracy: 0.84
step_num: 12400 | loss: 0.3134 | profit rate: 195087785989460829837665866088448.0 | accuracy: 0.84
step_num: 12600 | loss: 0.2785 | profit rate: 593911732016196644085943099925200896.0 | accuracy: 0.83
step_num: 12800 | loss: 0.2433 | profit rate: 152492190071327347175304591396916460257280.0 | accuracy: 0.84
step_num: 13000 | loss: 0.1881 | profit rate: 9243948865721827312576883897824796619692834816.0 | accuracy: 0.84
step_num: 13200 | loss: 0.3216 | profit rate: 66004770330050315919216562707036775002718095802368.0 | accuracy: 0.84
step_num: 13400 | loss: 0.2624 | profit rate: 93621322451767021311841245837190220742236341966733312.0 | accuracy: 0.84
step_num: 13600 | loss: 0.2049 | profit rate: 676113944291656842455687118323322704288007236722425331712.0 | accuracy: 0.84
step_num: 13800 | loss: 0.2414 | profit rate: 7151001038880872410902869393779274344617387053130089712582656.0 | accuracy: 0.84
step_num: 14000 | loss: 0.2351 | profit rate: 3187462008721695359430831085852207076591132595062848350278647808.0 | accuracy: 0.84
model saved @ step:14056,performance:6238391837604622265563807600586273279411350993130136034877636608.000,accuracy:0.84
step_num: 14200 | loss: 0.3039 | profit rate: 2116.4 | accuracy: 0.81
step_num: 14400 | loss: 0.2732 | profit rate: 6834553.5 | accuracy: 0.83
step_num: 14600 | loss: 0.3513 | profit rate: 10238994726.3 | accuracy: 0.83
step_num: 14800 | loss: 0.1641 | profit rate: 7312531839492.9 | accuracy: 0.83
step_num: 15000 | loss: 0.3086 | profit rate: 39084381157455312.0 | accuracy: 0.84
step_num: 15200 | loss: 0.1627 | profit rate: 1077366586434317451264.0 | accuracy: 0.84
step_num: 15400 | loss: 0.1074 | profit rate: 856258104415723534155776.0 | accuracy: 0.84
step_num: 15600 | loss: 0.1964 | profit rate: 39288442843402177340034252800.0 | accuracy: 0.85
step_num: 15800 | loss: 0.1687 | profit rate: 16264451355893146527342595670016.0 | accuracy: 0.85
step_num: 16000 | loss: 0.1501 | profit rate: 3059746389833706504322921877471232.0 | accuracy: 0.84
step_num: 16200 | loss: 0.2434 | profit rate: 1214890582436590052683586274896484761600.0 | accuracy: 0.84
step_num: 16400 | loss: 0.1989 | profit rate: 63351594424944650955837879411955235771383808.0 | accuracy: 0.85
step_num: 16600 | loss: 0.2290 | profit rate: 985571780645387903202923586838962584437531869184.0 | accuracy: 0.85
step_num: 16800 | loss: 0.3050 | profit rate: 3723080824505108842591633992398217281893614546321408.0 | accuracy: 0.85
step_num: 17000 | loss: 0.1904 | profit rate: 16062827992870954759426687563705330304209392677584633856.0 | accuracy: 0.85
step_num: 17200 | loss: 0.3451 | profit rate: 114820944338640111917817907488618799452628017283990955229184.0 | accuracy: 0.85
step_num: 17400 | loss: 0.2351 | profit rate: 251017023204756523425859635962478982323134226774547908689657856.0 | accuracy: 0.85
episode:   5/5,耗时:0.79分/3.85分,训练集: | step: 17570 | average_treward: 2882.1 | max_treward: 3265.8103 | average profit rate: 5243854922477069966824724264322376764746502741172061047296622592.000
model saved @ step:17570,performance:18159551950483297358525267684953062979226432334418834538039869440.000,accuracy:0.85
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 12%|        | 47/397 [00:00<00:00, 465.35it/s] 28%|       | 112/397 [00:00<00:00, 569.39it/s] 44%|     | 175/397 [00:00<00:00, 594.18it/s] 61%|    | 242/397 [00:00<00:00, 621.50it/s] 78%|  | 308/397 [00:00<00:00, 633.01it/s] 95%|| 376/397 [00:00<00:00, 644.54it/s]100%|| 397/397 [00:00<00:00, 619.54it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2907.29
2023-07-24T12:00:00 | net performance [%] = 190.7285
2023-07-24T12:00:00 | number of trades [#] = 50
==================================================
Trial 28 Complete [00h 04m 29s]
net_wealth: 2907.285325693924

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 06m 52s

Search: Running Trial #29

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
5                 |3                 |lags
0.95              |0.5               |gamma
5e-05             |0.001             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.2234 | profit rate:    1.0 | accuracy: 0.38
step_num: 400 | loss: 0.9822 | profit rate:    0.9 | accuracy: 0.39
step_num: 600 | loss: 1.1036 | profit rate:    0.7 | accuracy: 0.35
step_num: 800 | loss: 1.0571 | profit rate:    0.6 | accuracy: 0.33
step_num: 1000 | loss: 0.8546 | profit rate:    0.5 | accuracy: 0.32
step_num: 1200 | loss: 0.6770 | profit rate:    0.4 | accuracy: 0.32
step_num: 1400 | loss: 0.7323 | profit rate:    0.4 | accuracy: 0.32
step_num: 1600 | loss: 0.8610 | profit rate:    0.4 | accuracy: 0.30
step_num: 1800 | loss: 1.1574 | profit rate:    0.3 | accuracy: 0.28
step_num: 2000 | loss: 1.0385 | profit rate:    0.6 | accuracy: 0.28
step_num: 2200 | loss: 0.6989 | profit rate:    0.3 | accuracy: 0.28
step_num: 2400 | loss: 0.7571 | profit rate:    0.3 | accuracy: 0.29
step_num: 2600 | loss: 0.8899 | profit rate:    0.2 | accuracy: 0.30
step_num: 2800 | loss: 0.7127 | profit rate:    0.3 | accuracy: 0.31
step_num: 3000 | loss: 0.5405 | profit rate:    0.3 | accuracy: 0.30
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3158 | average_treward:  -38.6 | max_treward: 0.0000 | average profit rate:  0.324
step_num: 3200 | loss: 0.4531 | profit rate:    0.9 | accuracy: 0.42
step_num: 3400 | loss: 0.4626 | profit rate:    1.0 | accuracy: 0.39
step_num: 3600 | loss: 0.5709 | profit rate:    1.2 | accuracy: 0.42
step_num: 3800 | loss: 0.7685 | profit rate:    2.2 | accuracy: 0.39
step_num: 4000 | loss: 0.4266 | profit rate:    3.6 | accuracy: 0.38
step_num: 4200 | loss: 0.3290 | profit rate:    4.5 | accuracy: 0.38
step_num: 4400 | loss: 0.4532 | profit rate:   16.8 | accuracy: 0.38
step_num: 4600 | loss: 0.2401 | profit rate:   29.0 | accuracy: 0.38
step_num: 4800 | loss: 0.2704 | profit rate:   47.9 | accuracy: 0.37
step_num: 5000 | loss: 0.2669 | profit rate:  137.3 | accuracy: 0.36
step_num: 5200 | loss: 0.5735 | profit rate:  820.5 | accuracy: 0.37
step_num: 5400 | loss: 0.4461 | profit rate: 2885.0 | accuracy: 0.38
step_num: 5600 | loss: 0.4276 | profit rate: 10058.9 | accuracy: 0.39
step_num: 5800 | loss: 0.4717 | profit rate: 32878.6 | accuracy: 0.39
step_num: 6000 | loss: 0.5526 | profit rate: 154759.2 | accuracy: 0.40
step_num: 6200 | loss: 0.3857 | profit rate: 300864.3 | accuracy: 0.39
model saved @ step:6316,performance:453591.136,accuracy:0.39
step_num: 6400 | loss: 0.5070 | profit rate:    1.5 | accuracy: 0.53
step_num: 6600 | loss: 0.4808 | profit rate:    5.6 | accuracy: 0.51
step_num: 6800 | loss: 0.4148 | profit rate:   10.2 | accuracy: 0.51
step_num: 7000 | loss: 0.3336 | profit rate:   35.1 | accuracy: 0.46
step_num: 7200 | loss: 0.4014 | profit rate:  125.9 | accuracy: 0.46
step_num: 7400 | loss: 0.2418 | profit rate:  348.9 | accuracy: 0.45
step_num: 7600 | loss: 0.2416 | profit rate: 1847.6 | accuracy: 0.45
step_num: 7800 | loss: 0.2599 | profit rate: 3785.4 | accuracy: 0.45
step_num: 8000 | loss: 0.1897 | profit rate: 8585.3 | accuracy: 0.43
step_num: 8200 | loss: 0.2711 | profit rate: 38279.8 | accuracy: 0.42
step_num: 8400 | loss: 0.3464 | profit rate: 433712.4 | accuracy: 0.42
step_num: 8600 | loss: 0.4170 | profit rate: 2084563.1 | accuracy: 0.42
step_num: 8800 | loss: 0.3093 | profit rate: 13478800.4 | accuracy: 0.43
step_num: 9000 | loss: 0.3767 | profit rate: 95445033.8 | accuracy: 0.44
step_num: 9200 | loss: 0.2691 | profit rate: 467910507.4 | accuracy: 0.43
step_num: 9400 | loss: 0.1385 | profit rate: 1427628452.8 | accuracy: 0.42
episode:   3/5,耗时:1.36分/2.75分,训练集: | step: 9474 | average_treward:  487.6 | max_treward: 975.4410 | average profit rate: 586592180.661
model saved @ step:9474,performance:1759322950.523,accuracy:0.42
step_num: 9600 | loss: 0.3683 | profit rate:    1.8 | accuracy: 0.50
step_num: 9800 | loss: 0.3971 | profit rate:   10.0 | accuracy: 0.49
step_num: 10000 | loss: 0.3114 | profit rate:   21.5 | accuracy: 0.45
step_num: 10200 | loss: 0.1767 | profit rate:   90.4 | accuracy: 0.41
step_num: 10400 | loss: 0.2450 | profit rate:  309.1 | accuracy: 0.41
step_num: 10600 | loss: 0.3789 | profit rate: 1175.0 | accuracy: 0.39
step_num: 10800 | loss: 0.1641 | profit rate: 3967.1 | accuracy: 0.39
step_num: 11000 | loss: 0.1574 | profit rate: 8647.7 | accuracy: 0.38
step_num: 11200 | loss: 0.3557 | profit rate: 19398.0 | accuracy: 0.35
step_num: 11400 | loss: 0.2470 | profit rate: 105085.1 | accuracy: 0.35
step_num: 11600 | loss: 0.3180 | profit rate: 1118035.2 | accuracy: 0.36
step_num: 11800 | loss: 0.1533 | profit rate: 5775547.7 | accuracy: 0.36
step_num: 12000 | loss: 0.2300 | profit rate: 39638162.0 | accuracy: 0.36
step_num: 12200 | loss: 0.2946 | profit rate: 337553319.0 | accuracy: 0.37
step_num: 12400 | loss: 0.1795 | profit rate: 1402660509.1 | accuracy: 0.37
step_num: 12600 | loss: 0.1608 | profit rate: 3407763244.3 | accuracy: 0.36
model saved @ step:12632,performance:3742329255.400,accuracy:0.36
step_num: 12800 | loss: 0.3566 | profit rate:    3.0 | accuracy: 0.41
step_num: 13000 | loss: 0.4463 | profit rate:   12.1 | accuracy: 0.44
step_num: 13200 | loss: 0.2444 | profit rate:   31.9 | accuracy: 0.41
step_num: 13400 | loss: 0.3309 | profit rate:  153.9 | accuracy: 0.39
step_num: 13600 | loss: 0.3041 | profit rate:  685.6 | accuracy: 0.41
step_num: 13800 | loss: 0.8619 | profit rate: 4218.8 | accuracy: 0.40
step_num: 14000 | loss: 0.1437 | profit rate: 12584.5 | accuracy: 0.40
step_num: 14200 | loss: 0.1893 | profit rate: 27985.3 | accuracy: 0.38
step_num: 14400 | loss: 0.5214 | profit rate: 140310.0 | accuracy: 0.37
step_num: 14600 | loss: 0.3584 | profit rate: 968568.1 | accuracy: 0.37
step_num: 14800 | loss: 0.3716 | profit rate: 12715392.7 | accuracy: 0.38
step_num: 15000 | loss: 0.2102 | profit rate: 107801231.3 | accuracy: 0.39
step_num: 15200 | loss: 0.5428 | profit rate: 1275312563.7 | accuracy: 0.40
step_num: 15400 | loss: 0.4980 | profit rate: 16502491192.5 | accuracy: 0.41
step_num: 15600 | loss: 0.4218 | profit rate: 95444674511.7 | accuracy: 0.41
episode:   5/5,耗时:0.70分/4.17分,训练集: | step: 15790 | average_treward:  761.7 | max_treward: 1274.1427 | average profit rate: 50297664914.063
model saved @ step:15790,performance:245986218772.932,accuracy:0.41
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 12%|        | 50/406 [00:00<00:00, 500.00it/s] 27%|       | 111/406 [00:00<00:00, 560.52it/s] 43%|     | 176/406 [00:00<00:00, 598.49it/s] 59%|    | 238/406 [00:00<00:00, 604.57it/s] 75%|  | 303/406 [00:00<00:00, 618.35it/s] 91%| | 370/406 [00:00<00:00, 631.53it/s]==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
100%|| 406/406 [00:00<00:00, 612.92it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3812.12
2023-07-24T12:00:00 | net performance [%] = 281.2121
2023-07-24T12:00:00 | number of trades [#] = 66
==================================================
Trial 29 Complete [00h 04m 52s]
net_wealth: 3812.120876369187

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 11m 45s

Search: Running Trial #30

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.7               |0.5               |gamma
0.0001            |0.001             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.0718 | profit rate:    0.8 | accuracy: 0.31
step_num: 400 | loss: 0.4777 | profit rate:    1.1 | accuracy: 0.33
step_num: 600 | loss: 0.4538 | profit rate:    0.9 | accuracy: 0.33
step_num: 800 | loss: 0.3888 | profit rate:    1.2 | accuracy: 0.32
step_num: 1000 | loss: 0.4094 | profit rate:    2.3 | accuracy: 0.34
step_num: 1200 | loss: 0.3441 | profit rate:   16.3 | accuracy: 0.37
step_num: 1400 | loss: 0.3407 | profit rate:   50.3 | accuracy: 0.39
step_num: 1600 | loss: 0.2871 | profit rate:  169.3 | accuracy: 0.41
step_num: 1800 | loss: 0.3399 | profit rate: 2073.4 | accuracy: 0.43
step_num: 2000 | loss: 0.3203 | profit rate: 7293.1 | accuracy: 0.45
step_num: 2200 | loss: 0.2951 | profit rate: 50779.7 | accuracy: 0.47
step_num: 2400 | loss: 0.2789 | profit rate: 2429948.8 | accuracy: 0.49
step_num: 2600 | loss: 0.3034 | profit rate: 135279576.1 | accuracy: 0.51
step_num: 2800 | loss: 0.2098 | profit rate: 3572088520.9 | accuracy: 0.53
step_num: 3000 | loss: 0.1939 | profit rate: 86373498645.0 | accuracy: 0.55
step_num: 3200 | loss: 0.1631 | profit rate: 2155871726515.9 | accuracy: 0.56
step_num: 3400 | loss: 0.2193 | profit rate: 52251979551423.3 | accuracy: 0.58
step_num: 3600 | loss: 0.2018 | profit rate: 556981953480808.9 | accuracy: 0.59
episode:   1/5,耗时:1.06分/1.06分,训练集: | step: 3648 | average_treward: 1548.5 | max_treward: 1548.4502 | average profit rate: 779782717216995.500
model saved @ step:3648,performance:779782717216995.500,accuracy:0.59
step_num: 3800 | loss: 0.1526 | profit rate:  265.9 | accuracy: 0.88
step_num: 4000 | loss: 0.1381 | profit rate: 11252.4 | accuracy: 0.87
step_num: 4200 | loss: 0.1443 | profit rate: 180535.6 | accuracy: 0.84
step_num: 4400 | loss: 0.1787 | profit rate: 3571722.9 | accuracy: 0.84
step_num: 4600 | loss: 0.1530 | profit rate: 21692840.3 | accuracy: 0.84
step_num: 4800 | loss: 0.1685 | profit rate: 1450186402.1 | accuracy: 0.85
step_num: 5000 | loss: 0.1810 | profit rate: 23036972860.5 | accuracy: 0.85
step_num: 5200 | loss: 0.1075 | profit rate: 225810496024.1 | accuracy: 0.84
step_num: 5400 | loss: 0.1216 | profit rate: 21405242384593.9 | accuracy: 0.85
step_num: 5600 | loss: 0.1700 | profit rate: 164641166087694.9 | accuracy: 0.85
step_num: 5800 | loss: 0.1073 | profit rate: 2345670756187980.0 | accuracy: 0.85
step_num: 6000 | loss: 0.1119 | profit rate: 361108783031010432.0 | accuracy: 0.85
step_num: 6200 | loss: 0.1154 | profit rate: 41393151208333090816.0 | accuracy: 0.86
step_num: 6400 | loss: 0.1265 | profit rate: 1622495328603076296704.0 | accuracy: 0.86
step_num: 6600 | loss: 0.1054 | profit rate: 47109138004664133877760.0 | accuracy: 0.86
step_num: 6800 | loss: 0.0980 | profit rate: 1280398863903617521287168.0 | accuracy: 0.86
step_num: 7000 | loss: 0.0969 | profit rate: 74925822165986701607960576.0 | accuracy: 0.87
step_num: 7200 | loss: 0.0905 | profit rate: 912400267059736221935730688.0 | accuracy: 0.86
model saved @ step:7296,performance:2727682184297706442270441472.000,accuracy:0.86
step_num: 7400 | loss: 0.1101 | profit rate:   82.9 | accuracy: 0.90
step_num: 7600 | loss: 0.0997 | profit rate: 6225.2 | accuracy: 0.90
step_num: 7800 | loss: 0.1307 | profit rate: 125368.1 | accuracy: 0.88
step_num: 8000 | loss: 0.0959 | profit rate: 1797102.2 | accuracy: 0.88
step_num: 8200 | loss: 0.1107 | profit rate: 15676018.6 | accuracy: 0.87
step_num: 8400 | loss: 0.0939 | profit rate: 448267397.3 | accuracy: 0.88
step_num: 8600 | loss: 0.0769 | profit rate: 15214414260.0 | accuracy: 0.88
step_num: 8800 | loss: 0.0898 | profit rate: 201290353818.8 | accuracy: 0.87
step_num: 9000 | loss: 0.0968 | profit rate: 12862317900160.8 | accuracy: 0.88
step_num: 9200 | loss: 0.1186 | profit rate: 145766234933742.6 | accuracy: 0.87
step_num: 9400 | loss: 0.0779 | profit rate: 1503839992803049.2 | accuracy: 0.87
step_num: 9600 | loss: 0.0882 | profit rate: 170660495057668288.0 | accuracy: 0.88
step_num: 9800 | loss: 0.1008 | profit rate: 19875164014034989056.0 | accuracy: 0.88
step_num: 10000 | loss: 0.0747 | profit rate: 969829762118065979392.0 | accuracy: 0.88
step_num: 10200 | loss: 0.1017 | profit rate: 34562775248760563826688.0 | accuracy: 0.88
step_num: 10400 | loss: 0.0994 | profit rate: 1006098003219747113533440.0 | accuracy: 0.88
step_num: 10600 | loss: 0.0778 | profit rate: 44797390948935190649503744.0 | accuracy: 0.88
step_num: 10800 | loss: 0.0527 | profit rate: 1034933774489504789676687360.0 | accuracy: 0.88
episode:   3/5,耗时:1.18分/3.73分,训练集: | step: 10944 | average_treward: 2704.7 | max_treward: 3362.7281 | average profit rate: 2520799786097897411713171456.000
model saved @ step:10944,performance:4834717173995205689369165824.000,accuracy:0.89
step_num: 11000 | loss: 0.0822 | profit rate:   11.3 | accuracy: 0.95
step_num: 11200 | loss: 0.0763 | profit rate: 2932.9 | accuracy: 0.91
step_num: 11400 | loss: 0.0953 | profit rate: 66374.5 | accuracy: 0.89
step_num: 11600 | loss: 0.0610 | profit rate: 567884.8 | accuracy: 0.89
step_num: 11800 | loss: 0.0753 | profit rate: 15601245.9 | accuracy: 0.89
step_num: 12000 | loss: 0.0874 | profit rate: 201096016.6 | accuracy: 0.89
step_num: 12200 | loss: 0.0624 | profit rate: 12075307918.1 | accuracy: 0.90
step_num: 12400 | loss: 0.0685 | profit rate: 145344886127.0 | accuracy: 0.89
step_num: 12600 | loss: 0.0759 | profit rate: 7737556395744.9 | accuracy: 0.89
step_num: 12800 | loss: 0.0694 | profit rate: 121999061473921.4 | accuracy: 0.89
step_num: 13000 | loss: 0.0561 | profit rate: 970149021549975.9 | accuracy: 0.89
step_num: 13200 | loss: 0.0523 | profit rate: 62543456451677288.0 | accuracy: 0.89
step_num: 13400 | loss: 0.0575 | profit rate: 6219462335655458816.0 | accuracy: 0.89
step_num: 13600 | loss: 0.0797 | profit rate: 590688171090301288448.0 | accuracy: 0.89
step_num: 13800 | loss: 0.0714 | profit rate: 18163145562951912521728.0 | accuracy: 0.89
step_num: 14000 | loss: 0.0510 | profit rate: 636064237514528051429376.0 | accuracy: 0.89
step_num: 14200 | loss: 0.0483 | profit rate: 18264374799787794802671616.0 | accuracy: 0.89
step_num: 14400 | loss: 0.0788 | profit rate: 646235300073630102695444480.0 | accuracy: 0.89
model saved @ step:14592,performance:6176563089335473736849031168.000,accuracy:0.89
step_num: 14600 | loss: 0.0830 | profit rate:    1.2 | accuracy: 0.78
step_num: 14800 | loss: 0.0545 | profit rate: 1014.2 | accuracy: 0.91
step_num: 15000 | loss: 0.0801 | profit rate: 26328.3 | accuracy: 0.89
step_num: 15200 | loss: 0.0600 | profit rate: 366128.2 | accuracy: 0.90
step_num: 15400 | loss: 0.0360 | profit rate: 9168342.0 | accuracy: 0.91
step_num: 15600 | loss: 0.0662 | profit rate: 66616916.7 | accuracy: 0.90
step_num: 15800 | loss: 0.0659 | profit rate: 6284888528.8 | accuracy: 0.90
step_num: 16000 | loss: 0.0785 | profit rate: 78594828817.8 | accuracy: 0.89
step_num: 16200 | loss: 0.0758 | profit rate: 836177009902.8 | accuracy: 0.89
step_num: 16400 | loss: 0.0501 | profit rate: 75210374290171.7 | accuracy: 0.89
step_num: 16600 | loss: 0.0475 | profit rate: 528010718491257.4 | accuracy: 0.89
step_num: 16800 | loss: 0.0607 | profit rate: 10742119222669616.0 | accuracy: 0.89
step_num: 17000 | loss: 0.0521 | profit rate: 1636320018575719680.0 | accuracy: 0.89
step_num: 17200 | loss: 0.0763 | profit rate: 183285927889429364736.0 | accuracy: 0.89
step_num: 17400 | loss: 0.0690 | profit rate: 8276235889422455799808.0 | accuracy: 0.90
step_num: 17600 | loss: 0.0650 | profit rate: 246582310053506174681088.0 | accuracy: 0.90
step_num: 17800 | loss: 0.0660 | profit rate: 8736254455203642552090624.0 | accuracy: 0.90
step_num: 18000 | loss: 0.0412 | profit rate: 359721174296166442547019776.0 | accuracy: 0.90
step_num: 18200 | loss: 0.0601 | profit rate: 5010319574214816145598316544.0 | accuracy: 0.90
episode:   5/5,耗时:1.18分/6.09分,训练集: | step: 18240 | average_treward: 3004.1 | max_treward: 3469.3881 | average profit rate: 4095472583262038810702118912.000
model saved @ step:18240,performance:6738400468681026432254607360.000,accuracy:0.90
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 50/391 [00:00<00:00, 495.10it/s] 29%|       | 113/391 [00:00<00:00, 574.13it/s] 45%|     | 177/391 [00:00<00:00, 601.40it/s] 62%|   | 242/391 [00:00<00:00, 620.51it/s] 79%|  | 308/391 [00:00<00:00, 632.44it/s] 96%|| 375/391 [00:00<00:00, 640.95it/s]100%|| 391/391 [00:00<00:00, 617.14it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 8638.33
2023-07-24T12:00:00 | net performance [%] = 763.8332
2023-07-24T12:00:00 | number of trades [#] = 218
==================================================
Trial 30 Complete [00h 06m 20s]
net_wealth: 8638.331600821131

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 18m 05s

Search: Running Trial #31

Value             |Best Value So Far |Hyperparameter
10                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.5               |0.5               |gamma
0.0001            |0.001             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4291.000000   4301.000000
mean      0.000435    20113.607657  ...   20206.045010  20169.373185
std       0.027833    16040.642334  ...   16079.329741  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7763.510010   7730.930176
50%       0.000642    11571.842969  ...   11760.809570  11751.469727
75%       0.011590    29894.706152  ...   30037.855469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.6946 | profit rate:    1.4 | accuracy: 0.35
step_num: 400 | loss: 0.7142 | profit rate:    0.8 | accuracy: 0.33
step_num: 600 | loss: 0.7758 | profit rate:    2.6 | accuracy: 0.34
step_num: 800 | loss: 0.4940 | profit rate:    2.9 | accuracy: 0.31
step_num: 1000 | loss: 1.0349 | profit rate:  999.2 | accuracy: 0.35
step_num: 1200 | loss: 0.8343 | profit rate: 15019.2 | accuracy: 0.36
step_num: 1400 | loss: 0.6089 | profit rate: 1678183.3 | accuracy: 0.37
step_num: 1600 | loss: 0.3367 | profit rate: 6653830733.6 | accuracy: 0.39
step_num: 1800 | loss: 0.4609 | profit rate: 191436997661.7 | accuracy: 0.41
step_num: 2000 | loss: 0.4966 | profit rate: 310419034255672.2 | accuracy: 0.44
step_num: 2200 | loss: 0.5420 | profit rate: 1745498244150698180608.0 | accuracy: 0.47
step_num: 2400 | loss: 0.5831 | profit rate: 48539271342979663804760064.0 | accuracy: 0.50
step_num: 2600 | loss: 0.3849 | profit rate: 492818272803816563181287899136.0 | accuracy: 0.51
step_num: 2800 | loss: 0.3437 | profit rate: 6659509345399223369656381353230336.0 | accuracy: 0.53
step_num: 3000 | loss: 0.2817 | profit rate: 547176405265270748211941516700293267456.0 | accuracy: 0.55
step_num: 3200 | loss: 0.4466 | profit rate: 35646565695013556686862641502433373283418112.0 | accuracy: 0.56
step_num: 3400 | loss: 0.4101 | profit rate: 27198728242845904457827904352763643305887006720.0 | accuracy: 0.57
episode:   1/5,耗时:0.72分/0.72分,训练集: | step: 3514 | average_treward: 1857.2 | max_treward: 1857.1948 | average profit rate: 1121735266569094899615487634145198346380649693184.000
model saved @ step:3514,performance:1121735266569094899615487634145198346380649693184.000,accuracy:0.58
step_num: 3600 | loss: 0.3998 | profit rate: 1727.7 | accuracy: 0.89
step_num: 3800 | loss: 0.2509 | profit rate: 53034131.6 | accuracy: 0.86
step_num: 4000 | loss: 0.4479 | profit rate: 153857373976.7 | accuracy: 0.88
step_num: 4200 | loss: 0.3036 | profit rate: 58546084056541056.0 | accuracy: 0.87
step_num: 4400 | loss: 0.2983 | profit rate: 606568389949201317888.0 | accuracy: 0.86
step_num: 4600 | loss: 0.1870 | profit rate: 2530030971739386878674075648.0 | accuracy: 0.87
step_num: 4800 | loss: 0.1947 | profit rate: 61623295530006296966291538313216.0 | accuracy: 0.87
step_num: 5000 | loss: 0.5800 | profit rate: 50559471282509445656477791870112497664.0 | accuracy: 0.87
step_num: 5200 | loss: 0.4369 | profit rate: 1407504387870491163064973893676879824551936.0 | accuracy: 0.87
step_num: 5400 | loss: 0.1798 | profit rate: 610687888704470678736891106894084235524571136.0 | accuracy: 0.87
step_num: 5600 | loss: 0.2986 | profit rate: 2775134331574136224016234630119316867404622727217152.0 | accuracy: 0.88
step_num: 5800 | loss: 0.3063 | profit rate: 8775349689405097117433917489423726144552543133393754259456.0 | accuracy: 0.88
step_num: 6000 | loss: 0.1925 | profit rate: 6599273068244501685079251722990995112328253318886074888101036032.0 | accuracy: 0.88
step_num: 6200 | loss: 0.3546 | profit rate: 369865805780932849510249904411598311112738699096149753055851753504768.0 | accuracy: 0.87
step_num: 6400 | loss: 0.1237 | profit rate: 18868883060842456611782862938198727184878873213789359327761253315792338944.0 | accuracy: 0.88
step_num: 6600 | loss: 0.3375 | profit rate: 713409419405277380726038648063026615748245588090552469880973273480087522508800.0 | accuracy: 0.87
step_num: 6800 | loss: 0.2119 | profit rate: 139838767446685900890890442225086657018114097642551367362353841745158765504886734848.0 | accuracy: 0.87
step_num: 7000 | loss: 0.2170 | profit rate: 182953260746947599225023875988841431569655021911224590910964449025639555649067074715648.0 | accuracy: 0.87
model saved @ step:7028,performance:277193135431249433986440993675851393424439459802380537439816104329030967437795493150720.000,accuracy:0.87
step_num: 7200 | loss: 0.1916 | profit rate: 72419.2 | accuracy: 0.83
step_num: 7400 | loss: 0.1280 | profit rate: 15084243757.8 | accuracy: 0.89
step_num: 7600 | loss: 0.1686 | profit rate: 1011461207035956.5 | accuracy: 0.88
step_num: 7800 | loss: 0.2301 | profit rate: 801147551625011968.0 | accuracy: 0.87
step_num: 8000 | loss: 0.2016 | profit rate: 1599751916373938408521728.0 | accuracy: 0.88
step_num: 8200 | loss: 0.1844 | profit rate: 271758723252877314892803080192.0 | accuracy: 0.88
step_num: 8400 | loss: 0.1950 | profit rate: 3091404267093354103718413017808896.0 | accuracy: 0.88
step_num: 8600 | loss: 0.0679 | profit rate: 43410502618375207604552462564740579721216.0 | accuracy: 0.89
step_num: 8800 | loss: 0.1082 | profit rate: 47459344034850967330801159648661072739565568.0 | accuracy: 0.88
step_num: 9000 | loss: 0.0809 | profit rate: 159810617973373096487448282852523335299262054400.0 | accuracy: 0.88
step_num: 9200 | loss: 0.1213 | profit rate: 24634552929581004674000260070191360925779312536778178560.0 | accuracy: 0.89
step_num: 9400 | loss: 0.1381 | profit rate: 16377649124756971104965014207230576871489027963319120283303936.0 | accuracy: 0.88
step_num: 9600 | loss: 0.0557 | profit rate: 2776966670444032001420610749355013807739191219563437245962280501248.0 | accuracy: 0.89
step_num: 9800 | loss: 0.1386 | profit rate: 134493678144533384220583860108125968291516013332301182705123217815633920.0 | accuracy: 0.88
step_num: 10000 | loss: 0.0891 | profit rate: 23271662563962717517781298338472869055860670783917486363570873575432328839168.0 | accuracy: 0.88
step_num: 10200 | loss: 0.2120 | profit rate: 7024151620172347514217108561123915825985381636891743243504605406570613422619099136.0 | accuracy: 0.88
step_num: 10400 | loss: 0.1771 | profit rate: 53429962127850551685966238186819518299490755071153501011780219186248207053036393070592.0 | accuracy: 0.88
episode:   3/5,耗时:1.35分/2.86分,训练集: | step: 10542 | average_treward: 3098.3 | max_treward: 3768.5308 | average profit rate: 2509690065844795409384242724795705374370935491034802933124428516124935141462248655945728.000
model saved @ step:10542,performance:7251877062103136462882462534764202932820085624004806544280238779867219809147787732320256.000,accuracy:0.88
step_num: 10600 | loss: 0.1048 | profit rate:  250.8 | accuracy: 0.95
step_num: 10800 | loss: 0.1395 | profit rate: 6117799.1 | accuracy: 0.86
step_num: 11000 | loss: 0.1074 | profit rate: 178313951464.6 | accuracy: 0.88
step_num: 11200 | loss: 0.1560 | profit rate: 47974123028957160.0 | accuracy: 0.88
step_num: 11400 | loss: 0.0315 | profit rate: 241906439538460557312.0 | accuracy: 0.89
step_num: 11600 | loss: 0.1043 | profit rate: 2384363452362007393616265216.0 | accuracy: 0.89
step_num: 11800 | loss: 0.0469 | profit rate: 42050975940309122394600039776256.0 | accuracy: 0.89
step_num: 12000 | loss: 0.1616 | profit rate: 147902829776222123581389247478759424.0 | accuracy: 0.89
step_num: 12200 | loss: 0.0760 | profit rate: 2276184214755806505937053007882771308216320.0 | accuracy: 0.90
step_num: 12400 | loss: 0.1137 | profit rate: 982715871819840109787588353791523878556663808.0 | accuracy: 0.89
step_num: 12600 | loss: 0.0586 | profit rate: 183954341898171537796969067651530842019327658426368.0 | accuracy: 0.89
step_num: 12800 | loss: 0.1398 | profit rate: 3335578269724703179180234855088866758662293846139636547584.0 | accuracy: 0.89
step_num: 13000 | loss: 0.1237 | profit rate: 4766980742341329059019694622650606694959397397246502228881047552.0 | accuracy: 0.89
step_num: 13200 | loss: 0.2107 | profit rate: 1547458734137156392689129837476287161904693461273407727448057744195584.0 | accuracy: 0.89
step_num: 13400 | loss: 0.0584 | profit rate: 36522778131919869419892255390254674096453362246316059813993512182476701696.0 | accuracy: 0.89
step_num: 13600 | loss: 0.1356 | profit rate: 4694474073266694200082962599632561709936793085437996965402594752485924926390272.0 | accuracy: 0.89
step_num: 13800 | loss: 0.0350 | profit rate: 1031425196645759541308628649745511558011522847754614871958200459573447325235286114304.0 | accuracy: 0.89
step_num: 14000 | loss: 0.1242 | profit rate: 5200788488575393819371793551788792665268392079721374188818800588827638390810633528410112.0 | accuracy: 0.89
model saved @ step:14056,performance:13677221775700360966884462074413731298936922027039623674551431197197598241383172544659456.000,accuracy:0.89
step_num: 14200 | loss: 0.3255 | profit rate: 24638.3 | accuracy: 0.86
step_num: 14400 | loss: 0.0385 | profit rate: 3717167839.0 | accuracy: 0.89
step_num: 14600 | loss: 0.0872 | profit rate: 132669371168284.0 | accuracy: 0.90
step_num: 14800 | loss: 0.0426 | profit rate: 1214252712089739008.0 | accuracy: 0.90
step_num: 15000 | loss: 0.1170 | profit rate: 313266206497565464068096.0 | accuracy: 0.90
step_num: 15200 | loss: 0.2200 | profit rate: 308170387325416157149189373952.0 | accuracy: 0.90
step_num: 15400 | loss: 0.1878 | profit rate: 1955280731077621123629773569916928.0 | accuracy: 0.90
step_num: 15600 | loss: 0.0716 | profit rate: 10434095444554295787715803437543957987328.0 | accuracy: 0.90
step_num: 15800 | loss: 0.1437 | profit rate: 30991869212280256691526340066933005212450816.0 | accuracy: 0.90
step_num: 16000 | loss: 0.0698 | profit rate: 68218922358549905330007891838184445598865817600.0 | accuracy: 0.89
step_num: 16200 | loss: 0.0533 | profit rate: 6922704541103547230569086353802743607598345995147018240.0 | accuracy: 0.90
step_num: 16400 | loss: 0.1727 | profit rate: 29875301092227301696562930550912598571838791479661685611954176.0 | accuracy: 0.90
step_num: 16600 | loss: 0.3111 | profit rate: 3860999275358057491360779307223642798154501450658534724404496039936.0 | accuracy: 0.90
step_num: 16800 | loss: 0.1855 | profit rate: 344229794508641373922679380460821029319141750840787625715937262805450752.0 | accuracy: 0.90
step_num: 17000 | loss: 0.1569 | profit rate: 44782749793169962419249278205899660967414164189632897775927831218390046867456.0 | accuracy: 0.90
step_num: 17200 | loss: 0.1913 | profit rate: 8048805180217704181669702188492199105937946434940754861995836598164798043037106176.0 | accuracy: 0.90
step_num: 17400 | loss: 0.0377 | profit rate: 239113470270591526685424559173834534464347362348911862192007676805809142895397966970880.0 | accuracy: 0.90
episode:   5/5,耗时:0.78分/5.03分,训练集: | step: 17570 | average_treward: 3397.5 | max_treward: 3859.9086 | average profit rate: 15799285871065376437203527478477095917824373062911631470331222668148655620695084184371200.000
model saved @ step:17570,performance:57790137382092133665845148559796384979599011257225238007118473938456655846500851439894528.000,accuracy:0.89
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 12%|        | 49/397 [00:00<00:00, 485.17it/s] 27%|       | 106/397 [00:00<00:00, 528.67it/s] 43%|     | 169/397 [00:00<00:00, 574.53it/s] 59%|    | 235/397 [00:00<00:00, 605.72it/s] 76%|  | 301/397 [00:00<00:00, 622.94it/s] 92%|| 367/397 [00:00<00:00, 635.47it/s]100%|| 397/397 [00:00<00:00, 608.89it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2494.53
2023-07-24T12:00:00 | net performance [%] = 149.4535
2023-07-24T12:00:00 | number of trades [#] = 42
==================================================
Trial 31 Complete [00h 05m 39s]
net_wealth: 2494.5346362070322

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 23m 45s

Search: Running Trial #32

Value             |Best Value So Far |Hyperparameter
9                 |1                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
20                |3                 |lags
0.5               |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4306.000000   4315.000000
mean      0.000441    20062.255222  ...   20151.395964  20118.633889
std       0.027818    16039.874230  ...   16077.894500  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7715.610107   7690.540039
50%       0.000642    11554.824463  ...   11746.555176  11715.610352
75%       0.011655    29873.081836  ...   29983.155273  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.2559 | profit rate:    1.0 | accuracy: 0.35
step_num: 600 | loss: 0.2068 | profit rate:   18.6 | accuracy: 0.38
step_num: 800 | loss: 0.1583 | profit rate:  387.5 | accuracy: 0.43
step_num: 1000 | loss: 0.1650 | profit rate: 471047.5 | accuracy: 0.47
step_num: 1200 | loss: 0.1506 | profit rate: 246803349.1 | accuracy: 0.51
step_num: 1400 | loss: 0.1517 | profit rate: 129598891224.5 | accuracy: 0.53
step_num: 1600 | loss: 0.1163 | profit rate: 21379046561617828.0 | accuracy: 0.56
step_num: 1800 | loss: 0.1325 | profit rate: 2565906117128294400.0 | accuracy: 0.58
step_num: 2000 | loss: 0.1461 | profit rate: 5147945953045566717952.0 | accuracy: 0.60
step_num: 2200 | loss: 0.1429 | profit rate: 30443108468352276650482728960.0 | accuracy: 0.63
step_num: 2400 | loss: 0.1082 | profit rate: 7824573728372876761453989908709376.0 | accuracy: 0.65
step_num: 2600 | loss: 0.1499 | profit rate: 325295454962359068077298601001725460480.0 | accuracy: 0.66
step_num: 2800 | loss: 0.1201 | profit rate: 3813910876393788059265062650024915762151424.0 | accuracy: 0.67
step_num: 3000 | loss: 0.1151 | profit rate: 241788131764198425414003234229758898616924110848.0 | accuracy: 0.69
step_num: 3200 | loss: 0.0852 | profit rate: 51718301542607594590440641775571503620987113070133248.0 | accuracy: 0.70
step_num: 3400 | loss: 0.1127 | profit rate: 212960117343329653786106032128039990254568166970554843136.0 | accuracy: 0.71
episode:   1/5,耗时:1.89分/1.89分,训练集: | step: 3522 | average_treward: 2643.7 | max_treward: 2643.6618 | average profit rate: 14658318806885264715798125477446611963595032856838239420416.000
model saved @ step:3522,performance:14658318806885264715798125477446611963595032856838239420416.000,accuracy:0.72
step_num: 3600 | loss: 0.0958 | profit rate:  702.7 | accuracy: 0.90
step_num: 3800 | loss: 0.1328 | profit rate: 18461788.3 | accuracy: 0.86
step_num: 4000 | loss: 0.1325 | profit rate: 100264134616.5 | accuracy: 0.87
step_num: 4200 | loss: 0.0898 | profit rate: 17604944839235554.0 | accuracy: 0.88
step_num: 4400 | loss: 0.0879 | profit rate: 147409311016990162944.0 | accuracy: 0.89
step_num: 4600 | loss: 0.0765 | profit rate: 333489942413759477140422656.0 | accuracy: 0.89
step_num: 4800 | loss: 0.0863 | profit rate: 7273075054193901369567276433408.0 | accuracy: 0.89
step_num: 5000 | loss: 0.0945 | profit rate: 19990026292784438453354796672876544.0 | accuracy: 0.90
step_num: 5200 | loss: 0.0974 | profit rate: 82906674547137807606007789349877275688960.0 | accuracy: 0.90
step_num: 5400 | loss: 0.0707 | profit rate: 46143642882398972149325798512275616425836544.0 | accuracy: 0.90
step_num: 5600 | loss: 0.0830 | profit rate: 4466188007332503147929777383968166632063808569344.0 | accuracy: 0.90
step_num: 5800 | loss: 0.0773 | profit rate: 23567713016373213869759659064059706795981960573454647296.0 | accuracy: 0.90
step_num: 6000 | loss: 0.0590 | profit rate: 12878274184149409515767445751828556046127185528578922667573248.0 | accuracy: 0.90
step_num: 6200 | loss: 0.0999 | profit rate: 1641927477290463190572171513566800591642462418557575547638702407680.0 | accuracy: 0.90
step_num: 6400 | loss: 0.1104 | profit rate: 53074215842082565884011878120653751134329121943202964827566694039814144.0 | accuracy: 0.90
step_num: 6600 | loss: 0.0949 | profit rate: 3205009371405531624005864844611265876436611220010072719839037996745864773632.0 | accuracy: 0.90
step_num: 6800 | loss: 0.0800 | profit rate: 620428180924540752169256604520221351090331268408762435400450560408594962955894784.0 | accuracy: 0.90
step_num: 7000 | loss: 0.0975 | profit rate: 1743942587958732185739749113785615337469690727754137970201033120696954125181526212608.0 | accuracy: 0.90
model saved @ step:7044,performance:3450523632329228037962824329293216534186501172543501000255542709513401068530205458432.000,accuracy:0.90
step_num: 7200 | loss: 0.1536 | profit rate: 70492.3 | accuracy: 0.89
step_num: 7400 | loss: 0.1410 | profit rate: 3557536348.0 | accuracy: 0.89
step_num: 7600 | loss: 0.1218 | profit rate: 51065022329911.0 | accuracy: 0.89
step_num: 7800 | loss: 0.0837 | profit rate: 329708375030865408.0 | accuracy: 0.89
step_num: 8000 | loss: 0.0622 | profit rate: 26414657092731101249536.0 | accuracy: 0.90
step_num: 8200 | loss: 0.0843 | profit rate: 42551037186611106825893838848.0 | accuracy: 0.91
step_num: 8400 | loss: 0.0749 | profit rate: 145439266656551279750112941703168.0 | accuracy: 0.91
step_num: 8600 | loss: 0.0944 | profit rate: 336564706285501719773323692806280052736.0 | accuracy: 0.91
step_num: 8800 | loss: 0.0883 | profit rate: 584456102582664015007527520643845403443200.0 | accuracy: 0.91
step_num: 9000 | loss: 0.0973 | profit rate: 994899464266961421036826923813694682838335488.0 | accuracy: 0.90
step_num: 9200 | loss: 0.0894 | profit rate: 29098136103297511533836268250211486128203934661083136.0 | accuracy: 0.91
step_num: 9400 | loss: 0.0552 | profit rate: 71936808745429483851706456161543628757705455986453285699584.0 | accuracy: 0.91
step_num: 9600 | loss: 0.0973 | profit rate: 4043113695928678334636947154205113433123017720026873010872909824.0 | accuracy: 0.91
step_num: 9800 | loss: 0.1411 | profit rate: 190900800638588677465881229872498140140182532575372204807882931175424.0 | accuracy: 0.90
step_num: 10000 | loss: 0.1002 | profit rate: 20054979505627906799855726368238074344864899591426645523138878793402286080.0 | accuracy: 0.90
step_num: 10200 | loss: 0.0842 | profit rate: 2666071394603360593338184475413498750437085789121467568124324532339642581647360.0 | accuracy: 0.90
step_num: 10400 | loss: 0.0846 | profit rate: 61789028478427196725191972112702498076796704353362571303933840889851928040894889984.0 | accuracy: 0.91
episode:   3/5,耗时:2.35分/6.83分,训练集: | step: 10566 | average_treward: 3473.8 | max_treward: 3928.5931 | average profit rate: 6117430880598461637658207804588403532440778295409210344460674640447287807637123497984.000
model saved @ step:10566,performance:14901769009466155149575212386831047204446868144427766920349238169231823563750109085696.000,accuracy:0.91
step_num: 10600 | loss: 0.0767 | profit rate:   39.6 | accuracy: 0.91
step_num: 10800 | loss: 0.0891 | profit rate: 3520786.3 | accuracy: 0.86
step_num: 11000 | loss: 0.1094 | profit rate: 71041892415.3 | accuracy: 0.88
step_num: 11200 | loss: 0.1022 | profit rate: 16413345349583316.0 | accuracy: 0.90
step_num: 11400 | loss: 0.0905 | profit rate: 12819484579812014080.0 | accuracy: 0.90
step_num: 11600 | loss: 0.0772 | profit rate: 32658842300488909032783872.0 | accuracy: 0.91
step_num: 11800 | loss: 0.0847 | profit rate: 1515185951069041156212941389824.0 | accuracy: 0.90
step_num: 12000 | loss: 0.0718 | profit rate: 7460373908260402044450123919917056.0 | accuracy: 0.91
step_num: 12200 | loss: 0.0664 | profit rate: 84987368517770686331291476196112524640256.0 | accuracy: 0.91
step_num: 12400 | loss: 0.0820 | profit rate: 22470909779937752743358335186168177517133824.0 | accuracy: 0.91
step_num: 12600 | loss: 0.0920 | profit rate: 185135471368736057755383708991506371021992099840.0 | accuracy: 0.91
step_num: 12800 | loss: 0.0745 | profit rate: 10543721017498273402848557799396111520714356200963047424.0 | accuracy: 0.91
step_num: 13000 | loss: 0.0716 | profit rate: 9819778196700909542299267998410776430826679682315085489897472.0 | accuracy: 0.91
step_num: 13200 | loss: 0.1282 | profit rate: 430517727108147742632500249747270141878744646749308473272677957632.0 | accuracy: 0.91
step_num: 13400 | loss: 0.1134 | profit rate: 3206676653070729383435465672802634067315280624378363400809122560475136.0 | accuracy: 0.90
step_num: 13600 | loss: 0.0779 | profit rate: 310526352106973191194591112754770705970866422192161357418797754507551834112.0 | accuracy: 0.90
step_num: 13800 | loss: 0.1057 | profit rate: 159303399291953787935377814790677092934681588212090905024688657401866755529244672.0 | accuracy: 0.90
step_num: 14000 | loss: 0.0753 | profit rate: 979224067334475123387539156702885446454552773125725236219777929675163982622839799808.0 | accuracy: 0.90
step_num: 14200 | loss: 0.1140 | profit rate: 9564.4 | accuracy: 0.88
step_num: 14400 | loss: 0.1238 | profit rate: 406880048.5 | accuracy: 0.88
step_num: 14600 | loss: 0.1084 | profit rate: 480687265022.4 | accuracy: 0.89
step_num: 14800 | loss: 0.0830 | profit rate: 156783882266764736.0 | accuracy: 0.90
step_num: 15000 | loss: 0.0798 | profit rate: 1506546792543552798720.0 | accuracy: 0.90
step_num: 15200 | loss: 0.0813 | profit rate: 2990587013089567027220185088.0 | accuracy: 0.91
step_num: 15400 | loss: 0.0569 | profit rate: 44739396530214827939408566550528.0 | accuracy: 0.91
step_num: 15600 | loss: 0.0781 | profit rate: 17514180232726904811075591633708777472.0 | accuracy: 0.91
step_num: 15800 | loss: 0.0910 | profit rate: 163904395336587813237821245964559916728320.0 | accuracy: 0.91
step_num: 16000 | loss: 0.1041 | profit rate: 128960193493996130800329194945881644476661760.0 | accuracy: 0.91
step_num: 16200 | loss: 0.0965 | profit rate: 173621283422633619016602583545829795474907739455488.0 | accuracy: 0.91
step_num: 16400 | loss: 0.0799 | profit rate: 388871224055482034644118438367922828570350421181747691520.0 | accuracy: 0.91
step_num: 16600 | loss: 0.0819 | profit rate: 351740034275335193930586777373395325269274302502688679459291136.0 | accuracy: 0.91
step_num: 16800 | loss: 0.1062 | profit rate: 4537974065246744652238984173146672418343155426870003740920153899008.0 | accuracy: 0.91
step_num: 17000 | loss: 0.0823 | profit rate: 379932581028719608915449751059326269783249924571118368975662023968817152.0 | accuracy: 0.91
step_num: 17200 | loss: 0.0636 | profit rate: 7157470228534255592277762112805180371967604559274391996581646008453294981120.0 | accuracy: 0.91
step_num: 17400 | loss: 0.0704 | profit rate: 2660583706546162694163213430443613352065982010107584151444548886008705288981446656.0 | accuracy: 0.91
step_num: 17600 | loss: 0.0961 | profit rate: 2392354435807085566968562679629172692190969568948048108817387492971597526014011375616.0 | accuracy: 0.91
episode:   5/5,耗时:2.10分/11.04分,训练集: | step: 17610 | average_treward: 3645.8 | max_treward: 3928.5931 | average profit rate: 5298304106204848940327708587135661539853520237567462403676717085175412463500708020224.000
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 50/391 [00:00<00:00, 497.71it/s] 29%|       | 112/391 [00:00<00:00, 569.51it/s] 45%|     | 174/391 [00:00<00:00, 592.54it/s] 61%|   | 240/391 [00:00<00:00, 616.72it/s] 78%|  | 305/391 [00:00<00:00, 626.60it/s] 95%|| 371/391 [00:00<00:00, 635.76it/s]==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
100%|| 391/391 [00:00<00:00, 614.40it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2801.67
2023-07-24T12:00:00 | net performance [%] = 180.1671
2023-07-24T12:00:00 | number of trades [#] = 38
==================================================
Trial 32 Complete [00h 11m 21s]
net_wealth: 2801.671147212539

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 35m 06s

Search: Running Trial #33

Value             |Best Value So Far |Hyperparameter
3                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
5                 |3                 |lags
0.7               |0.5               |gamma
1e-05             |0.001             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4298.000000   4301.000000
mean      0.000435    20113.607657  ...   20180.392273  20169.373185
std       0.027833    16040.642334  ...   16078.781641  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7741.750122   7730.930176
50%       0.000642    11571.842969  ...   11754.949707  11751.469727
75%       0.011590    29894.706152  ...   30015.383301  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.7524 | profit rate:    0.9 | accuracy: 0.33
step_num: 800 | loss: 0.6026 | profit rate:    1.0 | accuracy: 0.33
step_num: 1000 | loss: 0.5876 | profit rate:    4.1 | accuracy: 0.33
step_num: 1200 | loss: 0.5131 | profit rate:   23.3 | accuracy: 0.33
step_num: 1400 | loss: 0.4498 | profit rate:  131.1 | accuracy: 0.36
step_num: 1600 | loss: 0.4258 | profit rate: 4637.5 | accuracy: 0.38
step_num: 1800 | loss: 0.3522 | profit rate: 23713.6 | accuracy: 0.38
step_num: 2000 | loss: 0.3238 | profit rate: 332262.1 | accuracy: 0.39
step_num: 2200 | loss: 0.3249 | profit rate: 77608784.3 | accuracy: 0.41
step_num: 2400 | loss: 0.2986 | profit rate: 38139687566.3 | accuracy: 0.43
step_num: 2600 | loss: 0.2884 | profit rate: 15123031298915.5 | accuracy: 0.46
step_num: 2800 | loss: 0.3164 | profit rate: 1794043855473973.0 | accuracy: 0.48
step_num: 3000 | loss: 0.3142 | profit rate: 432816957695502976.0 | accuracy: 0.50
step_num: 3200 | loss: 0.2794 | profit rate: 152516118771883376640.0 | accuracy: 0.53
step_num: 3400 | loss: 0.2675 | profit rate: 7230814480765631332352.0 | accuracy: 0.54
episode:   1/5,耗时:2.88分/2.88分,训练集: | step: 3523 | average_treward: 1425.2 | max_treward: 1425.2466 | average profit rate: 49157289568549524733952.000
model saved @ step:3523,performance:49157289568549524733952.000,accuracy:0.55
step_num: 3600 | loss: 0.2819 | profit rate:   45.4 | accuracy: 0.88
step_num: 3800 | loss: 0.2404 | profit rate: 7979.8 | accuracy: 0.83
step_num: 4000 | loss: 0.2319 | profit rate: 538112.6 | accuracy: 0.83
step_num: 4200 | loss: 0.2499 | profit rate: 136015270.6 | accuracy: 0.81
step_num: 4400 | loss: 0.2404 | profit rate: 10144742858.6 | accuracy: 0.82
step_num: 4600 | loss: 0.2464 | profit rate: 20743418577103.8 | accuracy: 0.82
step_num: 4800 | loss: 0.2252 | profit rate: 3192609310583855.0 | accuracy: 0.82
step_num: 5000 | loss: 0.2156 | profit rate: 795488096707318528.0 | accuracy: 0.82
step_num: 5200 | loss: 0.1907 | profit rate: 351567294967107747840.0 | accuracy: 0.82
step_num: 5400 | loss: 0.2024 | profit rate: 7092814936953208176640.0 | accuracy: 0.82
step_num: 5600 | loss: 0.2196 | profit rate: 4243015421984239551250432.0 | accuracy: 0.82
step_num: 5800 | loss: 0.1930 | profit rate: 12311258359379350325393620992.0 | accuracy: 0.83
step_num: 6000 | loss: 0.1913 | profit rate: 64259973715006235670188367282176.0 | accuracy: 0.83
step_num: 6200 | loss: 0.1872 | profit rate: 27494231608061253399387584235307008.0 | accuracy: 0.83
step_num: 6400 | loss: 0.2005 | profit rate: 9677787447873484395376910232111284224.0 | accuracy: 0.84
step_num: 6600 | loss: 0.1859 | profit rate: 3960431343279893463869134652576010076160.0 | accuracy: 0.84
step_num: 6800 | loss: 0.1765 | profit rate: 1794142046940658927570920391381022758928384.0 | accuracy: 0.84
step_num: 7000 | loss: 0.1861 | profit rate: 139583284658460292822261811329890623275663360.0 | accuracy: 0.84
model saved @ step:7046,performance:234558619497850544425062329176806289450205184.000,accuracy:0.84
step_num: 7200 | loss: 0.1723 | profit rate:  343.4 | accuracy: 0.86
step_num: 7400 | loss: 0.1627 | profit rate: 105011.5 | accuracy: 0.88
step_num: 7600 | loss: 0.1671 | profit rate: 20066417.3 | accuracy: 0.87
step_num: 7800 | loss: 0.1718 | profit rate: 1226173948.6 | accuracy: 0.86
step_num: 8000 | loss: 0.1688 | profit rate: 431427817817.8 | accuracy: 0.87
step_num: 8200 | loss: 0.1760 | profit rate: 512417567391930.2 | accuracy: 0.87
step_num: 8400 | loss: 0.1555 | profit rate: 70220704928843912.0 | accuracy: 0.87
step_num: 8600 | loss: 0.1540 | profit rate: 91455409776534405120.0 | accuracy: 0.86
step_num: 8800 | loss: 0.1467 | profit rate: 8076828588124275736576.0 | accuracy: 0.86
step_num: 9000 | loss: 0.1514 | profit rate: 322116263561074420219904.0 | accuracy: 0.86
step_num: 9200 | loss: 0.1847 | profit rate: 2047188754902308114705416192.0 | accuracy: 0.87
step_num: 9400 | loss: 0.1434 | profit rate: 7866054989022883951900826271744.0 | accuracy: 0.87
step_num: 9600 | loss: 0.1265 | profit rate: 15824435949093105285762481146298368.0 | accuracy: 0.88
step_num: 9800 | loss: 0.1359 | profit rate: 9654288482956307206454875035424260096.0 | accuracy: 0.88
step_num: 10000 | loss: 0.1240 | profit rate: 3673484609572978419484463439591816298496.0 | accuracy: 0.88
step_num: 10200 | loss: 0.1198 | profit rate: 2479890436767838816099379200083300823597056.0 | accuracy: 0.88
step_num: 10400 | loss: 0.1336 | profit rate: 425472811166644198637853018914396979903594496.0 | accuracy: 0.88
episode:   3/5,耗时:3.40分/9.67分,训练集: | step: 10569 | average_treward: 2610.1 | max_treward: 3338.1045 | average profit rate: 3100318543278477593459347999599280354635022336.000
model saved @ step:10569,performance:9066397010337581919040331612563684400279060480.000,accuracy:0.88
step_num: 10600 | loss: 0.1433 | profit rate:    6.0 | accuracy: 0.88
step_num: 10800 | loss: 0.1454 | profit rate: 3354.4 | accuracy: 0.87
step_num: 11000 | loss: 0.1139 | profit rate: 501292.1 | accuracy: 0.90
step_num: 11200 | loss: 0.1403 | profit rate: 247770663.0 | accuracy: 0.89
step_num: 11400 | loss: 0.1459 | profit rate: 6252693342.6 | accuracy: 0.88
step_num: 11600 | loss: 0.1387 | profit rate: 25214004056190.7 | accuracy: 0.89
step_num: 11800 | loss: 0.1203 | profit rate: 5436335540222527.0 | accuracy: 0.89
step_num: 12000 | loss: 0.1164 | profit rate: 549822068960909888.0 | accuracy: 0.88
step_num: 12200 | loss: 0.1177 | profit rate: 1729101347690216161280.0 | accuracy: 0.88
step_num: 12400 | loss: 0.1371 | profit rate: 46116122400240928030720.0 | accuracy: 0.88
step_num: 12600 | loss: 0.1244 | profit rate: 4698109766861116988719104.0 | accuracy: 0.88
step_num: 12800 | loss: 0.1207 | profit rate: 75817247317118568486976618496.0 | accuracy: 0.89
step_num: 13000 | loss: 0.1377 | profit rate: 307340396493736001817548997787648.0 | accuracy: 0.89
step_num: 13200 | loss: 0.1256 | profit rate: 220007222422205328325384892349153280.0 | accuracy: 0.89
step_num: 13400 | loss: 0.1196 | profit rate: 65865864526388384179241659278322302976.0 | accuracy: 0.89
step_num: 13600 | loss: 0.1078 | profit rate: 33538243045617291897080968649773397573632.0 | accuracy: 0.89
step_num: 13800 | loss: 0.0980 | profit rate: 37462444548892153468566902634722043868741632.0 | accuracy: 0.90
step_num: 14000 | loss: 0.1142 | profit rate: 4263595193934739519945806205653721491454296064.0 | accuracy: 0.90
model saved @ step:14092,performance:13835982668590496940356586909258169072253665280.000,accuracy:0.90
step_num: 14200 | loss: 0.1329 | profit rate:  110.4 | accuracy: 0.86
step_num: 14400 | loss: 0.1026 | profit rate: 33422.0 | accuracy: 0.89
step_num: 14600 | loss: 0.1186 | profit rate: 1534575.9 | accuracy: 0.89
step_num: 14800 | loss: 0.1243 | profit rate: 724358842.7 | accuracy: 0.89
step_num: 15000 | loss: 0.0981 | profit rate: 91738782493.6 | accuracy: 0.89
step_num: 15200 | loss: 0.1154 | profit rate: 216761986313651.5 | accuracy: 0.90
step_num: 15400 | loss: 0.1075 | profit rate: 38105785612048696.0 | accuracy: 0.90
step_num: 15600 | loss: 0.1081 | profit rate: 50612338029775732736.0 | accuracy: 0.90
step_num: 15800 | loss: 0.0886 | profit rate: 8051361962597693784064.0 | accuracy: 0.90
step_num: 16000 | loss: 0.0989 | profit rate: 219762407572087125311488.0 | accuracy: 0.89
step_num: 16200 | loss: 0.1013 | profit rate: 561284248722699393897070592.0 | accuracy: 0.90
step_num: 16400 | loss: 0.1177 | profit rate: 1442653794691815098928664150016.0 | accuracy: 0.90
step_num: 16600 | loss: 0.1062 | profit rate: 9933832128891065074104733974659072.0 | accuracy: 0.90
step_num: 16800 | loss: 0.1046 | profit rate: 3954773692343011905413745777104125952.0 | accuracy: 0.90
step_num: 17000 | loss: 0.1022 | profit rate: 1881392939620021143680353937376482951168.0 | accuracy: 0.90
step_num: 17200 | loss: 0.0945 | profit rate: 809645176646295847282803628428405659140096.0 | accuracy: 0.91
step_num: 17400 | loss: 0.0991 | profit rate: 620951451872269419345449316942037781326069760.0 | accuracy: 0.91
step_num: 17600 | loss: 0.0872 | profit rate: 33103316557565504203173156968620807533554040832.0 | accuracy: 0.91
episode:   5/5,耗时:4.36分/17.45分,训练集: | step: 17615 | average_treward: 2962.9 | max_treward: 3535.9232 | average profit rate: 11718753217580500068269995580439584524046696448.000
model saved @ step:17615,performance:35456827789476567451488846423568408742316736512.000,accuracy:0.91
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 13%|        | 54/406 [00:00<00:00, 540.00it/s] 28%|       | 114/406 [00:00<00:00, 568.60it/s] 44%|     | 180/406 [00:00<00:00, 608.43it/s] 61%|    | 247/406 [00:00<00:00, 630.13it/s] 77%|  | 313/406 [00:00<00:00, 640.84it/s] 94%|| 380/406 [00:00<00:00, 648.52it/s]==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
100%|| 406/406 [00:00<00:00, 628.86it/s]
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 4071.50
2023-07-24T12:00:00 | net performance [%] = 307.1498
2023-07-24T12:00:00 | number of trades [#] = 96
==================================================
Trial 33 Complete [00h 18m 27s]
net_wealth: 4071.4983036685726

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 04h 53m 33s

Search: Running Trial #34

Value             |Best Value So Far |Hyperparameter
6                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
8                 |3                 |lags
0.95              |0.5               |gamma
0.0005            |0.001             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4295.000000   4301.000000
mean      0.000435    20113.607657  ...   20191.527960  20169.373185
std       0.027833    16040.642334  ...   16078.872271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7755.915039   7730.930176
50%       0.000642    11571.842969  ...   11757.219727  11751.469727
75%       0.011590    29894.706152  ...   30018.430664  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.7184 | profit rate:    2.2 | accuracy: 0.33
step_num: 800 | loss: 0.5940 | profit rate:   10.9 | accuracy: 0.36
step_num: 1000 | loss: 0.5255 | profit rate:  934.2 | accuracy: 0.38
step_num: 1200 | loss: 0.4680 | profit rate: 390241.7 | accuracy: 0.43
step_num: 1400 | loss: 0.3499 | profit rate: 35310987.2 | accuracy: 0.47
step_num: 1600 | loss: 0.3024 | profit rate: 871434797171.6 | accuracy: 0.50
step_num: 1800 | loss: 0.2676 | profit rate: 39411009407142.4 | accuracy: 0.52
step_num: 2000 | loss: 0.2814 | profit rate: 13570524079173128.0 | accuracy: 0.55
step_num: 2200 | loss: 0.2849 | profit rate: 819567090660659691520.0 | accuracy: 0.57
step_num: 2400 | loss: 0.2248 | profit rate: 14016213700443126590603264.0 | accuracy: 0.59
step_num: 2600 | loss: 0.2024 | profit rate: 82284416739708009317484462080.0 | accuracy: 0.61
step_num: 2800 | loss: 0.2660 | profit rate: 122841683629330603796299408998400.0 | accuracy: 0.62
step_num: 3000 | loss: 0.2570 | profit rate: 531940106883965548338189788359163904.0 | accuracy: 0.64
step_num: 3200 | loss: 0.2689 | profit rate: 7795234021465906715461325217596566405120.0 | accuracy: 0.65
step_num: 3400 | loss: 0.2002 | profit rate: 4101121490968476903185127236086560330874880.0 | accuracy: 0.67
episode:   1/5,耗时:2.95分/2.95分,训练集: | step: 3520 | average_treward: 2296.1 | max_treward: 2296.1433 | average profit rate: 91843643062186631629609980365716541180739584.000
model saved @ step:3520,performance:91843643062186631629609980365716541180739584.000,accuracy:0.67
step_num: 3600 | loss: 0.2284 | profit rate:  206.7 | accuracy: 0.84
step_num: 3800 | loss: 0.2650 | profit rate: 782195.8 | accuracy: 0.86
step_num: 4000 | loss: 0.2390 | profit rate: 324869640.2 | accuracy: 0.85
step_num: 4200 | loss: 0.2507 | profit rate: 1584232949278.9 | accuracy: 0.85
step_num: 4400 | loss: 0.2484 | profit rate: 2016373457743165.0 | accuracy: 0.86
step_num: 4600 | loss: 0.2328 | profit rate: 146325101523450068992.0 | accuracy: 0.86
step_num: 4800 | loss: 0.2183 | profit rate: 397074185632648406237184.0 | accuracy: 0.87
step_num: 5000 | loss: 0.2246 | profit rate: 3356683544962841957617369088.0 | accuracy: 0.87
step_num: 5200 | loss: 0.1882 | profit rate: 22316635528519906950781620715520.0 | accuracy: 0.87
step_num: 5400 | loss: 0.2553 | profit rate: 3197054953101374292860016254779392.0 | accuracy: 0.87
step_num: 5600 | loss: 0.2376 | profit rate: 89572194876631244512592513118760861696.0 | accuracy: 0.87
step_num: 5800 | loss: 0.2626 | profit rate: 11130165412751863140684521149405838815789056.0 | accuracy: 0.87
step_num: 6000 | loss: 0.2067 | profit rate: 1356811863593056685225447386792699984111298674688.0 | accuracy: 0.87
step_num: 6200 | loss: 0.2396 | profit rate: 7346902465977474555672698278183445020711983662497792.0 | accuracy: 0.87
step_num: 6400 | loss: 0.2557 | profit rate: 22212083012759032667952567746041886723403875425020018688.0 | accuracy: 0.87
step_num: 6600 | loss: 0.1873 | profit rate: 103166504439357994943586687072900348024824178134291968950272.0 | accuracy: 0.87
step_num: 6800 | loss: 0.2408 | profit rate: 1252456390315072475408173117205197840290848985957603368316698624.0 | accuracy: 0.87
step_num: 7000 | loss: 0.2362 | profit rate: 657868201425280310624231374317760262064683725181575914463067897856.0 | accuracy: 0.87
model saved @ step:7040,performance:1319357028491329124989899964006668216028205770477387653750265479168.000,accuracy:0.87
step_num: 7200 | loss: 0.2113 | profit rate: 10132.9 | accuracy: 0.88
step_num: 7400 | loss: 0.1896 | profit rate: 25060237.8 | accuracy: 0.86
step_num: 7600 | loss: 0.2234 | profit rate: 36635504754.8 | accuracy: 0.85
step_num: 7800 | loss: 0.2181 | profit rate: 12286801136519.7 | accuracy: 0.86
step_num: 8000 | loss: 0.2862 | profit rate: 319319402588163584.0 | accuracy: 0.87
step_num: 8200 | loss: 0.1965 | profit rate: 4973861811585784217600.0 | accuracy: 0.87
step_num: 8400 | loss: 0.2270 | profit rate: 5940574299368022349971456.0 | accuracy: 0.87
step_num: 8600 | loss: 0.2342 | profit rate: 116627609017158616375625777152.0 | accuracy: 0.87
step_num: 8800 | loss: 0.1786 | profit rate: 86162392931746096197125917376512.0 | accuracy: 0.87
step_num: 9000 | loss: 0.2143 | profit rate: 22622654452835182066145199621406720.0 | accuracy: 0.87
step_num: 9200 | loss: 0.2477 | profit rate: 6465317848917908756193515973118487691264.0 | accuracy: 0.87
step_num: 9400 | loss: 0.2044 | profit rate: 681197470633114819745658892371814289218994176.0 | accuracy: 0.87
step_num: 9600 | loss: 0.2325 | profit rate: 13923596657637308727919364805225175247633524981760.0 | accuracy: 0.87
step_num: 9800 | loss: 0.2120 | profit rate: 100358312359301461913553177542053442467684573933207552.0 | accuracy: 0.87
step_num: 10000 | loss: 0.1537 | profit rate: 695339529642286129387428471047877590033372511436147785728.0 | accuracy: 0.88
step_num: 10200 | loss: 0.2160 | profit rate: 8685854853390813442048371023261067139184668715586488968937472.0 | accuracy: 0.88
step_num: 10400 | loss: 0.1963 | profit rate: 14823121598987668971191104125094621098254524830822240856244748288.0 | accuracy: 0.88
episode:   3/5,耗时:3.47分/10.36分,训练集: | step: 10560 | average_treward: 3160.6 | max_treward: 3624.3418 | average profit rate: 740718394515021204021175068969056873816614210940524401474505015296.000
model saved @ step:10560,performance:902798155053734393537520453722715640385807568502072292693566816256.000,accuracy:0.88
step_num: 10600 | loss: 0.1405 | profit rate:   25.2 | accuracy: 0.93
step_num: 10800 | loss: 0.2068 | profit rate: 145037.3 | accuracy: 0.88
step_num: 11000 | loss: 0.2057 | profit rate: 245236623.1 | accuracy: 0.88
step_num: 11200 | loss: 0.2386 | profit rate: 800449037030.4 | accuracy: 0.88
step_num: 11400 | loss: 0.2137 | profit rate: 85502275535130.3 | accuracy: 0.88
step_num: 11600 | loss: 0.2082 | profit rate: 21580800444033224704.0 | accuracy: 0.88
step_num: 11800 | loss: 0.2772 | profit rate: 50597095970887933362176.0 | accuracy: 0.89
step_num: 12000 | loss: 0.1596 | profit rate: 38191456169765277532160000.0 | accuracy: 0.89
step_num: 12200 | loss: 0.2006 | profit rate: 7092424562170067324687521677312.0 | accuracy: 0.90
step_num: 12400 | loss: 0.1734 | profit rate: 863261011680956683577955444588544.0 | accuracy: 0.89
step_num: 12600 | loss: 0.2224 | profit rate: 1647200765657334621695346370553053184.0 | accuracy: 0.89
step_num: 12800 | loss: 0.2085 | profit rate: 1272973622237630672999004181745315602235392.0 | accuracy: 0.89
step_num: 13000 | loss: 0.2318 | profit rate: 107402513874141267658482597340333288419869327360.0 | accuracy: 0.89
step_num: 13200 | loss: 0.1546 | profit rate: 1790282396758938677615758395717737411300681756704768.0 | accuracy: 0.90
step_num: 13400 | loss: 0.1672 | profit rate: 3783393715547894390115565469033784006434248527882223616.0 | accuracy: 0.89
step_num: 13600 | loss: 0.1530 | profit rate: 14606470534093495784051602766598324115505392956739497754624.0 | accuracy: 0.89
step_num: 13800 | loss: 0.2254 | profit rate: 254125726342252131322641908073302795522769447100160890988658688.0 | accuracy: 0.89
step_num: 14000 | loss: 0.1500 | profit rate: 204658330038659582580332189485231832245661166284528330056876949504.0 | accuracy: 0.89
model saved @ step:14080,performance:858245869685925876915989138526377345970540184913833303091202490368.000,accuracy:0.89
step_num: 14200 | loss: 0.2162 | profit rate: 1379.4 | accuracy: 0.88
step_num: 14400 | loss: 0.2759 | profit rate: 12350118.7 | accuracy: 0.90
step_num: 14600 | loss: 0.2123 | profit rate: 6585707899.0 | accuracy: 0.90
step_num: 14800 | loss: 0.2249 | profit rate: 12651758952629.4 | accuracy: 0.89
step_num: 15000 | loss: 0.2010 | profit rate: 12287648732450382.0 | accuracy: 0.88
step_num: 15200 | loss: 0.1650 | profit rate: 536614249913738133504.0 | accuracy: 0.89
step_num: 15400 | loss: 0.1825 | profit rate: 1380678629553650190516224.0 | accuracy: 0.89
step_num: 15600 | loss: 0.1997 | profit rate: 75179904786905036257530740736.0 | accuracy: 0.89
step_num: 15800 | loss: 0.1785 | profit rate: 78652917634248498630981693997056.0 | accuracy: 0.89
step_num: 16000 | loss: 0.2051 | profit rate: 16138995016924098044381306258718720.0 | accuracy: 0.89
step_num: 16200 | loss: 0.2327 | profit rate: 1693600231332364330009928558600354004992.0 | accuracy: 0.89
step_num: 16400 | loss: 0.2518 | profit rate: 138106655702083719922597101691292074228318208.0 | accuracy: 0.89
step_num: 16600 | loss: 0.1670 | profit rate: 15868916415230281405746859552664395565892045373440.0 | accuracy: 0.89
step_num: 16800 | loss: 0.1761 | profit rate: 49363074548169466271029515592344016705352205909098496.0 | accuracy: 0.89
step_num: 17000 | loss: 0.1882 | profit rate: 488683406901348869225460566431259010895772127406808104960.0 | accuracy: 0.89
step_num: 17200 | loss: 0.1849 | profit rate: 2403207096221029476688531961058923138499641975836340102627328.0 | accuracy: 0.89
step_num: 17400 | loss: 0.1932 | profit rate: 14179459305628742087212800549948431394485520360211442440716943360.0 | accuracy: 0.89
episode:   5/5,耗时:3.45分/17.33分,训练集: | step: 17600 | average_treward: 3356.7 | max_treward: 3658.4764 | average profit rate: 1028884104966575365004306360583242372320064530158199636833905672192.000
model saved @ step:17600,performance:2064019471601886868361493511593730069000793363845025386756397072384.000,accuracy:0.88
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 52/403 [00:00<00:00, 509.83it/s] 28%|       | 112/403 [00:00<00:00, 558.99it/s] 44%|     | 178/403 [00:00<00:00, 602.04it/s] 61%|    | 245/403 [00:00<00:00, 626.21it/s] 78%|  | 313/403 [00:00<00:00, 640.88it/s] 94%|| 379/403 [00:00<00:00, 646.69it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 625.45it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3397.80
2023-07-24T12:00:00 | net performance [%] = 239.7799
2023-07-24T12:00:00 | number of trades [#] = 62
==================================================
Trial 34 Complete [00h 18m 17s]
net_wealth: 3397.7987164498636

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 05h 11m 51s

Search: Running Trial #35

Value             |Best Value So Far |Hyperparameter
3                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
10                |3                 |lags
0.6               |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4298.000000   4301.000000
mean      0.000435    20113.607657  ...   20180.392273  20169.373185
std       0.027833    16040.642334  ...   16078.781641  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7741.750122   7730.930176
50%       0.000642    11571.842969  ...   11754.949707  11751.469727
75%       0.011590    29894.706152  ...   30015.383301  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.1754 | profit rate:    0.2 | accuracy: 0.32
step_num: 600 | loss: 0.1583 | profit rate:    0.8 | accuracy: 0.37
step_num: 800 | loss: 0.1172 | profit rate:    7.1 | accuracy: 0.40
step_num: 1000 | loss: 0.1212 | profit rate:   50.0 | accuracy: 0.43
step_num: 1200 | loss: 0.1062 | profit rate: 10653.3 | accuracy: 0.47
step_num: 1400 | loss: 0.1080 | profit rate: 511650.8 | accuracy: 0.50
step_num: 1600 | loss: 0.1032 | profit rate: 17299831.7 | accuracy: 0.53
step_num: 1800 | loss: 0.1035 | profit rate: 7006178155.9 | accuracy: 0.55
step_num: 2000 | loss: 0.1096 | profit rate: 113805186218.7 | accuracy: 0.57
step_num: 2200 | loss: 0.1017 | profit rate: 18563891243364.7 | accuracy: 0.59
step_num: 2400 | loss: 0.1069 | profit rate: 35842922177034596.0 | accuracy: 0.61
step_num: 2600 | loss: 0.0965 | profit rate: 94005540065807925248.0 | accuracy: 0.63
step_num: 2800 | loss: 0.0886 | profit rate: 53718775528192879886336.0 | accuracy: 0.64
step_num: 3000 | loss: 0.0848 | profit rate: 11011454104847458118926336.0 | accuracy: 0.65
step_num: 3200 | loss: 0.0703 | profit rate: 3313142193764643321667387392.0 | accuracy: 0.67
step_num: 3400 | loss: 0.0807 | profit rate: 1078908652449818986235822080000.0 | accuracy: 0.68
step_num: 3600 | loss: 0.0926 | profit rate: 89094370629515292313043762937856.0 | accuracy: 0.69
episode:   1/5,耗时:1.94分/1.94分,训练集: | step: 3658 | average_treward: 2300.4 | max_treward: 2300.4234 | average profit rate: 182567216727035945884108082642944.000
model saved @ step:3658,performance:182567216727035945884108082642944.000,accuracy:0.69
step_num: 3800 | loss: 0.1099 | profit rate: 14150.8 | accuracy: 0.91
step_num: 4000 | loss: 0.0923 | profit rate: 12521949.6 | accuracy: 0.87
step_num: 4200 | loss: 0.0934 | profit rate: 2213206590.8 | accuracy: 0.87
step_num: 4400 | loss: 0.0798 | profit rate: 763173849862.0 | accuracy: 0.87
step_num: 4600 | loss: 0.0885 | profit rate: 21778125068113.2 | accuracy: 0.86
step_num: 4800 | loss: 0.0938 | profit rate: 44827202230523536.0 | accuracy: 0.86
step_num: 5000 | loss: 0.0772 | profit rate: 11872794895132907520.0 | accuracy: 0.86
step_num: 5200 | loss: 0.0891 | profit rate: 760448638326869458944.0 | accuracy: 0.86
step_num: 5400 | loss: 0.1174 | profit rate: 1577069701009208256757760.0 | accuracy: 0.85
step_num: 5600 | loss: 0.0823 | profit rate: 48589810456901528498208768.0 | accuracy: 0.85
step_num: 5800 | loss: 0.0679 | profit rate: 4592960866819254673586782208.0 | accuracy: 0.85
step_num: 6000 | loss: 0.0513 | profit rate: 33986123335612663094165421162496.0 | accuracy: 0.85
step_num: 6200 | loss: 0.0375 | profit rate: 116342971488828608873669594462552064.0 | accuracy: 0.86
step_num: 6400 | loss: 0.0664 | profit rate: 115685710785615309154979225978707902464.0 | accuracy: 0.86
step_num: 6600 | loss: 0.0500 | profit rate: 40286466410191525562964565374480364339200.0 | accuracy: 0.86
step_num: 6800 | loss: 0.0699 | profit rate: 15825955357112995160767967652229955541008384.0 | accuracy: 0.86
step_num: 7000 | loss: 0.0624 | profit rate: 9952092888123680033516886587454589664850083840.0 | accuracy: 0.87
step_num: 7200 | loss: 0.0569 | profit rate: 802482754373623925049383273482440308781052067840.0 | accuracy: 0.87
model saved @ step:7316,performance:8346722837233669472404239990246766820414959124480.000,accuracy:0.87
step_num: 7400 | loss: 0.0533 | profit rate:  749.3 | accuracy: 0.94
step_num: 7600 | loss: 0.0567 | profit rate: 3312900.4 | accuracy: 0.89
step_num: 7800 | loss: 0.0644 | profit rate: 1053991862.0 | accuracy: 0.90
step_num: 8000 | loss: 0.0670 | profit rate: 140289070326.5 | accuracy: 0.89
step_num: 8200 | loss: 0.0485 | profit rate: 13698359402430.6 | accuracy: 0.87
step_num: 8400 | loss: 0.0522 | profit rate: 2252974620700949.5 | accuracy: 0.87
step_num: 8600 | loss: 0.0564 | profit rate: 3587636576524795392.0 | accuracy: 0.87
step_num: 8800 | loss: 0.0592 | profit rate: 406079283465966911488.0 | accuracy: 0.87
step_num: 9000 | loss: 0.0988 | profit rate: 475091919092914973573120.0 | accuracy: 0.87
step_num: 9200 | loss: 0.0580 | profit rate: 31720187832605837682016256.0 | accuracy: 0.86
step_num: 9400 | loss: 0.0606 | profit rate: 1254814857451355467897896960.0 | accuracy: 0.86
step_num: 9600 | loss: 0.0601 | profit rate: 9529480904457010869679635300352.0 | accuracy: 0.86
step_num: 9800 | loss: 0.0429 | profit rate: 20342178798331047796533909071593472.0 | accuracy: 0.87
step_num: 10000 | loss: 0.0502 | profit rate: 57242393343844623748240132103569670144.0 | accuracy: 0.87
step_num: 10200 | loss: 0.0398 | profit rate: 33593136082581536691784925529354495066112.0 | accuracy: 0.87
step_num: 10400 | loss: 0.0544 | profit rate: 13818505280131926838162348605713287561084928.0 | accuracy: 0.87
step_num: 10600 | loss: 0.0493 | profit rate: 5738370949800431897765792967358999089985355776.0 | accuracy: 0.88
step_num: 10800 | loss: 0.0455 | profit rate: 789370619165082846030189586742299664896254541824.0 | accuracy: 0.87
episode:   3/5,耗时:2.12分/6.22分,训练集: | step: 10974 | average_treward: 3072.1 | max_treward: 3496.5132 | average profit rate: 9335369422870299252142541684874910021092760354816.000
model saved @ step:10974,performance:19659385431377225687874955796964148977615157329920.000,accuracy:0.87
step_num: 11000 | loss: 0.0525 | profit rate:    6.5 | accuracy: 0.85
step_num: 11200 | loss: 0.0580 | profit rate: 416116.0 | accuracy: 0.89
step_num: 11400 | loss: 0.0685 | profit rate: 106982432.9 | accuracy: 0.90
step_num: 11600 | loss: 0.0272 | profit rate: 5925029520.4 | accuracy: 0.90
step_num: 11800 | loss: 0.0444 | profit rate: 2609990568408.8 | accuracy: 0.89
step_num: 12000 | loss: 0.0562 | profit rate: 204960660390215.3 | accuracy: 0.88
step_num: 12200 | loss: 0.0399 | profit rate: 527645126426671872.0 | accuracy: 0.88
step_num: 12400 | loss: 0.0475 | profit rate: 59632243791570993152.0 | accuracy: 0.87
step_num: 12600 | loss: 0.0950 | profit rate: 25274042325205256241152.0 | accuracy: 0.87
step_num: 12800 | loss: 0.0791 | profit rate: 8749961093150590736793600.0 | accuracy: 0.87
step_num: 13000 | loss: 0.0730 | profit rate: 194849348659182428575760384.0 | accuracy: 0.86
step_num: 13200 | loss: 0.0564 | profit rate: 214159213570921694046634115072.0 | accuracy: 0.86
step_num: 13400 | loss: 0.0374 | profit rate: 456565070642770672677649754619904.0 | accuracy: 0.86
step_num: 13600 | loss: 0.0368 | profit rate: 2108797438569814978336711690403446784.0 | accuracy: 0.87
step_num: 13800 | loss: 0.0472 | profit rate: 937963953909887427893464466095161212928.0 | accuracy: 0.87
step_num: 14000 | loss: 0.0466 | profit rate: 387395061365001028284070556264456672772096.0 | accuracy: 0.87
step_num: 14200 | loss: 0.0343 | profit rate: 151455530176986840552066147535129958085033984.0 | accuracy: 0.87
step_num: 14400 | loss: 0.0388 | profit rate: 59959293195481330589776786466311526353737875456.0 | accuracy: 0.87
step_num: 14600 | loss: 0.0315 | profit rate: 3406216056189787617627060839329313508840200732672.0 | accuracy: 0.87
model saved @ step:14632,performance:5118597116506132337874839609902756396279617552384.000,accuracy:0.87
step_num: 14800 | loss: 0.0426 | profit rate: 56156.7 | accuracy: 0.91
step_num: 15000 | loss: 0.0406 | profit rate: 29107954.5 | accuracy: 0.90
step_num: 15200 | loss: 0.0402 | profit rate: 4164003362.9 | accuracy: 0.89
step_num: 15400 | loss: 0.0503 | profit rate: 1936286932495.6 | accuracy: 0.89
step_num: 15600 | loss: 0.0654 | profit rate: 47413815695499.0 | accuracy: 0.88
step_num: 15800 | loss: 0.0503 | profit rate: 144558839095613120.0 | accuracy: 0.88
step_num: 16000 | loss: 0.0445 | profit rate: 33518383353449136128.0 | accuracy: 0.88
step_num: 16200 | loss: 0.0593 | profit rate: 3195860383221173714944.0 | accuracy: 0.88
step_num: 16400 | loss: 0.0338 | profit rate: 9516051967080965934678016.0 | accuracy: 0.88
step_num: 16600 | loss: 0.0615 | profit rate: 245457643790244557898121216.0 | accuracy: 0.88
step_num: 16800 | loss: 0.0443 | profit rate: 27696846132216290420390363136.0 | accuracy: 0.88
step_num: 17000 | loss: 0.0259 | profit rate: 376198725586237838822489045598208.0 | accuracy: 0.88
step_num: 17200 | loss: 0.0393 | profit rate: 2205833706405636415619512038995263488.0 | accuracy: 0.89
step_num: 17400 | loss: 0.0617 | profit rate: 1380081380062256347046545001529789644800.0 | accuracy: 0.89
step_num: 17600 | loss: 0.0361 | profit rate: 374205271619896875328872544475239835238400.0 | accuracy: 0.89
step_num: 17800 | loss: 0.0383 | profit rate: 145607773542513307478949042331965517771833344.0 | accuracy: 0.89
step_num: 18000 | loss: 0.0683 | profit rate: 125655267196468059901403583402723862171986427904.0 | accuracy: 0.89
step_num: 18200 | loss: 0.0526 | profit rate: 14227037581472841966300985427721222806700040388608.0 | accuracy: 0.89
episode:   5/5,耗时:2.34分/10.75分,训练集: | step: 18290 | average_treward: 3256.5 | max_treward: 3562.4830 | average profit rate: 15322848300802323351275268510113179475911892795392.000
model saved @ step:18290,performance:43489536118894593801482058371426400149434018037760.000,accuracy:0.89
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 12%|        | 48/401 [00:00<00:00, 475.25it/s] 26%|       | 103/401 [00:00<00:00, 519.01it/s] 41%|      | 164/401 [00:00<00:00, 555.43it/s] 58%|    | 231/401 [00:00<00:00, 595.68it/s] 74%|  | 297/401 [00:00<00:00, 616.46it/s] 91%| | 363/401 [00:00<00:00, 628.71it/s]100%|| 401/401 [00:00<00:00, 601.97it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3957.63
2023-07-24T12:00:00 | net performance [%] = 295.7634
2023-07-24T12:00:00 | number of trades [#] = 100
==================================================
Trial 35 Complete [00h 11m 00s]
net_wealth: 3957.6337136046923

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 05h 22m 51s

Search: Running Trial #36

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
14                |3                 |lags
0.8               |0.5               |gamma
0.001             |0.001             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4314.000000   4315.000000
mean      0.000441    20062.255222  ...   20122.295285  20118.633889
std       0.027818    16039.874230  ...   16077.162832  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7691.585083   7690.540039
50%       0.000642    11554.824463  ...   11724.320312  11715.610352
75%       0.011655    29873.081836  ...   29925.802734  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.3435 | profit rate:    1.5 | accuracy: 0.37
step_num: 400 | loss: 0.2038 | profit rate:    2.3 | accuracy: 0.37
step_num: 600 | loss: 0.2234 | profit rate:    5.6 | accuracy: 0.41
step_num: 800 | loss: 0.1576 | profit rate:   42.8 | accuracy: 0.45
step_num: 1000 | loss: 0.1083 | profit rate:  242.8 | accuracy: 0.49
step_num: 1200 | loss: 0.1584 | profit rate: 2874.2 | accuracy: 0.52
step_num: 1400 | loss: 0.1011 | profit rate: 20080.4 | accuracy: 0.55
step_num: 1600 | loss: 0.0807 | profit rate: 132416.1 | accuracy: 0.58
step_num: 1800 | loss: 0.3327 | profit rate: 6972226.5 | accuracy: 0.60
step_num: 2000 | loss: 0.1067 | profit rate: 313805577.6 | accuracy: 0.62
step_num: 2200 | loss: 0.0820 | profit rate: 18476889205.4 | accuracy: 0.64
step_num: 2400 | loss: 0.0854 | profit rate: 428019930829.4 | accuracy: 0.66
step_num: 2600 | loss: 0.0844 | profit rate: 12556035062655.6 | accuracy: 0.68
step_num: 2800 | loss: 0.0869 | profit rate: 487844610340180.2 | accuracy: 0.70
step_num: 3000 | loss: 0.1064 | profit rate: 11568093162788860.0 | accuracy: 0.71
episode:   1/5,耗时:1.13分/1.13分,训练集: | step: 3163 | average_treward: 2075.0 | max_treward: 2075.0325 | average profit rate: 58424118756385816.000
model saved @ step:3163,performance:58424118756385816.000,accuracy:0.71
step_num: 3200 | loss: 0.1117 | profit rate:    1.7 | accuracy: 0.92
step_num: 3400 | loss: 0.0607 | profit rate:   30.4 | accuracy: 0.92
step_num: 3600 | loss: 0.0824 | profit rate:  216.1 | accuracy: 0.88
step_num: 3800 | loss: 0.0777 | profit rate: 10266.6 | accuracy: 0.89
step_num: 4000 | loss: 0.0724 | profit rate: 182640.1 | accuracy: 0.88
step_num: 4200 | loss: 0.1410 | profit rate: 2461288.6 | accuracy: 0.87
step_num: 4400 | loss: 0.1367 | profit rate: 184119197.7 | accuracy: 0.87
step_num: 4600 | loss: 0.0885 | profit rate: 1776553603.0 | accuracy: 0.87
step_num: 4800 | loss: 0.0580 | profit rate: 21832266414.7 | accuracy: 0.87
step_num: 5000 | loss: 0.0877 | profit rate: 3419688240438.2 | accuracy: 0.87
step_num: 5200 | loss: 0.0576 | profit rate: 424158414892862.9 | accuracy: 0.88
step_num: 5400 | loss: 0.0917 | profit rate: 19746176686427016.0 | accuracy: 0.88
step_num: 5600 | loss: 0.1209 | profit rate: 611430269821416192.0 | accuracy: 0.88
step_num: 5800 | loss: 0.0851 | profit rate: 17370187025205452800.0 | accuracy: 0.88
step_num: 6000 | loss: 0.0943 | profit rate: 865874642603082776576.0 | accuracy: 0.89
step_num: 6200 | loss: 0.0715 | profit rate: 14888051923113400598528.0 | accuracy: 0.88
model saved @ step:6326,performance:55127360344452163960832.000,accuracy:0.88
step_num: 6400 | loss: 0.1106 | profit rate:    2.3 | accuracy: 0.88
step_num: 6600 | loss: 0.0854 | profit rate:   47.7 | accuracy: 0.88
step_num: 6800 | loss: 0.0924 | profit rate:  266.7 | accuracy: 0.87
step_num: 7000 | loss: 0.0990 | profit rate: 20065.1 | accuracy: 0.88
step_num: 7200 | loss: 0.0943 | profit rate: 325143.0 | accuracy: 0.88
step_num: 7400 | loss: 0.1137 | profit rate: 3541885.7 | accuracy: 0.87
step_num: 7600 | loss: 0.1370 | profit rate: 310236315.5 | accuracy: 0.87
step_num: 7800 | loss: 0.0870 | profit rate: 2234575061.5 | accuracy: 0.87
step_num: 8000 | loss: 0.0863 | profit rate: 35861582436.3 | accuracy: 0.87
step_num: 8200 | loss: 0.0674 | profit rate: 6263827516213.9 | accuracy: 0.88
step_num: 8400 | loss: 0.0808 | profit rate: 887756989111342.2 | accuracy: 0.88
step_num: 8600 | loss: 0.0891 | profit rate: 37198234269044104.0 | accuracy: 0.88
step_num: 8800 | loss: 0.0756 | profit rate: 992539358149975168.0 | accuracy: 0.88
step_num: 9000 | loss: 0.0697 | profit rate: 28591729785805619200.0 | accuracy: 0.89
step_num: 9200 | loss: 0.0934 | profit rate: 1705948683731862814720.0 | accuracy: 0.89
step_num: 9400 | loss: 0.1133 | profit rate: 27800703514170760364032.0 | accuracy: 0.89
episode:   3/5,耗时:1.36分/3.72分,训练集: | step: 9489 | average_treward: 2626.9 | max_treward: 2903.7653 | average profit rate: 36552913636351971164160.000
model saved @ step:9489,performance:54531322140484993810432.000,accuracy:0.89
step_num: 9600 | loss: 0.1257 | profit rate:    3.3 | accuracy: 0.91
step_num: 9800 | loss: 0.0644 | profit rate:   80.1 | accuracy: 0.91
step_num: 10000 | loss: 0.0651 | profit rate:  503.9 | accuracy: 0.89
step_num: 10200 | loss: 0.0834 | profit rate: 42437.4 | accuracy: 0.89
step_num: 10400 | loss: 0.0801 | profit rate: 574801.6 | accuracy: 0.88
step_num: 10600 | loss: 0.0806 | profit rate: 6299008.4 | accuracy: 0.87
step_num: 10800 | loss: 0.0978 | profit rate: 596219973.9 | accuracy: 0.87
step_num: 11000 | loss: 0.0604 | profit rate: 4188032164.1 | accuracy: 0.87
step_num: 11200 | loss: 0.0849 | profit rate: 87553267047.0 | accuracy: 0.87
step_num: 11400 | loss: 0.0566 | profit rate: 14121460892196.0 | accuracy: 0.88
step_num: 11600 | loss: 0.0438 | profit rate: 1876848331483812.8 | accuracy: 0.88
step_num: 11800 | loss: 0.0795 | profit rate: 85542995206674992.0 | accuracy: 0.88
step_num: 12000 | loss: 0.0581 | profit rate: 2561366943131491840.0 | accuracy: 0.88
step_num: 12200 | loss: 0.0517 | profit rate: 89675543628209192960.0 | accuracy: 0.89
step_num: 12400 | loss: 0.1097 | profit rate: 3743534608425936224256.0 | accuracy: 0.89
step_num: 12600 | loss: 0.1068 | profit rate: 51408882387182919090176.0 | accuracy: 0.89
model saved @ step:12652,performance:72755378188182255304704.000,accuracy:0.89
step_num: 12800 | loss: 0.0945 | profit rate:    3.8 | accuracy: 0.88
step_num: 13000 | loss: 0.0711 | profit rate:   98.8 | accuracy: 0.89
step_num: 13200 | loss: 0.0852 | profit rate: 1119.8 | accuracy: 0.88
step_num: 13400 | loss: 0.0625 | profit rate: 56092.9 | accuracy: 0.88
step_num: 13600 | loss: 0.0893 | profit rate: 628923.3 | accuracy: 0.86
step_num: 13800 | loss: 0.1006 | profit rate: 28931068.6 | accuracy: 0.86
step_num: 14000 | loss: 0.1180 | profit rate: 544290330.8 | accuracy: 0.86
step_num: 14200 | loss: 0.0915 | profit rate: 3911041956.7 | accuracy: 0.86
step_num: 14400 | loss: 0.0799 | profit rate: 138874944908.6 | accuracy: 0.86
step_num: 14600 | loss: 0.0729 | profit rate: 17121171981026.2 | accuracy: 0.87
step_num: 14800 | loss: 0.0824 | profit rate: 1860767355624351.2 | accuracy: 0.87
step_num: 15000 | loss: 0.0749 | profit rate: 60314796661912256.0 | accuracy: 0.87
step_num: 15200 | loss: 0.0579 | profit rate: 1747850206696812032.0 | accuracy: 0.87
step_num: 15400 | loss: 0.0670 | profit rate: 65461503986135457792.0 | accuracy: 0.88
step_num: 15600 | loss: 0.0977 | profit rate: 2106300968985786056704.0 | accuracy: 0.88
step_num: 15800 | loss: 0.0945 | profit rate: 22984564356192275529728.0 | accuracy: 0.88
episode:   5/5,耗时:1.36分/6.31分,训练集: | step: 15815 | average_treward: 2731.3 | max_treward: 2917.2069 | average profit rate: 41354496385226320642048.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 50/397 [00:00<00:00, 495.58it/s] 28%|       | 113/397 [00:00<00:00, 574.36it/s] 45%|     | 178/397 [00:00<00:00, 606.07it/s] 61%|   | 244/397 [00:00<00:00, 624.82it/s] 78%|  | 310/397 [00:00<00:00, 634.55it/s] 95%|| 377/397 [00:00<00:00, 643.32it/s]100%|| 397/397 [00:00<00:00, 622.61it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 8318.65
2023-07-24T12:00:00 | net performance [%] = 731.8648
2023-07-24T12:00:00 | number of trades [#] = 210
==================================================
Trial 36 Complete [00h 06m 30s]
net_wealth: 8318.648328697951

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 05h 29m 21s

Search: Running Trial #37

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.95              |0.5               |gamma
5e-05             |0.001             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.3404 | profit rate:   39.9 | accuracy: 0.36
step_num: 1200 | loss: 0.7100 | profit rate:   86.4 | accuracy: 0.36
step_num: 1400 | loss: 0.7237 | profit rate:  266.1 | accuracy: 0.36
step_num: 1600 | loss: 0.6182 | profit rate: 9492.7 | accuracy: 0.38
step_num: 1800 | loss: 0.6362 | profit rate: 10691976208.8 | accuracy: 0.41
step_num: 2000 | loss: 0.5825 | profit rate: 239747157245623.3 | accuracy: 0.43
step_num: 2200 | loss: 0.5407 | profit rate: 2389894647149076480.0 | accuracy: 0.45
step_num: 2400 | loss: 0.5106 | profit rate: 188710467803730669469696.0 | accuracy: 0.48
step_num: 2600 | loss: 0.4763 | profit rate: 5465718795246129314887892992.0 | accuracy: 0.50
step_num: 2800 | loss: 0.4986 | profit rate: 2161316004865487102018582361407488.0 | accuracy: 0.52
step_num: 3000 | loss: 0.4725 | profit rate: 1821492956495290228129327405401636864.0 | accuracy: 0.53
episode:   1/5,耗时:2.21分/2.21分,训练集: | step: 3149 | average_treward: 1390.6 | max_treward: 1390.6351 | average profit rate: 187532708870051469849076485381037228032.000
model saved @ step:3149,performance:187532708870051469849076485381037228032.000,accuracy:0.54
step_num: 3200 | loss: 0.4892 | profit rate:    2.4 | accuracy: 0.54
step_num: 3400 | loss: 0.4804 | profit rate: 2944494.5 | accuracy: 0.79
step_num: 3600 | loss: 0.4871 | profit rate: 7659489705.8 | accuracy: 0.80
step_num: 3800 | loss: 0.5430 | profit rate: 197272642257384448.0 | accuracy: 0.80
step_num: 4000 | loss: 0.5584 | profit rate: 18609349272013799161856.0 | accuracy: 0.79
step_num: 4200 | loss: 0.5084 | profit rate: 602126188660420013811826688.0 | accuracy: 0.81
step_num: 4400 | loss: 0.5657 | profit rate: 45598601727784886485747179737579520.0 | accuracy: 0.81
step_num: 4600 | loss: 0.5608 | profit rate: 34992175341904326120404778113589837824.0 | accuracy: 0.81
step_num: 4800 | loss: 0.5120 | profit rate: 4708658892715557768415071673144967897808896.0 | accuracy: 0.83
step_num: 5000 | loss: 0.4984 | profit rate: 69290940825841081195762404207944625560362852353572864.0 | accuracy: 0.84
step_num: 5200 | loss: 0.5536 | profit rate: 821732979711874643465362687486293551224055749259371292393472.0 | accuracy: 0.84
step_num: 5400 | loss: 0.5462 | profit rate: 1351426601626307895711311293373407575105135724685124630230041886720.0 | accuracy: 0.84
step_num: 5600 | loss: 0.5320 | profit rate: 128489842617955583085105065335805288429354760233749945605577606724321280.0 | accuracy: 0.84
step_num: 5800 | loss: 0.5508 | profit rate: 37643345092838084887790045708608530352377059556533308945304659808031619416064.0 | accuracy: 0.84
step_num: 6000 | loss: 0.5550 | profit rate: 41449353179023219887627909801738638534700841622121278362769480196841091237626773504.0 | accuracy: 0.84
step_num: 6200 | loss: 0.5270 | profit rate: 867363679866675230993206702253874526288441338990789825051509608819879395155067101249536.0 | accuracy: 0.84
model saved @ step:6298,performance:10724254604994949456150995726823711033491628994006395149268925770326726087410058801446912.000,accuracy:0.84
step_num: 6400 | loss: 0.5298 | profit rate:    7.2 | accuracy: 0.74
step_num: 6600 | loss: 0.5257 | profit rate: 31549861.1 | accuracy: 0.84
step_num: 6800 | loss: 0.5154 | profit rate: 7442723576520.0 | accuracy: 0.86
step_num: 7000 | loss: 0.5215 | profit rate: 169905054188272779264.0 | accuracy: 0.85
step_num: 7200 | loss: 0.5653 | profit rate: 25764821146867540789559296.0 | accuracy: 0.85
step_num: 7400 | loss: 0.4801 | profit rate: 4860426776068476590781498392576.0 | accuracy: 0.85
step_num: 7600 | loss: 0.5913 | profit rate: 19370841099567325968893429535742099456.0 | accuracy: 0.85
step_num: 7800 | loss: 0.5531 | profit rate: 61190176013679251024542534099220492713984.0 | accuracy: 0.86
step_num: 8000 | loss: 0.5286 | profit rate: 2955083322374645933024010613752055658562443018240.0 | accuracy: 0.87
step_num: 8200 | loss: 0.5284 | profit rate: 227067970915006852782220064502655341756683840630946791424.0 | accuracy: 0.87
step_num: 8400 | loss: 0.6048 | profit rate: 2718540109552412785936308815427244879410130950288206454587392000.0 | accuracy: 0.87
step_num: 8600 | loss: 0.5483 | profit rate: 6975551599414927444588000476850218985423907870435692270800511380226048.0 | accuracy: 0.87
step_num: 8800 | loss: 0.5653 | profit rate: 2570605150484345692265699201679362669441413602401013558030668040321531641856.0 | accuracy: 0.87
step_num: 9000 | loss: 0.5480 | profit rate: 350289617611665503133722897207694880072508201179264114234001032694509065440591872.0 | accuracy: 0.86
step_num: 9200 | loss: 0.5772 | profit rate: 446406808216411097370738938613361852188101099040730079810945379248479446356245191065600.0 | accuracy: 0.86
step_num: 9400 | loss: 0.6197 | profit rate: 1778860552583080961198508248560040509247202546648684826215361350234894174149366525089284096.0 | accuracy: 0.86
episode:   3/5,耗时:3.25分/8.72分,训练集: | step: 9447 | average_treward: 2693.3 | max_treward: 3390.7564 | average profit rate: 1525542431213132826189158511053994875560206263555885632026744108219060373176930199895277568.000
model saved @ step:9447,performance:4565903039034403506142312695316164631064259652015709795173672739503807937862499924080328704.000,accuracy:0.86
step_num: 9600 | loss: 0.5326 | profit rate: 2758.3 | accuracy: 0.80
step_num: 9800 | loss: 0.5225 | profit rate: 431027338.4 | accuracy: 0.83
step_num: 10000 | loss: 0.5723 | profit rate: 186594608797354.2 | accuracy: 0.84
step_num: 10200 | loss: 0.5791 | profit rate: 1299849019837330227200.0 | accuracy: 0.84
step_num: 10400 | loss: 0.5451 | profit rate: 83567144311336761460523008.0 | accuracy: 0.82
step_num: 10600 | loss: 0.5769 | profit rate: 9061680326036481618624895753650176.0 | accuracy: 0.84
step_num: 10800 | loss: 0.5536 | profit rate: 40649535107606374417884384392139243520.0 | accuracy: 0.84
step_num: 11000 | loss: 0.5193 | profit rate: 542772201753563014215560350456972968984576.0 | accuracy: 0.85
step_num: 11200 | loss: 0.5687 | profit rate: 290300004722252633520102783333950914823972582326272.0 | accuracy: 0.86
step_num: 11400 | loss: 0.5467 | profit rate: 6168868214686579977826199956470504883898786961136906403840.0 | accuracy: 0.86
step_num: 11600 | loss: 0.5805 | profit rate: 102497102112923489790901374661572244024086105012979487791760015360.0 | accuracy: 0.86
step_num: 11800 | loss: 0.5684 | profit rate: 49970653789352066501142047465407794548929719447518524480137275683897344.0 | accuracy: 0.86
step_num: 12000 | loss: 0.5925 | profit rate: 23370445270959021440089810286617198005898470080599121524662490561842371362816.0 | accuracy: 0.85
step_num: 12200 | loss: 0.5432 | profit rate: 12800987658742326798118920487009478888275966189158134444912473877720317734609223680.0 | accuracy: 0.85
step_num: 12400 | loss: 0.5463 | profit rate: 3787019779459280426624605642158121096451886348979880830730680895845693040785384869462016.0 | accuracy: 0.85
step_num: 12600 | loss: 0.5288 | profit rate:    2.0 | accuracy: 1.00
step_num: 12800 | loss: 0.5660 | profit rate: 505570.6 | accuracy: 0.81
step_num: 13000 | loss: 0.5287 | profit rate: 668299376.9 | accuracy: 0.80
step_num: 13200 | loss: 0.5692 | profit rate: 94658889191663456.0 | accuracy: 0.82
step_num: 13400 | loss: 0.5463 | profit rate: 26967273958665214754816.0 | accuracy: 0.82
step_num: 13600 | loss: 0.5522 | profit rate: 657628760678050570419830784.0 | accuracy: 0.82
step_num: 13800 | loss: 0.5615 | profit rate: 40397096207598185544112177737105408.0 | accuracy: 0.82
step_num: 14000 | loss: 0.5856 | profit rate: 175209156737267283693792454206386339840.0 | accuracy: 0.83
step_num: 14200 | loss: 0.5608 | profit rate: 7306603761963350802417888881572151272931328.0 | accuracy: 0.84
step_num: 14400 | loss: 0.5540 | profit rate: 106783609370099436853230225865883844723256793860407296.0 | accuracy: 0.85
step_num: 14600 | loss: 0.5906 | profit rate: 697734868508537488648601875308818663772621158256983435902976.0 | accuracy: 0.85
step_num: 14800 | loss: 0.6166 | profit rate: 320868469925027865280792622860121279812715529662491774055230734336.0 | accuracy: 0.85
step_num: 15000 | loss: 0.6685 | profit rate: 170812417020982081959591492722745521399866684109326500140537547493212160.0 | accuracy: 0.85
step_num: 15200 | loss: 0.5867 | profit rate: 70676978827594092341583167310456568336515740153452043077161668852662191259648.0 | accuracy: 0.85
step_num: 15400 | loss: 0.6075 | profit rate: 133444189574613562604162824704275209677846447848514708942713631954816811152476995584.0 | accuracy: 0.84
step_num: 15600 | loss: 0.6070 | profit rate: 2087471818800518808598492587038159075775377742530833007982297165307773988211931840774144.0 | accuracy: 0.85
episode:   5/5,耗时:3.36分/15.34分,训练集: | step: 15745 | average_treward: 2958.3 | max_treward: 3390.7564 | average profit rate: 1531484304543375952968801596992213424527092749545187186817637256648308030571603727363342336.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 14%|        | 54/397 [00:00<00:00, 533.82it/s] 30%|       | 119/397 [00:00<00:00, 601.83it/s] 46%|     | 183/397 [00:00<00:00, 618.42it/s] 63%|   | 250/397 [00:00<00:00, 636.24it/s] 80%|  | 317/397 [00:00<00:00, 646.04it/s] 97%|| 384/397 [00:00<00:00, 652.73it/s]100%|| 397/397 [00:00<00:00, 632.73it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2079.28
2023-07-24T12:00:00 | net performance [%] = 107.9278
2023-07-24T12:00:00 | number of trades [#] = 32
==================================================
Trial 37 Complete [00h 15m 30s]
net_wealth: 2079.2781824424524

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 05h 44m 52s

Search: Running Trial #38

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
10                |3                 |lags
0.92              |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.5512 | profit rate:    3.8 | accuracy: 0.34
step_num: 600 | loss: 0.4529 | profit rate:  270.0 | accuracy: 0.38
step_num: 800 | loss: 0.4928 | profit rate: 4636.3 | accuracy: 0.40
step_num: 1000 | loss: 0.7410 | profit rate: 22391386.3 | accuracy: 0.43
step_num: 1200 | loss: 0.6316 | profit rate: 4377032051.8 | accuracy: 0.46
step_num: 1400 | loss: 0.4637 | profit rate: 1188485830646.9 | accuracy: 0.48
step_num: 1600 | loss: 0.5491 | profit rate: 690262278814765952.0 | accuracy: 0.50
step_num: 1800 | loss: 0.5593 | profit rate: 58518612243369779200.0 | accuracy: 0.52
step_num: 2000 | loss: 0.5651 | profit rate: 213054517742237137240064.0 | accuracy: 0.53
step_num: 2200 | loss: 0.6286 | profit rate: 1447261150747462543984488873984.0 | accuracy: 0.54
step_num: 2400 | loss: 0.5518 | profit rate: 36515948535856926943929335612964864.0 | accuracy: 0.55
step_num: 2600 | loss: 0.5850 | profit rate: 92236971001476771363049974758318800896.0 | accuracy: 0.56
step_num: 2800 | loss: 0.6646 | profit rate: 221812378947377320556730017976652211945472.0 | accuracy: 0.56
step_num: 3000 | loss: 0.5916 | profit rate: 7987275306118691310065861467704060358007193600.0 | accuracy: 0.57
step_num: 3200 | loss: 0.6217 | profit rate: 1081240074799020517891118001830241583066722569551872.0 | accuracy: 0.58
step_num: 3400 | loss: 0.6028 | profit rate: 317546179310919693956359961088377110731288959873187840.0 | accuracy: 0.58
episode:   1/5,耗时:1.87分/1.87分,训练集: | step: 3518 | average_treward: 1795.2 | max_treward: 1795.1555 | average profit rate: 6629394081275463435077597374690863406470983068145418240.000
model saved @ step:3518,performance:6629394081275463435077597374690863406470983068145418240.000,accuracy:0.58
step_num: 3600 | loss: 0.6167 | profit rate:  557.8 | accuracy: 0.76
step_num: 3800 | loss: 0.6307 | profit rate: 21755245.9 | accuracy: 0.74
step_num: 4000 | loss: 0.5192 | profit rate: 34100002512.8 | accuracy: 0.74
step_num: 4200 | loss: 0.6053 | profit rate: 803046007525220.0 | accuracy: 0.70
step_num: 4400 | loss: 0.5057 | profit rate: 3663363346358378496.0 | accuracy: 0.68
step_num: 4600 | loss: 0.6446 | profit rate: 2205182459973928510029824.0 | accuracy: 0.69
step_num: 4800 | loss: 0.5510 | profit rate: 17370623956400700606054924288.0 | accuracy: 0.70
step_num: 5000 | loss: 0.4568 | profit rate: 627493285401192966575994613792768.0 | accuracy: 0.70
step_num: 5200 | loss: 0.5517 | profit rate: 735919149228832932072754851442851840.0 | accuracy: 0.69
step_num: 5400 | loss: 0.4606 | profit rate: 140280997082710057649061522022011502592.0 | accuracy: 0.68
step_num: 5600 | loss: 0.5292 | profit rate: 4366134786147921309704778059716667884435406848.0 | accuracy: 0.70
step_num: 5800 | loss: 0.5796 | profit rate: 445057515351893575098666980505750641911127758340096.0 | accuracy: 0.69
step_num: 6000 | loss: 0.6390 | profit rate: 25813731323878768110040863663090905633445804556746227712.0 | accuracy: 0.69
step_num: 6200 | loss: 0.6978 | profit rate: 387245792654937896158491155570063908566704354662133511749632.0 | accuracy: 0.69
step_num: 6400 | loss: 0.7238 | profit rate: 1833124573954910702913363212357140062116118864116821170413633536.0 | accuracy: 0.69
step_num: 6600 | loss: 0.5410 | profit rate: 104694656035191386726807805793821918753730551860995683620457690431488.0 | accuracy: 0.69
step_num: 6800 | loss: 0.5973 | profit rate: 1699348126495670709410115468257759593889150470298984520085035720000929792.0 | accuracy: 0.69
step_num: 7000 | loss: 0.6921 | profit rate: 393557528235254625709654133816050708389768934932875166959218706925186187264.0 | accuracy: 0.68
model saved @ step:7036,performance:661911930768640615850262082203340015902346198276590105277214547218112970752.000,accuracy:0.68
step_num: 7200 | loss: 0.4903 | profit rate: 36865.3 | accuracy: 0.76
step_num: 7400 | loss: 0.5430 | profit rate: 5882227405.9 | accuracy: 0.78
step_num: 7600 | loss: 0.6225 | profit rate: 48941454134363.7 | accuracy: 0.76
step_num: 7800 | loss: 0.5477 | profit rate: 7685023472344171.0 | accuracy: 0.73
step_num: 8000 | loss: 0.6097 | profit rate: 3153491945919385436160.0 | accuracy: 0.72
step_num: 8200 | loss: 0.5502 | profit rate: 103780038862530807429332992.0 | accuracy: 0.72
step_num: 8400 | loss: 0.4518 | profit rate: 163061689881029857004969000960.0 | accuracy: 0.72
step_num: 8600 | loss: 0.4829 | profit rate: 161417193434273987843128284317483008.0 | accuracy: 0.71
step_num: 8800 | loss: 0.4668 | profit rate: 179772444060819332592257009540514447360.0 | accuracy: 0.71
step_num: 9000 | loss: 0.5177 | profit rate: 242560730181377301639030417849398847340544.0 | accuracy: 0.71
step_num: 9200 | loss: 0.6067 | profit rate: 32073918599684843349734554093649510255050826448896.0 | accuracy: 0.71
step_num: 9400 | loss: 0.5203 | profit rate: 5390459380149743288421562681871177095764054819987259392.0 | accuracy: 0.71
step_num: 9600 | loss: 0.5707 | profit rate: 50359982666767031304910458187500446177364513635665920917504.0 | accuracy: 0.70
step_num: 9800 | loss: 0.5768 | profit rate: 327054103709343916043531199243307622844135195899707326208147456.0 | accuracy: 0.70
step_num: 10000 | loss: 0.6364 | profit rate: 21866090045560696474356838956810928216292400792286884928567933665280.0 | accuracy: 0.70
step_num: 10200 | loss: 0.5466 | profit rate: 4809492808058697578948790162211903342960781483669850353986738415042822144.0 | accuracy: 0.70
step_num: 10400 | loss: 0.6095 | profit rate: 875999628012710695756752396003716351156419111685726879453104000203306827776.0 | accuracy: 0.70
episode:   3/5,耗时:2.08分/6.04分,训练集: | step: 10554 | average_treward: 2292.5 | max_treward: 2569.9893 | average profit rate: 16753893552452827042116683632594083590567482233700802241122441046715449475072.000
model saved @ step:10554,performance:49599768726589846436083827020605551816785316010862913418713648166976815628288.000,accuracy:0.70
step_num: 10600 | loss: 0.5970 | profit rate:  206.2 | accuracy: 0.87
step_num: 10800 | loss: 0.4866 | profit rate: 506071.4 | accuracy: 0.73
step_num: 11000 | loss: 0.5252 | profit rate: 6017643977.8 | accuracy: 0.74
step_num: 11200 | loss: 0.5575 | profit rate: 1131217885829814.0 | accuracy: 0.74
step_num: 11400 | loss: 0.5137 | profit rate: 531894959792586496.0 | accuracy: 0.72
step_num: 11600 | loss: 0.6055 | profit rate: 7550822555650400182075392.0 | accuracy: 0.73
step_num: 11800 | loss: 0.4924 | profit rate: 18146015289371116827658158080.0 | accuracy: 0.72
step_num: 12000 | loss: 0.4704 | profit rate: 9900034129425901199444250984448.0 | accuracy: 0.71
step_num: 12200 | loss: 0.5018 | profit rate: 13131731461020729618570870585391316992.0 | accuracy: 0.70
step_num: 12400 | loss: 0.5738 | profit rate: 1842372023799068483764546354589787488256.0 | accuracy: 0.69
step_num: 12600 | loss: 0.6546 | profit rate: 90032786689424299576008638744491712667713536.0 | accuracy: 0.70
step_num: 12800 | loss: 0.4833 | profit rate: 600993870381158425937811931872504462336729880199168.0 | accuracy: 0.70
step_num: 13000 | loss: 0.5370 | profit rate: 17079226146623260668040362866355316355598836374419013632.0 | accuracy: 0.69
step_num: 13200 | loss: 0.5356 | profit rate: 8438486918636215243907079715200149892827979837040544167493632.0 | accuracy: 0.70
step_num: 13400 | loss: 0.5681 | profit rate: 16245960095373261840296331462794201987818277549475480715239882752.0 | accuracy: 0.69
step_num: 13600 | loss: 0.4729 | profit rate: 469439131892257555253167344893691416605717495223521372491905299906560.0 | accuracy: 0.69
step_num: 13800 | loss: 0.5377 | profit rate: 3069915468615422893133819207898566236149884679475562333295243063271096320.0 | accuracy: 0.68
step_num: 14000 | loss: 0.6056 | profit rate: 20264736513559703125872391862496065688858980605714489634941003299975914848256.0 | accuracy: 0.69
model saved @ step:14072,performance:37263025180091656535887309538847119132875221309438369123494839291816160788480.000,accuracy:0.68
step_num: 14200 | loss: 0.5006 | profit rate: 28520.4 | accuracy: 0.80
step_num: 14400 | loss: 0.5198 | profit rate: 1305311304.5 | accuracy: 0.74
step_num: 14600 | loss: 0.5128 | profit rate: 7350819074830.0 | accuracy: 0.72
step_num: 14800 | loss: 0.3834 | profit rate: 2966853288235723.0 | accuracy: 0.68
step_num: 15000 | loss: 0.5536 | profit rate: 103832418593234862080.0 | accuracy: 0.69
step_num: 15200 | loss: 0.5695 | profit rate: 54088816064574248982675456.0 | accuracy: 0.70
step_num: 15400 | loss: 0.5390 | profit rate: 17411388346962916813440024576.0 | accuracy: 0.68
step_num: 15600 | loss: 0.4899 | profit rate: 11010724538257505367773158983073792.0 | accuracy: 0.69
step_num: 15800 | loss: 0.5352 | profit rate: 6547560595965725900359255043109552128.0 | accuracy: 0.69
step_num: 16000 | loss: 0.5185 | profit rate: 8563455287538110520254224939348171685888.0 | accuracy: 0.69
step_num: 16200 | loss: 0.5784 | profit rate: 1393431091009193539460829891586249259642519552.0 | accuracy: 0.69
step_num: 16400 | loss: 0.4534 | profit rate: 1756511933500143929964290832737732671494885444943872.0 | accuracy: 0.69
step_num: 16600 | loss: 0.4533 | profit rate: 209127888217213827315378199123427995847883501427912343552.0 | accuracy: 0.69
step_num: 16800 | loss: 0.5121 | profit rate: 2431938706112612846490964452790853460932563626731319637049344.0 | accuracy: 0.68
step_num: 17000 | loss: 0.5959 | profit rate: 52333091580059958984285041520521178771590094995069830818340798464.0 | accuracy: 0.68
step_num: 17200 | loss: 0.5846 | profit rate: 9888749037786576824766463743527160602804164235888724680711711580225536.0 | accuracy: 0.68
step_num: 17400 | loss: 0.6111 | profit rate: 9547252276823012942010744517857806845501884416694629820402623485887643648.0 | accuracy: 0.68
episode:   5/5,耗时:2.35分/10.50分,训练集: | step: 17590 | average_treward: 2399.2 | max_treward: 2579.5594 | average profit rate: 17781603052744985249278712729770924178415147839742655677467759687848674983936.000
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 13%|        | 53/401 [00:00<00:00, 523.14it/s] 29%|       | 117/401 [00:00<00:00, 588.07it/s] 46%|     | 183/401 [00:00<00:00, 615.13it/s] 62%|   | 249/401 [00:00<00:00, 630.20it/s] 79%|  | 316/401 [00:00<00:00, 639.87it/s] 95%|| 382/401 [00:00<00:00, 644.32it/s]100%|| 401/401 [00:00<00:00, 627.17it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2503.60
2023-07-24T12:00:00 | net performance [%] = 150.3603
2023-07-24T12:00:00 | number of trades [#] = 48
==================================================
Trial 38 Complete [00h 10m 50s]
net_wealth: 2503.603496428796

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 05h 55m 41s

Search: Running Trial #39

Value             |Best Value So Far |Hyperparameter
10                |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
5                 |3                 |lags
0.85              |0.5               |gamma
1e-05             |0.001             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4291.000000   4301.000000
mean      0.000435    20113.607657  ...   20206.045010  20169.373185
std       0.027833    16040.642334  ...   16079.329741  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7763.510010   7730.930176
50%       0.000642    11571.842969  ...   11760.809570  11751.469727
75%       0.011590    29894.706152  ...   30037.855469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 1.0620 | profit rate:    4.3 | accuracy: 0.34
step_num: 800 | loss: 1.0015 | profit rate:   50.5 | accuracy: 0.35
step_num: 1000 | loss: 0.8609 | profit rate:  450.3 | accuracy: 0.36
step_num: 1200 | loss: 0.7113 | profit rate: 1647.7 | accuracy: 0.35
step_num: 1400 | loss: 0.6511 | profit rate: 2212.3 | accuracy: 0.34
step_num: 1600 | loss: 0.5614 | profit rate: 11704.4 | accuracy: 0.35
step_num: 1800 | loss: 0.5752 | profit rate: 66420.2 | accuracy: 0.36
step_num: 2000 | loss: 0.5598 | profit rate: 238241.1 | accuracy: 0.36
step_num: 2200 | loss: 0.5658 | profit rate: 807445694.7 | accuracy: 0.39
step_num: 2400 | loss: 0.6150 | profit rate: 1923136420678.5 | accuracy: 0.40
step_num: 2600 | loss: 0.6150 | profit rate: 14429832427896.0 | accuracy: 0.41
step_num: 2800 | loss: 0.6410 | profit rate: 22947795120718044.0 | accuracy: 0.42
step_num: 3000 | loss: 0.6638 | profit rate: 674175599971804928.0 | accuracy: 0.43
step_num: 3200 | loss: 0.6205 | profit rate: 158365675008361201664.0 | accuracy: 0.44
step_num: 3400 | loss: 0.6714 | profit rate: 515110112392706984509440.0 | accuracy: 0.45
step_num: 3600 | loss: 0.6169 | profit rate: 32874994285456131675389952.0 | accuracy: 0.46
episode:   1/5,耗时:2.95分/2.95分,训练集: | step: 3663 | average_treward:  877.3 | max_treward: 877.2828 | average profit rate: 44456709891545055780405248.000
model saved @ step:3663,performance:44456709891545055780405248.000,accuracy:0.46
step_num: 3800 | loss: 0.6744 | profit rate: 1993.8 | accuracy: 0.49
step_num: 4000 | loss: 0.6745 | profit rate: 10501847.5 | accuracy: 0.56
step_num: 4200 | loss: 0.6720 | profit rate: 1068893302.6 | accuracy: 0.57
step_num: 4400 | loss: 0.6391 | profit rate: 6187023865052.3 | accuracy: 0.60
step_num: 4600 | loss: 0.6456 | profit rate: 783478099146915.9 | accuracy: 0.61
step_num: 4800 | loss: 0.6885 | profit rate: 13580640150909532160.0 | accuracy: 0.62
step_num: 5000 | loss: 0.6866 | profit rate: 10955858968722955829248.0 | accuracy: 0.62
step_num: 5200 | loss: 0.5742 | profit rate: 5061686305015581879828480.0 | accuracy: 0.63
step_num: 5400 | loss: 0.6324 | profit rate: 23184171111058974136462213120.0 | accuracy: 0.63
step_num: 5600 | loss: 0.6730 | profit rate: 1317933308401905829517721600000.0 | accuracy: 0.63
step_num: 5800 | loss: 0.6464 | profit rate: 205015662616616062563243895291904.0 | accuracy: 0.63
step_num: 6000 | loss: 0.6451 | profit rate: 24306844462571864057003437625582813184.0 | accuracy: 0.64
step_num: 6200 | loss: 0.6452 | profit rate: 57281043660145938732932785017559701258240.0 | accuracy: 0.63
step_num: 6400 | loss: 0.6872 | profit rate: 37710579225474311543561532871422684126248960.0 | accuracy: 0.64
step_num: 6600 | loss: 0.6853 | profit rate: 5655644079131620030409502423059099821369458688.0 | accuracy: 0.64
step_num: 6800 | loss: 0.7119 | profit rate: 14126493723053716201248998487680187043739292663808.0 | accuracy: 0.64
step_num: 7000 | loss: 0.6151 | profit rate: 98041358317367106691191021951033528720799489939472384.0 | accuracy: 0.64
step_num: 7200 | loss: 0.6019 | profit rate: 8055828409231516368197997125336454248739226334145806336.0 | accuracy: 0.64
model saved @ step:7326,performance:74613357249042007566011852058927955804164953610194518016.000,accuracy:0.64
step_num: 7400 | loss: 0.6017 | profit rate:  277.1 | accuracy: 0.55
step_num: 7600 | loss: 0.6798 | profit rate: 10262045.7 | accuracy: 0.63
step_num: 7800 | loss: 0.7046 | profit rate: 3222564772.7 | accuracy: 0.61
step_num: 8000 | loss: 0.6246 | profit rate: 1238332095148.5 | accuracy: 0.63
step_num: 8200 | loss: 0.6455 | profit rate: 755545324899154.0 | accuracy: 0.65
step_num: 8400 | loss: 0.6548 | profit rate: 2252998920177953024.0 | accuracy: 0.65
step_num: 8600 | loss: 0.6567 | profit rate: 67838851151611455078400.0 | accuracy: 0.66
step_num: 8800 | loss: 0.6227 | profit rate: 10486091129817396863303680.0 | accuracy: 0.66
step_num: 9000 | loss: 0.6690 | profit rate: 223454369356405589480105312256.0 | accuracy: 0.67
step_num: 9200 | loss: 0.6154 | profit rate: 5353103861501255318422843031552.0 | accuracy: 0.65
step_num: 9400 | loss: 0.6476 | profit rate: 1962267178775000435525268633812992.0 | accuracy: 0.66
step_num: 9600 | loss: 0.6414 | profit rate: 35105744820151687900033266901086896128.0 | accuracy: 0.67
step_num: 9800 | loss: 0.5990 | profit rate: 953435317234029497985599220400272896425984.0 | accuracy: 0.67
step_num: 10000 | loss: 0.5861 | profit rate: 7977416676212363113454931249533802634102702080.0 | accuracy: 0.67
step_num: 10200 | loss: 0.5977 | profit rate: 690886004888041656375400663368878086935625596928.0 | accuracy: 0.67
step_num: 10400 | loss: 0.6402 | profit rate: 1603204111381750305402716581966971845093588943765504.0 | accuracy: 0.67
step_num: 10600 | loss: 0.6249 | profit rate: 6875179523893044115831185589785880229836489081554468864.0 | accuracy: 0.67
step_num: 10800 | loss: 0.6472 | profit rate: 3003371649794058130680841659763325526991411364039002947584.0 | accuracy: 0.67
episode:   3/5,耗时:3.51分/9.97分,训练集: | step: 10989 | average_treward: 1644.4 | max_treward: 2090.5817 | average profit rate: 29114647039520944538510941958699457490036967242856994439168.000
model saved @ step:10989,performance:87269327761313790464618061169686207277368055804219598307328.000,accuracy:0.67
step_num: 11000 | loss: 0.6171 | profit rate:    1.7 | accuracy: 0.58
step_num: 11200 | loss: 0.6978 | profit rate: 2970198.2 | accuracy: 0.67
step_num: 11400 | loss: 0.6846 | profit rate: 2424681098.0 | accuracy: 0.65
step_num: 11600 | loss: 0.6757 | profit rate: 211207582960.9 | accuracy: 0.65
step_num: 11800 | loss: 0.6795 | profit rate: 1993257378854888.2 | accuracy: 0.67
step_num: 12000 | loss: 0.6464 | profit rate: 1649815568997856256.0 | accuracy: 0.65
step_num: 12200 | loss: 0.5744 | profit rate: 67406033564067524771840.0 | accuracy: 0.66
step_num: 12400 | loss: 0.5845 | profit rate: 40755081677679298714009600.0 | accuracy: 0.67
step_num: 12600 | loss: 0.5722 | profit rate: 58232413354529074223098363904.0 | accuracy: 0.67
step_num: 12800 | loss: 0.6127 | profit rate: 114973616380784237585217957658624.0 | accuracy: 0.66
step_num: 13000 | loss: 0.6133 | profit rate: 7024719967685452402901128205828096.0 | accuracy: 0.66
step_num: 13200 | loss: 0.6490 | profit rate: 66363860110339882531225607201317978112.0 | accuracy: 0.67
step_num: 13400 | loss: 0.6485 | profit rate: 2913435760375019954593167013722876501032960.0 | accuracy: 0.68
step_num: 13600 | loss: 0.5927 | profit rate: 47900766862550042374202222907456825780047183872.0 | accuracy: 0.68
step_num: 13800 | loss: 0.6346 | profit rate: 69084803709972903927269668519816545791389269491712.0 | accuracy: 0.68
step_num: 14000 | loss: 0.5915 | profit rate: 9164726683016701694149028902658359294640838808698880.0 | accuracy: 0.68
step_num: 14200 | loss: 0.6302 | profit rate: 9559943538101292151453439452228975324886429583552806912.0 | accuracy: 0.68
step_num: 14400 | loss: 0.6205 | profit rate: 72744341479506921588512492969759893061816499152791334289408.0 | accuracy: 0.68
step_num: 14600 | loss: 0.6419 | profit rate: 7235727410301291971289416227572637419344151332452614937772032.0 | accuracy: 0.68
model saved @ step:14652,performance:9081563977589699969436959780403177821653194563351025169727488.000,accuracy:0.68
step_num: 14800 | loss: 0.6438 | profit rate: 134154.6 | accuracy: 0.64
step_num: 15000 | loss: 0.6827 | profit rate: 243454195.6 | accuracy: 0.65
step_num: 15200 | loss: 0.7113 | profit rate: 86296170169.4 | accuracy: 0.65
step_num: 15400 | loss: 0.7181 | profit rate: 411763562015841.8 | accuracy: 0.66
step_num: 15600 | loss: 0.6466 | profit rate: 57904523911088552.0 | accuracy: 0.66
step_num: 15800 | loss: 0.6268 | profit rate: 3661153767240405876736.0 | accuracy: 0.67
step_num: 16000 | loss: 0.6231 | profit rate: 4150796705422263613128704.0 | accuracy: 0.67
step_num: 16200 | loss: 0.5953 | profit rate: 3535782009141993606867845120.0 | accuracy: 0.68
step_num: 16400 | loss: 0.5904 | profit rate: 89974667249809879907824197173248.0 | accuracy: 0.67
step_num: 16600 | loss: 0.5794 | profit rate: 4120048998139539738051077988155392.0 | accuracy: 0.67
step_num: 16800 | loss: 0.5902 | profit rate: 2928984862004945312317536825608503296.0 | accuracy: 0.68
step_num: 17000 | loss: 0.6081 | profit rate: 3257702715420111439784255213223392812466176.0 | accuracy: 0.68
step_num: 17200 | loss: 0.6356 | profit rate: 66786874257968345309798710904887532388666572800.0 | accuracy: 0.69
step_num: 17400 | loss: 0.6095 | profit rate: 18046465005639437593632615845056315370964995014656.0 | accuracy: 0.69
step_num: 17600 | loss: 0.5519 | profit rate: 3883235873960277510348224740705994440736670071390208.0 | accuracy: 0.68
step_num: 17800 | loss: 0.6139 | profit rate: 4322537852635055133234954963680523898841407157836972032.0 | accuracy: 0.68
step_num: 18000 | loss: 0.5856 | profit rate: 38655603172109567277271589464923322702259938085875484721152.0 | accuracy: 0.69
step_num: 18200 | loss: 0.6043 | profit rate: 2914788909755438655766818320213775075055935295036134258638848.0 | accuracy: 0.68
episode:   5/5,耗时:3.53分/17.02分,训练集: | step: 18315 | average_treward: 1847.5 | max_treward: 2169.3594 | average profit rate: 8568866400698766422531570939076172520963121609619607176347648.000
model saved @ step:18315,performance:33675424084785568841289712919958500438442218857402848103104512.000,accuracy:0.68
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 13%|        | 54/406 [00:00<00:00, 534.68it/s] 28%|       | 115/406 [00:00<00:00, 577.77it/s] 44%|     | 180/406 [00:00<00:00, 607.90it/s] 61%|    | 247/406 [00:00<00:00, 629.82it/s] 77%|  | 314/406 [00:00<00:00, 644.23it/s] 94%|| 380/406 [00:00<00:00, 649.57it/s]100%|| 406/406 [00:00<00:00, 629.16it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3498.01
2023-07-24T12:00:00 | net performance [%] = 249.8010
2023-07-24T12:00:00 | number of trades [#] = 86
==================================================
Trial 39 Complete [00h 17m 54s]
net_wealth: 3498.0101241751627

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 13m 36s

Search: Running Trial #40

Value             |Best Value So Far |Hyperparameter
11                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.8               |0.5               |gamma
5e-05             |0.001             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4290.000000   4301.000000
mean      0.000435    20113.607657  ...   20209.671704  20169.373185
std       0.027833    16040.642334  ...   16079.448796  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7766.127563   7730.930176
50%       0.000642    11571.842969  ...   11761.109863  11751.469727
75%       0.011590    29894.706152  ...   30046.502930  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.0869 | profit rate:    2.2 | accuracy: 0.38
step_num: 400 | loss: 1.1362 | profit rate:    3.7 | accuracy: 0.37
step_num: 600 | loss: 0.9487 | profit rate:   12.3 | accuracy: 0.35
step_num: 800 | loss: 0.8392 | profit rate:   25.5 | accuracy: 0.32
step_num: 1000 | loss: 0.5416 | profit rate:   23.1 | accuracy: 0.31
step_num: 1200 | loss: 0.7622 | profit rate: 2515.2 | accuracy: 0.33
step_num: 1400 | loss: 0.4448 | profit rate: 34119.2 | accuracy: 0.33
step_num: 1600 | loss: 0.2261 | profit rate: 44481.6 | accuracy: 0.30
step_num: 1800 | loss: 0.2127 | profit rate: 308693.9 | accuracy: 0.28
step_num: 2000 | loss: 0.2770 | profit rate: 632343.9 | accuracy: 0.27
step_num: 2200 | loss: 0.6373 | profit rate: 9126431.3 | accuracy: 0.28
step_num: 2400 | loss: 0.5879 | profit rate: 227074460.8 | accuracy: 0.29
step_num: 2600 | loss: 0.7558 | profit rate: 659424567.0 | accuracy: 0.31
step_num: 2800 | loss: 0.9904 | profit rate: 8717173140.5 | accuracy: 0.33
step_num: 3000 | loss: 0.8566 | profit rate: 224512815937.3 | accuracy: 0.35
episode:   1/5,耗时:0.86分/0.86分,训练集: | step: 3160 | average_treward:  410.4 | max_treward: 410.3520 | average profit rate: 1270463919653.473
model saved @ step:3160,performance:1270463919653.473,accuracy:0.35
step_num: 3200 | loss: 0.7310 | profit rate:    1.5 | accuracy: 0.49
step_num: 3400 | loss: 0.7762 | profit rate:  156.4 | accuracy: 0.50
step_num: 3600 | loss: 0.7550 | profit rate: 2945.0 | accuracy: 0.51
step_num: 3800 | loss: 0.8037 | profit rate: 4040778.7 | accuracy: 0.55
step_num: 4000 | loss: 0.6634 | profit rate: 393502207.4 | accuracy: 0.56
step_num: 4200 | loss: 0.6365 | profit rate: 9280274804.6 | accuracy: 0.57
step_num: 4400 | loss: 0.8032 | profit rate: 1033011001757539.8 | accuracy: 0.58
step_num: 4600 | loss: 0.6893 | profit rate: 11473497218756056.0 | accuracy: 0.58
step_num: 4800 | loss: 0.6528 | profit rate: 162061372504859104.0 | accuracy: 0.58
step_num: 5000 | loss: 0.8224 | profit rate: 16046287585725147774976.0 | accuracy: 0.59
step_num: 5200 | loss: 0.9172 | profit rate: 6148367804406006022144.0 | accuracy: 0.58
step_num: 5400 | loss: 0.8166 | profit rate: 545778441939091269353472.0 | accuracy: 0.59
step_num: 5600 | loss: 0.7842 | profit rate: 7793867600066084018847744.0 | accuracy: 0.59
step_num: 5800 | loss: 0.7679 | profit rate: 280071068014610957759152128.0 | accuracy: 0.59
step_num: 6000 | loss: 0.7532 | profit rate: 75709990735158636475123236864.0 | accuracy: 0.59
step_num: 6200 | loss: 0.6931 | profit rate: 896223273712231711255629398016.0 | accuracy: 0.59
model saved @ step:6320,performance:4125864298495797272255987187712.000,accuracy:0.59
step_num: 6400 | loss: 0.5970 | profit rate:    1.0 | accuracy: 0.46
step_num: 6600 | loss: 0.6517 | profit rate:   92.8 | accuracy: 0.53
step_num: 6800 | loss: 0.6156 | profit rate: 3767.8 | accuracy: 0.57
step_num: 7000 | loss: 0.6748 | profit rate: 39219648.6 | accuracy: 0.59
step_num: 7200 | loss: 0.7170 | profit rate: 3021542646.8 | accuracy: 0.60
step_num: 7400 | loss: 0.5604 | profit rate: 104412612880.3 | accuracy: 0.60
step_num: 7600 | loss: 0.8297 | profit rate: 12820083880053784.0 | accuracy: 0.61
step_num: 7800 | loss: 0.5417 | profit rate: 209439889082912352.0 | accuracy: 0.61
step_num: 8000 | loss: 0.7037 | profit rate: 10616828454466025472.0 | accuracy: 0.61
step_num: 8200 | loss: 0.7862 | profit rate: 553135710465793768554496.0 | accuracy: 0.61
step_num: 8400 | loss: 0.7502 | profit rate: 772856412845972320681984.0 | accuracy: 0.61
step_num: 8600 | loss: 0.6667 | profit rate: 853557568964913768377090048.0 | accuracy: 0.61
step_num: 8800 | loss: 0.7069 | profit rate: 1593698745882827289366888448.0 | accuracy: 0.61
step_num: 9000 | loss: 0.7731 | profit rate: 33672427213655818944047480832.0 | accuracy: 0.61
step_num: 9200 | loss: 0.7027 | profit rate: 22846859322270866062082087845888.0 | accuracy: 0.61
step_num: 9400 | loss: 0.6657 | profit rate: 1032738354413659703738914803023872.0 | accuracy: 0.61
episode:   3/5,耗时:0.94分/2.77分,训练集: | step: 9480 | average_treward:  847.4 | max_treward: 1129.4000 | average profit rate: 448945348579669663779781540315136.000
model saved @ step:9480,performance:1342710181440513260495183137472512.000,accuracy:0.60
step_num: 9600 | loss: 0.6757 | profit rate:    1.2 | accuracy: 0.50
step_num: 9800 | loss: 0.7053 | profit rate:  196.2 | accuracy: 0.54
step_num: 10000 | loss: 0.6351 | profit rate: 117041.8 | accuracy: 0.60
step_num: 10200 | loss: 0.6991 | profit rate: 117025202.4 | accuracy: 0.60
step_num: 10400 | loss: 0.6156 | profit rate: 9926967378.2 | accuracy: 0.61
step_num: 10600 | loss: 0.7064 | profit rate: 34367961239153.8 | accuracy: 0.61
step_num: 10800 | loss: 0.8398 | profit rate: 13033647851192528.0 | accuracy: 0.62
step_num: 11000 | loss: 0.5780 | profit rate: 382534244169683840.0 | accuracy: 0.62
step_num: 11200 | loss: 0.6801 | profit rate: 610122398409137979392.0 | accuracy: 0.62
step_num: 11400 | loss: 0.7515 | profit rate: 585762035047990447570944.0 | accuracy: 0.62
step_num: 11600 | loss: 0.7270 | profit rate: 19258447468180528972169216.0 | accuracy: 0.62
step_num: 11800 | loss: 0.6267 | profit rate: 6868168040655239594003922944.0 | accuracy: 0.62
step_num: 12000 | loss: 0.6657 | profit rate: 40506821003701146597520834560.0 | accuracy: 0.62
step_num: 12200 | loss: 0.7655 | profit rate: 1930241699176404816354670018560.0 | accuracy: 0.62
step_num: 12400 | loss: 0.6785 | profit rate: 3744577159143826923409484552339456.0 | accuracy: 0.62
step_num: 12600 | loss: 0.6949 | profit rate: 11120381851053458601130288352329728.0 | accuracy: 0.62
model saved @ step:12640,performance:13150517211703038429466317251674112.000,accuracy:0.61
step_num: 12800 | loss: 0.6117 | profit rate:   15.3 | accuracy: 0.53
step_num: 13000 | loss: 0.6647 | profit rate:  326.1 | accuracy: 0.55
step_num: 13200 | loss: 0.5851 | profit rate: 119507.1 | accuracy: 0.58
step_num: 13400 | loss: 0.6142 | profit rate: 115429641.5 | accuracy: 0.59
step_num: 13600 | loss: 0.6254 | profit rate: 6342441758.5 | accuracy: 0.59
step_num: 13800 | loss: 0.7238 | profit rate: 130697397956968.1 | accuracy: 0.61
step_num: 14000 | loss: 0.6689 | profit rate: 5991682399386672.0 | accuracy: 0.61
step_num: 14200 | loss: 0.4689 | profit rate: 1026269269418358912.0 | accuracy: 0.62
step_num: 14400 | loss: 0.5742 | profit rate: 1261596726457652477952.0 | accuracy: 0.62
step_num: 14600 | loss: 0.7240 | profit rate: 577777990550105840680960.0 | accuracy: 0.62
step_num: 14800 | loss: 0.8221 | profit rate: 15831412853163264479068160.0 | accuracy: 0.61
step_num: 15000 | loss: 0.6127 | profit rate: 2171055318140838776072568832.0 | accuracy: 0.62
step_num: 15200 | loss: 0.7571 | profit rate: 16838533325140193541298847744.0 | accuracy: 0.61
step_num: 15400 | loss: 0.8964 | profit rate: 4792240847818844901473381253120.0 | accuracy: 0.61
step_num: 15600 | loss: 0.7542 | profit rate: 274728853397806583819573309472768.0 | accuracy: 0.62
episode:   5/5,耗时:0.97分/4.67分,训练集: | step: 15800 | average_treward:  988.6 | max_treward: 1207.8088 | average profit rate: 3193560603061175122735581951426560.000
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 52/408 [00:00<00:00, 515.32it/s] 28%|       | 113/408 [00:00<00:00, 564.19it/s] 43%|     | 174/408 [00:00<00:00, 584.93it/s] 58%|    | 237/408 [00:00<00:00, 597.94it/s] 74%|  | 300/408 [00:00<00:00, 609.40it/s] 89%| | 363/408 [00:00<00:00, 614.29it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 601.85it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 5019.59
2023-07-24T12:00:00 | net performance [%] = 401.9587
2023-07-24T12:00:00 | number of trades [#] = 104
==================================================
Trial 40 Complete [00h 05m 07s]
net_wealth: 5019.586839343135

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 18m 42s

Search: Running Trial #41

Value             |Best Value So Far |Hyperparameter
15                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.92              |0.5               |gamma
1e-05             |0.001             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4286.000000   4301.000000
mean      0.000435    20113.607657  ...   20224.573864  20169.373185
std       0.027833    16040.642334  ...   16079.545659  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7778.380005   7730.930176
50%       0.000642    11571.842969  ...   11768.989746  11751.469727
75%       0.011590    29894.706152  ...   30071.020508  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.0173 | profit rate:    2.0 | accuracy: 0.35
step_num: 400 | loss: 0.6866 | profit rate:    2.6 | accuracy: 0.35
step_num: 600 | loss: 0.6867 | profit rate:    5.1 | accuracy: 0.35
step_num: 800 | loss: 0.6831 | profit rate:  168.0 | accuracy: 0.37
step_num: 1000 | loss: 0.5739 | profit rate: 3388.4 | accuracy: 0.37
step_num: 1200 | loss: 0.7152 | profit rate: 7415687.0 | accuracy: 0.39
step_num: 1400 | loss: 0.5224 | profit rate: 453972706.1 | accuracy: 0.40
step_num: 1600 | loss: 0.4465 | profit rate: 171809836426.4 | accuracy: 0.41
step_num: 1800 | loss: 0.9258 | profit rate: 3826900323813266944.0 | accuracy: 0.44
step_num: 2000 | loss: 0.9989 | profit rate: 2966076298825274971127808.0 | accuracy: 0.47
step_num: 2200 | loss: 0.8883 | profit rate: 116335697263213277927308263424.0 | accuracy: 0.49
step_num: 2400 | loss: 0.7469 | profit rate: 11510058716401734857897727053791232.0 | accuracy: 0.51
step_num: 2600 | loss: 0.6998 | profit rate: 2320274137679227832983824603773568811008.0 | accuracy: 0.53
step_num: 2800 | loss: 0.7990 | profit rate: 1396909319071998249672962652536660026154024960.0 | accuracy: 0.55
step_num: 3000 | loss: 0.7669 | profit rate: 264029869029160533647237840562884163635687456768.0 | accuracy: 0.55
episode:   1/5,耗时:1.15分/1.15分,训练集: | step: 3143 | average_treward: 1595.6 | max_treward: 1595.5557 | average profit rate: 4003053475911096235817635223038582027514021937152.000
model saved @ step:3143,performance:4003053475911096235817635223038582027514021937152.000,accuracy:0.56
step_num: 3200 | loss: 0.5192 | profit rate:    3.4 | accuracy: 0.67
step_num: 3400 | loss: 0.6808 | profit rate: 5137978.5 | accuracy: 0.78
step_num: 3600 | loss: 0.5832 | profit rate: 7128554337.3 | accuracy: 0.78
step_num: 3800 | loss: 0.7491 | profit rate: 241850144712883648.0 | accuracy: 0.78
step_num: 4000 | loss: 0.6505 | profit rate: 17940631339512058871808.0 | accuracy: 0.77
step_num: 4200 | loss: 0.5737 | profit rate: 415010859506729152065568768.0 | accuracy: 0.78
step_num: 4400 | loss: 0.6910 | profit rate: 56955650099806384943090649379373056.0 | accuracy: 0.79
step_num: 4600 | loss: 0.5260 | profit rate: 45777246960468920905314463320687771648.0 | accuracy: 0.78
step_num: 4800 | loss: 0.4673 | profit rate: 5320287623543444669015811358594175980273664.0 | accuracy: 0.79
step_num: 5000 | loss: 0.7824 | profit rate: 187668217824395046084436028374108650873632286054547456.0 | accuracy: 0.80
step_num: 5200 | loss: 0.5345 | profit rate: 1494047543492232681917832672180681608102456523799980484329472.0 | accuracy: 0.81
step_num: 5400 | loss: 0.4931 | profit rate: 6643316568857794121510240962466233008660399447001664692010186964992.0 | accuracy: 0.82
step_num: 5600 | loss: 0.5581 | profit rate: 540957749496236148457102324855235084840928855170658056866452741115871232.0 | accuracy: 0.82
step_num: 5800 | loss: 0.5097 | profit rate: 224775264534467625247166808949500716513935612760384723214742064919706408583168.0 | accuracy: 0.82
step_num: 6000 | loss: 0.6463 | profit rate: 574322359825197887033656025944231200289532853411151180832200220067167748696985042944.0 | accuracy: 0.82
step_num: 6200 | loss: 0.7467 | profit rate: 27176069777020556096063358362772286221207510387511687680797017874052239490475065446760448.0 | accuracy: 0.82
model saved @ step:6286,performance:151820621551725760319646651745525982807078399333492695199340710518452988593904739185328128.000,accuracy:0.82
step_num: 6400 | loss: 0.6148 | profit rate:    5.2 | accuracy: 0.66
step_num: 6600 | loss: 0.4737 | profit rate: 56566891.0 | accuracy: 0.78
step_num: 6800 | loss: 0.5957 | profit rate: 17830441742969.3 | accuracy: 0.80
step_num: 7000 | loss: 0.6191 | profit rate: 1041774856494377992192.0 | accuracy: 0.82
step_num: 7200 | loss: 0.5526 | profit rate: 124549036408518769511497728.0 | accuracy: 0.82
step_num: 7400 | loss: 0.6030 | profit rate: 3770836541189907581493918035869696.0 | accuracy: 0.83
step_num: 7600 | loss: 0.6351 | profit rate: 361918368024033563710284266729709240320.0 | accuracy: 0.83
step_num: 7800 | loss: 0.3865 | profit rate: 1147451416959719276944154438319835615068160.0 | accuracy: 0.84
step_num: 8000 | loss: 0.3488 | profit rate: 379218790746797095372596601603033400498407233028096.0 | accuracy: 0.85
step_num: 8200 | loss: 0.4994 | profit rate: 45540137535080455951596170318283551757489688331183290580992.0 | accuracy: 0.85
step_num: 8400 | loss: 0.3980 | profit rate: 1784834751073298931304249988137661035823293046288462211761005658112.0 | accuracy: 0.85
step_num: 8600 | loss: 0.2617 | profit rate: 1228422420157931429793540615368201219247321545668141878279128146532892672.0 | accuracy: 0.85
step_num: 8800 | loss: 0.3577 | profit rate: 1051957218523533790932411826425364804407628645622856273530543681635770160906240.0 | accuracy: 0.86
step_num: 9000 | loss: 0.5339 | profit rate: 343909775914608053066581263109668733605033307962894898341126676282694604663837163520.0 | accuracy: 0.86
step_num: 9200 | loss: 0.5657 | profit rate: 353569421737661253533705205666330787894602191908731921485505832668689184257934669645873152.0 | accuracy: 0.85
step_num: 9400 | loss: 0.4883 | profit rate: 911511049235845962529317493117842318469234029237655250924841795178797542717819719662071447552.0 | accuracy: 0.85
episode:   3/5,耗时:1.35分/3.78分,训练集: | step: 9429 | average_treward: 2669.9 | max_treward: 3319.2643 | average profit rate: 556511696237864067641010937496571497493359781882645259036787810382363709753748767474731450368.000
model saved @ step:9429,performance:1669383268092040350713002433778559266879836734079409943673796558842275081425539783574796894208.000,accuracy:0.85
step_num: 9600 | loss: 0.5248 | profit rate: 5187.8 | accuracy: 0.69
step_num: 9800 | loss: 0.3787 | profit rate: 333629237.3 | accuracy: 0.78
step_num: 10000 | loss: 0.4707 | profit rate: 2946847378155104.0 | accuracy: 0.81
step_num: 10200 | loss: 0.3493 | profit rate: 32675464088649153380352.0 | accuracy: 0.82
step_num: 10400 | loss: 0.4534 | profit rate: 203362297385131501248577536.0 | accuracy: 0.81
step_num: 10600 | loss: 0.5814 | profit rate: 61688914078955155132785041961123840.0 | accuracy: 0.82
step_num: 10800 | loss: 0.3656 | profit rate: 304577953598710963868932012727672504320.0 | accuracy: 0.83
step_num: 11000 | loss: 0.3536 | profit rate: 4989944912229414622031000054108626882658304.0 | accuracy: 0.83
step_num: 11200 | loss: 0.4740 | profit rate: 68902533483068406453400011369466358148030942540726272.0 | accuracy: 0.84
step_num: 11400 | loss: 0.3865 | profit rate: 8273499880584723171794359246179086925731353230801063022428160.0 | accuracy: 0.84
step_num: 11600 | loss: 0.4194 | profit rate: 13115218287221492824834339600332202628594337678020260510034712068096.0 | accuracy: 0.84
step_num: 11800 | loss: 0.3685 | profit rate: 9233126009876952376225590424295179122634056995293042775582059279704653824.0 | accuracy: 0.84
step_num: 12000 | loss: 0.2604 | profit rate: 4688141377405539956049230415454704547634181695453478870955515327160978384093184.0 | accuracy: 0.84
step_num: 12200 | loss: 0.4411 | profit rate: 58504593494215230735701951366963328441751912569040850436206550192337062340548750213120.0 | accuracy: 0.85
step_num: 12400 | loss: 0.4616 | profit rate: 485520892018509858447993717081893292826269122735237846440697822029489758081429022378557440.0 | accuracy: 0.84
step_num: 12600 | loss: 0.3799 | profit rate:    2.1 | accuracy: 0.62
step_num: 12800 | loss: 0.3748 | profit rate: 1924366.3 | accuracy: 0.76
step_num: 13000 | loss: 0.2938 | profit rate: 16865642218.5 | accuracy: 0.81
step_num: 13200 | loss: 0.4721 | profit rate: 586457833033067008.0 | accuracy: 0.80
step_num: 13400 | loss: 0.4772 | profit rate: 149782645683491369385984.0 | accuracy: 0.82
step_num: 13600 | loss: 0.4869 | profit rate: 6495900835767816984058658816.0 | accuracy: 0.82
step_num: 13800 | loss: 0.5345 | profit rate: 2713762548919116913239684691733250048.0 | accuracy: 0.83
step_num: 14000 | loss: 0.3078 | profit rate: 6506329981660698616925572582414563147776.0 | accuracy: 0.83
step_num: 14200 | loss: 0.3267 | profit rate: 667194681066659304122005124688071510181543936.0 | accuracy: 0.84
step_num: 14400 | loss: 0.3993 | profit rate: 47675357260332813413251812197066491525247728545463009280.0 | accuracy: 0.85
step_num: 14600 | loss: 0.4260 | profit rate: 225079012490477756233690890497446120010008592602234831346073600.0 | accuracy: 0.84
step_num: 14800 | loss: 0.3120 | profit rate: 299528594546990743411968134137265923015021062451843133872605094739968.0 | accuracy: 0.85
step_num: 15000 | loss: 0.2652 | profit rate: 246263724741782113604829877068446583734579807516478049469795515469202980864.0 | accuracy: 0.85
step_num: 15200 | loss: 0.3222 | profit rate: 509900641122731006490138602175253669363620339064694981127732327074981999533883392.0 | accuracy: 0.85
step_num: 15400 | loss: 0.3820 | profit rate: 1321331658990305351447147694029581631188966281971410837765523408287060788778742736486400.0 | accuracy: 0.85
step_num: 15600 | loss: 0.4805 | profit rate: 2994936661245336237415856322180942375930236618964778464558925851673228221365467002802536448.0 | accuracy: 0.84
episode:   5/5,耗时:1.27分/6.31分,训练集: | step: 15715 | average_treward: 2913.4 | max_treward: 3319.2643 | average profit rate: 470130792371238656704507731425302536449788688010525246703606139305137683735444712601004539904.000
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 50/391 [00:00<00:00, 499.99it/s] 29%|       | 113/391 [00:00<00:00, 573.10it/s] 46%|     | 179/391 [00:00<00:00, 608.45it/s] 63%|   | 246/391 [00:00<00:00, 630.13it/s] 80%|  | 312/391 [00:00<00:00, 640.83it/s] 97%|| 379/391 [00:00<00:00, 646.33it/s]==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
100%|| 391/391 [00:00<00:00, 626.08it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2057.17
2023-07-24T12:00:00 | net performance [%] = 105.7173
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 41 Complete [00h 06m 27s]
net_wealth: 2057.173266898447

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 25m 10s

Search: Running Trial #42

Value             |Best Value So Far |Hyperparameter
8                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
8                 |3                 |lags
0.5               |0.5               |gamma
0.0005            |0.001             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4293.000000   4301.000000
mean      0.000435    20113.607657  ...   20198.799136  20169.373185
std       0.027833    16040.642334  ...   16079.087003  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7760.089844   7730.930176
50%       0.000642    11571.842969  ...   11760.540039  11751.469727
75%       0.011590    29894.706152  ...   30020.560547  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.4924 | profit rate:    0.8 | accuracy: 0.32
step_num: 400 | loss: 0.2557 | profit rate:    1.0 | accuracy: 0.35
step_num: 600 | loss: 0.1723 | profit rate:   28.7 | accuracy: 0.41
step_num: 800 | loss: 0.1840 | profit rate:  924.1 | accuracy: 0.43
step_num: 1000 | loss: 0.1838 | profit rate: 81714.4 | accuracy: 0.47
step_num: 1200 | loss: 0.1776 | profit rate: 79348289.6 | accuracy: 0.49
step_num: 1400 | loss: 0.1988 | profit rate: 29609644576.7 | accuracy: 0.51
step_num: 1600 | loss: 0.1744 | profit rate: 3197777882373.3 | accuracy: 0.53
step_num: 1800 | loss: 0.1755 | profit rate: 178691199573479712.0 | accuracy: 0.56
step_num: 2000 | loss: 0.1966 | profit rate: 23458720777943773184.0 | accuracy: 0.57
step_num: 2200 | loss: 0.1961 | profit rate: 92011009902633837133824.0 | accuracy: 0.59
step_num: 2400 | loss: 0.1534 | profit rate: 90929854862573889264694591488.0 | accuracy: 0.61
step_num: 2600 | loss: 0.2026 | profit rate: 4429051069489686529900537993756672.0 | accuracy: 0.63
step_num: 2800 | loss: 0.2178 | profit rate: 168770579102825024478527695820515442688.0 | accuracy: 0.64
step_num: 3000 | loss: 0.2229 | profit rate: 324296140389145150213964549726352330194944.0 | accuracy: 0.65
step_num: 3200 | loss: 0.1369 | profit rate: 8705480593076054411832584956759042568646295552.0 | accuracy: 0.66
step_num: 3400 | loss: 0.1640 | profit rate: 252580652620769613786616865550115744395183706341376.0 | accuracy: 0.67
step_num: 3600 | loss: 0.1906 | profit rate: 186084020026977977307344622373311582658558694497714176.0 | accuracy: 0.68
episode:   1/5,耗时:1.32分/1.32分,训练集: | step: 3660 | average_treward: 2409.4 | max_treward: 2409.4029 | average profit rate: 423576131995979255864555715058640260234774191997452288.000
model saved @ step:3660,performance:423576131995979255864555715058640260234774191997452288.000,accuracy:0.68
step_num: 3800 | loss: 0.2543 | profit rate: 1644604.5 | accuracy: 0.87
step_num: 4000 | loss: 0.2555 | profit rate: 179071207678.4 | accuracy: 0.86
step_num: 4200 | loss: 0.1725 | profit rate: 2630641772413983.5 | accuracy: 0.87
step_num: 4400 | loss: 0.1946 | profit rate: 61623469893113823232.0 | accuracy: 0.86
step_num: 4600 | loss: 0.1891 | profit rate: 23050264930278619217920.0 | accuracy: 0.85
step_num: 4800 | loss: 0.1834 | profit rate: 7761245305433884371850362880.0 | accuracy: 0.85
step_num: 5000 | loss: 0.1931 | profit rate: 230609688995814740587839597051904.0 | accuracy: 0.85
step_num: 5200 | loss: 0.1643 | profit rate: 317144435083270143593001003270537216.0 | accuracy: 0.85
step_num: 5400 | loss: 0.1400 | profit rate: 406178404512516138820556282135503762882560.0 | accuracy: 0.86
step_num: 5600 | loss: 0.1762 | profit rate: 63172223630373481356738923524364897718632448.0 | accuracy: 0.85
step_num: 5800 | loss: 0.2187 | profit rate: 112886122058715679867383579536287073327728558080.0 | accuracy: 0.85
step_num: 6000 | loss: 0.1302 | profit rate: 516731003560464370408995522632263051610961849465438208.0 | accuracy: 0.85
step_num: 6200 | loss: 0.1858 | profit rate: 35781620944929876126849664823521803266141469536594708922368.0 | accuracy: 0.85
step_num: 6400 | loss: 0.1939 | profit rate: 483940262577554713859657875848096503639707586666888249129041920.0 | accuracy: 0.85
step_num: 6600 | loss: 0.1830 | profit rate: 3475903231349416782618235747249522444756366188007549937725630054400.0 | accuracy: 0.85
step_num: 6800 | loss: 0.0770 | profit rate: 92706487508209332791871929506132119604653726310164114996421643863064576.0 | accuracy: 0.85
step_num: 7000 | loss: 0.1376 | profit rate: 6493281988436173344703532679404431344048537991877910737458693191296654245888.0 | accuracy: 0.85
step_num: 7200 | loss: 0.1729 | profit rate: 6000587421255940520197514910837730727581813587095113663397438147029217048526848.0 | accuracy: 0.85
model saved @ step:7320,performance:221599981848315496521325346337953888032270673111038892353169598085967138284109824.000,accuracy:0.85
step_num: 7400 | loss: 0.2083 | profit rate: 2727.0 | accuracy: 0.81
step_num: 7600 | loss: 0.2090 | profit rate: 3931952341.6 | accuracy: 0.84
step_num: 7800 | loss: 0.1663 | profit rate: 52646645077439.6 | accuracy: 0.84
step_num: 8000 | loss: 0.2019 | profit rate: 264570713659911360.0 | accuracy: 0.83
step_num: 8200 | loss: 0.1843 | profit rate: 425497528439422713856.0 | accuracy: 0.83
step_num: 8400 | loss: 0.2066 | profit rate: 6269676794762855853326336.0 | accuracy: 0.83
step_num: 8600 | loss: 0.1690 | profit rate: 2139472539900442898421172404224.0 | accuracy: 0.83
step_num: 8800 | loss: 0.1359 | profit rate: 3463788407046310888515176572649472.0 | accuracy: 0.84
step_num: 9000 | loss: 0.1285 | profit rate: 853331790810132230026708190622243618816.0 | accuracy: 0.84
step_num: 9200 | loss: 0.1491 | profit rate: 857728032454692500142342834974412131794944.0 | accuracy: 0.84
step_num: 9400 | loss: 0.1679 | profit rate: 448558378653909988607106325571637843077365760.0 | accuracy: 0.83
step_num: 9600 | loss: 0.1322 | profit rate: 1144849273904255301821699466211889179982612131741696.0 | accuracy: 0.84
step_num: 9800 | loss: 0.1754 | profit rate: 746055338124273921696873894725298838362984740200030142464.0 | accuracy: 0.84
step_num: 10000 | loss: 0.1607 | profit rate: 11357815053727017988192804920233412736038011570014660350443520.0 | accuracy: 0.84
step_num: 10200 | loss: 0.2056 | profit rate: 142907053433904481951432606861815137975942421269781305754547912704.0 | accuracy: 0.84
step_num: 10400 | loss: 0.1617 | profit rate: 1904541331401653394828782728703604924394491959197022461120254719295488.0 | accuracy: 0.84
step_num: 10600 | loss: 0.1416 | profit rate: 61521811918470971336478028911720434511597997117203962648048349785851166720.0 | accuracy: 0.84
step_num: 10800 | loss: 0.1606 | profit rate: 303731519110947045344902363973606241530832220305477700823534019937664950599680.0 | accuracy: 0.84
episode:   3/5,耗时:2.36分/5.11分,训练集: | step: 10980 | average_treward: 3196.1 | max_treward: 3604.0126 | average profit rate: 88326868085774815485789996767963545124102844269916073984484031362592502880141312.000
step_num: 11000 | loss: 0.1832 | profit rate:    4.2 | accuracy: 0.67
step_num: 11200 | loss: 0.1164 | profit rate: 880390917.8 | accuracy: 0.88
step_num: 11400 | loss: 0.1848 | profit rate: 10392886454987.1 | accuracy: 0.87
step_num: 11600 | loss: 0.1677 | profit rate: 8934199709840830.0 | accuracy: 0.86
step_num: 11800 | loss: 0.1535 | profit rate: 328108586786683224064.0 | accuracy: 0.85
step_num: 12000 | loss: 0.2104 | profit rate: 1030513296793515530911744.0 | accuracy: 0.85
step_num: 12200 | loss: 0.1244 | profit rate: 423371326033057429529229787136.0 | accuracy: 0.85
step_num: 12400 | loss: 0.1489 | profit rate: 2788911808805046095009487469412352.0 | accuracy: 0.85
step_num: 12600 | loss: 0.1400 | profit rate: 69980873997010763282933561732255186944.0 | accuracy: 0.85
step_num: 12800 | loss: 0.1101 | profit rate: 1122216142005806016501951696703501696499712.0 | accuracy: 0.85
step_num: 13000 | loss: 0.1806 | profit rate: 292162301421514260539486998979789348656906240.0 | accuracy: 0.85
step_num: 13200 | loss: 0.1226 | profit rate: 38848245822363311460745849297841338833391860056064.0 | accuracy: 0.84
step_num: 13400 | loss: 0.1116 | profit rate: 10307618429097843072443956686708354048856797969897226240.0 | accuracy: 0.84
step_num: 13600 | loss: 0.1728 | profit rate: 1265608265080739309509163316074330184870674795260823608492032.0 | accuracy: 0.84
step_num: 13800 | loss: 0.2092 | profit rate: 10671484097750373819691537480899691516726428877484435101085335552.0 | accuracy: 0.84
step_num: 14000 | loss: 0.1794 | profit rate: 108762513767607819757290346646117997165921082910494903945326296563712.0 | accuracy: 0.84
step_num: 14200 | loss: 0.0970 | profit rate: 1520775432151833222861621874440501735839545120454659641681649849736364032.0 | accuracy: 0.84
step_num: 14400 | loss: 0.1413 | profit rate: 42776817828925040266875895549129618711038360844510227017485458482300547235840.0 | accuracy: 0.84
step_num: 14600 | loss: 0.1380 | profit rate: 27047361259182574163480604316239876085148732073397639959286723269696437239152640.0 | accuracy: 0.84
step_num: 14800 | loss: 0.1638 | profit rate: 14048377.7 | accuracy: 0.88
step_num: 15000 | loss: 0.1558 | profit rate: 463718470787.5 | accuracy: 0.86
step_num: 15200 | loss: 0.1038 | profit rate: 3011654225798561.0 | accuracy: 0.86
step_num: 15400 | loss: 0.1068 | profit rate: 59237977641865854976.0 | accuracy: 0.83
step_num: 15600 | loss: 0.1548 | profit rate: 15780779517255541063680.0 | accuracy: 0.83
step_num: 15800 | loss: 0.1568 | profit rate: 9045945907747260167104757760.0 | accuracy: 0.83
step_num: 16000 | loss: 0.1657 | profit rate: 155151202939356633922471251148800.0 | accuracy: 0.84
step_num: 16200 | loss: 0.1506 | profit rate: 322752756997587111815471919091679232.0 | accuracy: 0.84
step_num: 16400 | loss: 0.1217 | profit rate: 522571691139241818563858183208559267807232.0 | accuracy: 0.85
step_num: 16600 | loss: 0.1826 | profit rate: 61557720184689357878562634355985154932998144.0 | accuracy: 0.84
step_num: 16800 | loss: 0.1777 | profit rate: 171810912507274990433618482115502482088429355008.0 | accuracy: 0.84
step_num: 17000 | loss: 0.0980 | profit rate: 1925059650655077582611664375741833319406239765810380800.0 | accuracy: 0.85
step_num: 17200 | loss: 0.1203 | profit rate: 137714804089732520724962292501123024935235726866123673567232.0 | accuracy: 0.84
step_num: 17400 | loss: 0.1666 | profit rate: 2592365539632346996316273298772074341930205626936790344976564224.0 | accuracy: 0.84
step_num: 17600 | loss: 0.1168 | profit rate: 6175284899808715155686202361717994412363762090427532784810405658624.0 | accuracy: 0.84
step_num: 17800 | loss: 0.0836 | profit rate: 152998825079053274557450202164942091781807038300312566819713954877538304.0 | accuracy: 0.84
step_num: 18000 | loss: 0.1295 | profit rate: 14867186899497307033999271405900876399403896762229285506335597537100222693376.0 | accuracy: 0.85
step_num: 18200 | loss: 0.1005 | profit rate: 42397157259702801005886745035146916309424342726715549878015124808208985989578752.0 | accuracy: 0.84
episode:   5/5,耗时:2.35分/9.83分,训练集: | step: 18300 | average_treward: 3354.4 | max_treward: 3604.0126 | average profit rate: 107284863261961643797500333467513369707197526934311255846161645767459688901771264.000
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 51/403 [00:00<00:00, 500.54it/s] 28%|       | 112/403 [00:00<00:00, 561.16it/s] 44%|     | 176/403 [00:00<00:00, 593.05it/s] 60%|    | 240/403 [00:00<00:00, 609.05it/s] 76%|  | 305/403 [00:00<00:00, 621.48it/s] 92%|| 371/403 [00:00<00:00, 632.34it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 612.17it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3156.83
2023-07-24T12:00:00 | net performance [%] = 215.6826
2023-07-24T12:00:00 | number of trades [#] = 52
==================================================
Trial 42 Complete [00h 10m 50s]
net_wealth: 3156.8262883500843

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 36m 00s

Search: Running Trial #43

Value             |Best Value So Far |Hyperparameter
1                 |1                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
8                 |3                 |lags
0.5               |0.5               |gamma
0.0001            |0.001             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4314.000000   4315.000000
mean      0.000441    20062.255222  ...   20122.295285  20118.633889
std       0.027818    16039.874230  ...   16077.162832  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7691.585083   7690.540039
50%       0.000642    11554.824463  ...   11724.320312  11715.610352
75%       0.011655    29873.081836  ...   29925.802734  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.5128 | profit rate:    1.0 | accuracy: 0.34
step_num: 400 | loss: 0.3881 | profit rate:    1.4 | accuracy: 0.34
step_num: 600 | loss: 1.2624 | profit rate:    2.0 | accuracy: 0.33
step_num: 800 | loss: 0.4634 | profit rate:    3.0 | accuracy: 0.34
step_num: 1000 | loss: 0.7856 | profit rate:    3.5 | accuracy: 0.35
step_num: 1200 | loss: 0.3801 | profit rate:   14.4 | accuracy: 0.37
step_num: 1400 | loss: 0.3918 | profit rate:   35.6 | accuracy: 0.37
step_num: 1600 | loss: 0.3944 | profit rate:  173.6 | accuracy: 0.38
step_num: 1800 | loss: 0.5050 | profit rate:  502.9 | accuracy: 0.40
step_num: 2000 | loss: 0.4677 | profit rate: 1689.6 | accuracy: 0.42
step_num: 2200 | loss: 0.4819 | profit rate: 45493.2 | accuracy: 0.44
step_num: 2400 | loss: 0.2972 | profit rate: 651022.7 | accuracy: 0.45
step_num: 2600 | loss: 0.4844 | profit rate: 4057279.7 | accuracy: 0.45
step_num: 2800 | loss: 0.3661 | profit rate: 33813595.5 | accuracy: 0.47
step_num: 3000 | loss: 0.3078 | profit rate: 175523132.0 | accuracy: 0.46
step_num: 3200 | loss: 0.2338 | profit rate: 600699305.3 | accuracy: 0.46
step_num: 3400 | loss: 0.3676 | profit rate: 1733841747.3 | accuracy: 0.46
episode:   1/5,耗时:0.77分/0.77分,训练集: | step: 3534 | average_treward:  853.5 | max_treward: 853.5443 | average profit rate: 3272624544.657
model saved @ step:3534,performance:3272624544.657,accuracy:0.46
step_num: 3600 | loss: 0.4869 | profit rate:    3.2 | accuracy: 0.72
step_num: 3800 | loss: 0.4325 | profit rate:   34.5 | accuracy: 0.69
step_num: 4000 | loss: 0.3834 | profit rate:  193.7 | accuracy: 0.67
step_num: 4200 | loss: 0.2561 | profit rate:  866.0 | accuracy: 0.61
step_num: 4400 | loss: 0.3522 | profit rate: 2777.1 | accuracy: 0.62
step_num: 4600 | loss: 0.3188 | profit rate: 79212.7 | accuracy: 0.63
step_num: 4800 | loss: 0.3583 | profit rate: 701118.1 | accuracy: 0.63
step_num: 5000 | loss: 0.2672 | profit rate: 4646165.0 | accuracy: 0.64
step_num: 5200 | loss: 0.3140 | profit rate: 112296244.7 | accuracy: 0.64
step_num: 5400 | loss: 0.3882 | profit rate: 454011756.4 | accuracy: 0.64
step_num: 5600 | loss: 0.4538 | profit rate: 5695687929.6 | accuracy: 0.65
step_num: 5800 | loss: 0.2917 | profit rate: 331434909339.8 | accuracy: 0.66
step_num: 6000 | loss: 0.3607 | profit rate: 14764902502107.9 | accuracy: 0.67
step_num: 6200 | loss: 0.2576 | profit rate: 346548070708768.5 | accuracy: 0.68
step_num: 6400 | loss: 0.2401 | profit rate: 6009303736046613.0 | accuracy: 0.69
step_num: 6600 | loss: 0.2504 | profit rate: 91890335640691120.0 | accuracy: 0.69
step_num: 6800 | loss: 0.1930 | profit rate: 3706494395533126656.0 | accuracy: 0.70
step_num: 7000 | loss: 0.1324 | profit rate: 47180683959848001536.0 | accuracy: 0.71
model saved @ step:7068,performance:71116299245402251264.000,accuracy:0.70
step_num: 7200 | loss: 0.0894 | profit rate:   19.2 | accuracy: 0.89
step_num: 7400 | loss: 0.2966 | profit rate:  344.1 | accuracy: 0.82
step_num: 7600 | loss: 0.2681 | profit rate: 2563.4 | accuracy: 0.81
step_num: 7800 | loss: 0.2156 | profit rate: 50894.9 | accuracy: 0.80
step_num: 8000 | loss: 0.2092 | profit rate: 596450.7 | accuracy: 0.81
step_num: 8200 | loss: 0.1730 | profit rate: 31086243.4 | accuracy: 0.82
step_num: 8400 | loss: 0.1365 | profit rate: 402499853.4 | accuracy: 0.81
step_num: 8600 | loss: 0.2823 | profit rate: 19747537109.7 | accuracy: 0.81
step_num: 8800 | loss: 0.1363 | profit rate: 256880599143.0 | accuracy: 0.81
step_num: 9000 | loss: 0.0845 | profit rate: 1731325321575.9 | accuracy: 0.81
step_num: 9200 | loss: 0.1174 | profit rate: 115169269311094.4 | accuracy: 0.82
step_num: 9400 | loss: 0.1638 | profit rate: 8597978728776186.0 | accuracy: 0.82
step_num: 9600 | loss: 0.1327 | profit rate: 994027229336600064.0 | accuracy: 0.83
step_num: 9800 | loss: 0.1386 | profit rate: 28798175690122694656.0 | accuracy: 0.83
step_num: 10000 | loss: 0.1548 | profit rate: 991659107274736140288.0 | accuracy: 0.83
step_num: 10200 | loss: 0.1657 | profit rate: 26578238246740199211008.0 | accuracy: 0.84
step_num: 10400 | loss: 0.1293 | profit rate: 955586185175000099586048.0 | accuracy: 0.84
step_num: 10600 | loss: 0.1652 | profit rate: 8555738987553543900102656.0 | accuracy: 0.84
episode:   3/5,耗时:0.86分/2.48分,训练集: | step: 10602 | average_treward: 1950.7 | max_treward: 2916.0432 | average profit rate: 2851936701284263869284352.000
model saved @ step:10602,performance:8555738987553543900102656.000,accuracy:0.84
step_num: 10800 | loss: 0.1068 | profit rate:   60.2 | accuracy: 0.89
step_num: 11000 | loss: 0.1585 | profit rate: 1330.7 | accuracy: 0.88
step_num: 11200 | loss: 0.1741 | profit rate: 18844.7 | accuracy: 0.86
step_num: 11400 | loss: 0.0952 | profit rate: 125402.9 | accuracy: 0.86
step_num: 11600 | loss: 0.1626 | profit rate: 5822749.4 | accuracy: 0.87
step_num: 11800 | loss: 0.1022 | profit rate: 139828540.2 | accuracy: 0.87
step_num: 12000 | loss: 0.0816 | profit rate: 1767105679.9 | accuracy: 0.86
step_num: 12200 | loss: 0.1352 | profit rate: 125021595831.6 | accuracy: 0.86
step_num: 12400 | loss: 0.1348 | profit rate: 1292127626756.9 | accuracy: 0.86
step_num: 12600 | loss: 0.0893 | profit rate: 14761596917776.9 | accuracy: 0.86
step_num: 12800 | loss: 0.1823 | profit rate: 2238961417944045.0 | accuracy: 0.87
step_num: 13000 | loss: 0.0981 | profit rate: 265956177360438240.0 | accuracy: 0.87
step_num: 13200 | loss: 0.2037 | profit rate: 13861675538559340544.0 | accuracy: 0.87
step_num: 13400 | loss: 0.1047 | profit rate: 465002333055400869888.0 | accuracy: 0.88
step_num: 13600 | loss: 0.1850 | profit rate: 13581033313464567726080.0 | accuracy: 0.88
step_num: 13800 | loss: 0.1155 | profit rate: 675853326892269576388608.0 | accuracy: 0.88
step_num: 14000 | loss: 0.0946 | profit rate: 12033374634226965964390400.0 | accuracy: 0.88
model saved @ step:14136,performance:48127381904219654858997760.000,accuracy:0.88
step_num: 14200 | loss: 0.0630 | profit rate:    5.6 | accuracy: 0.94
step_num: 14400 | loss: 0.0457 | profit rate:  164.6 | accuracy: 0.91
step_num: 14600 | loss: 0.0911 | profit rate: 2486.8 | accuracy: 0.89
step_num: 14800 | loss: 0.0540 | profit rate: 52744.3 | accuracy: 0.89
step_num: 15000 | loss: 0.0763 | profit rate: 302820.1 | accuracy: 0.88
step_num: 15200 | loss: 0.1952 | profit rate: 27108372.5 | accuracy: 0.88
step_num: 15400 | loss: 0.1250 | profit rate: 345695372.2 | accuracy: 0.87
step_num: 15600 | loss: 0.1247 | profit rate: 4343331785.3 | accuracy: 0.87
step_num: 15800 | loss: 0.0458 | profit rate: 295346702198.6 | accuracy: 0.87
step_num: 16000 | loss: 0.0781 | profit rate: 2097997260118.0 | accuracy: 0.87
step_num: 16200 | loss: 0.1328 | profit rate: 36871280011007.6 | accuracy: 0.88
step_num: 16400 | loss: 0.1453 | profit rate: 6310188284582477.0 | accuracy: 0.88
step_num: 16600 | loss: 0.0881 | profit rate: 926498200667259136.0 | accuracy: 0.88
step_num: 16800 | loss: 0.1926 | profit rate: 32660372604089573376.0 | accuracy: 0.88
step_num: 17000 | loss: 0.0679 | profit rate: 1012329235013740920832.0 | accuracy: 0.88
step_num: 17200 | loss: 0.1462 | profit rate: 25907223487123344588800.0 | accuracy: 0.89
step_num: 17400 | loss: 0.0322 | profit rate: 1445181560119152173121536.0 | accuracy: 0.89
step_num: 17600 | loss: 0.0736 | profit rate: 20095330833744287194152960.0 | accuracy: 0.89
episode:   5/5,耗时:1.35分/4.70分,训练集: | step: 17670 | average_treward: 2461.1 | max_treward: 3251.6217 | average profit rate: 17714692963385439286198272.000
model saved @ step:17670,performance:31890272808854761238429696.000,accuracy:0.89
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 53/403 [00:00<00:00, 524.75it/s] 28%|       | 113/403 [00:00<00:00, 568.83it/s] 44%|     | 177/403 [00:00<00:00, 595.85it/s] 60%|    | 243/403 [00:00<00:00, 621.00it/s] 76%|  | 306/403 [00:00<00:00, 606.27it/s] 93%|| 374/403 [00:00<00:00, 628.95it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 613.28it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 8542.69
2023-07-24T12:00:00 | net performance [%] = 754.2694
2023-07-24T12:00:00 | number of trades [#] = 202
==================================================
Trial 43 Complete [00h 04m 48s]
net_wealth: 8551.24538636923

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 40m 49s

Search: Running Trial #44

Value             |Best Value So Far |Hyperparameter
6                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.85              |0.5               |gamma
1e-05             |0.001             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4295.000000   4301.000000
mean      0.000435    20113.607657  ...   20191.527960  20169.373185
std       0.027833    16040.642334  ...   16078.872271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7755.915039   7730.930176
50%       0.000642    11571.842969  ...   11757.219727  11751.469727
75%       0.011590    29894.706152  ...   30018.430664  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8180 | profit rate:    0.3 | accuracy: 0.29
step_num: 400 | loss: 0.9029 | profit rate:    0.6 | accuracy: 0.34
step_num: 600 | loss: 1.6905 | profit rate:    0.1 | accuracy: 0.34
step_num: 800 | loss: 1.1263 | profit rate:    0.5 | accuracy: 0.37
step_num: 1000 | loss: 1.5020 | profit rate:    0.7 | accuracy: 0.36
step_num: 1200 | loss: 0.9335 | profit rate:    1.4 | accuracy: 0.36
step_num: 1400 | loss: 1.0386 | profit rate:    6.4 | accuracy: 0.38
step_num: 1600 | loss: 0.8358 | profit rate:  343.2 | accuracy: 0.39
step_num: 1800 | loss: 0.3100 | profit rate:  432.4 | accuracy: 0.38
step_num: 2000 | loss: 1.4212 | profit rate:   71.2 | accuracy: 0.37
step_num: 2200 | loss: 0.5934 | profit rate:   17.6 | accuracy: 0.35
step_num: 2400 | loss: 0.9888 | profit rate:   68.6 | accuracy: 0.35
step_num: 2600 | loss: 0.6373 | profit rate:   79.0 | accuracy: 0.35
step_num: 2800 | loss: 0.6036 | profit rate:  356.1 | accuracy: 0.36
step_num: 3000 | loss: 0.9823 | profit rate: 3843.8 | accuracy: 0.37
step_num: 3200 | loss: 0.9266 | profit rate: 1451.3 | accuracy: 0.37
step_num: 3400 | loss: 0.9202 | profit rate:  527.6 | accuracy: 0.37
episode:   1/5,耗时:0.70分/0.70分,训练集: | step: 3525 | average_treward:   50.5 | max_treward: 50.5078 | average profit rate: 245.072
model saved @ step:3525,performance:245.072,accuracy:0.37
step_num: 3600 | loss: 0.7730 | profit rate:    9.3 | accuracy: 0.54
step_num: 3800 | loss: 0.7564 | profit rate:   41.2 | accuracy: 0.52
step_num: 4000 | loss: 0.7379 | profit rate:  103.4 | accuracy: 0.51
step_num: 4200 | loss: 0.7665 | profit rate:   25.2 | accuracy: 0.48
step_num: 4400 | loss: 0.3509 | profit rate:  109.2 | accuracy: 0.47
step_num: 4600 | loss: 0.4992 | profit rate:  128.3 | accuracy: 0.44
step_num: 4800 | loss: 0.6329 | profit rate:  571.5 | accuracy: 0.45
step_num: 5000 | loss: 0.4374 | profit rate: 4866.3 | accuracy: 0.44
step_num: 5200 | loss: 0.5016 | profit rate: 42479.8 | accuracy: 0.44
step_num: 5400 | loss: 0.4793 | profit rate: 66734.4 | accuracy: 0.43
step_num: 5600 | loss: 0.4222 | profit rate: 4129.0 | accuracy: 0.40
step_num: 5800 | loss: 0.6052 | profit rate: 1301.8 | accuracy: 0.38
step_num: 6000 | loss: 0.8110 | profit rate: 4373.0 | accuracy: 0.38
step_num: 6200 | loss: 0.4924 | profit rate: 19132.2 | accuracy: 0.39
step_num: 6400 | loss: 0.7460 | profit rate: 188379.8 | accuracy: 0.39
step_num: 6600 | loss: 1.0892 | profit rate: 333630.1 | accuracy: 0.40
step_num: 6800 | loss: 0.6834 | profit rate: 78047.6 | accuracy: 0.40
step_num: 7000 | loss: 0.8162 | profit rate: 23089.5 | accuracy: 0.40
model saved @ step:7050,performance:18499.777,accuracy:0.40
step_num: 7200 | loss: 0.6811 | profit rate:   26.4 | accuracy: 0.52
step_num: 7400 | loss: 0.7553 | profit rate:  339.3 | accuracy: 0.55
step_num: 7600 | loss: 0.9317 | profit rate:   72.5 | accuracy: 0.50
step_num: 7800 | loss: 0.7813 | profit rate:   83.8 | accuracy: 0.49
step_num: 8000 | loss: 0.6212 | profit rate:   65.8 | accuracy: 0.44
step_num: 8200 | loss: 0.5928 | profit rate:  650.9 | accuracy: 0.44
step_num: 8400 | loss: 0.6889 | profit rate:  754.8 | accuracy: 0.45
step_num: 8600 | loss: 0.7878 | profit rate: 97739.4 | accuracy: 0.45
step_num: 8800 | loss: 0.4955 | profit rate: 316368.7 | accuracy: 0.44
step_num: 9000 | loss: 0.3764 | profit rate: 157373.3 | accuracy: 0.42
step_num: 9200 | loss: 0.5074 | profit rate: 26246.1 | accuracy: 0.40
step_num: 9400 | loss: 0.5708 | profit rate: 165770.7 | accuracy: 0.39
step_num: 9600 | loss: 0.6078 | profit rate: 66415.2 | accuracy: 0.39
step_num: 9800 | loss: 0.5012 | profit rate: 298478.5 | accuracy: 0.39
step_num: 10000 | loss: 0.8613 | profit rate: 1783955.2 | accuracy: 0.40
step_num: 10200 | loss: 0.9255 | profit rate: 1875413.0 | accuracy: 0.40
step_num: 10400 | loss: 1.0782 | profit rate: 777158.5 | accuracy: 0.40
episode:   3/5,耗时:0.78分/2.28分,训练集: | step: 10575 | average_treward:  141.5 | max_treward: 206.7797 | average profit rate: 147362.592
model saved @ step:10575,performance:423342.926,accuracy:0.40
step_num: 10600 | loss: 0.5344 | profit rate:    3.5 | accuracy: 0.62
step_num: 10800 | loss: 0.6148 | profit rate:   25.8 | accuracy: 0.50
step_num: 11000 | loss: 0.8133 | profit rate:  476.5 | accuracy: 0.54
step_num: 11200 | loss: 0.9679 | profit rate:  108.2 | accuracy: 0.50
step_num: 11400 | loss: 0.5616 | profit rate:  480.2 | accuracy: 0.50
step_num: 11600 | loss: 0.6406 | profit rate:  334.8 | accuracy: 0.44
step_num: 11800 | loss: 0.5826 | profit rate:  487.1 | accuracy: 0.44
step_num: 12000 | loss: 0.4811 | profit rate: 3453.6 | accuracy: 0.45
step_num: 12200 | loss: 0.6515 | profit rate: 892712.8 | accuracy: 0.45
step_num: 12400 | loss: 0.2885 | profit rate: 1660511.7 | accuracy: 0.44
step_num: 12600 | loss: 0.4149 | profit rate: 267364.2 | accuracy: 0.42
step_num: 12800 | loss: 0.4741 | profit rate: 66873.7 | accuracy: 0.40
step_num: 13000 | loss: 0.8842 | profit rate: 243167.0 | accuracy: 0.39
step_num: 13200 | loss: 0.5874 | profit rate: 792569.5 | accuracy: 0.40
step_num: 13400 | loss: 0.5814 | profit rate: 2466404.8 | accuracy: 0.40
step_num: 13600 | loss: 0.5631 | profit rate: 24440813.6 | accuracy: 0.41
step_num: 13800 | loss: 0.9769 | profit rate: 10833371.6 | accuracy: 0.41
step_num: 14000 | loss: 0.6290 | profit rate: 3389234.6 | accuracy: 0.41
model saved @ step:14100,performance:2542589.330,accuracy:0.40
step_num: 14200 | loss: 0.7010 | profit rate:   32.5 | accuracy: 0.61
step_num: 14400 | loss: 0.6995 | profit rate:  148.7 | accuracy: 0.54
step_num: 14600 | loss: 0.7639 | profit rate:  417.2 | accuracy: 0.52
step_num: 14800 | loss: 0.6077 | profit rate:  318.6 | accuracy: 0.49
step_num: 15000 | loss: 0.3079 | profit rate:  510.0 | accuracy: 0.47
step_num: 15200 | loss: 0.5782 | profit rate: 1119.3 | accuracy: 0.44
step_num: 15400 | loss: 0.7715 | profit rate: 4715.1 | accuracy: 0.45
step_num: 15600 | loss: 1.0711 | profit rate: 1186924.5 | accuracy: 0.45
step_num: 15800 | loss: 0.5768 | profit rate: 4180150.8 | accuracy: 0.45
step_num: 16000 | loss: 0.5130 | profit rate: 5412604.1 | accuracy: 0.44
step_num: 16200 | loss: 0.4991 | profit rate: 459875.5 | accuracy: 0.41
step_num: 16400 | loss: 0.5288 | profit rate: 423052.4 | accuracy: 0.40
step_num: 16600 | loss: 0.9826 | profit rate: 2611544.6 | accuracy: 0.40
step_num: 16800 | loss: 0.4512 | profit rate: 7903651.2 | accuracy: 0.40
step_num: 17000 | loss: 0.6914 | profit rate: 74259141.8 | accuracy: 0.41
step_num: 17200 | loss: 0.8628 | profit rate: 265467411.2 | accuracy: 0.41
step_num: 17400 | loss: 0.5606 | profit rate: 122659621.9 | accuracy: 0.41
step_num: 17600 | loss: 0.6454 | profit rate: 70828499.0 | accuracy: 0.41
episode:   5/5,耗时:0.76分/3.84分,训练集: | step: 17625 | average_treward:  198.8 | max_treward: 304.8665 | average profit rate: 13382988.636
model saved @ step:17625,performance:63930266.076,accuracy:0.41
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 12%|        | 51/408 [00:00<00:00, 510.00it/s] 26%|       | 106/408 [00:00<00:00, 530.38it/s] 41%|      | 168/408 [00:00<00:00, 571.16it/s] 58%|    | 235/408 [00:00<00:00, 607.72it/s] 74%|  | 302/408 [00:00<00:00, 627.83it/s] 90%| | 369/408 [00:00<00:00, 637.78it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
100%|| 408/408 [00:00<00:00, 612.61it/s]
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1739.83
2023-07-24T12:00:00 | net performance [%] = 73.9831
2023-07-24T12:00:00 | number of trades [#] = 14
==================================================
Trial 44 Complete [00h 04m 29s]
net_wealth: 1739.831029680594

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 45m 18s

Search: Running Trial #45

Value             |Best Value So Far |Hyperparameter
2                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.7               |0.5               |gamma
0.0005            |0.001             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4299.000000   4301.000000
mean      0.000435    20113.607657  ...   20176.664105  20169.373185
std       0.027833    16040.642334  ...   16078.769271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7739.330078   7730.930176
50%       0.000642    11571.842969  ...   11754.589844  11751.469727
75%       0.011590    29894.706152  ...   30014.465820  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.3812 | profit rate:    0.6 | accuracy: 0.34
step_num: 400 | loss: 0.2322 | profit rate:    0.9 | accuracy: 0.33
step_num: 600 | loss: 0.1951 | profit rate:    1.9 | accuracy: 0.36
step_num: 800 | loss: 0.1548 | profit rate:   23.0 | accuracy: 0.41
step_num: 1000 | loss: 0.1720 | profit rate:  214.4 | accuracy: 0.44
step_num: 1200 | loss: 0.1776 | profit rate: 10986.9 | accuracy: 0.47
step_num: 1400 | loss: 0.1204 | profit rate: 139599.4 | accuracy: 0.50
step_num: 1600 | loss: 0.1654 | profit rate: 1707999.2 | accuracy: 0.53
step_num: 1800 | loss: 0.1447 | profit rate: 393075204.5 | accuracy: 0.54
step_num: 2000 | loss: 0.1630 | profit rate: 139508978389.4 | accuracy: 0.56
step_num: 2200 | loss: 0.1325 | profit rate: 34272662730272.0 | accuracy: 0.59
step_num: 2400 | loss: 0.1344 | profit rate: 2567978441223739.5 | accuracy: 0.61
step_num: 2600 | loss: 0.1334 | profit rate: 259152988831339776.0 | accuracy: 0.63
step_num: 2800 | loss: 0.1580 | profit rate: 28548261878282051584.0 | accuracy: 0.64
step_num: 3000 | loss: 0.1462 | profit rate: 1069700628035717169152.0 | accuracy: 0.65
episode:   1/5,耗时:1.13分/1.13分,训练集: | step: 3149 | average_treward: 1780.0 | max_treward: 1780.0401 | average profit rate: 9523301504822292774912.000
model saved @ step:3149,performance:9523301504822292774912.000,accuracy:0.65
step_num: 3200 | loss: 0.1227 | profit rate:    2.3 | accuracy: 0.83
step_num: 3400 | loss: 0.1576 | profit rate:  189.4 | accuracy: 0.83
step_num: 3600 | loss: 0.1278 | profit rate: 2938.4 | accuracy: 0.81
step_num: 3800 | loss: 0.1365 | profit rate: 1728730.1 | accuracy: 0.83
step_num: 4000 | loss: 0.1610 | profit rate: 91725007.3 | accuracy: 0.82
step_num: 4200 | loss: 0.0830 | profit rate: 3434146897.2 | accuracy: 0.83
step_num: 4400 | loss: 0.0990 | profit rate: 1701919459545.5 | accuracy: 0.83
step_num: 4600 | loss: 0.0813 | profit rate: 30425015369451.6 | accuracy: 0.83
step_num: 4800 | loss: 0.1186 | profit rate: 1392493903749482.5 | accuracy: 0.83
step_num: 5000 | loss: 0.1420 | profit rate: 1834084883056775936.0 | accuracy: 0.83
step_num: 5200 | loss: 0.1340 | profit rate: 1490431966688875380736.0 | accuracy: 0.84
step_num: 5400 | loss: 0.0817 | profit rate: 285895472080606256431104.0 | accuracy: 0.84
step_num: 5600 | loss: 0.1069 | profit rate: 26519718559654776483610624.0 | accuracy: 0.85
step_num: 5800 | loss: 0.1341 | profit rate: 3020898149367150646531194880.0 | accuracy: 0.85
step_num: 6000 | loss: 0.1317 | profit rate: 629198710803033392451394994176.0 | accuracy: 0.85
step_num: 6200 | loss: 0.0842 | profit rate: 21389298218366889429340826632192.0 | accuracy: 0.85
model saved @ step:6298,performance:119649148718833498198377706291200.000,accuracy:0.85
step_num: 6400 | loss: 0.1390 | profit rate:    3.7 | accuracy: 0.81
step_num: 6600 | loss: 0.1364 | profit rate:  489.1 | accuracy: 0.85
step_num: 6800 | loss: 0.1111 | profit rate: 10336.9 | accuracy: 0.85
step_num: 7000 | loss: 0.0680 | profit rate: 7882862.1 | accuracy: 0.86
step_num: 7200 | loss: 0.1562 | profit rate: 368068591.7 | accuracy: 0.84
step_num: 7400 | loss: 0.1014 | profit rate: 12383955440.2 | accuracy: 0.84
step_num: 7600 | loss: 0.1276 | profit rate: 7066506768024.3 | accuracy: 0.84
step_num: 7800 | loss: 0.1065 | profit rate: 112135603800091.5 | accuracy: 0.84
step_num: 8000 | loss: 0.1164 | profit rate: 8939167229622356.0 | accuracy: 0.85
step_num: 8200 | loss: 0.0604 | profit rate: 9759982299704934400.0 | accuracy: 0.85
step_num: 8400 | loss: 0.0896 | profit rate: 9141921712157243736064.0 | accuracy: 0.85
step_num: 8600 | loss: 0.0853 | profit rate: 1702240126585199172517888.0 | accuracy: 0.86
step_num: 8800 | loss: 0.1114 | profit rate: 178561020675082547764396032.0 | accuracy: 0.86
step_num: 9000 | loss: 0.0749 | profit rate: 32095285723572627346510839808.0 | accuracy: 0.86
step_num: 9200 | loss: 0.1045 | profit rate: 4275252631570446047973864374272.0 | accuracy: 0.87
step_num: 9400 | loss: 0.0778 | profit rate: 150515461575405226654039921393664.0 | accuracy: 0.86
episode:   3/5,耗时:1.24分/3.63分,训练集: | step: 9447 | average_treward: 2459.4 | max_treward: 2827.8471 | average profit rate: 120786419524972452597606033391616.000
model saved @ step:9447,performance:242710109846560547822402743042048.000,accuracy:0.86
step_num: 9600 | loss: 0.1042 | profit rate:    6.9 | accuracy: 0.84
step_num: 9800 | loss: 0.1128 | profit rate:  857.1 | accuracy: 0.84
step_num: 10000 | loss: 0.0832 | profit rate: 35706.0 | accuracy: 0.85
step_num: 10200 | loss: 0.0797 | profit rate: 12302673.3 | accuracy: 0.86
step_num: 10400 | loss: 0.1134 | profit rate: 663434595.4 | accuracy: 0.85
step_num: 10600 | loss: 0.1283 | profit rate: 232172974258.2 | accuracy: 0.85
step_num: 10800 | loss: 0.1038 | profit rate: 12844278123195.3 | accuracy: 0.86
step_num: 11000 | loss: 0.0933 | profit rate: 233277832325315.3 | accuracy: 0.86
step_num: 11200 | loss: 0.1156 | profit rate: 117663774773895408.0 | accuracy: 0.86
step_num: 11400 | loss: 0.0917 | profit rate: 54481007228703948800.0 | accuracy: 0.86
step_num: 11600 | loss: 0.0853 | profit rate: 42821252054295938859008.0 | accuracy: 0.87
step_num: 11800 | loss: 0.0545 | profit rate: 6053648510146471979384832.0 | accuracy: 0.87
step_num: 12000 | loss: 0.0690 | profit rate: 989715212836274583753457664.0 | accuracy: 0.87
step_num: 12200 | loss: 0.0754 | profit rate: 131180175188654820257217642496.0 | accuracy: 0.88
step_num: 12400 | loss: 0.1046 | profit rate: 13030037113320194552770527756288.0 | accuracy: 0.87
model saved @ step:12596,performance:259750561517038650054975263080448.000,accuracy:0.87
step_num: 12600 | loss: 0.0932 | profit rate:    1.3 | accuracy: 0.80
step_num: 12800 | loss: 0.1080 | profit rate:   66.8 | accuracy: 0.88
step_num: 13000 | loss: 0.0774 | profit rate: 1649.8 | accuracy: 0.88
step_num: 13200 | loss: 0.0920 | profit rate: 332734.8 | accuracy: 0.88
step_num: 13400 | loss: 0.0750 | profit rate: 52711669.2 | accuracy: 0.87
step_num: 13600 | loss: 0.0991 | profit rate: 2571887065.5 | accuracy: 0.86
step_num: 13800 | loss: 0.1228 | profit rate: 686566494816.2 | accuracy: 0.86
step_num: 14000 | loss: 0.0640 | profit rate: 31872530403157.6 | accuracy: 0.87
step_num: 14200 | loss: 0.0739 | profit rate: 694671121089808.0 | accuracy: 0.87
step_num: 14400 | loss: 0.1038 | profit rate: 539554645278177280.0 | accuracy: 0.87
step_num: 14600 | loss: 0.1026 | profit rate: 427213249341728686080.0 | accuracy: 0.87
step_num: 14800 | loss: 0.0550 | profit rate: 137207911249993237790720.0 | accuracy: 0.87
step_num: 15000 | loss: 0.0791 | profit rate: 23342666184681762546778112.0 | accuracy: 0.88
step_num: 15200 | loss: 0.0718 | profit rate: 3270084792705388861129228288.0 | accuracy: 0.88
step_num: 15400 | loss: 0.0976 | profit rate: 536020730406063673548889653248.0 | accuracy: 0.88
step_num: 15600 | loss: 0.0761 | profit rate: 25360399656950669838297340051456.0 | accuracy: 0.87
episode:   5/5,耗时:1.25分/6.13分,训练集: | step: 15745 | average_treward: 2625.1 | max_treward: 2878.9966 | average profit rate: 174437703557999431944980138033152.000
model saved @ step:15745,performance:250078697698041241949099874320384.000,accuracy:0.87
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 51/397 [00:00<00:00, 504.99it/s] 28%|       | 113/397 [00:00<00:00, 568.67it/s] 46%|     | 181/397 [00:00<00:00, 613.65it/s] 62%|   | 247/397 [00:00<00:00, 631.78it/s] 79%|  | 313/397 [00:00<00:00, 641.89it/s] 96%|| 380/397 [00:00<00:00, 649.21it/s]100%|| 397/397 [00:00<00:00, 628.06it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 5327.01
2023-07-24T12:00:00 | net performance [%] = 432.7014
2023-07-24T12:00:00 | number of trades [#] = 140
==================================================
Trial 45 Complete [00h 06m 14s]
net_wealth: 5327.013652385396

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 06h 51m 32s

Search: Running Trial #46

Value             |Best Value So Far |Hyperparameter
9                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.85              |0.5               |gamma
1e-05             |0.001             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4292.000000   4301.000000
mean      0.000435    20113.607657  ...   20202.430277  20169.373185
std       0.027833    16040.642334  ...   16079.200001  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7761.477417   7730.930176
50%       0.000642    11571.842969  ...   11760.674805  11751.469727
75%       0.011590    29894.706152  ...   30029.208008  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.9343 | profit rate:    3.0 | accuracy: 0.34
step_num: 800 | loss: 0.5925 | profit rate:    3.0 | accuracy: 0.33
step_num: 1000 | loss: 0.5080 | profit rate:  325.4 | accuracy: 0.35
step_num: 1200 | loss: 0.4502 | profit rate: 4289.6 | accuracy: 0.36
step_num: 1400 | loss: 0.4113 | profit rate: 270951.6 | accuracy: 0.39
step_num: 1600 | loss: 0.4059 | profit rate: 5601382117.1 | accuracy: 0.43
step_num: 1800 | loss: 0.3840 | profit rate: 230246386830.9 | accuracy: 0.44
step_num: 2000 | loss: 0.3571 | profit rate: 240623704746836.5 | accuracy: 0.47
step_num: 2200 | loss: 0.3649 | profit rate: 785617391977612312576.0 | accuracy: 0.50
step_num: 2400 | loss: 0.3719 | profit rate: 150658997438826955665309696.0 | accuracy: 0.53
step_num: 2600 | loss: 0.3272 | profit rate: 881246739545779451918442037248.0 | accuracy: 0.54
step_num: 2800 | loss: 0.3129 | profit rate: 7608153883643611447109335352606720.0 | accuracy: 0.56
step_num: 3000 | loss: 0.3008 | profit rate: 352582521858242363200406580530197299200.0 | accuracy: 0.58
step_num: 3200 | loss: 0.3139 | profit rate: 47753692126946860138097002228058084798889984.0 | accuracy: 0.59
step_num: 3400 | loss: 0.2983 | profit rate: 29552032800652342984522986892485259397053808640.0 | accuracy: 0.61
episode:   1/5,耗时:2.96分/2.96分,训练集: | step: 3514 | average_treward: 2007.8 | max_treward: 2007.7777 | average profit rate: 1031965257847915451255443081686551860539230781440.000
model saved @ step:3514,performance:1031965257847915451255443081686551860539230781440.000,accuracy:0.61
step_num: 3600 | loss: 0.3039 | profit rate: 1025.3 | accuracy: 0.82
step_num: 3800 | loss: 0.2833 | profit rate: 16671213.7 | accuracy: 0.81
step_num: 4000 | loss: 0.2694 | profit rate: 27613120145.1 | accuracy: 0.83
step_num: 4200 | loss: 0.2472 | profit rate: 4925993118067457.0 | accuracy: 0.84
step_num: 4400 | loss: 0.2222 | profit rate: 36117095688676044800.0 | accuracy: 0.84
step_num: 4600 | loss: 0.2360 | profit rate: 50554365330345146630275072.0 | accuracy: 0.85
step_num: 4800 | loss: 0.2281 | profit rate: 507058323980860663777875460096.0 | accuracy: 0.85
step_num: 5000 | loss: 0.2426 | profit rate: 124046267781945512436945769587539968.0 | accuracy: 0.85
step_num: 5200 | loss: 0.1927 | profit rate: 2335502341491418225392679110719421022208.0 | accuracy: 0.85
step_num: 5400 | loss: 0.2401 | profit rate: 533480829235183671615837320272302345027584.0 | accuracy: 0.85
step_num: 5600 | loss: 0.2439 | profit rate: 683868433243971002599830694469546153880267522048.0 | accuracy: 0.85
step_num: 5800 | loss: 0.2372 | profit rate: 865007013443595146620642424093069940460465024866975744.0 | accuracy: 0.86
step_num: 6000 | loss: 0.2352 | profit rate: 373692802432904257068010367103959428445275619906198429499392.0 | accuracy: 0.86
step_num: 6200 | loss: 0.2586 | profit rate: 9433851352880278698448330157715414775075830461556759023331573760.0 | accuracy: 0.85
step_num: 6400 | loss: 0.2180 | profit rate: 210659781337303217140944368633842105753949956817910503942986777231360.0 | accuracy: 0.85
step_num: 6600 | loss: 0.2556 | profit rate: 4040313727731994144091070877517766217161906608918899681690411474880561152.0 | accuracy: 0.85
step_num: 6800 | loss: 0.2443 | profit rate: 320691811269122427734735241891807048536951421432795993875753810982393790595072.0 | accuracy: 0.85
step_num: 7000 | loss: 0.2383 | profit rate: 224083315703518318419286435334570674805473851192105342097982591260370471191838720.0 | accuracy: 0.85
model saved @ step:7028,performance:368021987564711050861521645801763099542264703191574666811222009392119063536205824.000,accuracy:0.85
step_num: 7200 | loss: 0.2634 | profit rate: 50827.7 | accuracy: 0.83
step_num: 7400 | loss: 0.2466 | profit rate: 2986231514.7 | accuracy: 0.84
step_num: 7600 | loss: 0.2106 | profit rate: 78497112672725.6 | accuracy: 0.84
step_num: 7800 | loss: 0.2263 | profit rate: 37273048561528536.0 | accuracy: 0.84
step_num: 8000 | loss: 0.2237 | profit rate: 26178201674642760925184.0 | accuracy: 0.86
step_num: 8200 | loss: 0.2059 | profit rate: 2081281139222327130914291712.0 | accuracy: 0.86
step_num: 8400 | loss: 0.2045 | profit rate: 14279327620078603184738177908736.0 | accuracy: 0.86
step_num: 8600 | loss: 0.2303 | profit rate: 54076977534531050864989192946530123776.0 | accuracy: 0.86
step_num: 8800 | loss: 0.2056 | profit rate: 32028923320281852795106237022605720682496.0 | accuracy: 0.86
step_num: 9000 | loss: 0.2304 | profit rate: 57984552988549855085680225697692620832112640.0 | accuracy: 0.86
step_num: 9200 | loss: 0.2172 | profit rate: 2473130910555388385472850145731494745762237568253952.0 | accuracy: 0.86
step_num: 9400 | loss: 0.2078 | profit rate: 857751961461293010174568366683707519874102499523690496000.0 | accuracy: 0.86
step_num: 9600 | loss: 0.2312 | profit rate: 41951918921499393419936538543861524929342666595254256724344832.0 | accuracy: 0.86
step_num: 9800 | loss: 0.2043 | profit rate: 649639894468487662039958563230930107508832688914983555523833495552.0 | accuracy: 0.86
step_num: 10000 | loss: 0.2204 | profit rate: 58565288215237519476074431985817389722186066769191513438416661666332672.0 | accuracy: 0.86
step_num: 10200 | loss: 0.2186 | profit rate: 4103444659778779562926486553867837746792486055471820319945266344856551161856.0 | accuracy: 0.86
step_num: 10400 | loss: 0.1979 | profit rate: 18944029046993519891737405973116090875091307165160282258189962991899889864015872.0 | accuracy: 0.86
episode:   3/5,耗时:3.51分/10.00分,训练集: | step: 10542 | average_treward: 2988.5 | max_treward: 3503.0255 | average profit rate: 570696157777152984140299797575309771882835563636407625289177671661119180892012544.000
model saved @ step:10542,performance:1344066485766748006871669415481352914024269671388080527951406406140349733450809344.000,accuracy:0.86
step_num: 10600 | loss: 0.2021 | profit rate:  202.7 | accuracy: 0.90
step_num: 10800 | loss: 0.2150 | profit rate: 2401976.7 | accuracy: 0.83
step_num: 11000 | loss: 0.1966 | profit rate: 33072022905.1 | accuracy: 0.85
step_num: 11200 | loss: 0.1940 | profit rate: 3855444748291147.0 | accuracy: 0.86
step_num: 11400 | loss: 0.2073 | profit rate: 8345428504489676800.0 | accuracy: 0.87
step_num: 11600 | loss: 0.1917 | profit rate: 31541430111656586361438208.0 | accuracy: 0.87
step_num: 11800 | loss: 0.1861 | profit rate: 327091352398759241757451354112.0 | accuracy: 0.86
step_num: 12000 | loss: 0.1831 | profit rate: 539793788523739409158869704769536.0 | accuracy: 0.86
step_num: 12200 | loss: 0.1947 | profit rate: 2303418701744189890561762639127133552640.0 | accuracy: 0.87
step_num: 12400 | loss: 0.2013 | profit rate: 721849672229412652336536446460607707742208.0 | accuracy: 0.86
step_num: 12600 | loss: 0.2110 | profit rate: 43013589146327241309457316725114846546961104896.0 | accuracy: 0.87
step_num: 12800 | loss: 0.2074 | profit rate: 190246062299099961247119641970641253128834185967960064.0 | accuracy: 0.87
step_num: 13000 | loss: 0.2025 | profit rate: 66454940244564322673338161186369538748292344396330618060800.0 | accuracy: 0.87
step_num: 13200 | loss: 0.1967 | profit rate: 8220389728460797649564718940028540405333141365066412092584624128.0 | accuracy: 0.87
step_num: 13400 | loss: 0.2068 | profit rate: 69148920857759287970244886721957779655479561556941704644113679253504.0 | accuracy: 0.86
step_num: 13600 | loss: 0.2139 | profit rate: 4417743291722056262253127599642862427050276128327951852349735799187570688.0 | accuracy: 0.86
step_num: 13800 | loss: 0.1881 | profit rate: 343617109786238876924866815593893600947695189979745391350681623988501926117376.0 | accuracy: 0.86
step_num: 14000 | loss: 0.2049 | profit rate: 470014516085712583095665492347273263182357348500517144760578998736698410407034880.0 | accuracy: 0.86
model saved @ step:14056,performance:1146928715367920004094748269167983379626237934408376102817192479385442535249805312.000,accuracy:0.86
step_num: 14200 | loss: 0.2198 | profit rate: 12528.6 | accuracy: 0.85
step_num: 14400 | loss: 0.2106 | profit rate: 350571818.0 | accuracy: 0.83
step_num: 14600 | loss: 0.2222 | profit rate: 5648610943161.9 | accuracy: 0.85
step_num: 14800 | loss: 0.1879 | profit rate: 17829155126020124.0 | accuracy: 0.84
step_num: 15000 | loss: 0.1891 | profit rate: 1533994818348057362432.0 | accuracy: 0.86
step_num: 15200 | loss: 0.1891 | profit rate: 663380254505345703842152448.0 | accuracy: 0.86
step_num: 15400 | loss: 0.1846 | profit rate: 2050376872656580125314881945600.0 | accuracy: 0.85
step_num: 15600 | loss: 0.2008 | profit rate: 2776586286746881601321953634853847040.0 | accuracy: 0.86
step_num: 15800 | loss: 0.1971 | profit rate: 2835036819447379866256079295491442999296.0 | accuracy: 0.86
step_num: 16000 | loss: 0.2042 | profit rate: 3000930570673263594396280938000260412735488.0 | accuracy: 0.85
step_num: 16200 | loss: 0.2224 | profit rate: 37717168821028144290970550846656037184598035136512.0 | accuracy: 0.86
step_num: 16400 | loss: 0.2018 | profit rate: 37389792849718232345513111670394790995975079702153920512.0 | accuracy: 0.86
step_num: 16600 | loss: 0.2101 | profit rate: 1162292885820026974119661896572319376096108856841583240151040.0 | accuracy: 0.86
step_num: 16800 | loss: 0.2077 | profit rate: 31598848345935147106327098701416919765687077570185100348333490176.0 | accuracy: 0.85
step_num: 17000 | loss: 0.2280 | profit rate: 1632676720275924904304632631479221949714599562984938850475843981934592.0 | accuracy: 0.85
step_num: 17200 | loss: 0.1994 | profit rate: 73597575099977375752430122463586881790670371294854951745854274284755615744.0 | accuracy: 0.85
step_num: 17400 | loss: 0.1957 | profit rate: 746545963213797441361569845234994780125003239368845456169404426042928672014336.0 | accuracy: 0.85
episode:   5/5,耗时:3.54分/17.06分,训练集: | step: 17570 | average_treward: 3191.7 | max_treward: 3512.2324 | average profit rate: 591875234378170395356284663128498338152564130395388276051796889868660671602753536.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 14%|        | 54/397 [00:00<00:00, 534.66it/s] 30%|       | 120/397 [00:00<00:00, 604.54it/s] 46%|     | 183/397 [00:00<00:00, 616.01it/s] 63%|   | 251/397 [00:00<00:00, 636.18it/s] 80%|  | 318/397 [00:00<00:00, 645.98it/s] 97%|| 385/397 [00:00<00:00, 654.08it/s]==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
100%|| 397/397 [00:00<00:00, 635.16it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2337.03
2023-07-24T12:00:00 | net performance [%] = 133.7030
2023-07-24T12:00:00 | number of trades [#] = 28
==================================================
Trial 46 Complete [00h 17m 56s]
net_wealth: 2337.0300208225603

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 09m 28s

Search: Running Trial #47

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
8                 |3                 |lags
0.7               |0.5               |gamma
0.001             |0.001             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.5277 | profit rate:    4.4 | accuracy: 0.36
step_num: 800 | loss: 0.4329 | profit rate:    3.3 | accuracy: 0.36
step_num: 1000 | loss: 0.4285 | profit rate:   68.9 | accuracy: 0.40
step_num: 1200 | loss: 0.4814 | profit rate: 21642.0 | accuracy: 0.42
step_num: 1400 | loss: 0.4227 | profit rate: 4000613.5 | accuracy: 0.44
step_num: 1600 | loss: 0.4801 | profit rate: 38316810.5 | accuracy: 0.44
step_num: 1800 | loss: 0.5072 | profit rate: 85275363592400.6 | accuracy: 0.47
step_num: 2000 | loss: 0.5013 | profit rate: 2671223495837105152.0 | accuracy: 0.48
step_num: 2200 | loss: 0.4887 | profit rate: 7874739139102869815296.0 | accuracy: 0.50
step_num: 2400 | loss: 0.5134 | profit rate: 43115513889970122758553600.0 | accuracy: 0.51
step_num: 2600 | loss: 0.5145 | profit rate: 95196699548548946150058622976.0 | accuracy: 0.52
step_num: 2800 | loss: 0.5524 | profit rate: 10180968987536264974443139083272192.0 | accuracy: 0.54
step_num: 3000 | loss: 0.4914 | profit rate: 4517076147261497260453045148051308544.0 | accuracy: 0.55
episode:   1/5,耗时:1.00分/1.00分,训练集: | step: 3169 | average_treward: 1194.1 | max_treward: 1194.0858 | average profit rate: 41433742170578714592966571080988753920.000
model saved @ step:3169,performance:41433742170578714592966571080988753920.000,accuracy:0.55
step_num: 3200 | loss: 0.5078 | profit rate:    1.8 | accuracy: 0.47
step_num: 3400 | loss: 0.4613 | profit rate: 183972.2 | accuracy: 0.69
step_num: 3600 | loss: 0.4960 | profit rate: 16335225.8 | accuracy: 0.66
step_num: 3800 | loss: 0.4876 | profit rate: 3753634556794.8 | accuracy: 0.64
step_num: 4000 | loss: 0.5433 | profit rate: 7474301551264057.0 | accuracy: 0.64
step_num: 4200 | loss: 0.4264 | profit rate: 5906896960566650880.0 | accuracy: 0.65
step_num: 4400 | loss: 0.4671 | profit rate: 5197372035016460553158656.0 | accuracy: 0.65
step_num: 4600 | loss: 0.4616 | profit rate: 696505394085238120646705152.0 | accuracy: 0.64
step_num: 4800 | loss: 0.4445 | profit rate: 251571818833188919657248063488.0 | accuracy: 0.64
step_num: 5000 | loss: 0.5101 | profit rate: 1340144213944354247171332502890479616.0 | accuracy: 0.64
step_num: 5200 | loss: 0.5305 | profit rate: 188258413341262963976361618433255225163776.0 | accuracy: 0.65
step_num: 5400 | loss: 0.4674 | profit rate: 837012684092778295986335195295579018914430976.0 | accuracy: 0.64
step_num: 5600 | loss: 0.4824 | profit rate: 1223222012833155500999730357422457447402509959168.0 | accuracy: 0.64
step_num: 5800 | loss: 0.4804 | profit rate: 10527667806530252803550730504288920922028314600669184.0 | accuracy: 0.64
step_num: 6000 | loss: 0.4883 | profit rate: 697291335664140073551644442760671729255711236005960876032.0 | accuracy: 0.64
step_num: 6200 | loss: 0.4704 | profit rate: 151297502615222921818922349217941986065793479970153708912640.0 | accuracy: 0.64
model saved @ step:6338,performance:1272403599073029519795639331413806759054263801574900606435328.000,accuracy:0.63
step_num: 6400 | loss: 0.4338 | profit rate:    2.0 | accuracy: 0.37
step_num: 6600 | loss: 0.3957 | profit rate: 146263.7 | accuracy: 0.56
step_num: 6800 | loss: 0.4428 | profit rate: 22730319.2 | accuracy: 0.54
step_num: 7000 | loss: 0.3988 | profit rate: 27977462435483.7 | accuracy: 0.58
step_num: 7200 | loss: 0.4548 | profit rate: 14580178394472744.0 | accuracy: 0.59
step_num: 7400 | loss: 0.4293 | profit rate: 49896706889920634880.0 | accuracy: 0.61
step_num: 7600 | loss: 0.4026 | profit rate: 186958153288011345175773184.0 | accuracy: 0.62
step_num: 7800 | loss: 0.4232 | profit rate: 15727490785910316436270612480.0 | accuracy: 0.61
step_num: 8000 | loss: 0.3957 | profit rate: 12232399174757317184612655431680.0 | accuracy: 0.61
step_num: 8200 | loss: 0.4392 | profit rate: 846319067150578215068677323624143650816.0 | accuracy: 0.63
step_num: 8400 | loss: 0.4842 | profit rate: 41882477050718507617518976806138377689628672.0 | accuracy: 0.63
step_num: 8600 | loss: 0.4575 | profit rate: 126798631592105730614311619436697734952477786112.0 | accuracy: 0.63
step_num: 8800 | loss: 0.4612 | profit rate: 104367244161685821514984481380600670623939422060544.0 | accuracy: 0.62
step_num: 9000 | loss: 0.4783 | profit rate: 528657250158149588041703667585020851870627941641617408.0 | accuracy: 0.62
step_num: 9200 | loss: 0.4928 | profit rate: 133626070691283154342350136672833881264603462458684441886720.0 | accuracy: 0.63
step_num: 9400 | loss: 0.4387 | profit rate: 9038515263258702855959803256186967804062811129764020045742080.0 | accuracy: 0.62
episode:   3/5,耗时:1.22分/3.45分,训练集: | step: 9507 | average_treward: 1677.6 | max_treward: 1943.7855 | average profit rate: 15354360900471102968684291170227467991930617730124814865137664.000
model saved @ step:9507,performance:44790679102340281170316850061718448539595051200668464467410944.000,accuracy:0.61
step_num: 9600 | loss: 0.3581 | profit rate:    3.5 | accuracy: 0.36
step_num: 9800 | loss: 0.3986 | profit rate: 481429.4 | accuracy: 0.53
step_num: 10000 | loss: 0.3518 | profit rate: 15147409.6 | accuracy: 0.51
step_num: 10200 | loss: 0.4047 | profit rate: 216251555887051.7 | accuracy: 0.58
step_num: 10400 | loss: 0.4698 | profit rate: 519776560502448768.0 | accuracy: 0.61
step_num: 10600 | loss: 0.4389 | profit rate: 792330560733410230272.0 | accuracy: 0.62
step_num: 10800 | loss: 0.4212 | profit rate: 1158135339253546808695062528.0 | accuracy: 0.63
step_num: 11000 | loss: 0.4284 | profit rate: 93600356526001865471163367424.0 | accuracy: 0.62
step_num: 11200 | loss: 0.4586 | profit rate: 91252787374663113760863919538176.0 | accuracy: 0.63
step_num: 11400 | loss: 0.4469 | profit rate: 3905139677098373147467101139819026186240.0 | accuracy: 0.64
step_num: 11600 | loss: 0.4238 | profit rate: 496366816427072319238561706487465794672263168.0 | accuracy: 0.65
step_num: 11800 | loss: 0.4222 | profit rate: 19591353083297502163073709424113372972669003104256.0 | accuracy: 0.65
step_num: 12000 | loss: 0.4622 | profit rate: 11050345117088868452642497344871314702016738102345728.0 | accuracy: 0.64
step_num: 12200 | loss: 0.4466 | profit rate: 24408006773615421406015038517985338560132970767544483840.0 | accuracy: 0.63
step_num: 12400 | loss: 0.4253 | profit rate: 967294724528953676822505518511095900093403894780259532275712.0 | accuracy: 0.64
step_num: 12600 | loss: 0.4345 | profit rate: 151988417958556757016733599139498816136646788774903090966953984.0 | accuracy: 0.63
model saved @ step:12676,performance:203065803668926668036001001025969830087668183751421443207856128.000,accuracy:0.62
step_num: 12800 | loss: 0.3825 | profit rate:    5.3 | accuracy: 0.43
step_num: 13000 | loss: 0.3861 | profit rate: 420796.0 | accuracy: 0.51
step_num: 13200 | loss: 0.3835 | profit rate: 2006177581.8 | accuracy: 0.54
step_num: 13400 | loss: 0.3907 | profit rate: 977699311199959.8 | accuracy: 0.58
step_num: 13600 | loss: 0.4114 | profit rate: 1548301682239781632.0 | accuracy: 0.60
step_num: 13800 | loss: 0.4499 | profit rate: 165800237498292754186240.0 | accuracy: 0.62
step_num: 14000 | loss: 0.3891 | profit rate: 1238291780713486879247302656.0 | accuracy: 0.62
step_num: 14200 | loss: 0.3889 | profit rate: 222436794188011895432461418496.0 | accuracy: 0.61
step_num: 14400 | loss: 0.4177 | profit rate: 40354857340805514294155755447648256.0 | accuracy: 0.63
step_num: 14600 | loss: 0.4073 | profit rate: 10275244774106939868461334304077853491200.0 | accuracy: 0.63
step_num: 14800 | loss: 0.4207 | profit rate: 5021032993678358205665281071071244834637348864.0 | accuracy: 0.64
step_num: 15000 | loss: 0.4005 | profit rate: 26577021932848001993652043358440628139782234439680.0 | accuracy: 0.64
step_num: 15200 | loss: 0.4353 | profit rate: 35771361187470924724142612089222961363978835200049152.0 | accuracy: 0.64
step_num: 15400 | loss: 0.3958 | profit rate: 249925616743027129846116814801106531873112592427341840384.0 | accuracy: 0.63
step_num: 15600 | loss: 0.4839 | profit rate: 12104554353157305758789701881656857320095801751698199956946944.0 | accuracy: 0.64
step_num: 15800 | loss: 0.3931 | profit rate: 252762837059006515565638682064070821492020234836851634265391104.0 | accuracy: 0.63
episode:   5/5,耗时:1.23分/6.06分,训练集: | step: 15845 | average_treward: 1813.5 | max_treward: 2049.2303 | average profit rate: 122176313905975233824849888313431333267446371620077545828909056.000
model saved @ step:15845,performance:361752683159536200745681723266263718623487637855562659637755904.000,accuracy:0.63
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 10%|         | 41/403 [00:00<00:00, 405.94it/s] 26%|       | 103/403 [00:00<00:00, 525.19it/s] 41%|      | 165/403 [00:00<00:00, 563.02it/s] 57%|    | 231/403 [00:00<00:00, 600.90it/s] 73%|  | 295/403 [00:00<00:00, 614.90it/s] 90%| | 361/403 [00:00<00:00, 628.88it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 600.06it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2716.60
2023-07-24T12:00:00 | net performance [%] = 171.6602
2023-07-24T12:00:00 | number of trades [#] = 34
==================================================
Trial 47 Complete [00h 06m 15s]
net_wealth: 2716.6022705585024

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 15m 43s

Search: Running Trial #48

Value             |Best Value So Far |Hyperparameter
12                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
10                |3                 |lags
0.9               |0.5               |gamma
0.0005            |0.001             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
1                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4303.000000   4315.000000
mean      0.000441    20062.255222  ...   20162.113925  20118.633889
std       0.027818    16039.874230  ...   16078.371573  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7724.814941   7690.540039
50%       0.000642    11554.824463  ...   11750.650391  11715.610352
75%       0.011655    29873.081836  ...   30003.260742  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 0.7942 | profit rate:    0.1 | accuracy: 0.33
step_num: 1200 | loss: 0.4811 | profit rate:    0.5 | accuracy: 0.33
step_num: 1400 | loss: 0.4608 | profit rate:    2.6 | accuracy: 0.35
step_num: 1600 | loss: 0.4997 | profit rate:   20.0 | accuracy: 0.36
step_num: 1800 | loss: 0.5168 | profit rate: 18557228.7 | accuracy: 0.40
step_num: 2000 | loss: 0.4877 | profit rate: 355787431162.8 | accuracy: 0.42
step_num: 2200 | loss: 0.5082 | profit rate: 1085255831060009.9 | accuracy: 0.44
step_num: 2400 | loss: 0.4924 | profit rate: 3273662886594461696.0 | accuracy: 0.46
step_num: 2600 | loss: 0.4906 | profit rate: 87065709070946962243584.0 | accuracy: 0.48
step_num: 2800 | loss: 0.4917 | profit rate: 8284021223806040704609681408.0 | accuracy: 0.50
step_num: 3000 | loss: 0.4525 | profit rate: 21401747843770376859856576446464.0 | accuracy: 0.52
episode:   1/5,耗时:1.26分/1.26分,训练集: | step: 3167 | average_treward: 1164.9 | max_treward: 1164.8783 | average profit rate: 663883048920285164155541695496192.000
model saved @ step:3167,performance:663883048920285164155541695496192.000,accuracy:0.52
step_num: 3200 | loss: 0.4646 | profit rate:    5.4 | accuracy: 0.76
step_num: 3400 | loss: 0.4760 | profit rate: 411614.9 | accuracy: 0.80
step_num: 3600 | loss: 0.4871 | profit rate: 302927109.9 | accuracy: 0.77
step_num: 3800 | loss: 0.4988 | profit rate: 612481063341811.2 | accuracy: 0.79
step_num: 4000 | loss: 0.4874 | profit rate: 52613872380418850816.0 | accuracy: 0.79
step_num: 4200 | loss: 0.4530 | profit rate: 331652316033395575488512.0 | accuracy: 0.80
step_num: 4400 | loss: 0.5083 | profit rate: 516483807497270817809288396800.0 | accuracy: 0.79
step_num: 4600 | loss: 0.5156 | profit rate: 176597953796637272907611662974976.0 | accuracy: 0.78
step_num: 4800 | loss: 0.4692 | profit rate: 1901168069910752911003150481037983744.0 | accuracy: 0.79
step_num: 5000 | loss: 0.5012 | profit rate: 59114924549680560112174635101934917875924992.0 | accuracy: 0.80
step_num: 5200 | loss: 0.4682 | profit rate: 82800310666333910568152108611600526056019692879872.0 | accuracy: 0.80
step_num: 5400 | loss: 0.5351 | profit rate: 1936357401062240323097861839451021432684499349117337600.0 | accuracy: 0.79
step_num: 5600 | loss: 0.5067 | profit rate: 17331358754088278027698392032159984133739103137112088641536.0 | accuracy: 0.79
step_num: 5800 | loss: 0.4978 | profit rate: 1586735779656988428499366879415334212967208462902429881886310400.0 | accuracy: 0.79
step_num: 6000 | loss: 0.5525 | profit rate: 576695820627819212784604331615128794595354271011936893487228104212480.0 | accuracy: 0.79
step_num: 6200 | loss: 0.5259 | profit rate: 1384881891629306072747760773008579995981856615212918103424481619383156736.0 | accuracy: 0.79
model saved @ step:6334,performance:47540657914355339167742827883469103231020417792355184668251887947485282304.000,accuracy:0.78
step_num: 6400 | loss: 0.5571 | profit rate:    7.3 | accuracy: 0.73
step_num: 6600 | loss: 0.5287 | profit rate: 2259574.9 | accuracy: 0.79
step_num: 6800 | loss: 0.5175 | profit rate: 2341927303.8 | accuracy: 0.79
step_num: 7000 | loss: 0.5223 | profit rate: 12030450913215740.0 | accuracy: 0.80
step_num: 7200 | loss: 0.5397 | profit rate: 160967203803633876992.0 | accuracy: 0.78
step_num: 7400 | loss: 0.5317 | profit rate: 1416388477267066730053632.0 | accuracy: 0.80
step_num: 7600 | loss: 0.5393 | profit rate: 4586035804011819968800307019776.0 | accuracy: 0.79
step_num: 7800 | loss: 0.5194 | profit rate: 289149867260867172683714727510016.0 | accuracy: 0.77
step_num: 8000 | loss: 0.4979 | profit rate: 5378944185678043843260906341132140544.0 | accuracy: 0.78
step_num: 8200 | loss: 0.5186 | profit rate: 1110830730794612384397795565222990310545555456.0 | accuracy: 0.79
step_num: 8400 | loss: 0.5232 | profit rate: 1530384132858732765416266633405089819838043868102656.0 | accuracy: 0.79
step_num: 8600 | loss: 0.5382 | profit rate: 63848095127172450781517184583705106587834569613457227776.0 | accuracy: 0.79
step_num: 8800 | loss: 0.5791 | profit rate: 369998259550632435136877248199977012609791128254743505272832.0 | accuracy: 0.78
step_num: 9000 | loss: 0.5534 | profit rate: 13025947404416826682606545931687827669090077314072338145986215936.0 | accuracy: 0.78
step_num: 9200 | loss: 0.5656 | profit rate: 6550326366882569016026056710819492805413948728531195136197409439219712.0 | accuracy: 0.79
step_num: 9400 | loss: 0.5412 | profit rate: 15274495748032768875006300863068206249277879437076182233001339861424144384.0 | accuracy: 0.78
episode:   3/5,耗时:1.89分/5.16分,训练集: | step: 9501 | average_treward: 2223.7 | max_treward: 2761.2386 | average profit rate: 43410281704930262081857271107695954824059595587873460903255939359344427008.000
step_num: 9600 | loss: 0.5413 | profit rate:   13.8 | accuracy: 0.68
step_num: 9800 | loss: 0.5041 | profit rate: 4995759.1 | accuracy: 0.78
step_num: 10000 | loss: 0.5266 | profit rate: 7344655922.5 | accuracy: 0.77
step_num: 10200 | loss: 0.5491 | profit rate: 172248660096887584.0 | accuracy: 0.79
step_num: 10400 | loss: 0.5518 | profit rate: 937997977264586883072.0 | accuracy: 0.78
step_num: 10600 | loss: 0.5418 | profit rate: 2648758424381580701073408.0 | accuracy: 0.79
step_num: 10800 | loss: 0.5110 | profit rate: 8278048732141394451171331014656.0 | accuracy: 0.78
step_num: 11000 | loss: 0.5346 | profit rate: 1561483754879675615402946199552000.0 | accuracy: 0.77
step_num: 11200 | loss: 0.5202 | profit rate: 148158884361117869799913865467935064064.0 | accuracy: 0.78
step_num: 11400 | loss: 0.5488 | profit rate: 2774453593624424197117497816123529934342717440.0 | accuracy: 0.78
step_num: 11600 | loss: 0.5678 | profit rate: 865300741387674259691957829148299965980941614055424.0 | accuracy: 0.78
step_num: 11800 | loss: 0.5667 | profit rate: 228904705007435951824963449147072089707840452152243781632.0 | accuracy: 0.78
step_num: 12000 | loss: 0.5825 | profit rate: 706373176619789996281098834706558016117351461059767780245504.0 | accuracy: 0.77
step_num: 12200 | loss: 0.5394 | profit rate: 46990567924023365202144523421446393383094803851962598141150101504.0 | accuracy: 0.77
step_num: 12400 | loss: 0.5669 | profit rate: 8954246059169861827034330402381367230005374018020908410153731859939328.0 | accuracy: 0.78
step_num: 12600 | loss: 0.5441 | profit rate: 13687341497899571252126780275573327495751676892074117304714660544470056960.0 | accuracy: 0.77
step_num: 12800 | loss: 0.5766 | profit rate:   17.9 | accuracy: 0.69
step_num: 13000 | loss: 0.5701 | profit rate: 7421646.0 | accuracy: 0.76
step_num: 13200 | loss: 0.5547 | profit rate: 168533715274.8 | accuracy: 0.76
step_num: 13400 | loss: 0.5665 | profit rate: 443347230407842752.0 | accuracy: 0.77
step_num: 13600 | loss: 0.5493 | profit rate: 5222267284236527468544.0 | accuracy: 0.78
step_num: 13800 | loss: 0.5862 | profit rate: 2905854098764783580419719168.0 | accuracy: 0.78
step_num: 14000 | loss: 0.5209 | profit rate: 40928852619809342102683053457408.0 | accuracy: 0.78
step_num: 14200 | loss: 0.5492 | profit rate: 6804694183638808742193364717273088.0 | accuracy: 0.77
step_num: 14400 | loss: 0.5696 | profit rate: 50229416358416948318364085082051208806400.0 | accuracy: 0.78
step_num: 14600 | loss: 0.5344 | profit rate: 96191968472128666817208757459882670797197672448.0 | accuracy: 0.78
step_num: 14800 | loss: 0.5234 | profit rate: 80474789476748664004089545576379718747234439572488192.0 | accuracy: 0.77
step_num: 15000 | loss: 0.5326 | profit rate: 2343475315325587915054354160006219531424166467382515073024.0 | accuracy: 0.77
step_num: 15200 | loss: 0.5516 | profit rate: 11116830128136580759016664715525901119883758017849376689356800.0 | accuracy: 0.77
step_num: 15400 | loss: 0.5130 | profit rate: 199281060890924216006873889808427203489298345698152548567917527040.0 | accuracy: 0.76
step_num: 15600 | loss: 0.5562 | profit rate: 93463943913565883214630566096411001282328275667459053747613766617399296.0 | accuracy: 0.77
step_num: 15800 | loss: 0.5598 | profit rate: 52545121947929348912020530797150149270319500865502238027616451054312357888.0 | accuracy: 0.76
episode:   5/5,耗时:1.88分/8.94分,训练集: | step: 15835 | average_treward: 2421.2 | max_treward: 2761.2386 | average profit rate: 49532589908215864187837852176366928410678390577500504311827762735478734848.000
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 13%|        | 54/401 [00:00<00:00, 533.87it/s] 30%|       | 119/401 [00:00<00:00, 594.89it/s] 46%|     | 184/401 [00:00<00:00, 617.04it/s] 63%|   | 251/401 [00:00<00:00, 637.77it/s] 79%|  | 318/401 [00:00<00:00, 648.22it/s] 96%|| 385/401 [00:00<00:00, 655.59it/s]==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
100%|| 401/401 [00:00<00:00, 635.87it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2370.25
2023-07-24T12:00:00 | net performance [%] = 137.0247
2023-07-24T12:00:00 | number of trades [#] = 60
==================================================
Trial 48 Complete [00h 09m 02s]
net_wealth: 2372.619815786861

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 24m 45s

Search: Running Trial #49

Value             |Best Value So Far |Hyperparameter
10                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
10                |3                 |lags
0.9               |0.5               |gamma
0.0001            |0.001             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
2                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4291.000000   4301.000000
mean      0.000435    20113.607657  ...   20206.045010  20169.373185
std       0.027833    16040.642334  ...   16079.329741  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7763.510010   7730.930176
50%       0.000642    11571.842969  ...   11760.809570  11751.469727
75%       0.011590    29894.706152  ...   30037.855469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8279 | profit rate:    3.0 | accuracy: 0.36
step_num: 400 | loss: 0.5928 | profit rate:  101.1 | accuracy: 0.44
step_num: 600 | loss: 0.9275 | profit rate:  403.7 | accuracy: 0.41
step_num: 800 | loss: 0.8630 | profit rate: 2437.8 | accuracy: 0.43
step_num: 1000 | loss: 1.1883 | profit rate: 701495.6 | accuracy: 0.44
step_num: 1200 | loss: 0.5519 | profit rate: 995550910.2 | accuracy: 0.48
step_num: 1400 | loss: 0.6774 | profit rate: 333295825976.1 | accuracy: 0.50
step_num: 1600 | loss: 0.9572 | profit rate: 111166986698796768.0 | accuracy: 0.53
step_num: 1800 | loss: 0.6135 | profit rate: 16734702869504372736.0 | accuracy: 0.55
step_num: 2000 | loss: 0.8285 | profit rate: 47413752045195734548480.0 | accuracy: 0.57
step_num: 2200 | loss: 0.9207 | profit rate: 363667037167260484978379587584.0 | accuracy: 0.59
step_num: 2400 | loss: 1.0793 | profit rate: 78552114413942854701613712828006400.0 | accuracy: 0.61
step_num: 2600 | loss: 0.6456 | profit rate: 366704971877412519720480635686435684352.0 | accuracy: 0.62
step_num: 2800 | loss: 0.8222 | profit rate: 3249648303225977944847090955734815401312256.0 | accuracy: 0.64
step_num: 3000 | loss: 0.4036 | profit rate: 312476697017999969263222807518475761792158007296.0 | accuracy: 0.65
step_num: 3200 | loss: 0.8394 | profit rate: 57548149643616970971692264847968587708378041892732928.0 | accuracy: 0.66
step_num: 3400 | loss: 0.5290 | profit rate: 49553334799024198641677792585936864762747216237730725888.0 | accuracy: 0.67
episode:   1/5,耗时:0.79分/0.79分,训练集: | step: 3518 | average_treward: 2322.2 | max_treward: 2322.2012 | average profit rate: 1809197498560673045757533715968201343644242006006300672000.000
model saved @ step:3518,performance:1809197498560673045757533715968201343644242006006300672000.000,accuracy:0.67
step_num: 3600 | loss: 0.5833 | profit rate:  999.8 | accuracy: 0.87
step_num: 3800 | loss: 0.8894 | profit rate: 16399914.6 | accuracy: 0.81
step_num: 4000 | loss: 0.6771 | profit rate: 22852285272.9 | accuracy: 0.82
step_num: 4200 | loss: 0.3720 | profit rate: 6061429251679537.0 | accuracy: 0.83
step_num: 4400 | loss: 0.5527 | profit rate: 69954312287423963136.0 | accuracy: 0.83
step_num: 4600 | loss: 0.3672 | profit rate: 105284628339805113787875328.0 | accuracy: 0.83
step_num: 4800 | loss: 0.3927 | profit rate: 2048363933494397340392483717120.0 | accuracy: 0.84
step_num: 5000 | loss: 1.0722 | profit rate: 666119489317409441933508344455102464.0 | accuracy: 0.84
step_num: 5200 | loss: 0.4996 | profit rate: 15112945799830282680588549434760306360320.0 | accuracy: 0.84
step_num: 5400 | loss: 0.5139 | profit rate: 5631448576042713380029261199227798163554304.0 | accuracy: 0.84
step_num: 5600 | loss: 0.6829 | profit rate: 15940298720160739567966051931193228338989587496960.0 | accuracy: 0.84
step_num: 5800 | loss: 0.4418 | profit rate: 25354405432778228445463643041265779941953159499190632448.0 | accuracy: 0.85
step_num: 6000 | loss: 0.5697 | profit rate: 25611212687391676832721322932624618262919954265847554308571136.0 | accuracy: 0.85
step_num: 6200 | loss: 0.5318 | profit rate: 356895331244267215849087588126021286574652778964849802621592010752.0 | accuracy: 0.84
step_num: 6400 | loss: 0.4027 | profit rate: 7022732222651999301899130924565176024676118117545396148179170314158080.0 | accuracy: 0.84
step_num: 6600 | loss: 0.5480 | profit rate: 184693611144372894032754403642990682078239518444754449994131324202175692800.0 | accuracy: 0.84
step_num: 6800 | loss: 0.5171 | profit rate: 39571727936963217956394395422457897473081130218850486336294331943299649915322368.0 | accuracy: 0.84
step_num: 7000 | loss: 0.4568 | profit rate: 35535078554583465806537111946963656421786346715178794951263109446190069490613485568.0 | accuracy: 0.84
model saved @ step:7036,performance:63128049517585704618245506049962163463131910825660428259629987215516428271238512640.000,accuracy:0.84
step_num: 7200 | loss: 0.2390 | profit rate: 42966.3 | accuracy: 0.85
step_num: 7400 | loss: 0.5033 | profit rate: 2717709802.6 | accuracy: 0.86
step_num: 7600 | loss: 0.9882 | profit rate: 54412057855735.4 | accuracy: 0.85
step_num: 7800 | loss: 0.3083 | profit rate: 74473000663105040.0 | accuracy: 0.84
step_num: 8000 | loss: 0.6461 | profit rate: 85109545359007620792320.0 | accuracy: 0.85
step_num: 8200 | loss: 0.4459 | profit rate: 12182258856962778640601317376.0 | accuracy: 0.85
step_num: 8400 | loss: 0.4307 | profit rate: 105117920640519057003313635524608.0 | accuracy: 0.85
step_num: 8600 | loss: 0.6011 | profit rate: 392020941305314129302901441197441548288.0 | accuracy: 0.86
step_num: 8800 | loss: 0.3763 | profit rate: 882306498482772689333944566267496624029696.0 | accuracy: 0.86
step_num: 9000 | loss: 0.4878 | profit rate: 1646717301460559813395077535721450237962747904.0 | accuracy: 0.86
step_num: 9200 | loss: 0.8897 | profit rate: 107613534283661771807052554756536215050530787514384384.0 | accuracy: 0.86
step_num: 9400 | loss: 0.9531 | profit rate: 97344512521992689361934545082421443223288575505229976436736.0 | accuracy: 0.86
step_num: 9600 | loss: 0.2650 | profit rate: 6861087117137329010344877434765175271250053614679661982546657280.0 | accuracy: 0.86
step_num: 9800 | loss: 0.5119 | profit rate: 75961053901118741407682773302123260571519945653661551198826324295680.0 | accuracy: 0.86
step_num: 10000 | loss: 0.4520 | profit rate: 8140028882270934548397416673711394130955741753372320050108109091745300480.0 | accuracy: 0.86
step_num: 10200 | loss: 0.5434 | profit rate: 893278166590495695269966937792359993409191291124910306085615692773576912404480.0 | accuracy: 0.86
step_num: 10400 | loss: 0.4534 | profit rate: 7143877846917851098940263940725939463492749661109687313735594277326332923681439744.0 | accuracy: 0.86
episode:   3/5,耗时:1.36分/3.02分,训练集: | step: 10554 | average_treward: 3078.2 | max_treward: 3501.0064 | average profit rate: 201098840362723559187674579915525788723581877087453805726474422816033532055950196736.000
model saved @ step:10554,performance:540168471570584945984831566545975408040598633417070315282648858692011686793001828352.000,accuracy:0.85
step_num: 10600 | loss: 0.6768 | profit rate:  158.2 | accuracy: 0.98
step_num: 10800 | loss: 0.3838 | profit rate: 2866201.1 | accuracy: 0.86
step_num: 11000 | loss: 0.5363 | profit rate: 59372714268.7 | accuracy: 0.86
step_num: 11200 | loss: 0.2975 | profit rate: 8340125174959819.0 | accuracy: 0.85
step_num: 11400 | loss: 0.2534 | profit rate: 9895927912866461696.0 | accuracy: 0.85
step_num: 11600 | loss: 0.5069 | profit rate: 75672445276849492222541824.0 | accuracy: 0.85
step_num: 11800 | loss: 0.3833 | profit rate: 1904085785467384506509204389888.0 | accuracy: 0.86
step_num: 12000 | loss: 0.5851 | profit rate: 7283948242753391967067959365468160.0 | accuracy: 0.86
step_num: 12200 | loss: 0.2632 | profit rate: 50705821671485217715153899398361543344128.0 | accuracy: 0.86
step_num: 12400 | loss: 0.3728 | profit rate: 18822050446581376756464332603245937691721728.0 | accuracy: 0.86
step_num: 12600 | loss: 0.7602 | profit rate: 677415760999490331755181375508108843468904726528.0 | accuracy: 0.86
step_num: 12800 | loss: 0.2239 | profit rate: 24640643420310283862416533039390348152891845458377310208.0 | accuracy: 0.86
step_num: 13000 | loss: 0.5474 | profit rate: 11921816406269692817436082088089677718892894503889267127746560.0 | accuracy: 0.86
step_num: 13200 | loss: 0.4827 | profit rate: 2934835304679062064826894420073419883389991289277171590764003590144.0 | accuracy: 0.86
step_num: 13400 | loss: 0.4018 | profit rate: 22392593921034585458398830537275675070228804213034265127062533998379008.0 | accuracy: 0.86
step_num: 13600 | loss: 0.5073 | profit rate: 870069649191601183009743658462527229948651612652387249191930408905425813504.0 | accuracy: 0.86
step_num: 13800 | loss: 0.3283 | profit rate: 107238093028029310977853941382382538652603077483413177552985492651218531717742592.0 | accuracy: 0.86
step_num: 14000 | loss: 0.6398 | profit rate: 723426183630311345831838060275492463581601670044373580502577711594528695246240350208.0 | accuracy: 0.85
model saved @ step:14072,performance:1733441824080983964508120732096144259654696250276254076678383931699376446753900331008.000,accuracy:0.85
step_num: 14200 | loss: 0.5880 | profit rate: 8218.4 | accuracy: 0.85
step_num: 14400 | loss: 0.3647 | profit rate: 828211812.5 | accuracy: 0.87
step_num: 14600 | loss: 0.3759 | profit rate: 11290752027320.9 | accuracy: 0.87
step_num: 14800 | loss: 0.1888 | profit rate: 129278192463662688.0 | accuracy: 0.86
step_num: 15000 | loss: 0.5817 | profit rate: 3839616521238604152832.0 | accuracy: 0.86
step_num: 15200 | loss: 0.4804 | profit rate: 3043401349098581672740257792.0 | accuracy: 0.86
step_num: 15400 | loss: 0.5896 | profit rate: 41642842602664673782798735114240.0 | accuracy: 0.86
step_num: 15600 | loss: 1.1764 | profit rate: 140106287793282538640807175777878540288.0 | accuracy: 0.86
step_num: 15800 | loss: 0.2459 | profit rate: 209559242163113837052455819616252925575168.0 | accuracy: 0.86
step_num: 16000 | loss: 0.6054 | profit rate: 503978899478833376888878739483643213883899904.0 | accuracy: 0.86
step_num: 16200 | loss: 0.6474 | profit rate: 2397228322055610412036277618249887886258988707217408.0 | accuracy: 0.86
step_num: 16400 | loss: 0.6166 | profit rate: 6595392154919498085256378115304237655313045321059399630848.0 | accuracy: 0.86
step_num: 16600 | loss: 0.3808 | profit rate: 5835588110027019273878031315317678511059739446073812973023920128.0 | accuracy: 0.86
step_num: 16800 | loss: 0.5091 | profit rate: 53700580706523644673398888998569450836486251445740685414666017439744.0 | accuracy: 0.86
step_num: 17000 | loss: 0.4152 | profit rate: 8200823125840792938073794790594272308646579805262390500350031351441784832.0 | accuracy: 0.86
step_num: 17200 | loss: 0.5814 | profit rate: 1094073589415265901406480528133692258525197747848441873384842286782413023477760.0 | accuracy: 0.86
step_num: 17400 | loss: 0.5699 | profit rate: 17023779966926636602482484611080801645784981125422303287995439525882390320800333824.0 | accuracy: 0.86
episode:   5/5,耗时:0.86分/4.74分,训练集: | step: 17590 | average_treward: 3261.5 | max_treward: 3550.9914 | average profit rate: 1263223724001816883959784212327030727293434766982243928441626463089720486501189419008.000
model saved @ step:17590,performance:3979380274839929319408683248231555501302475474038882696518869932111393210822821937152.000,accuracy:0.85
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 13%|        | 51/401 [00:00<00:00, 504.97it/s] 28%|       | 111/401 [00:00<00:00, 557.38it/s] 44%|     | 175/401 [00:00<00:00, 589.55it/s] 60%|    | 242/401 [00:00<00:00, 618.62it/s] 77%|  | 308/401 [00:00<00:00, 631.16it/s] 94%|| 375/401 [00:00<00:00, 640.91it/s]100%|| 401/401 [00:00<00:00, 618.31it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2352.04
2023-07-24T12:00:00 | net performance [%] = 135.2037
2023-07-24T12:00:00 | number of trades [#] = 42
==================================================
Trial 49 Complete [00h 05m 18s]
net_wealth: 2352.0373551714433

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 30m 03s

Search: Running Trial #50

Value             |Best Value So Far |Hyperparameter
3                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.85              |0.5               |gamma
0.001             |0.001             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4298.000000   4301.000000
mean      0.000435    20113.607657  ...   20180.392273  20169.373185
std       0.027833    16040.642334  ...   16078.781641  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7741.750122   7730.930176
50%       0.000642    11571.842969  ...   11754.949707  11751.469727
75%       0.011590    29894.706152  ...   30015.383301  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.5974 | profit rate:    2.2 | accuracy: 0.40
step_num: 400 | loss: 0.2734 | profit rate:    4.1 | accuracy: 0.40
step_num: 600 | loss: 0.6873 | profit rate:   52.4 | accuracy: 0.42
step_num: 800 | loss: 0.3455 | profit rate:  859.3 | accuracy: 0.44
step_num: 1000 | loss: 0.6413 | profit rate: 13297.0 | accuracy: 0.48
step_num: 1200 | loss: 0.5011 | profit rate: 798128.2 | accuracy: 0.50
step_num: 1400 | loss: 0.3219 | profit rate: 20801875.0 | accuracy: 0.53
step_num: 1600 | loss: 0.2777 | profit rate: 291289816.1 | accuracy: 0.54
step_num: 1800 | loss: 0.5402 | profit rate: 448833186738.5 | accuracy: 0.56
step_num: 2000 | loss: 0.8197 | profit rate: 236288054092422.2 | accuracy: 0.57
step_num: 2200 | loss: 0.3179 | profit rate: 148315980673954368.0 | accuracy: 0.59
step_num: 2400 | loss: 0.2868 | profit rate: 37525920607929761792.0 | accuracy: 0.61
step_num: 2600 | loss: 0.3900 | profit rate: 5977439594682092879872.0 | accuracy: 0.62
step_num: 2800 | loss: 0.2989 | profit rate: 1092381993397721617137664.0 | accuracy: 0.63
step_num: 3000 | loss: 0.2701 | profit rate: 71922233075795466272112640.0 | accuracy: 0.64
episode:   1/5,耗时:0.70分/0.70分,训练集: | step: 3149 | average_treward: 1732.6 | max_treward: 1732.6049 | average profit rate: 1163213005815474450021220352.000
model saved @ step:3149,performance:1163213005815474450021220352.000,accuracy:0.64
step_num: 3200 | loss: 0.1412 | profit rate:    3.1 | accuracy: 0.90
step_num: 3400 | loss: 0.2490 | profit rate:  786.0 | accuracy: 0.81
step_num: 3600 | loss: 0.1937 | profit rate: 17142.0 | accuracy: 0.78
step_num: 3800 | loss: 0.3691 | profit rate: 32072022.4 | accuracy: 0.80
step_num: 4000 | loss: 0.1153 | profit rate: 4294256612.4 | accuracy: 0.79
step_num: 4200 | loss: 0.1756 | profit rate: 356937101450.4 | accuracy: 0.80
step_num: 4400 | loss: 0.2264 | profit rate: 761469815770807.5 | accuracy: 0.80
step_num: 4600 | loss: 0.1625 | profit rate: 12806022942645630.0 | accuracy: 0.79
step_num: 4800 | loss: 0.2096 | profit rate: 803856965849842048.0 | accuracy: 0.79
step_num: 5000 | loss: 0.3399 | profit rate: 1267152990039299850240.0 | accuracy: 0.79
step_num: 5200 | loss: 0.1982 | profit rate: 2868393646954135072800768.0 | accuracy: 0.79
step_num: 5400 | loss: 0.1671 | profit rate: 1203227528905821207497015296.0 | accuracy: 0.79
step_num: 5600 | loss: 0.2939 | profit rate: 257389371228595970498371780608.0 | accuracy: 0.79
step_num: 5800 | loss: 0.2017 | profit rate: 78728627064597890983743178407936.0 | accuracy: 0.80
step_num: 6000 | loss: 0.4458 | profit rate: 46910726428078954555587321917341696.0 | accuracy: 0.80
step_num: 6200 | loss: 0.2832 | profit rate: 2613546355393164565595982360345575424.0 | accuracy: 0.80
model saved @ step:6298,performance:11924260955501749090613291060008321024.000,accuracy:0.80
step_num: 6400 | loss: 0.1813 | profit rate:    6.5 | accuracy: 0.85
step_num: 6600 | loss: 0.1899 | profit rate: 1068.2 | accuracy: 0.81
step_num: 6800 | loss: 0.3104 | profit rate: 38985.6 | accuracy: 0.80
step_num: 7000 | loss: 0.1822 | profit rate: 62353727.4 | accuracy: 0.80
step_num: 7200 | loss: 0.1495 | profit rate: 8587200451.1 | accuracy: 0.81
step_num: 7400 | loss: 0.2357 | profit rate: 772895946938.1 | accuracy: 0.82
step_num: 7600 | loss: 0.1996 | profit rate: 820027014238086.2 | accuracy: 0.82
step_num: 7800 | loss: 0.1366 | profit rate: 17547034448514478.0 | accuracy: 0.82
step_num: 8000 | loss: 0.2254 | profit rate: 3568387902354484736.0 | accuracy: 0.81
step_num: 8200 | loss: 0.2908 | profit rate: 13577329766983777910784.0 | accuracy: 0.82
step_num: 8400 | loss: 0.1436 | profit rate: 39756628638983151308242944.0 | accuracy: 0.82
step_num: 8600 | loss: 0.2113 | profit rate: 19952801987889396090096582656.0 | accuracy: 0.82
step_num: 8800 | loss: 0.1860 | profit rate: 5505366792681565701454996439040.0 | accuracy: 0.82
step_num: 9000 | loss: 0.1631 | profit rate: 2519096446410153191498543611772928.0 | accuracy: 0.83
step_num: 9200 | loss: 0.3899 | profit rate: 781829410082385958149113994868162560.0 | accuracy: 0.82
step_num: 9400 | loss: 0.2519 | profit rate: 49570655183028385292688010931662225408.0 | accuracy: 0.82
episode:   3/5,耗时:0.77分/2.25分,训练集: | step: 9447 | average_treward: 2293.4 | max_treward: 2629.7392 | average profit rate: 32653482804536957699999139841907359744.000
model saved @ step:9447,performance:86036187456945898891407470282563125248.000,accuracy:0.82
step_num: 9600 | loss: 0.2399 | profit rate:   14.3 | accuracy: 0.78
step_num: 9800 | loss: 0.2999 | profit rate: 1812.0 | accuracy: 0.78
step_num: 10000 | loss: 0.2611 | profit rate: 167725.4 | accuracy: 0.78
step_num: 10200 | loss: 0.1804 | profit rate: 119135743.3 | accuracy: 0.79
step_num: 10400 | loss: 0.2820 | profit rate: 16278940469.8 | accuracy: 0.80
step_num: 10600 | loss: 0.2716 | profit rate: 20017145558425.8 | accuracy: 0.81
step_num: 10800 | loss: 0.1760 | profit rate: 1897249261724381.8 | accuracy: 0.81
step_num: 11000 | loss: 0.1073 | profit rate: 50850065303964032.0 | accuracy: 0.82
step_num: 11200 | loss: 0.2253 | profit rate: 112722405546338811904.0 | accuracy: 0.82
step_num: 11400 | loss: 0.2437 | profit rate: 200726072521860027777024.0 | accuracy: 0.82
step_num: 11600 | loss: 0.2063 | profit rate: 760214300587687426459172864.0 | accuracy: 0.83
step_num: 11800 | loss: 0.3022 | profit rate: 177379767137637549737110405120.0 | accuracy: 0.82
step_num: 12000 | loss: 0.3044 | profit rate: 76152081256171677390679322918912.0 | accuracy: 0.82
step_num: 12200 | loss: 0.1290 | profit rate: 17436048752672203205111757141966848.0 | accuracy: 0.83
step_num: 12400 | loss: 0.3433 | profit rate: 7945562760793623173953757669712986112.0 | accuracy: 0.83
model saved @ step:12596,performance:226565012688941130943025148485424906240.000,accuracy:0.83
step_num: 12600 | loss: 0.2431 | profit rate:    1.4 | accuracy: 0.80
step_num: 12800 | loss: 0.2978 | profit rate:   74.1 | accuracy: 0.72
step_num: 13000 | loss: 0.1314 | profit rate: 2885.7 | accuracy: 0.75
step_num: 13200 | loss: 0.2050 | profit rate: 2014673.8 | accuracy: 0.78
step_num: 13400 | loss: 0.1871 | profit rate: 825887269.7 | accuracy: 0.81
step_num: 13600 | loss: 0.1299 | profit rate: 108776349320.7 | accuracy: 0.82
step_num: 13800 | loss: 0.2166 | profit rate: 122979841945559.2 | accuracy: 0.82
step_num: 14000 | loss: 0.1792 | profit rate: 10304854992102588.0 | accuracy: 0.83
step_num: 14200 | loss: 0.2417 | profit rate: 304277480228166208.0 | accuracy: 0.83
step_num: 14400 | loss: 0.3379 | profit rate: 653422875875551870976.0 | accuracy: 0.82
step_num: 14600 | loss: 0.4452 | profit rate: 1131008399892386001453056.0 | accuracy: 0.82
step_num: 14800 | loss: 0.2953 | profit rate: 1181817172130076281343574016.0 | accuracy: 0.82
step_num: 15000 | loss: 0.1758 | profit rate: 532764901224915626719243665408.0 | accuracy: 0.83
step_num: 15200 | loss: 0.1577 | profit rate: 174488769078762795302957701136384.0 | accuracy: 0.83
step_num: 15400 | loss: 0.3857 | profit rate: 115034515394426965519957582241857536.0 | accuracy: 0.83
step_num: 15600 | loss: 0.4136 | profit rate: 8437348948132695600625912031416942592.0 | accuracy: 0.83
episode:   5/5,耗时:1.36分/4.99分,训练集: | step: 15745 | average_treward: 2453.2 | max_treward: 2708.5805 | average profit rate: 88326828178071455401707020903988068352.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 51/397 [00:00<00:00, 510.00it/s] 28%|       | 113/397 [00:00<00:00, 571.35it/s] 44%|     | 176/397 [00:00<00:00, 598.04it/s] 61%|    | 241/397 [00:00<00:00, 618.51it/s] 77%|  | 307/397 [00:00<00:00, 631.18it/s] 94%|| 373/397 [00:00<00:00, 638.78it/s]==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
100%|| 397/397 [00:00<00:00, 618.38it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3731.52
2023-07-24T12:00:00 | net performance [%] = 273.1525
2023-07-24T12:00:00 | number of trades [#] = 68
==================================================
Trial 50 Complete [00h 05m 38s]
net_wealth: 3731.5246011581603

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 35m 41s

Search: Running Trial #51

Value             |Best Value So Far |Hyperparameter
12                |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
7                 |3                 |lags
0.95              |0.5               |gamma
1e-05             |0.001             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4303.000000   4315.000000
mean      0.000441    20062.255222  ...   20162.113925  20118.633889
std       0.027818    16039.874230  ...   16078.371573  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7724.814941   7690.540039
50%       0.000642    11554.824463  ...   11750.650391  11715.610352
75%       0.011655    29873.081836  ...   30003.260742  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.3300 | profit rate:    0.1 | accuracy: 0.32
step_num: 1200 | loss: 0.7439 | profit rate:    0.1 | accuracy: 0.32
step_num: 1400 | loss: 0.6358 | profit rate:    0.1 | accuracy: 0.31
step_num: 1600 | loss: 0.5864 | profit rate:    0.1 | accuracy: 0.31
step_num: 1800 | loss: 0.5358 | profit rate:    0.1 | accuracy: 0.29
step_num: 2000 | loss: 0.5285 | profit rate:    0.3 | accuracy: 0.29
step_num: 2200 | loss: 0.5080 | profit rate:    1.1 | accuracy: 0.30
step_num: 2400 | loss: 0.4412 | profit rate:    2.4 | accuracy: 0.29
step_num: 2600 | loss: 0.4435 | profit rate:    3.2 | accuracy: 0.28
step_num: 2800 | loss: 0.4275 | profit rate: 1419.3 | accuracy: 0.29
step_num: 3000 | loss: 0.3950 | profit rate: 10213.1 | accuracy: 0.29
episode:   1/5,耗时:2.09分/2.09分,训练集: | step: 3170 | average_treward:  185.2 | max_treward: 185.2237 | average profit rate: 62613.120
model saved @ step:3170,performance:62613.120,accuracy:0.28
step_num: 3200 | loss: 0.3584 | profit rate:    1.9 | accuracy: 0.16
step_num: 3400 | loss: 0.3435 | profit rate:  355.5 | accuracy: 0.26
step_num: 3600 | loss: 0.3545 | profit rate: 1201.7 | accuracy: 0.29
step_num: 3800 | loss: 0.3836 | profit rate: 54652.5 | accuracy: 0.30
step_num: 4000 | loss: 0.3975 | profit rate: 13254584.7 | accuracy: 0.33
step_num: 4200 | loss: 0.3948 | profit rate: 47641766.9 | accuracy: 0.33
step_num: 4400 | loss: 0.4238 | profit rate: 2390706216.4 | accuracy: 0.33
step_num: 4600 | loss: 0.4396 | profit rate: 19126232458.4 | accuracy: 0.34
step_num: 4800 | loss: 0.4230 | profit rate: 1569657541102.9 | accuracy: 0.35
step_num: 5000 | loss: 0.4680 | profit rate: 4083498523416750080.0 | accuracy: 0.39
step_num: 5200 | loss: 0.5302 | profit rate: 76796550659203460497408.0 | accuracy: 0.42
step_num: 5400 | loss: 0.5642 | profit rate: 21831976742759781275533312.0 | accuracy: 0.42
step_num: 5600 | loss: 0.6034 | profit rate: 6630979782961944360690647040.0 | accuracy: 0.43
step_num: 5800 | loss: 0.5940 | profit rate: 4462842647420802457690131398656.0 | accuracy: 0.44
step_num: 6000 | loss: 0.6118 | profit rate: 57019120166744523304498381360988160.0 | accuracy: 0.45
step_num: 6200 | loss: 0.6145 | profit rate: 1940317290120826498644031069858299904.0 | accuracy: 0.45
model saved @ step:6340,performance:17768838059492323923287707022350352384.000,accuracy:0.45
step_num: 6400 | loss: 0.6293 | profit rate:    2.4 | accuracy: 0.48
step_num: 6600 | loss: 0.6167 | profit rate: 21863.6 | accuracy: 0.60
step_num: 6800 | loss: 0.6662 | profit rate: 363549.4 | accuracy: 0.57
step_num: 7000 | loss: 0.6483 | profit rate: 24003937425.1 | accuracy: 0.62
step_num: 7200 | loss: 0.6807 | profit rate: 2888925272257.5 | accuracy: 0.60
step_num: 7400 | loss: 0.6220 | profit rate: 1905361845106888.0 | accuracy: 0.62
step_num: 7600 | loss: 0.6785 | profit rate: 66484415630765711360.0 | accuracy: 0.62
step_num: 7800 | loss: 0.6776 | profit rate: 2892135093602880585728.0 | accuracy: 0.62
step_num: 8000 | loss: 0.6419 | profit rate: 2804921930164161159888896.0 | accuracy: 0.63
step_num: 8200 | loss: 0.7504 | profit rate: 255635241798089819318273844445184.0 | accuracy: 0.65
step_num: 8400 | loss: 0.7221 | profit rate: 8892021947815385041530836815194357760.0 | accuracy: 0.65
step_num: 8600 | loss: 0.7519 | profit rate: 5014506338688973912854350287351733813248.0 | accuracy: 0.65
step_num: 8800 | loss: 0.7425 | profit rate: 6300427258286223239784451885620501569077248.0 | accuracy: 0.65
step_num: 9000 | loss: 0.7412 | profit rate: 3196439452365584203647923565861725556724203520.0 | accuracy: 0.65
step_num: 9200 | loss: 0.7536 | profit rate: 40429018847254806688060443245282568456134004310016.0 | accuracy: 0.65
step_num: 9400 | loss: 0.7320 | profit rate: 2332651675475126481840989110744640060009811592347648.0 | accuracy: 0.65
episode:   3/5,耗时:3.17分/8.65分,训练集: | step: 9510 | average_treward: 1023.7 | max_treward: 1694.9540 | average profit rate: 7848629484934289046020030000446297709591324260302848.000
model saved @ step:9510,performance:23545888454802848528868149012516672475475128856084480.000,accuracy:0.65
step_num: 9600 | loss: 0.7431 | profit rate:    4.3 | accuracy: 0.66
step_num: 9800 | loss: 0.7009 | profit rate: 39044.7 | accuracy: 0.67
step_num: 10000 | loss: 0.7164 | profit rate: 4843466.4 | accuracy: 0.68
step_num: 10200 | loss: 0.7490 | profit rate: 1366145571684.2 | accuracy: 0.70
step_num: 10400 | loss: 0.7491 | profit rate: 71392561233472.5 | accuracy: 0.67
step_num: 10600 | loss: 0.7312 | profit rate: 61865748352549736.0 | accuracy: 0.68
step_num: 10800 | loss: 0.7137 | profit rate: 5650829351006211407872.0 | accuracy: 0.67
step_num: 11000 | loss: 0.7569 | profit rate: 220325769931829398208512.0 | accuracy: 0.66
step_num: 11200 | loss: 0.6887 | profit rate: 1785531973098982539637293056.0 | accuracy: 0.67
step_num: 11400 | loss: 0.6956 | profit rate: 100751174080008371586899188023033856.0 | accuracy: 0.69
step_num: 11600 | loss: 0.7390 | profit rate: 2158742399033731777572234220899974250496.0 | accuracy: 0.69
step_num: 11800 | loss: 0.7713 | profit rate: 31952089868276241369236655905919571840729088.0 | accuracy: 0.69
step_num: 12000 | loss: 0.7405 | profit rate: 5113298877821279637888701442230852348454895616.0 | accuracy: 0.68
step_num: 12200 | loss: 0.7321 | profit rate: 3971517723051197830375150060186689858637171523584.0 | accuracy: 0.68
step_num: 12400 | loss: 0.7477 | profit rate: 126668731116687085524909092407217055405970418045026304.0 | accuracy: 0.68
step_num: 12600 | loss: 0.7505 | profit rate: 66177445434802684768054444474739307998480385663083479040.0 | accuracy: 0.68
model saved @ step:12680,performance:105500601333551812852380376939758122260772169519432990720.000,accuracy:0.68
step_num: 12800 | loss: 0.7295 | profit rate:    8.3 | accuracy: 0.68
step_num: 13000 | loss: 0.6652 | profit rate: 267005.6 | accuracy: 0.72
step_num: 13200 | loss: 0.6885 | profit rate: 984926829.1 | accuracy: 0.73
step_num: 13400 | loss: 0.7180 | profit rate: 39498219514992.0 | accuracy: 0.72
step_num: 13600 | loss: 0.6886 | profit rate: 42562725785290232.0 | accuracy: 0.71
step_num: 13800 | loss: 0.7470 | profit rate: 196464519532740116480.0 | accuracy: 0.70
step_num: 14000 | loss: 0.7580 | profit rate: 816308270626129531895808.0 | accuracy: 0.70
step_num: 14200 | loss: 0.6630 | profit rate: 98929773017113241531187200.0 | accuracy: 0.69
step_num: 14400 | loss: 0.6861 | profit rate: 25690280433076627639767717117952.0 | accuracy: 0.70
step_num: 14600 | loss: 0.7376 | profit rate: 15907832147013170304900300508999188480.0 | accuracy: 0.70
step_num: 14800 | loss: 0.7295 | profit rate: 2037333587709496188060549149366270340104192.0 | accuracy: 0.70
step_num: 15000 | loss: 0.7145 | profit rate: 5107084021849774821762259153537239059271778304.0 | accuracy: 0.70
step_num: 15200 | loss: 0.7272 | profit rate: 6314912137402040471883110128783308048216650416128.0 | accuracy: 0.70
step_num: 15400 | loss: 0.7308 | profit rate: 26162966071250572006748277111600401587654288258105344.0 | accuracy: 0.70
step_num: 15600 | loss: 0.7657 | profit rate: 839475990074967213684750933125276060990239512838631587840.0 | accuracy: 0.70
step_num: 15800 | loss: 0.7378 | profit rate: 91644996041047507578749586678962446382090144804157303816192.0 | accuracy: 0.70
episode:   5/5,耗时:3.16分/14.92分,训练集: | step: 15850 | average_treward: 1393.6 | max_treward: 2012.9900 | average profit rate: 23152812010552667123728850525370651380220646110401742766080.000
model saved @ step:15850,performance:115658535905541329694795881363846918781618327326797533806592.000,accuracy:0.69
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 13%|        | 52/404 [00:00<00:00, 514.87it/s] 28%|       | 113/404 [00:00<00:00, 567.28it/s] 44%|     | 177/404 [00:00<00:00, 597.59it/s] 60%|    | 244/404 [00:00<00:00, 623.56it/s] 77%|  | 311/404 [00:00<00:00, 637.92it/s] 93%|| 377/404 [00:00<00:00, 645.37it/s]100%|| 404/404 [00:00<00:00, 624.43it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2961.25
2023-07-24T12:00:00 | net performance [%] = 196.1251
2023-07-24T12:00:00 | number of trades [#] = 76
==================================================
Trial 51 Complete [00h 15m 10s]
net_wealth: 2961.2507451446536

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 07h 50m 51s

Search: Running Trial #52

Value             |Best Value So Far |Hyperparameter
9                 |1                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
8                 |3                 |lags
0.92              |0.5               |gamma
0.0001            |0.001             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4306.000000   4315.000000
mean      0.000441    20062.255222  ...   20151.395964  20118.633889
std       0.027818    16039.874230  ...   16077.894500  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7715.610107   7690.540039
50%       0.000642    11554.824463  ...   11746.555176  11715.610352
75%       0.011655    29873.081836  ...   29983.155273  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.5548 | profit rate:    4.5 | accuracy: 0.34
step_num: 800 | loss: 0.4834 | profit rate:  157.7 | accuracy: 0.36
step_num: 1000 | loss: 0.4693 | profit rate: 1369.7 | accuracy: 0.37
step_num: 1200 | loss: 0.5023 | profit rate: 534405.1 | accuracy: 0.39
step_num: 1400 | loss: 0.4671 | profit rate: 34078921.1 | accuracy: 0.42
step_num: 1600 | loss: 0.5046 | profit rate: 1853365299.9 | accuracy: 0.44
step_num: 1800 | loss: 0.5266 | profit rate: 30651545004751.8 | accuracy: 0.47
step_num: 2000 | loss: 0.4626 | profit rate: 325364291944986176.0 | accuracy: 0.49
step_num: 2200 | loss: 0.4896 | profit rate: 307799764636283633664.0 | accuracy: 0.50
step_num: 2400 | loss: 0.4842 | profit rate: 493967658857662907416576.0 | accuracy: 0.52
step_num: 2600 | loss: 0.5355 | profit rate: 10474961246222010326731194368.0 | accuracy: 0.55
step_num: 2800 | loss: 0.4473 | profit rate: 363710097366772546605956758241280.0 | accuracy: 0.56
step_num: 3000 | loss: 0.4627 | profit rate: 522566379962388440469788208236855296.0 | accuracy: 0.57
episode:   1/5,耗时:1.50分/1.50分,训练集: | step: 3169 | average_treward: 1499.9 | max_treward: 1499.8945 | average profit rate: 26731391544960824370800269595401781248.000
model saved @ step:3169,performance:26731391544960824370800269595401781248.000,accuracy:0.58
step_num: 3200 | loss: 0.4723 | profit rate:    3.8 | accuracy: 0.72
step_num: 3400 | loss: 0.4522 | profit rate: 47451.7 | accuracy: 0.77
step_num: 3600 | loss: 0.4953 | profit rate: 6945957.5 | accuracy: 0.74
step_num: 3800 | loss: 0.4974 | profit rate: 1004964144230.3 | accuracy: 0.76
step_num: 4000 | loss: 0.4794 | profit rate: 26575350787942560.0 | accuracy: 0.78
step_num: 4200 | loss: 0.4793 | profit rate: 134345185124710891520.0 | accuracy: 0.79
step_num: 4400 | loss: 0.4641 | profit rate: 76622703658845640832581632.0 | accuracy: 0.80
step_num: 4600 | loss: 0.4359 | profit rate: 25051579699435599730808193024.0 | accuracy: 0.79
step_num: 4800 | loss: 0.4548 | profit rate: 6970206219307166875957933899776.0 | accuracy: 0.78
step_num: 5000 | loss: 0.4387 | profit rate: 79532968082449840347854774040067571712.0 | accuracy: 0.79
step_num: 5200 | loss: 0.4752 | profit rate: 11143951466200783574176850836709891417047040.0 | accuracy: 0.79
step_num: 5400 | loss: 0.4854 | profit rate: 209608735565441112742952143237943384728370413568.0 | accuracy: 0.80
step_num: 5600 | loss: 0.4418 | profit rate: 1278430974909801439204175697637343479757539964354560.0 | accuracy: 0.80
step_num: 5800 | loss: 0.4195 | profit rate: 39824297726384544737255634029977752960566724697534758912.0 | accuracy: 0.80
step_num: 6000 | loss: 0.4524 | profit rate: 1977293245747394824489764792206225955322569506936570133872640.0 | accuracy: 0.80
step_num: 6200 | loss: 0.4362 | profit rate: 1841351658729725401076911244590515544314017931933649831592984576.0 | accuracy: 0.80
model saved @ step:6338,performance:86923953712530786584795614302438399212343053310038641870670659584.000,accuracy:0.79
step_num: 6400 | loss: 0.4576 | profit rate:    9.0 | accuracy: 0.83
step_num: 6600 | loss: 0.4249 | profit rate: 254965.5 | accuracy: 0.80
step_num: 6800 | loss: 0.4813 | profit rate: 72174023.3 | accuracy: 0.79
step_num: 7000 | loss: 0.4772 | profit rate: 49358882645079.8 | accuracy: 0.80
step_num: 7200 | loss: 0.4564 | profit rate: 740906274779801600.0 | accuracy: 0.81
step_num: 7400 | loss: 0.4454 | profit rate: 1530435569437281615872.0 | accuracy: 0.82
step_num: 7600 | loss: 0.4333 | profit rate: 1912914794645869397421326336.0 | accuracy: 0.83
step_num: 7800 | loss: 0.4534 | profit rate: 217706409709856497954627518464.0 | accuracy: 0.82
step_num: 8000 | loss: 0.4255 | profit rate: 281798042769403303677234167939072.0 | accuracy: 0.81
step_num: 8200 | loss: 0.4133 | profit rate: 6361107105182254595702565103422641537024.0 | accuracy: 0.82
step_num: 8400 | loss: 0.5025 | profit rate: 1324383513324581104272883513539628668066725888.0 | accuracy: 0.82
step_num: 8600 | loss: 0.4649 | profit rate: 23793292534141103768274677438915249772915700269056.0 | accuracy: 0.82
step_num: 8800 | loss: 0.4681 | profit rate: 65718724229320978043481899612063155067783380041990144.0 | accuracy: 0.82
step_num: 9000 | loss: 0.4374 | profit rate: 1299167264695147133866928029914473834794261616970025664512.0 | accuracy: 0.82
step_num: 9200 | loss: 0.4539 | profit rate: 171125402938758922279664569932635611033515188711159714170273792.0 | accuracy: 0.82
step_num: 9400 | loss: 0.4410 | profit rate: 71978184544534021484402908908656381024895457352534019889285824512.0 | accuracy: 0.81
episode:   3/5,耗时:1.84分/5.20分,训练集: | step: 9507 | average_treward: 2316.3 | max_treward: 2764.4552 | average profit rate: 336809557535328371728135473484131565034287317450932366977649344512.000
model saved @ step:9507,performance:923504718893454293523571510208286259002082913851965987319896342528.000,accuracy:0.81
step_num: 9600 | loss: 0.4466 | profit rate:   13.5 | accuracy: 0.76
step_num: 9800 | loss: 0.4729 | profit rate: 598969.8 | accuracy: 0.77
step_num: 10000 | loss: 0.4909 | profit rate: 173797408.6 | accuracy: 0.78
step_num: 10200 | loss: 0.4765 | profit rate: 400681855024925.7 | accuracy: 0.80
step_num: 10400 | loss: 0.4809 | profit rate: 2297672810415529216.0 | accuracy: 0.80
step_num: 10600 | loss: 0.4492 | profit rate: 7212143059320099045376.0 | accuracy: 0.81
step_num: 10800 | loss: 0.4535 | profit rate: 7226363870721775988522352640.0 | accuracy: 0.82
step_num: 11000 | loss: 0.4188 | profit rate: 916343444168817626100273250304.0 | accuracy: 0.80
step_num: 11200 | loss: 0.3954 | profit rate: 3408271558117803854789101423165440.0 | accuracy: 0.80
step_num: 11400 | loss: 0.4256 | profit rate: 24838910685888231356472658858357735555072.0 | accuracy: 0.81
step_num: 11600 | loss: 0.5016 | profit rate: 1819997940921251788021318711993718132818575360.0 | accuracy: 0.81
step_num: 11800 | loss: 0.4575 | profit rate: 147588164126658519497762015368960935600252600188928.0 | accuracy: 0.81
step_num: 12000 | loss: 0.4541 | profit rate: 163672243437887203643137323137000207582623573045411840.0 | accuracy: 0.81
step_num: 12200 | loss: 0.4881 | profit rate: 1058453775906653496641322338854586464272241701714086854656.0 | accuracy: 0.81
step_num: 12400 | loss: 0.4734 | profit rate: 66009989687148433567479346703144910807546099486276129541586944.0 | accuracy: 0.80
step_num: 12600 | loss: 0.5010 | profit rate: 108350814232090608032616223751598262158033989810179375842482716672.0 | accuracy: 0.80
step_num: 12800 | loss: 0.4189 | profit rate:   32.5 | accuracy: 0.82
step_num: 13000 | loss: 0.4810 | profit rate: 1274307.3 | accuracy: 0.78
step_num: 13200 | loss: 0.4568 | profit rate: 6510071007.4 | accuracy: 0.80
step_num: 13400 | loss: 0.4893 | profit rate: 3298799089483089.5 | accuracy: 0.81
step_num: 13600 | loss: 0.4638 | profit rate: 35720029048128864256.0 | accuracy: 0.82
step_num: 13800 | loss: 0.4782 | profit rate: 1378895202738683565309952.0 | accuracy: 0.83
step_num: 14000 | loss: 0.4343 | profit rate: 22486910751854686942718328832.0 | accuracy: 0.83
step_num: 14200 | loss: 0.4276 | profit rate: 4303485907847575644484344479744.0 | accuracy: 0.81
step_num: 14400 | loss: 0.4559 | profit rate: 460821971250097154085043554379366400.0 | accuracy: 0.81
step_num: 14600 | loss: 0.4191 | profit rate: 156439951601512083444262429107034855047168.0 | accuracy: 0.81
step_num: 14800 | loss: 0.4955 | profit rate: 33490312450313279983818403168637447138921414656.0 | accuracy: 0.81
step_num: 15000 | loss: 0.5304 | profit rate: 576676588725203054025305005488078527643199754731520.0 | accuracy: 0.81
step_num: 15200 | loss: 0.4342 | profit rate: 2132900616012542525375867071655434915498873427656179712.0 | accuracy: 0.81
step_num: 15400 | loss: 0.4921 | profit rate: 32229662958236752083920440726179292889841345318710520315904.0 | accuracy: 0.81
step_num: 15600 | loss: 0.4832 | profit rate: 2330722776479114409854110538805985585424486914666247750839959552.0 | accuracy: 0.81
step_num: 15800 | loss: 0.4551 | profit rate: 995897911336127132782427025442234800952638160003443272750897037312.0 | accuracy: 0.80
episode:   5/5,耗时:2.38分/9.96分,训练集: | step: 15845 | average_treward: 2491.9 | max_treward: 2773.8929 | average profit rate: 626955784569527878995403749646717655187026596725026335163529822208.000
model saved @ step:15845,performance:1836702317876399244674090435936679574885694688223346238654951456768.000,accuracy:0.80
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 13%|        | 54/403 [00:00<00:00, 534.68it/s] 29%|       | 116/403 [00:00<00:00, 584.66it/s] 45%|     | 180/403 [00:00<00:00, 607.12it/s] 61%|   | 247/403 [00:00<00:00, 629.79it/s] 78%|  | 313/403 [00:00<00:00, 640.63it/s] 94%|| 380/403 [00:00<00:00, 650.19it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 629.69it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2703.32
2023-07-24T12:00:00 | net performance [%] = 170.3316
2023-07-24T12:00:00 | number of trades [#] = 72
==================================================
Trial 52 Complete [00h 10m 30s]
net_wealth: 2703.3159884246807

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 01m 22s

Search: Running Trial #53

Value             |Best Value So Far |Hyperparameter
7                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.85              |0.5               |gamma
0.0001            |0.001             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4294.000000   4301.000000
mean      0.000435    20113.607657  ...   20195.171043  20169.373185
std       0.027833    16040.642334  ...   16078.971923  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7758.522461   7730.930176
50%       0.000642    11571.842969  ...   11758.879883  11751.469727
75%       0.011590    29894.706152  ...   30019.495605  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.5535 | profit rate:    1.9 | accuracy: 0.36
step_num: 600 | loss: 0.5132 | profit rate:    7.5 | accuracy: 0.36
step_num: 800 | loss: 0.4738 | profit rate:    8.3 | accuracy: 0.35
step_num: 1000 | loss: 0.4868 | profit rate:   39.5 | accuracy: 0.35
step_num: 1200 | loss: 0.5245 | profit rate:  176.1 | accuracy: 0.36
step_num: 1400 | loss: 0.5514 | profit rate: 1041.0 | accuracy: 0.37
step_num: 1600 | loss: 0.5672 | profit rate: 45534.1 | accuracy: 0.38
step_num: 1800 | loss: 0.4558 | profit rate: 133501.5 | accuracy: 0.38
step_num: 2000 | loss: 0.3433 | profit rate: 2293757.7 | accuracy: 0.39
step_num: 2200 | loss: 0.5081 | profit rate: 6210510179.0 | accuracy: 0.40
step_num: 2400 | loss: 0.5572 | profit rate: 187808712775.3 | accuracy: 0.41
step_num: 2600 | loss: 0.5154 | profit rate: 30905342394975.6 | accuracy: 0.43
step_num: 2800 | loss: 0.6079 | profit rate: 1281652042787333.8 | accuracy: 0.44
step_num: 3000 | loss: 0.5429 | profit rate: 210438446146597536.0 | accuracy: 0.46
step_num: 3200 | loss: 0.5359 | profit rate: 27464221307110502400.0 | accuracy: 0.46
step_num: 3400 | loss: 0.5053 | profit rate: 645387518559709036544.0 | accuracy: 0.47
episode:   1/5,耗时:1.88分/1.88分,训练集: | step: 3525 | average_treward:  892.6 | max_treward: 892.6103 | average profit rate: 5857783436435400949760.000
model saved @ step:3525,performance:5857783436435400949760.000,accuracy:0.48
step_num: 3600 | loss: 0.5511 | profit rate:   13.1 | accuracy: 0.66
step_num: 3800 | loss: 0.6192 | profit rate: 1008.4 | accuracy: 0.64
step_num: 4000 | loss: 0.5949 | profit rate: 76961.2 | accuracy: 0.66
step_num: 4200 | loss: 0.5549 | profit rate: 2814047.3 | accuracy: 0.64
step_num: 4400 | loss: 0.5951 | profit rate: 66352723.4 | accuracy: 0.61
step_num: 4600 | loss: 0.6193 | profit rate: 44126150570.3 | accuracy: 0.62
step_num: 4800 | loss: 0.6304 | profit rate: 1052058669722.9 | accuracy: 0.61
step_num: 5000 | loss: 0.5956 | profit rate: 91699837803471.4 | accuracy: 0.61
step_num: 5200 | loss: 0.6014 | profit rate: 6584433152382802.0 | accuracy: 0.61
step_num: 5400 | loss: 0.5458 | profit rate: 74274537788682688.0 | accuracy: 0.61
step_num: 5600 | loss: 0.5306 | profit rate: 288374810965770633216.0 | accuracy: 0.62
step_num: 5800 | loss: 0.5501 | profit rate: 110763805085831884963840.0 | accuracy: 0.62
step_num: 6000 | loss: 0.6206 | profit rate: 3024655676523567132966912.0 | accuracy: 0.61
step_num: 6200 | loss: 0.5685 | profit rate: 767282394332446496535871488.0 | accuracy: 0.62
step_num: 6400 | loss: 0.5513 | profit rate: 25418476783110402673523818496.0 | accuracy: 0.61
step_num: 6600 | loss: 0.4047 | profit rate: 4025569518849774828089902104576.0 | accuracy: 0.61
step_num: 6800 | loss: 0.4495 | profit rate: 814224246538295522598602691051520.0 | accuracy: 0.61
step_num: 7000 | loss: 0.4489 | profit rate: 33955559856875236116278139548598272.0 | accuracy: 0.61
model saved @ step:7050,performance:46552688961975897142909336115216384.000,accuracy:0.61
step_num: 7200 | loss: 0.5344 | profit rate:   58.8 | accuracy: 0.62
step_num: 7400 | loss: 0.5163 | profit rate: 12981.0 | accuracy: 0.64
step_num: 7600 | loss: 0.5103 | profit rate: 892520.9 | accuracy: 0.61
step_num: 7800 | loss: 0.4738 | profit rate: 19106664.6 | accuracy: 0.59
step_num: 8000 | loss: 0.5551 | profit rate: 4209836939.4 | accuracy: 0.59
step_num: 8200 | loss: 0.5691 | profit rate: 1205343030519.7 | accuracy: 0.59
step_num: 8400 | loss: 0.5403 | profit rate: 17753156313361.2 | accuracy: 0.58
step_num: 8600 | loss: 0.4688 | profit rate: 3478119043970347.5 | accuracy: 0.58
step_num: 8800 | loss: 0.4609 | profit rate: 125717699741635584.0 | accuracy: 0.58
step_num: 9000 | loss: 0.5279 | profit rate: 3094942183890548736.0 | accuracy: 0.58
step_num: 9200 | loss: 0.5204 | profit rate: 33675306184544446578688.0 | accuracy: 0.60
step_num: 9400 | loss: 0.5555 | profit rate: 4529090175404298534387712.0 | accuracy: 0.60
step_num: 9600 | loss: 0.5390 | profit rate: 376920666516818508539494400.0 | accuracy: 0.60
step_num: 9800 | loss: 0.5753 | profit rate: 34570807216719380198654476288.0 | accuracy: 0.60
step_num: 10000 | loss: 0.5539 | profit rate: 2659132421115586457236959920128.0 | accuracy: 0.60
step_num: 10200 | loss: 0.5547 | profit rate: 397368987652771591599916687818752.0 | accuracy: 0.60
step_num: 10400 | loss: 0.5713 | profit rate: 34675985934560911463651458561343488.0 | accuracy: 0.61
episode:   3/5,耗时:2.15分/6.61分,训练集: | step: 10575 | average_treward: 1295.6 | max_treward: 1527.9189 | average profit rate: 215827655219665651444037654713204736.000
model saved @ step:10575,performance:600930276697015218794704298951311360.000,accuracy:0.61
step_num: 10600 | loss: 0.5001 | profit rate:    6.7 | accuracy: 0.73
step_num: 10800 | loss: 0.5078 | profit rate:  533.4 | accuracy: 0.64
step_num: 11000 | loss: 0.4821 | profit rate: 50490.4 | accuracy: 0.65
step_num: 11200 | loss: 0.4926 | profit rate: 4323868.3 | accuracy: 0.63
step_num: 11400 | loss: 0.5136 | profit rate: 26221863.7 | accuracy: 0.61
step_num: 11600 | loss: 0.5131 | profit rate: 89379161464.4 | accuracy: 0.62
step_num: 11800 | loss: 0.5340 | profit rate: 4764648288358.2 | accuracy: 0.62
step_num: 12000 | loss: 0.5180 | profit rate: 152658655119997.6 | accuracy: 0.61
step_num: 12200 | loss: 0.4409 | profit rate: 55179143952308624.0 | accuracy: 0.60
step_num: 12400 | loss: 0.4418 | profit rate: 959807792138366592.0 | accuracy: 0.61
step_num: 12600 | loss: 0.4947 | profit rate: 36319836728850857984.0 | accuracy: 0.61
step_num: 12800 | loss: 0.5333 | profit rate: 488200755453331775684608.0 | accuracy: 0.62
step_num: 13000 | loss: 0.6078 | profit rate: 14454368526289140195524608.0 | accuracy: 0.61
step_num: 13200 | loss: 0.6176 | profit rate: 4043602144222854817750450176.0 | accuracy: 0.62
step_num: 13400 | loss: 0.5564 | profit rate: 174620455055031362266719059968.0 | accuracy: 0.62
step_num: 13600 | loss: 0.5453 | profit rate: 12481065381072907154524391604224.0 | accuracy: 0.62
step_num: 13800 | loss: 0.4998 | profit rate: 3510263281990543145729870077624320.0 | accuracy: 0.62
step_num: 14000 | loss: 0.5246 | profit rate: 416586390915985012491865050000130048.0 | accuracy: 0.62
model saved @ step:14100,performance:862702917260930471958742366221762560.000,accuracy:0.62
step_num: 14200 | loss: 0.5415 | profit rate:   30.2 | accuracy: 0.65
step_num: 14400 | loss: 0.4595 | profit rate: 6315.6 | accuracy: 0.64
step_num: 14600 | loss: 0.5446 | profit rate: 192876.5 | accuracy: 0.64
step_num: 14800 | loss: 0.5150 | profit rate: 32671191.9 | accuracy: 0.63
step_num: 15000 | loss: 0.5875 | profit rate: 2149305353.2 | accuracy: 0.61
step_num: 15200 | loss: 0.5151 | profit rate: 6023681003101.9 | accuracy: 0.63
step_num: 15400 | loss: 0.5378 | profit rate: 142496021835968.8 | accuracy: 0.61
step_num: 15600 | loss: 0.4742 | profit rate: 31353168661717356.0 | accuracy: 0.61
step_num: 15800 | loss: 0.4408 | profit rate: 940790348983433728.0 | accuracy: 0.60
step_num: 16000 | loss: 0.5026 | profit rate: 16997702993419802624.0 | accuracy: 0.60
step_num: 16200 | loss: 0.5093 | profit rate: 45926579022222541717504.0 | accuracy: 0.61
step_num: 16400 | loss: 0.5097 | profit rate: 20964002120379080485371904.0 | accuracy: 0.61
step_num: 16600 | loss: 0.5955 | profit rate: 2236737016154779992966823936.0 | accuracy: 0.61
step_num: 16800 | loss: 0.5515 | profit rate: 157426980494253748671693717504.0 | accuracy: 0.62
step_num: 17000 | loss: 0.5714 | profit rate: 28204514595744042352878488125440.0 | accuracy: 0.62
step_num: 17200 | loss: 0.5271 | profit rate: 2777314774971459485433446837256192.0 | accuracy: 0.62
step_num: 17400 | loss: 0.5424 | profit rate: 795813117067120654156576260855169024.0 | accuracy: 0.62
step_num: 17600 | loss: 0.5233 | profit rate: 20354106303893893120886007894032515072.0 | accuracy: 0.62
episode:   5/5,耗时:2.16分/10.89分,训练集: | step: 17625 | average_treward: 1411.1 | max_treward: 1599.2276 | average profit rate: 4980688384661938958776787034282393600.000
model saved @ step:17625,performance:23393256040389766629723316892668526592.000,accuracy:0.62
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 52/408 [00:00<00:00, 520.00it/s] 28%|       | 115/408 [00:00<00:00, 577.91it/s] 44%|     | 179/408 [00:00<00:00, 602.27it/s] 60%|    | 246/408 [00:00<00:00, 626.37it/s] 76%|  | 312/408 [00:00<00:00, 638.40it/s] 93%|| 379/408 [00:00<00:00, 647.94it/s]100%|| 408/408 [00:00<00:00, 627.78it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 5601.73
2023-07-24T12:00:00 | net performance [%] = 460.1731
2023-07-24T12:00:00 | number of trades [#] = 100
==================================================
Trial 53 Complete [00h 11m 08s]
net_wealth: 5601.730919777241

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 12m 30s

Search: Running Trial #54

Value             |Best Value So Far |Hyperparameter
5                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
3                 |3                 |lags
0.8               |0.5               |gamma
0.0005            |0.001             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
0.2               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4296.000000   4301.000000
mean      0.000435    20113.607657  ...   20187.844288  20169.373185
std       0.027833    16040.642334  ...   16078.813220  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7752.362549   7730.930176
50%       0.000642    11571.842969  ...   11756.264648  11751.469727
75%       0.011590    29894.706152  ...   30017.365723  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.5845 | profit rate:    0.2 | accuracy: 0.32
step_num: 800 | loss: 0.4294 | profit rate:    0.3 | accuracy: 0.32
step_num: 1000 | loss: 0.3883 | profit rate:    0.6 | accuracy: 0.33
step_num: 1200 | loss: 0.3311 | profit rate:   17.7 | accuracy: 0.36
step_num: 1400 | loss: 0.3536 | profit rate:  192.5 | accuracy: 0.38
step_num: 1600 | loss: 0.3353 | profit rate: 3124.3 | accuracy: 0.39
step_num: 1800 | loss: 0.3734 | profit rate: 768333.4 | accuracy: 0.42
step_num: 2000 | loss: 0.3888 | profit rate: 7773204.9 | accuracy: 0.44
step_num: 2200 | loss: 0.4099 | profit rate: 1213792428.0 | accuracy: 0.46
step_num: 2400 | loss: 0.4247 | profit rate: 466403020466.1 | accuracy: 0.47
step_num: 2600 | loss: 0.3934 | profit rate: 42837898426836.7 | accuracy: 0.48
step_num: 2800 | loss: 0.4014 | profit rate: 7173925152788821.0 | accuracy: 0.49
step_num: 3000 | loss: 0.4072 | profit rate: 129990934990201456.0 | accuracy: 0.49
step_num: 3200 | loss: 0.4137 | profit rate: 10109256853373345792.0 | accuracy: 0.50
step_num: 3400 | loss: 0.4412 | profit rate: 1916885017753535119360.0 | accuracy: 0.51
step_num: 3600 | loss: 0.4059 | profit rate: 54578326843235973988352.0 | accuracy: 0.51
episode:   1/5,耗时:1.19分/1.19分,训练集: | step: 3665 | average_treward: 1131.5 | max_treward: 1131.4758 | average profit rate: 93771772013866723049472.000
model saved @ step:3665,performance:93771772013866723049472.000,accuracy:0.51
step_num: 3800 | loss: 0.4156 | profit rate:  974.8 | accuracy: 0.57
step_num: 4000 | loss: 0.3864 | profit rate: 579772.8 | accuracy: 0.60
step_num: 4200 | loss: 0.3692 | profit rate: 24728252.2 | accuracy: 0.58
step_num: 4400 | loss: 0.3808 | profit rate: 1607456255.1 | accuracy: 0.58
step_num: 4600 | loss: 0.3306 | profit rate: 15372211665.2 | accuracy: 0.57
step_num: 4800 | loss: 0.3369 | profit rate: 9759061856379.2 | accuracy: 0.58
step_num: 5000 | loss: 0.3480 | profit rate: 945952357153233.8 | accuracy: 0.58
step_num: 5200 | loss: 0.3105 | profit rate: 50915679947533272.0 | accuracy: 0.59
step_num: 5400 | loss: 0.3575 | profit rate: 18517711028638695424.0 | accuracy: 0.59
step_num: 5600 | loss: 0.3389 | profit rate: 331486143007960530944.0 | accuracy: 0.59
step_num: 5800 | loss: 0.3386 | profit rate: 28538444884353338048512.0 | accuracy: 0.60
step_num: 6000 | loss: 0.3742 | profit rate: 39154918113908538331889664.0 | accuracy: 0.61
step_num: 6200 | loss: 0.3923 | profit rate: 11197315323863795438811348992.0 | accuracy: 0.61
step_num: 6400 | loss: 0.3751 | profit rate: 2043076532314647546201009815552.0 | accuracy: 0.61
step_num: 6600 | loss: 0.3521 | profit rate: 203959643467444983291802753695744.0 | accuracy: 0.61
step_num: 6800 | loss: 0.3812 | profit rate: 29355712670044449362387606964273152.0 | accuracy: 0.61
step_num: 7000 | loss: 0.3629 | profit rate: 9776940836679654717352376051100024832.0 | accuracy: 0.61
step_num: 7200 | loss: 0.3501 | profit rate: 202217222299654414509738706184381136896.0 | accuracy: 0.61
model saved @ step:7330,performance:1964430272901935706551637179010773942272.000,accuracy:0.61
step_num: 7400 | loss: 0.3367 | profit rate:   17.3 | accuracy: 0.51
step_num: 7600 | loss: 0.3252 | profit rate: 33265.7 | accuracy: 0.57
step_num: 7800 | loss: 0.3245 | profit rate: 3233437.3 | accuracy: 0.56
step_num: 8000 | loss: 0.3166 | profit rate: 104518814.9 | accuracy: 0.55
step_num: 8200 | loss: 0.3301 | profit rate: 7365947032.9 | accuracy: 0.55
step_num: 8400 | loss: 0.3318 | profit rate: 415661037789.7 | accuracy: 0.56
step_num: 8600 | loss: 0.2739 | profit rate: 396350560139359.0 | accuracy: 0.58
step_num: 8800 | loss: 0.2614 | profit rate: 21271305732927844.0 | accuracy: 0.57
step_num: 9000 | loss: 0.2528 | profit rate: 8767351572374521856.0 | accuracy: 0.58
step_num: 9200 | loss: 0.2824 | profit rate: 207697568085754249216.0 | accuracy: 0.58
step_num: 9400 | loss: 0.2728 | profit rate: 7671655220098179792896.0 | accuracy: 0.59
step_num: 9600 | loss: 0.3379 | profit rate: 16297160010199003452932096.0 | accuracy: 0.60
step_num: 9800 | loss: 0.2743 | profit rate: 3067489777155425154830958592.0 | accuracy: 0.60
step_num: 10000 | loss: 0.3143 | profit rate: 2388517972991739680193138130944.0 | accuracy: 0.60
step_num: 10200 | loss: 0.2978 | profit rate: 325033543396155072432388452646912.0 | accuracy: 0.60
step_num: 10400 | loss: 0.2992 | profit rate: 12507198019633276850195068027404288.0 | accuracy: 0.60
step_num: 10600 | loss: 0.3036 | profit rate: 2243293202640368519146742457391120384.0 | accuracy: 0.59
step_num: 10800 | loss: 0.3267 | profit rate: 95963535525354784549729287534526070784.0 | accuracy: 0.59
episode:   3/5,耗时:1.42分/4.21分,训练集: | step: 10995 | average_treward: 1650.6 | max_treward: 1915.8650 | average profit rate: 1245520348954580734796795051527492337664.000
model saved @ step:10995,performance:1772130773961806346723020523743056232448.000,accuracy:0.58
step_num: 11000 | loss: 0.2754 | profit rate:    1.5 | accuracy: 0.50
step_num: 11200 | loss: 0.2788 | profit rate: 27879.1 | accuracy: 0.58
step_num: 11400 | loss: 0.2679 | profit rate: 2052768.7 | accuracy: 0.55
step_num: 11600 | loss: 0.2826 | profit rate: 105344939.1 | accuracy: 0.55
step_num: 11800 | loss: 0.2573 | profit rate: 7414839409.9 | accuracy: 0.55
step_num: 12000 | loss: 0.2427 | profit rate: 105000427678.7 | accuracy: 0.55
step_num: 12200 | loss: 0.2626 | profit rate: 104213507417767.4 | accuracy: 0.57
step_num: 12400 | loss: 0.2536 | profit rate: 7326722236849952.0 | accuracy: 0.57
step_num: 12600 | loss: 0.2640 | profit rate: 198503277309547616.0 | accuracy: 0.57
step_num: 12800 | loss: 0.2406 | profit rate: 232292460473454166016.0 | accuracy: 0.57
step_num: 13000 | loss: 0.2647 | profit rate: 4428340141624219664384.0 | accuracy: 0.57
step_num: 13200 | loss: 0.2692 | profit rate: 1858268131644481258651648.0 | accuracy: 0.59
step_num: 13400 | loss: 0.2601 | profit rate: 1371288088976255303892860928.0 | accuracy: 0.59
step_num: 13600 | loss: 0.2720 | profit rate: 547769458724881315701148614656.0 | accuracy: 0.59
step_num: 13800 | loss: 0.2394 | profit rate: 234960302909033626649504593739776.0 | accuracy: 0.60
step_num: 14000 | loss: 0.2532 | profit rate: 18023659837993520669327802549403648.0 | accuracy: 0.59
step_num: 14200 | loss: 0.2512 | profit rate: 854993315315235352957511907162456064.0 | accuracy: 0.59
step_num: 14400 | loss: 0.2573 | profit rate: 103950636331873713921114606446634336256.0 | accuracy: 0.59
step_num: 14600 | loss: 0.2655 | profit rate: 3136751512153905034447483684770050736128.0 | accuracy: 0.58
model saved @ step:14660,performance:4681110416386869921715763736583090470912.000,accuracy:0.58
step_num: 14800 | loss: 0.2399 | profit rate: 2546.6 | accuracy: 0.56
step_num: 15000 | loss: 0.2400 | profit rate: 1329724.6 | accuracy: 0.59
step_num: 15200 | loss: 0.2350 | profit rate: 63467658.2 | accuracy: 0.56
step_num: 15400 | loss: 0.2664 | profit rate: 6907182651.7 | accuracy: 0.57
step_num: 15600 | loss: 0.2687 | profit rate: 37008071154.3 | accuracy: 0.55
step_num: 15800 | loss: 0.2627 | profit rate: 41270629537106.3 | accuracy: 0.57
step_num: 16000 | loss: 0.2253 | profit rate: 12760795154291038.0 | accuracy: 0.58
step_num: 16200 | loss: 0.2254 | profit rate: 245964473454383520.0 | accuracy: 0.58
step_num: 16400 | loss: 0.2264 | profit rate: 374619966383728492544.0 | accuracy: 0.58
step_num: 16600 | loss: 0.2070 | profit rate: 2745318270929080942592.0 | accuracy: 0.58
step_num: 16800 | loss: 0.2442 | profit rate: 138744636004688610721792.0 | accuracy: 0.58
step_num: 17000 | loss: 0.2431 | profit rate: 576227041075349306518536192.0 | accuracy: 0.59
step_num: 17200 | loss: 0.2362 | profit rate: 185712489785616486523310440448.0 | accuracy: 0.59
step_num: 17400 | loss: 0.2549 | profit rate: 40625355924788363096116640612352.0 | accuracy: 0.59
step_num: 17600 | loss: 0.2061 | profit rate: 5301414955525476048003119282388992.0 | accuracy: 0.59
step_num: 17800 | loss: 0.2177 | profit rate: 466960611284945915709093558265839616.0 | accuracy: 0.59
step_num: 18000 | loss: 0.2268 | profit rate: 170394126184221332226527884943929901056.0 | accuracy: 0.58
step_num: 18200 | loss: 0.1913 | profit rate: 3057454005431872743591016438391092805632.0 | accuracy: 0.58
episode:   5/5,耗时:1.43分/8.03分,训练集: | step: 18325 | average_treward: 1792.9 | max_treward: 2033.0275 | average profit rate: 7704520854774035426359868492036427481088.000
model saved @ step:18325,performance:30104932810619568783586379864732740878336.000,accuracy:0.58
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 13%|        | 54/408 [00:00<00:00, 534.87it/s] 28%|       | 115/408 [00:00<00:00, 578.89it/s] 44%|     | 179/408 [00:00<00:00, 605.98it/s] 60%|    | 246/408 [00:00<00:00, 628.71it/s] 77%|  | 314/408 [00:00<00:00, 644.82it/s] 93%|| 381/408 [00:00<00:00, 651.53it/s]100%|| 408/408 [00:00<00:00, 631.52it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 4784.26
2023-07-24T12:00:00 | net performance [%] = 378.4264
2023-07-24T12:00:00 | number of trades [#] = 70
==================================================
Trial 54 Complete [00h 09m 01s]
net_wealth: 4789.053372161488

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 21m 31s

Search: Running Trial #55

Value             |Best Value So Far |Hyperparameter
8                 |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
14                |3                 |lags
0.85              |0.5               |gamma
0.0005            |0.001             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4293.000000   4301.000000
mean      0.000435    20113.607657  ...   20198.799136  20169.373185
std       0.027833    16040.642334  ...   16079.087003  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7760.089844   7730.930176
50%       0.000642    11571.842969  ...   11760.540039  11751.469727
75%       0.011590    29894.706152  ...   30020.560547  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.2976 | profit rate:    8.2 | accuracy: 0.36
step_num: 600 | loss: 0.3734 | profit rate:  108.1 | accuracy: 0.39
step_num: 800 | loss: 0.2714 | profit rate: 26679.9 | accuracy: 0.43
step_num: 1000 | loss: 0.1892 | profit rate: 3235932.3 | accuracy: 0.46
step_num: 1200 | loss: 0.1834 | profit rate: 7342016631.0 | accuracy: 0.50
step_num: 1400 | loss: 0.1456 | profit rate: 2186422290940.0 | accuracy: 0.54
step_num: 1600 | loss: 0.1342 | profit rate: 343655067855959.3 | accuracy: 0.56
step_num: 1800 | loss: 0.1970 | profit rate: 178685746752587628544.0 | accuracy: 0.59
step_num: 2000 | loss: 0.1709 | profit rate: 12080296807310495678726144.0 | accuracy: 0.61
step_num: 2200 | loss: 0.1144 | profit rate: 378942188833245718617387958272.0 | accuracy: 0.63
step_num: 2400 | loss: 0.1359 | profit rate: 933145782853975230367864731992064.0 | accuracy: 0.64
step_num: 2600 | loss: 0.1132 | profit rate: 33758140081979773958942136807345618944.0 | accuracy: 0.66
step_num: 2800 | loss: 0.1036 | profit rate: 830234238915629382829219246645896586199040.0 | accuracy: 0.68
step_num: 3000 | loss: 0.1690 | profit rate: 2331589704910068587869018930137664214884417536.0 | accuracy: 0.69
episode:   1/5,耗时:1.11分/1.11分,训练集: | step: 3149 | average_treward: 2211.6 | max_treward: 2211.6107 | average profit rate: 164977113917710091364497877890125447474360352768.000
model saved @ step:3149,performance:164977113917710091364497877890125447474360352768.000,accuracy:0.69
step_num: 3200 | loss: 0.1486 | profit rate:    6.3 | accuracy: 0.88
step_num: 3400 | loss: 0.1446 | profit rate: 301369.3 | accuracy: 0.87
step_num: 3600 | loss: 0.1431 | profit rate: 217932098.5 | accuracy: 0.88
step_num: 3800 | loss: 0.1281 | profit rate: 138942338138237.2 | accuracy: 0.89
step_num: 4000 | loss: 0.1466 | profit rate: 3049337679850636800.0 | accuracy: 0.89
step_num: 4200 | loss: 0.0921 | profit rate: 7803727817356648382464.0 | accuracy: 0.89
step_num: 4400 | loss: 0.1228 | profit rate: 25418608622830794950286770176.0 | accuracy: 0.89
step_num: 4600 | loss: 0.1434 | profit rate: 3953695277304792490549975187456.0 | accuracy: 0.89
step_num: 4800 | loss: 0.1051 | profit rate: 19495155767802633523100757516091392.0 | accuracy: 0.89
step_num: 5000 | loss: 0.0992 | profit rate: 357198701089320600359387665650013802856448.0 | accuracy: 0.89
step_num: 5200 | loss: 0.1163 | profit rate: 93345947894495133496276492217230324402678136832.0 | accuracy: 0.89
step_num: 5400 | loss: 0.1160 | profit rate: 3174951150894739109301795431538461190511898400915456.0 | accuracy: 0.89
step_num: 5600 | loss: 0.1123 | profit rate: 23972264747371513066410812588813834647922306776848924672.0 | accuracy: 0.89
step_num: 5800 | loss: 0.0985 | profit rate: 1073471993299743224022915889798873995019343971903621579145216.0 | accuracy: 0.89
step_num: 6000 | loss: 0.1011 | profit rate: 299295721048684355612738835179566668545074667368857691426499067904.0 | accuracy: 0.90
step_num: 6200 | loss: 0.1129 | profit rate: 477506461464931838032596379091794678376440209280443825672040549974016.0 | accuracy: 0.89
model saved @ step:6298,performance:4650724043933707066847722323064611500120651299640422299608373700591616.000,accuracy:0.89
step_num: 6400 | loss: 0.1434 | profit rate:   24.3 | accuracy: 0.87
step_num: 6600 | loss: 0.1260 | profit rate: 1460894.9 | accuracy: 0.87
step_num: 6800 | loss: 0.1176 | profit rate: 6811377697.3 | accuracy: 0.90
step_num: 7000 | loss: 0.1328 | profit rate: 5200330855883812.0 | accuracy: 0.91
step_num: 7200 | loss: 0.0915 | profit rate: 70997806037306155008.0 | accuracy: 0.91
step_num: 7400 | loss: 0.1017 | profit rate: 199694139662980089905152.0 | accuracy: 0.91
step_num: 7600 | loss: 0.0813 | profit rate: 156924449933684138558791614464.0 | accuracy: 0.91
step_num: 7800 | loss: 0.0995 | profit rate: 60972183114123069152183831232512.0 | accuracy: 0.90
step_num: 8000 | loss: 0.1415 | profit rate: 2998633561563399810176186587853881344.0 | accuracy: 0.90
step_num: 8200 | loss: 0.1018 | profit rate: 7298370274675335539230088707970005725085696.0 | accuracy: 0.90
step_num: 8400 | loss: 0.0930 | profit rate: 1525916524613176902191206223665164862693752963072.0 | accuracy: 0.90
step_num: 8600 | loss: 0.1076 | profit rate: 101199152670495269451555199478029353407792414107631616.0 | accuracy: 0.90
step_num: 8800 | loss: 0.0985 | profit rate: 1784693856506350347873879016283173137271776939077063933952.0 | accuracy: 0.90
step_num: 9000 | loss: 0.0845 | profit rate: 93416709760821787327783503420972337830285463227143069252976640.0 | accuracy: 0.91
step_num: 9200 | loss: 0.0695 | profit rate: 8003315895084546039140816967727843503109534857990252961453465141248.0 | accuracy: 0.91
step_num: 9400 | loss: 0.1077 | profit rate: 8128395385490726994576685886666802597192860989802699127771833091227648.0 | accuracy: 0.90
episode:   3/5,耗时:1.26分/3.90分,训练集: | step: 9447 | average_treward: 3009.1 | max_treward: 3438.6275 | average profit rate: 7296258064431689509003439525002283568168456209960506192503374570586112.000
model saved @ step:9447,performance:17238050149361363758905907550775526741905258055704871706010433286569984.000,accuracy:0.90
step_num: 9600 | loss: 0.1379 | profit rate:  490.7 | accuracy: 0.89
step_num: 9800 | loss: 0.1554 | profit rate: 8667878.1 | accuracy: 0.89
step_num: 10000 | loss: 0.1220 | profit rate: 58621861833.4 | accuracy: 0.88
step_num: 10200 | loss: 0.0974 | profit rate: 34813956061915748.0 | accuracy: 0.90
step_num: 10400 | loss: 0.0782 | profit rate: 271168341194428547072.0 | accuracy: 0.90
step_num: 10600 | loss: 0.1045 | profit rate: 106816685367902272114130944.0 | accuracy: 0.91
step_num: 10800 | loss: 0.1019 | profit rate: 243869407781014280326671761408.0 | accuracy: 0.90
step_num: 11000 | loss: 0.0884 | profit rate: 172894719998162472793787299004416.0 | accuracy: 0.90
step_num: 11200 | loss: 0.1126 | profit rate: 239045834341249617618652290011466039296.0 | accuracy: 0.90
step_num: 11400 | loss: 0.0841 | profit rate: 148923374229716673649182584488105053603758080.0 | accuracy: 0.91
step_num: 11600 | loss: 0.0699 | profit rate: 59229923178251851393214333884378076353280620888064.0 | accuracy: 0.90
step_num: 11800 | loss: 0.0851 | profit rate: 787559603506974896353524278707426790995841598718214144.0 | accuracy: 0.90
step_num: 12000 | loss: 0.0789 | profit rate: 59056195435061868681876949339259691053017577835750653689856.0 | accuracy: 0.91
step_num: 12200 | loss: 0.0817 | profit rate: 1727863878702456281265825870669491019079002597067449928419115008.0 | accuracy: 0.91
step_num: 12400 | loss: 0.0773 | profit rate: 135057410277475532364912365496399548569097771460449528965815699767296.0 | accuracy: 0.91
model saved @ step:12596,performance:32525024745518015544230239735734921323631966744063451710543778208022528.000,accuracy:0.91
step_num: 12600 | loss: 0.1251 | profit rate:    1.9 | accuracy: 1.00
step_num: 12800 | loss: 0.0963 | profit rate: 23392.0 | accuracy: 0.92
step_num: 13000 | loss: 0.0959 | profit rate: 16233202.3 | accuracy: 0.91
step_num: 13200 | loss: 0.0895 | profit rate: 2444765290621.7 | accuracy: 0.89
step_num: 13400 | loss: 0.0652 | profit rate: 121005328019526496.0 | accuracy: 0.89
step_num: 13600 | loss: 0.0684 | profit rate: 456167594391057137664.0 | accuracy: 0.90
step_num: 13800 | loss: 0.0854 | profit rate: 271915407665091322606256128.0 | accuracy: 0.90
step_num: 14000 | loss: 0.1086 | profit rate: 365731979008532406958745976832.0 | accuracy: 0.90
step_num: 14200 | loss: 0.1009 | profit rate: 195626062828604541122697502916608.0 | accuracy: 0.90
step_num: 14400 | loss: 0.0920 | profit rate: 3934562185224347621760276676886375956480.0 | accuracy: 0.90
step_num: 14600 | loss: 0.0761 | profit rate: 1257413019711087569189956370377770803933478912.0 | accuracy: 0.90
step_num: 14800 | loss: 0.0819 | profit rate: 63630357987424824028013704567053960822721714585600.0 | accuracy: 0.90
step_num: 15000 | loss: 0.0772 | profit rate: 846954271598837444555574006258642725081566082322399232.0 | accuracy: 0.90
step_num: 15200 | loss: 0.0621 | profit rate: 65724952471509571694358839664742789713527171011904171671552.0 | accuracy: 0.90
step_num: 15400 | loss: 0.0742 | profit rate: 7042524328647188483366320959361905152013058875147024209153097728.0 | accuracy: 0.90
step_num: 15600 | loss: 0.0784 | profit rate: 34892983163378625599812505563976777476413752572302528812586490658816.0 | accuracy: 0.90
episode:   5/5,耗时:1.27分/6.45分,训练集: | step: 15745 | average_treward: 3194.8 | max_treward: 3484.8019 | average profit rate: 11481248492970693099539804380659384266115039504256947246491068346138624.000
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 13%|        | 52/397 [00:00<00:00, 516.49it/s] 29%|       | 114/397 [00:00<00:00, 577.20it/s] 45%|     | 179/397 [00:00<00:00, 607.63it/s] 61%|   | 244/397 [00:00<00:00, 624.29it/s] 78%|  | 311/397 [00:00<00:00, 636.16it/s] 95%|| 377/397 [00:00<00:00, 642.05it/s]100%|| 397/397 [00:00<00:00, 623.55it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3088.47
2023-07-24T12:00:00 | net performance [%] = 208.8465
2023-07-24T12:00:00 | number of trades [#] = 64
==================================================
Trial 55 Complete [00h 06m 35s]
net_wealth: 3088.4653607861237

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 28m 07s

Search: Running Trial #56

Value             |Best Value So Far |Hyperparameter
2                 |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
7                 |3                 |lags
0.9               |0.5               |gamma
1e-05             |0.001             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
5                 |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4299.000000   4301.000000
mean      0.000435    20113.607657  ...   20176.664105  20169.373185
std       0.027833    16040.642334  ...   16078.769271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7739.330078   7730.930176
50%       0.000642    11571.842969  ...   11754.589844  11751.469727
75%       0.011590    29894.706152  ...   30014.465820  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.7375 | profit rate:    0.3 | accuracy: 0.32
step_num: 600 | loss: 0.6676 | profit rate:    0.2 | accuracy: 0.33
step_num: 800 | loss: 0.6591 | profit rate:    0.3 | accuracy: 0.33
step_num: 1000 | loss: 0.6667 | profit rate:    0.1 | accuracy: 0.32
step_num: 1200 | loss: 0.5786 | profit rate:    0.2 | accuracy: 0.33
step_num: 1400 | loss: 0.5534 | profit rate:    0.3 | accuracy: 0.33
step_num: 1600 | loss: 0.5753 | profit rate:    0.7 | accuracy: 0.34
step_num: 1800 | loss: 0.5474 | profit rate:    1.1 | accuracy: 0.34
step_num: 2000 | loss: 0.4581 | profit rate:    2.3 | accuracy: 0.35
step_num: 2200 | loss: 0.5294 | profit rate:   47.7 | accuracy: 0.36
step_num: 2400 | loss: 0.5341 | profit rate:  391.5 | accuracy: 0.37
step_num: 2600 | loss: 0.4506 | profit rate: 8244.3 | accuracy: 0.37
step_num: 2800 | loss: 0.4374 | profit rate: 68006.0 | accuracy: 0.38
step_num: 3000 | loss: 0.3985 | profit rate: 1750115.6 | accuracy: 0.39
step_num: 3200 | loss: 0.4474 | profit rate: 38093250.2 | accuracy: 0.40
step_num: 3400 | loss: 0.4556 | profit rate: 188652066.1 | accuracy: 0.40
episode:   1/5,耗时:1.84分/1.84分,训练集: | step: 3521 | average_treward:  592.1 | max_treward: 592.0606 | average profit rate: 732603697.770
model saved @ step:3521,performance:732603697.770,accuracy:0.41
step_num: 3600 | loss: 0.4033 | profit rate:    6.0 | accuracy: 0.39
step_num: 3800 | loss: 0.3245 | profit rate:  164.0 | accuracy: 0.51
step_num: 4000 | loss: 0.3421 | profit rate: 2038.5 | accuracy: 0.56
step_num: 4200 | loss: 0.4277 | profit rate: 152003.3 | accuracy: 0.60
step_num: 4400 | loss: 0.4242 | profit rate: 3685594.6 | accuracy: 0.62
step_num: 4600 | loss: 0.4747 | profit rate: 717650455.5 | accuracy: 0.63
step_num: 4800 | loss: 0.4985 | profit rate: 20617575091.5 | accuracy: 0.64
step_num: 5000 | loss: 0.4597 | profit rate: 1056575253862.5 | accuracy: 0.64
step_num: 5200 | loss: 0.4320 | profit rate: 88960900336500.4 | accuracy: 0.65
step_num: 5400 | loss: 0.4658 | profit rate: 768846227481918.1 | accuracy: 0.66
step_num: 5600 | loss: 0.5356 | profit rate: 61804244298626176.0 | accuracy: 0.67
step_num: 5800 | loss: 0.5691 | profit rate: 14146944921731616768.0 | accuracy: 0.67
step_num: 6000 | loss: 0.5785 | profit rate: 5755006096076008587264.0 | accuracy: 0.68
step_num: 6200 | loss: 0.4404 | profit rate: 284951370085365949923328.0 | accuracy: 0.68
step_num: 6400 | loss: 0.3997 | profit rate: 15078868035904823546085376.0 | accuracy: 0.68
step_num: 6600 | loss: 0.4379 | profit rate: 890094288123668232677621760.0 | accuracy: 0.69
step_num: 6800 | loss: 0.5135 | profit rate: 39875660518035400824283201536.0 | accuracy: 0.69
step_num: 7000 | loss: 0.4534 | profit rate: 540033805299206182461893509120.0 | accuracy: 0.69
model saved @ step:7042,performance:730960833638077003893630304256.000,accuracy:0.68
step_num: 7200 | loss: 0.3928 | profit rate:   63.7 | accuracy: 0.72
step_num: 7400 | loss: 0.3401 | profit rate: 3528.6 | accuracy: 0.73
step_num: 7600 | loss: 0.3649 | profit rate: 119276.7 | accuracy: 0.74
step_num: 7800 | loss: 0.3408 | profit rate: 2314031.9 | accuracy: 0.74
step_num: 8000 | loss: 0.4755 | profit rate: 192963112.8 | accuracy: 0.75
step_num: 8200 | loss: 0.4724 | profit rate: 22134270391.6 | accuracy: 0.75
step_num: 8400 | loss: 0.4354 | profit rate: 630148889018.3 | accuracy: 0.75
step_num: 8600 | loss: 0.3763 | profit rate: 127555953965732.6 | accuracy: 0.75
step_num: 8800 | loss: 0.3971 | profit rate: 3816079872022494.5 | accuracy: 0.76
step_num: 9000 | loss: 0.3178 | profit rate: 65700543071490864.0 | accuracy: 0.76
step_num: 9200 | loss: 0.3717 | profit rate: 23219222807002570752.0 | accuracy: 0.76
step_num: 9400 | loss: 0.4187 | profit rate: 5544942479029748891648.0 | accuracy: 0.76
step_num: 9600 | loss: 0.4163 | profit rate: 1063254253229539699195904.0 | accuracy: 0.76
step_num: 9800 | loss: 0.3453 | profit rate: 100444554444474168547213312.0 | accuracy: 0.76
step_num: 10000 | loss: 0.3757 | profit rate: 6131347432009510337248231424.0 | accuracy: 0.76
step_num: 10200 | loss: 0.3020 | profit rate: 504393407946250167300472700928.0 | accuracy: 0.77
step_num: 10400 | loss: 0.3918 | profit rate: 14027475272851364580911629729792.0 | accuracy: 0.76
episode:   3/5,耗时:2.05分/5.95分,训练集: | step: 10563 | average_treward: 1719.5 | max_treward: 2430.6789 | average profit rate: 43175714163050765468098946400256.000
model saved @ step:10563,performance:128796181655514202934117071323136.000,accuracy:0.76
step_num: 10600 | loss: 0.3770 | profit rate:    4.8 | accuracy: 0.89
step_num: 10800 | loss: 0.3337 | profit rate:  773.9 | accuracy: 0.83
step_num: 11000 | loss: 0.2719 | profit rate: 26587.2 | accuracy: 0.82
step_num: 11200 | loss: 0.2996 | profit rate: 2269208.4 | accuracy: 0.82
step_num: 11400 | loss: 0.2913 | profit rate: 28114816.1 | accuracy: 0.82
step_num: 11600 | loss: 0.3106 | profit rate: 16018139646.0 | accuracy: 0.83
step_num: 11800 | loss: 0.2777 | profit rate: 735958771401.8 | accuracy: 0.82
step_num: 12000 | loss: 0.2838 | profit rate: 24945491156945.8 | accuracy: 0.82
step_num: 12200 | loss: 0.3160 | profit rate: 15214513770094694.0 | accuracy: 0.82
step_num: 12400 | loss: 0.2259 | profit rate: 264049047966511968.0 | accuracy: 0.82
step_num: 12600 | loss: 0.2292 | profit rate: 12599887203831744512.0 | accuracy: 0.83
step_num: 12800 | loss: 0.3091 | profit rate: 17154729320312398151680.0 | accuracy: 0.83
step_num: 13000 | loss: 0.3121 | profit rate: 13042158812076475506753536.0 | accuracy: 0.83
step_num: 13200 | loss: 0.2608 | profit rate: 2038535263104450216209678336.0 | accuracy: 0.84
step_num: 13400 | loss: 0.2420 | profit rate: 162768689862352175878100746240.0 | accuracy: 0.83
step_num: 13600 | loss: 0.2431 | profit rate: 17788775629295531587910389202944.0 | accuracy: 0.84
step_num: 13800 | loss: 0.2814 | profit rate: 2441103074521075296232474677346304.0 | accuracy: 0.83
step_num: 14000 | loss: 0.2745 | profit rate: 102030261123997910438940514736668672.0 | accuracy: 0.83
model saved @ step:14084,performance:244836602830631761285944564984578048.000,accuracy:0.83
step_num: 14200 | loss: 0.2983 | profit rate:   59.4 | accuracy: 0.90
step_num: 14400 | loss: 0.2849 | profit rate: 7172.1 | accuracy: 0.88
step_num: 14600 | loss: 0.2096 | profit rate: 116151.2 | accuracy: 0.86
step_num: 14800 | loss: 0.2493 | profit rate: 17630582.9 | accuracy: 0.85
step_num: 15000 | loss: 0.2018 | profit rate: 718166213.9 | accuracy: 0.85
step_num: 15200 | loss: 0.2333 | profit rate: 240333114102.9 | accuracy: 0.85
step_num: 15400 | loss: 0.2547 | profit rate: 10935445618104.7 | accuracy: 0.84
step_num: 15600 | loss: 0.2332 | profit rate: 3962248319218102.0 | accuracy: 0.84
step_num: 15800 | loss: 0.2196 | profit rate: 210838032233677824.0 | accuracy: 0.84
step_num: 16000 | loss: 0.1731 | profit rate: 3952992570652344832.0 | accuracy: 0.85
step_num: 16200 | loss: 0.2080 | profit rate: 1927085720712730116096.0 | accuracy: 0.85
step_num: 16400 | loss: 0.1800 | profit rate: 1226715222430370173550592.0 | accuracy: 0.86
step_num: 16600 | loss: 0.2136 | profit rate: 954203870958239792326770688.0 | accuracy: 0.86
step_num: 16800 | loss: 0.1722 | profit rate: 107656452616602554321936056320.0 | accuracy: 0.86
step_num: 17000 | loss: 0.2032 | profit rate: 15578502657454757643078055493632.0 | accuracy: 0.86
step_num: 17200 | loss: 0.2183 | profit rate: 1595947720944765818581321976381440.0 | accuracy: 0.86
step_num: 17400 | loss: 0.2243 | profit rate: 190138692924060865567964347026636800.0 | accuracy: 0.86
step_num: 17600 | loss: 0.2488 | profit rate: 4284453505950048387804258103248027648.0 | accuracy: 0.86
episode:   5/5,耗时:2.05分/10.39分,训练集: | step: 17605 | average_treward: 2231.6 | max_treward: 3102.8731 | average profit rate: 928958667660460255784463412207026176.000
model saved @ step:17605,performance:4399827208329180788146908416008257536.000,accuracy:0.86
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 13%|        | 51/404 [00:00<00:00, 509.23it/s] 28%|       | 112/404 [00:00<00:00, 565.15it/s] 43%|     | 173/404 [00:00<00:00, 585.55it/s] 58%|    | 235/404 [00:00<00:00, 594.44it/s] 75%|  | 301/404 [00:00<00:00, 615.74it/s] 91%| | 366/404 [00:00<00:00, 627.13it/s]100%|| 404/404 [00:00<00:00, 609.14it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 6078.67
2023-07-24T12:00:00 | net performance [%] = 507.8674
2023-07-24T12:00:00 | number of trades [#] = 136
==================================================
Trial 56 Complete [00h 10m 45s]
net_wealth: 6078.674107287357

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 38m 52s

Search: Running Trial #57

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
225               |225               |lookback
False             |False             |MarketFactor
20                |3                 |lags
0.8               |0.5               |gamma
0.001             |0.001             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.3244 | profit rate:   29.1 | accuracy: 0.37
step_num: 800 | loss: 0.2493 | profit rate:  144.7 | accuracy: 0.37
step_num: 1000 | loss: 0.2272 | profit rate: 3733.9 | accuracy: 0.40
step_num: 1200 | loss: 0.2337 | profit rate: 316978040.0 | accuracy: 0.43
step_num: 1400 | loss: 0.2122 | profit rate: 455034933192.5 | accuracy: 0.47
step_num: 1600 | loss: 0.1865 | profit rate: 566014552941730.6 | accuracy: 0.51
step_num: 1800 | loss: 0.1819 | profit rate: 1163656480847267627008.0 | accuracy: 0.53
step_num: 2000 | loss: 0.1934 | profit rate: 496927024783595782799360.0 | accuracy: 0.55
step_num: 2200 | loss: 0.1751 | profit rate: 359999952681608755106212216832.0 | accuracy: 0.58
step_num: 2400 | loss: 0.1665 | profit rate: 32314576161375253240666613341239640064.0 | accuracy: 0.60
step_num: 2600 | loss: 0.1806 | profit rate: 30535401266993867718999335399311195519320064.0 | accuracy: 0.61
step_num: 2800 | loss: 0.1674 | profit rate: 44521240697618453654068735729228950044943035924480.0 | accuracy: 0.63
step_num: 3000 | loss: 0.1907 | profit rate: 3243333822221194269300415595991528430017655315437191168.0 | accuracy: 0.64
step_num: 3200 | loss: 0.2017 | profit rate: 995913758171921438841991709438080682223432781509181229236224.0 | accuracy: 0.65
step_num: 3400 | loss: 0.1845 | profit rate: 979555706864736039063818576023546577902507362325571790207914606592.0 | accuracy: 0.66
step_num: 3600 | loss: 0.1757 | profit rate: 9202546485368996288731708997660977275861400142839605410162160087072768.0 | accuracy: 0.67
episode:   1/5,耗时:1.87分/1.87分,训练集: | step: 3662 | average_treward: 2578.4 | max_treward: 2578.3797 | average profit rate: 36509276418459281686069813258702315606353896423860986189912210147377152.000
model saved @ step:3662,performance:36509276418459281686069813258702315606353896423860986189912210147377152.000,accuracy:0.67
step_num: 3800 | loss: 0.1848 | profit rate: 260050525.7 | accuracy: 0.90
step_num: 4000 | loss: 0.1519 | profit rate: 7504558771778205.0 | accuracy: 0.90
step_num: 4200 | loss: 0.1559 | profit rate: 23767968177912937447424.0 | accuracy: 0.90
step_num: 4400 | loss: 0.1527 | profit rate: 6238348223540859860466794496.0 | accuracy: 0.86
step_num: 4600 | loss: 0.1522 | profit rate: 14770736274337679931978436050944.0 | accuracy: 0.85
step_num: 4800 | loss: 0.1602 | profit rate: 783572630184280600904984831906927345664.0 | accuracy: 0.85
step_num: 5000 | loss: 0.1657 | profit rate: 371782555633631687146195492968967967506169856.0 | accuracy: 0.86
step_num: 5200 | loss: 0.1640 | profit rate: 20720512588480941460476328206100695729412035837952.0 | accuracy: 0.85
step_num: 5400 | loss: 0.1602 | profit rate: 3201181442347845385404042618949627430875603063346235965440.0 | accuracy: 0.85
step_num: 5600 | loss: 0.1780 | profit rate: 3162213606923263592875831160211327200796951211516522471096320.0 | accuracy: 0.84
step_num: 5800 | loss: 0.1657 | profit rate: 421615225781223803211773139006967106306071290450913232041816358912.0 | accuracy: 0.85
step_num: 6000 | loss: 0.1673 | profit rate: 3606631612174609497821454379895169403838421564837977995803422360884916256768.0 | accuracy: 0.86
step_num: 6200 | loss: 0.1437 | profit rate: 15959527760783919171237710898696122870908196936104727025008796327981928864408403968.0 | accuracy: 0.85
step_num: 6400 | loss: 0.1721 | profit rate: 4410323956226088629580535238652637113105154628359741811382232199373686763362697376432128.0 | accuracy: 0.85
step_num: 6600 | loss: 0.1715 | profit rate: 1226516566600312041077025857577870629696280414912015939048547846885712317011087951927208574976.0 | accuracy: 0.85
step_num: 6800 | loss: 0.1557 | profit rate: 786793302394247479274087030211265716167426764761247701003623869672174000265492365925904579985145856.0 | accuracy: 0.85
step_num: 7000 | loss: 0.1660 | profit rate: 2186816475406968630311877402495572829698390113757396629921829672902034453553554148748635126529822094786560.0 | accuracy: 0.85
step_num: 7200 | loss: 0.1339 | profit rate: 12632382116650608300247740863489295081095904782397083557343191087097809988016702031318533272177861794304360448.0 | accuracy: 0.85
model saved @ step:7324,performance:2051397129821669340538342055982729244663037187902110526561850160140646764893297829579630632589320426980378673152.000,accuracy:0.85
step_num: 7400 | loss: 0.1358 | profit rate: 9440.9 | accuracy: 0.84
step_num: 7600 | loss: 0.1338 | profit rate: 158488474544968.7 | accuracy: 0.90
step_num: 7800 | loss: 0.1363 | profit rate: 988412002913093550080.0 | accuracy: 0.90
step_num: 8000 | loss: 0.1460 | profit rate: 49980507656583235936190464.0 | accuracy: 0.87
step_num: 8200 | loss: 0.1636 | profit rate: 2135470343266927914139512733696.0 | accuracy: 0.86
step_num: 8400 | loss: 0.1591 | profit rate: 1833459926059493963385215503191506944.0 | accuracy: 0.86
step_num: 8600 | loss: 0.1506 | profit rate: 17436994547437912522888024321631246052491264.0 | accuracy: 0.86
step_num: 8800 | loss: 0.1519 | profit rate: 1184809306882728366437717488804164413935606300672.0 | accuracy: 0.85
step_num: 9000 | loss: 0.1675 | profit rate: 181324409341718858715479923959138593852232965080236425216.0 | accuracy: 0.86
step_num: 9200 | loss: 0.1555 | profit rate: 436432258236616269653567213602263513690453456324711443070976.0 | accuracy: 0.85
step_num: 9400 | loss: 0.1448 | profit rate: 11805542451485103524842558248313485922414008954063716870936068096.0 | accuracy: 0.85
step_num: 9600 | loss: 0.1505 | profit rate: 3945693474060453260880752367930351489896124286936120147142181901670809600.0 | accuracy: 0.85
step_num: 9800 | loss: 0.1309 | profit rate: 71599444431191521323973311381922954938520163160158324827665145745465029565612032.0 | accuracy: 0.85
step_num: 10000 | loss: 0.1409 | profit rate: 977911711976304235080046810880659123264080484128563755872820228659331772127676781821952.0 | accuracy: 0.85
step_num: 10200 | loss: 0.1557 | profit rate: 245013862782811185823944861485046781559721662415587415166198075216731074677929314412191023104.0 | accuracy: 0.85
step_num: 10400 | loss: 0.1725 | profit rate: 222531855913273560799293738305617478752192873346769541037125090579863472279344017502547718508118016.0 | accuracy: 0.85
step_num: 10600 | loss: 0.1750 | profit rate: 797214140173015769209250212283667304672963245840743746654928973566330965377765259907310643772519702593536.0 | accuracy: 0.85
step_num: 10800 | loss: 0.1405 | profit rate: 52002906066600260654403306616916697578489854488350072108874165320647974179866926817259194270873957198077100032.0 | accuracy: 0.85
episode:   3/5,耗时:2.16分/6.25分,训练集: | step: 10986 | average_treward: 3526.7 | max_treward: 4028.2853 | average profit rate: 13769363646889980963776418529044979502043859078397667731757932019024281095915569940128607264434241000230948438016.000
model saved @ step:10986,performance:39256693810848271681802257100355887165824547148932792391345488834861022819192005146363931102652921303620640571392.000,accuracy:0.85
step_num: 11000 | loss: 0.1421 | profit rate:    9.3 | accuracy: 0.73
step_num: 11200 | loss: 0.1595 | profit rate: 399617302557.5 | accuracy: 0.85
step_num: 11400 | loss: 0.1121 | profit rate: 473893256359293632.0 | accuracy: 0.88
step_num: 11600 | loss: 0.1387 | profit rate: 35004495962013278666752.0 | accuracy: 0.87
step_num: 11800 | loss: 0.1407 | profit rate: 73125012908407624273986846720.0 | accuracy: 0.86
step_num: 12000 | loss: 0.1413 | profit rate: 3729923226160526553705964340510720.0 | accuracy: 0.85
step_num: 12200 | loss: 0.1279 | profit rate: 572963226101116972604379726900220691218432.0 | accuracy: 0.86
step_num: 12400 | loss: 0.1470 | profit rate: 104458668171138628243456918795127833322913267712.0 | accuracy: 0.87
step_num: 12600 | loss: 0.1383 | profit rate: 1623738456904279511789383158263148338431559383121920.0 | accuracy: 0.87
step_num: 12800 | loss: 0.1313 | profit rate: 111766936326821466041514809987349903161961705894770156503040.0 | accuracy: 0.87
step_num: 13000 | loss: 0.1522 | profit rate: 175145729966343818819410131032334728852582145491276393827270656.0 | accuracy: 0.86
step_num: 13200 | loss: 0.1406 | profit rate: 2004471370921896275257109643737411526785380048296551893195454135926784.0 | accuracy: 0.87
step_num: 13400 | loss: 0.1318 | profit rate: 582463357940362342066346229866598571792022822825116274987570777762400315637760.0 | accuracy: 0.87
step_num: 13600 | loss: 0.1567 | profit rate: 4471333073544799881914272877389071265847973389147349481249692770346617232838350602240.0 | accuracy: 0.87
step_num: 13800 | loss: 0.1324 | profit rate: 19257523038411416282364140737255603880599939682624334372632092075123030415616481258559766528.0 | accuracy: 0.87
step_num: 14000 | loss: 0.1219 | profit rate: 5568087651039583262473643864909993750788473072395372218492394909474437989370187407379973510529024.0 | accuracy: 0.87
step_num: 14200 | loss: 0.1220 | profit rate: 3426730434756410287509487843393193480272948294761788670101129453128826322710771005596632699539929694208.0 | accuracy: 0.87
step_num: 14400 | loss: 0.0943 | profit rate: 4268097002090651527509499665480320630420442489998675677356216313005493129435320156215645106345755747293331456.0 | accuracy: 0.87
step_num: 14600 | loss: 0.1266 | profit rate: 34917015600317625076948119775585729768366940023669604563577425274808239749232179434622603961410445489851139620864.0 | accuracy: 0.87
model saved @ step:14648,performance:78607249591296723227225048937606781991491797617256034020997256781786736823616012989617067881933395030193664425984.000,accuracy:0.87
step_num: 14800 | loss: 0.1393 | profit rate: 1262537846.7 | accuracy: 0.88
step_num: 15000 | loss: 0.1383 | profit rate: 29957529036898496.0 | accuracy: 0.90
step_num: 15200 | loss: 0.1284 | profit rate: 39303401144599332257792.0 | accuracy: 0.91
step_num: 15400 | loss: 0.1553 | profit rate: 62324006215553961425450827776.0 | accuracy: 0.89
step_num: 15600 | loss: 0.1547 | profit rate: 92160804642389050478839545724928.0 | accuracy: 0.86
step_num: 15800 | loss: 0.1558 | profit rate: 8264178277121523857332235758862998700032.0 | accuracy: 0.86
step_num: 16000 | loss: 0.1538 | profit rate: 4783556907718334009131084454598014886985334784.0 | accuracy: 0.87
step_num: 16200 | loss: 0.1179 | profit rate: 107539486734799100832220118486069447328504628641792.0 | accuracy: 0.87
step_num: 16400 | loss: 0.1543 | profit rate: 17017090523062931777861950997349617667562815876758897688576.0 | accuracy: 0.86
step_num: 16600 | loss: 0.1471 | profit rate: 15673781518917306253985014957699432402689376877839401604874240.0 | accuracy: 0.85
step_num: 16800 | loss: 0.1465 | profit rate: 1832569928714893886534596419719960313595728568538939703947568349184.0 | accuracy: 0.86
step_num: 17000 | loss: 0.1185 | profit rate: 47869019032492712813735156107703785346510737899164504205809882700778456481792.0 | accuracy: 0.86
step_num: 17200 | loss: 0.1197 | profit rate: 178939337204671401953985904420081319296840232547705850793756080514625830506863788032.0 | accuracy: 0.86
step_num: 17400 | loss: 0.1417 | profit rate: 42923764216086756653780316477053430081179591968333249179737236009366587038247861060894720.0 | accuracy: 0.86
step_num: 17600 | loss: 0.1415 | profit rate: 28776771650254967097693831329536067946204972292186053959876964492613886268207193145954246066176.0 | accuracy: 0.86
step_num: 17800 | loss: 0.1292 | profit rate: 22949499107810772422762005169887875242503387104623466087376937839851223883558689156019403858756239360.0 | accuracy: 0.86
step_num: 18000 | loss: 0.1479 | profit rate: 80409075269358442166559041090719073950257025504699028460894615754139491019544676483362326519903569162797056.0 | accuracy: 0.86
step_num: 18200 | loss: 0.1227 | profit rate: 368412958810248108237558320831873823698030694511449908539445670058242991961323102316231392696402392075156324352.0 | accuracy: 0.86
episode:   5/5,耗时:2.34分/11.00分,训练集: | step: 18310 | average_treward: 3758.8 | max_treward: 4115.7570 | average profit rate: 32980203203369952239412603564954468424474866192152298400316990836542324654213922199665312041429494738456254873600.000
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 52/391 [00:00<00:00, 513.53it/s] 30%|       | 117/391 [00:00<00:00, 586.54it/s] 45%|     | 177/391 [00:00<00:00, 591.73it/s] 62%|   | 244/391 [00:00<00:00, 621.68it/s] 79%|  | 309/391 [00:00<00:00, 631.84it/s] 96%|| 376/391 [00:00<00:00, 642.60it/s]100%|| 391/391 [00:00<00:00, 620.73it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2238.19
2023-07-24T12:00:00 | net performance [%] = 123.8185
2023-07-24T12:00:00 | number of trades [#] = 32
==================================================
Trial 57 Complete [00h 11m 14s]
net_wealth: 2238.185160870539

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 50m 06s

Search: Running Trial #58

Value             |Best Value So Far |Hyperparameter
14                |1                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
7                 |3                 |lags
0.85              |0.5               |gamma
0.0001            |0.001             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.9158 | profit rate:    4.0 | accuracy: 0.34
step_num: 400 | loss: 0.7197 | profit rate:    1.6 | accuracy: 0.30
step_num: 600 | loss: 0.7134 | profit rate:   11.5 | accuracy: 0.31
step_num: 800 | loss: 0.7602 | profit rate:    3.0 | accuracy: 0.30
step_num: 1000 | loss: 0.7959 | profit rate:  459.4 | accuracy: 0.34
step_num: 1200 | loss: 0.6553 | profit rate:  522.0 | accuracy: 0.33
step_num: 1400 | loss: 0.5819 | profit rate: 6203.2 | accuracy: 0.34
step_num: 1600 | loss: 0.9631 | profit rate: 8668936.0 | accuracy: 0.35
step_num: 1800 | loss: 0.6108 | profit rate: 300509810.6 | accuracy: 0.37
step_num: 2000 | loss: 0.5584 | profit rate: 108063566984.7 | accuracy: 0.39
step_num: 2200 | loss: 1.0471 | profit rate: 2281586176601698304.0 | accuracy: 0.42
step_num: 2400 | loss: 0.8934 | profit rate: 418489502893124026368.0 | accuracy: 0.44
step_num: 2600 | loss: 0.7147 | profit rate: 119307399856848279437312.0 | accuracy: 0.44
step_num: 2800 | loss: 0.7593 | profit rate: 143099126241191557538512896.0 | accuracy: 0.46
step_num: 3000 | loss: 0.6450 | profit rate: 708480874778607588457918234624.0 | accuracy: 0.48
step_num: 3200 | loss: 0.6716 | profit rate: 61735130966347390956718667474141184.0 | accuracy: 0.49
step_num: 3400 | loss: 0.6620 | profit rate: 3521614336305772153405476252208332800.0 | accuracy: 0.50
episode:   1/5,耗时:0.78分/0.78分,训练集: | step: 3521 | average_treward: 1143.5 | max_treward: 1143.4875 | average profit rate: 30097291660296690355007355542956933120.000
model saved @ step:3521,performance:30097291660296690355007355542956933120.000,accuracy:0.50
step_num: 3600 | loss: 0.6098 | profit rate:  457.9 | accuracy: 0.75
step_num: 3800 | loss: 0.8070 | profit rate: 314613.8 | accuracy: 0.66
step_num: 4000 | loss: 0.8040 | profit rate: 76960138.9 | accuracy: 0.67
step_num: 4200 | loss: 0.9576 | profit rate: 555212965877.8 | accuracy: 0.66
step_num: 4400 | loss: 0.7706 | profit rate: 1309623664071880.8 | accuracy: 0.65
step_num: 4600 | loss: 0.8585 | profit rate: 61980914079721766912.0 | accuracy: 0.66
step_num: 4800 | loss: 0.6192 | profit rate: 128364143254178713567232.0 | accuracy: 0.67
step_num: 5000 | loss: 0.6861 | profit rate: 9630894766832624435848019968.0 | accuracy: 0.66
step_num: 5200 | loss: 0.7019 | profit rate: 2472140504944160948591513305088.0 | accuracy: 0.65
step_num: 5400 | loss: 0.5696 | profit rate: 240011168626921511364874077208576.0 | accuracy: 0.65
step_num: 5600 | loss: 0.7642 | profit rate: 695086637533364331332681052684373983232.0 | accuracy: 0.66
step_num: 5800 | loss: 0.7178 | profit rate: 676410737488665450099534669352494837308325888.0 | accuracy: 0.67
step_num: 6000 | loss: 0.7392 | profit rate: 3708164498562208349530376561199518575888860971008.0 | accuracy: 0.66
step_num: 6200 | loss: 0.7293 | profit rate: 6312238048743736150406059450268146805183126052012032.0 | accuracy: 0.66
step_num: 6400 | loss: 0.6233 | profit rate: 4143387617801635985072470107639890361156813678262091776.0 | accuracy: 0.66
step_num: 6600 | loss: 0.6323 | profit rate: 7473175157243016041495026770817856485633892879226797817856.0 | accuracy: 0.66
step_num: 6800 | loss: 0.6343 | profit rate: 128815981886510174662875787803410466558217629672751377594449920.0 | accuracy: 0.65
step_num: 7000 | loss: 0.5296 | profit rate: 4561194789232739263638301913066932581440282675761495065126502400.0 | accuracy: 0.65
model saved @ step:7042,performance:7092911181879843777220910563900479998027934058455704945058381824.000,accuracy:0.65
step_num: 7200 | loss: 0.6144 | profit rate: 5415.0 | accuracy: 0.69
step_num: 7400 | loss: 0.7576 | profit rate: 14208937.6 | accuracy: 0.67
step_num: 7600 | loss: 0.7676 | profit rate: 71550086837.6 | accuracy: 0.67
step_num: 7800 | loss: 0.7218 | profit rate: 1999596154376.7 | accuracy: 0.64
step_num: 8000 | loss: 0.6600 | profit rate: 74577417942962992.0 | accuracy: 0.65
step_num: 8200 | loss: 0.8912 | profit rate: 1340988629413422694400.0 | accuracy: 0.66
step_num: 8400 | loss: 0.6741 | profit rate: 2139943827462856386805760.0 | accuracy: 0.67
step_num: 8600 | loss: 0.7807 | profit rate: 92936673922535291810754854912.0 | accuracy: 0.65
step_num: 8800 | loss: 0.5840 | profit rate: 173057932055478415211941421121536.0 | accuracy: 0.65
step_num: 9000 | loss: 0.6073 | profit rate: 26017444218513247426302195837960192.0 | accuracy: 0.66
step_num: 9200 | loss: 0.7688 | profit rate: 15901065325899297957481059474082975627345920.0 | accuracy: 0.67
step_num: 9400 | loss: 0.7088 | profit rate: 310002840506447864261831835392817909513121169408.0 | accuracy: 0.67
step_num: 9600 | loss: 0.6350 | profit rate: 603519650087286972190305233940865659403917374521344.0 | accuracy: 0.66
step_num: 9800 | loss: 0.6681 | profit rate: 2446886145967353129982529545409145327070834008147361792.0 | accuracy: 0.66
step_num: 10000 | loss: 0.7000 | profit rate: 4441039125720742924301961858233200515267281427732587610112.0 | accuracy: 0.66
step_num: 10200 | loss: 0.6224 | profit rate: 31341660098928576124364388899533196356510032638738391415914496.0 | accuracy: 0.66
step_num: 10400 | loss: 0.7072 | profit rate: 8104068797453448545738775097060895891433511572283673828472651776.0 | accuracy: 0.65
episode:   3/5,耗时:0.86分/2.53分,训练集: | step: 10563 | average_treward: 1733.2 | max_treward: 2056.0988 | average profit rate: 49748809001755462991862466671574541448817175448303621330532564992.000
model saved @ step:10563,performance:142153515823386559813382862759852326385271919449285355605864742912.000,accuracy:0.65
step_num: 10600 | loss: 0.6146 | profit rate:   27.4 | accuracy: 0.79
step_num: 10800 | loss: 0.6730 | profit rate: 111500.0 | accuracy: 0.68
step_num: 11000 | loss: 0.6536 | profit rate: 88600045.4 | accuracy: 0.66
step_num: 11200 | loss: 0.7125 | profit rate: 1704280549311.0 | accuracy: 0.66
step_num: 11400 | loss: 0.6994 | profit rate: 97825619993436.5 | accuracy: 0.65
step_num: 11600 | loss: 0.7259 | profit rate: 82091521682463457280.0 | accuracy: 0.67
step_num: 11800 | loss: 0.7190 | profit rate: 78788835193114933067776.0 | accuracy: 0.67
step_num: 12000 | loss: 0.6142 | profit rate: 82210274120929668902158336.0 | accuracy: 0.67
step_num: 12200 | loss: 0.7044 | profit rate: 75897612173844803408602947649536.0 | accuracy: 0.67
step_num: 12400 | loss: 0.6505 | profit rate: 5544794490926365889068844573523968.0 | accuracy: 0.66
step_num: 12600 | loss: 0.6597 | profit rate: 110282777793401809922443846346352885760.0 | accuracy: 0.67
step_num: 12800 | loss: 0.7370 | profit rate: 21962837602087155795352944147874410765536460800.0 | accuracy: 0.68
step_num: 13000 | loss: 0.7501 | profit rate: 251617022056277862109314826067747343343216127639552.0 | accuracy: 0.68
step_num: 13200 | loss: 0.7305 | profit rate: 4825989268698326717400375132085336891407661675822710784.0 | accuracy: 0.67
step_num: 13400 | loss: 0.6952 | profit rate: 5478162598224428144685251859068294219881738349271903633408.0 | accuracy: 0.67
step_num: 13600 | loss: 0.6401 | profit rate: 2776924293056945136958556330373053307521802720506620313337856.0 | accuracy: 0.67
step_num: 13800 | loss: 0.6217 | profit rate: 26447972308452215095624796758700777295586583188450673997629095936.0 | accuracy: 0.66
step_num: 14000 | loss: 0.6049 | profit rate: 7292024087502886525159304257016727318816398429827158258854144245760.0 | accuracy: 0.66
model saved @ step:14084,performance:17399589068847450340369764184290403488830408595733821441960996503552.000,accuracy:0.66
step_num: 14200 | loss: 0.7694 | profit rate:  403.4 | accuracy: 0.65
step_num: 14400 | loss: 0.7049 | profit rate: 31103039.9 | accuracy: 0.70
step_num: 14600 | loss: 0.7818 | profit rate: 10440049317.5 | accuracy: 0.68
step_num: 14800 | loss: 0.6475 | profit rate: 9170553796847.4 | accuracy: 0.67
step_num: 15000 | loss: 0.6933 | profit rate: 45671034070183280.0 | accuracy: 0.67
step_num: 15200 | loss: 0.7452 | profit rate: 2997428849014899474432.0 | accuracy: 0.68
step_num: 15400 | loss: 0.6498 | profit rate: 4116296927251529476341760.0 | accuracy: 0.69
step_num: 15600 | loss: 0.9552 | profit rate: 1310225312774170713640891580416.0 | accuracy: 0.69
step_num: 15800 | loss: 0.6788 | profit rate: 303955460848218164545340313698304.0 | accuracy: 0.68
step_num: 16000 | loss: 0.5668 | profit rate: 62438651257392480081741556230389760.0 | accuracy: 0.68
step_num: 16200 | loss: 0.5736 | profit rate: 1788007548664954568240403887049744643522560.0 | accuracy: 0.69
step_num: 16400 | loss: 0.6454 | profit rate: 1224990006760743356896970993360470532706980069376.0 | accuracy: 0.69
step_num: 16600 | loss: 0.7621 | profit rate: 59836371037001751283697064391644367271816032646332416.0 | accuracy: 0.69
step_num: 16800 | loss: 0.6799 | profit rate: 114684448510930207560060430618593697895948564508887220224.0 | accuracy: 0.69
step_num: 17000 | loss: 0.6644 | profit rate: 139988328825760639181938422511482846435560612865169669750784.0 | accuracy: 0.68
step_num: 17200 | loss: 0.7261 | profit rate: 111303190944082381819465533010935171629504784490285367858036736.0 | accuracy: 0.68
step_num: 17400 | loss: 0.6806 | profit rate: 905104403411989196274140747932022111295457330469472952984734269440.0 | accuracy: 0.68
step_num: 17600 | loss: 0.5575 | profit rate: 29735777679203216793211295250689958894973671011945536168548481630208.0 | accuracy: 0.68
episode:   5/5,耗时:0.88分/4.28分,训练集: | step: 17605 | average_treward: 1897.1 | max_treward: 2152.8257 | average profit rate: 9469876342475091506178457711732477208477285562231292538549205729280.000
model saved @ step:17605,performance:29800546216522743367943812127422783294880133938870712902610979913728.000,accuracy:0.68
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 12%|        | 50/404 [00:00<00:00, 500.00it/s] 27%|       | 108/404 [00:00<00:00, 543.88it/s] 41%|      | 166/404 [00:00<00:00, 557.77it/s] 57%|    | 231/404 [00:00<00:00, 589.39it/s] 73%|  | 295/404 [00:00<00:00, 607.49it/s] 89%| | 361/404 [00:00<00:00, 625.16it/s]==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
100%|| 404/404 [00:00<00:00, 600.26it/s]
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2931.52
2023-07-24T12:00:00 | net performance [%] = 193.1524
2023-07-24T12:00:00 | number of trades [#] = 54
==================================================
Trial 58 Complete [00h 04m 22s]
net_wealth: 2931.524448581284

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 08h 54m 29s

Search: Running Trial #59

Value             |Best Value So Far |Hyperparameter
4                 |1                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
20                |3                 |lags
0.6               |0.5               |gamma
0.0001            |0.001             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
10                |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.5156 | profit rate:   11.9 | accuracy: 0.38
step_num: 600 | loss: 0.3169 | profit rate:   44.9 | accuracy: 0.41
step_num: 800 | loss: 0.2921 | profit rate:  210.3 | accuracy: 0.42
step_num: 1000 | loss: 0.2679 | profit rate: 1044.7 | accuracy: 0.43
step_num: 1200 | loss: 0.2324 | profit rate: 337307.6 | accuracy: 0.46
step_num: 1400 | loss: 0.1910 | profit rate: 26956975.4 | accuracy: 0.49
step_num: 1600 | loss: 0.1923 | profit rate: 907540222.2 | accuracy: 0.51
step_num: 1800 | loss: 0.1797 | profit rate: 3501978050832.9 | accuracy: 0.54
step_num: 2000 | loss: 0.1646 | profit rate: 122789042620792.2 | accuracy: 0.57
step_num: 2200 | loss: 0.1706 | profit rate: 68256366300593112.0 | accuracy: 0.59
step_num: 2400 | loss: 0.1506 | profit rate: 1104883744318781915136.0 | accuracy: 0.61
step_num: 2600 | loss: 0.1408 | profit rate: 7491196564618727322025984.0 | accuracy: 0.63
step_num: 2800 | loss: 0.1518 | profit rate: 9781242847508710445203587072.0 | accuracy: 0.64
step_num: 3000 | loss: 0.1535 | profit rate: 5548654317452332859289407324160.0 | accuracy: 0.66
step_num: 3200 | loss: 0.1505 | profit rate: 6523752690502056006205088005619712.0 | accuracy: 0.67
step_num: 3400 | loss: 0.1354 | profit rate: 5638731764787784105284804209788583936.0 | accuracy: 0.68
step_num: 3600 | loss: 0.1341 | profit rate: 743905719437747078936371679776401784832.0 | accuracy: 0.69
episode:   1/5,耗时:1.40分/1.40分,训练集: | step: 3648 | average_treward: 2362.8 | max_treward: 2362.8010 | average profit rate: 1432434565119469389892497118062276771840.000
model saved @ step:3648,performance:1432434565119469389892497118062276771840.000,accuracy:0.69
step_num: 3800 | loss: 0.1342 | profit rate: 125005.7 | accuracy: 0.89
step_num: 4000 | loss: 0.1167 | profit rate: 254406853.6 | accuracy: 0.89
step_num: 4200 | loss: 0.1107 | profit rate: 148835144059.0 | accuracy: 0.90
step_num: 4400 | loss: 0.1259 | profit rate: 86019571781272.2 | accuracy: 0.88
step_num: 4600 | loss: 0.1179 | profit rate: 4757390704441727.0 | accuracy: 0.87
step_num: 4800 | loss: 0.1260 | profit rate: 70443580049589846016.0 | accuracy: 0.88
step_num: 5000 | loss: 0.1340 | profit rate: 59541270000748959105024.0 | accuracy: 0.88
step_num: 5200 | loss: 0.1154 | profit rate: 9441957385318913233911808.0 | accuracy: 0.88
step_num: 5400 | loss: 0.1197 | profit rate: 142057085741896713958062030848.0 | accuracy: 0.88
step_num: 5600 | loss: 0.1334 | profit rate: 6962797468418033927364634738688.0 | accuracy: 0.88
step_num: 5800 | loss: 0.1200 | profit rate: 2084978777602715867057350466600960.0 | accuracy: 0.88
step_num: 6000 | loss: 0.0896 | profit rate: 151320711389834581942779252069934039040.0 | accuracy: 0.88
step_num: 6200 | loss: 0.0721 | profit rate: 2097945944315751085821095531281278851612672.0 | accuracy: 0.89
step_num: 6400 | loss: 0.1188 | profit rate: 5798225211204768447598291049032825755230273536.0 | accuracy: 0.89
step_num: 6600 | loss: 0.1269 | profit rate: 5197205698192957930328986304540492632253605609472.0 | accuracy: 0.89
step_num: 6800 | loss: 0.1002 | profit rate: 6557905365246682514651387699180827148848807435829248.0 | accuracy: 0.89
step_num: 7000 | loss: 0.0782 | profit rate: 26414099253240369679202721561614671474472136609747697664.0 | accuracy: 0.90
step_num: 7200 | loss: 0.0709 | profit rate: 3258489171495102633737183914175994953580056933823506546688.0 | accuracy: 0.89
model saved @ step:7296,performance:37003502996186898905257859415075364959533859911701186478080.000,accuracy:0.89
step_num: 7400 | loss: 0.0989 | profit rate: 9264.9 | accuracy: 0.94
step_num: 7600 | loss: 0.1006 | profit rate: 67924278.7 | accuracy: 0.90
step_num: 7800 | loss: 0.1237 | profit rate: 24877240318.8 | accuracy: 0.89
step_num: 8000 | loss: 0.1076 | profit rate: 13850367718080.8 | accuracy: 0.89
step_num: 8200 | loss: 0.0832 | profit rate: 1711645622000008.5 | accuracy: 0.89
step_num: 8400 | loss: 0.1035 | profit rate: 4349485339686557184.0 | accuracy: 0.89
step_num: 8600 | loss: 0.0934 | profit rate: 9023333359169526824960.0 | accuracy: 0.89
step_num: 8800 | loss: 0.1017 | profit rate: 4326641277536908225806336.0 | accuracy: 0.90
step_num: 9000 | loss: 0.0904 | profit rate: 24136218542657012283012546560.0 | accuracy: 0.89
step_num: 9200 | loss: 0.0977 | profit rate: 4593983427724840143073849638912.0 | accuracy: 0.89
step_num: 9400 | loss: 0.0856 | profit rate: 440909541751300120973701254479872.0 | accuracy: 0.89
step_num: 9600 | loss: 0.0790 | profit rate: 18681840498480068717818363067949383680.0 | accuracy: 0.90
step_num: 9800 | loss: 0.0779 | profit rate: 329710177488934698534562568306124369428480.0 | accuracy: 0.90
step_num: 10000 | loss: 0.0577 | profit rate: 2429211835914575151137677454138563194020429824.0 | accuracy: 0.90
step_num: 10200 | loss: 0.0848 | profit rate: 3885008261062174835731235337224069589239639048192.0 | accuracy: 0.90
step_num: 10400 | loss: 0.0845 | profit rate: 4892314859786583203907081126285789971588375585488896.0 | accuracy: 0.90
step_num: 10600 | loss: 0.0848 | profit rate: 8534135715159899160820445739946661340342376745150709760.0 | accuracy: 0.91
step_num: 10800 | loss: 0.0761 | profit rate: 3926710323461081307286654401088719704034913180477575659520.0 | accuracy: 0.91
episode:   3/5,耗时:2.38分/5.37分,训练集: | step: 10944 | average_treward: 3256.4 | max_treward: 3757.1994 | average profit rate: 52536583383278920081727184359617657021860454215921292017664.000
model saved @ step:10944,performance:120606247153649850189551094398466035338188366411881936584704.000,accuracy:0.91
step_num: 11000 | loss: 0.0858 | profit rate:  185.7 | accuracy: 0.96
step_num: 11200 | loss: 0.0490 | profit rate: 16519934.2 | accuracy: 0.92
step_num: 11400 | loss: 0.1045 | profit rate: 18362214368.9 | accuracy: 0.91
step_num: 11600 | loss: 0.1066 | profit rate: 1476247525184.2 | accuracy: 0.90
step_num: 11800 | loss: 0.0779 | profit rate: 1842261553123800.5 | accuracy: 0.90
step_num: 12000 | loss: 0.0742 | profit rate: 804138758143445120.0 | accuracy: 0.91
step_num: 12200 | loss: 0.1115 | profit rate: 4123033130310866829312.0 | accuracy: 0.90
step_num: 12400 | loss: 0.0912 | profit rate: 2335483616069517993574400.0 | accuracy: 0.90
step_num: 12600 | loss: 0.0664 | profit rate: 5879716567384950639895248896.0 | accuracy: 0.91
step_num: 12800 | loss: 0.0801 | profit rate: 1669582790929516731020047548416.0 | accuracy: 0.90
step_num: 13000 | loss: 0.1155 | profit rate: 99690899089666584336106027745280.0 | accuracy: 0.90
step_num: 13200 | loss: 0.0948 | profit rate: 1211253705222701209831575925400010752.0 | accuracy: 0.90
step_num: 13400 | loss: 0.0762 | profit rate: 15681485882841857908153132230733132201984.0 | accuracy: 0.91
step_num: 13600 | loss: 0.0712 | profit rate: 329310941817045863373312931969705526962421760.0 | accuracy: 0.91
step_num: 13800 | loss: 0.0666 | profit rate: 464309594753338232921527102514579591715253911552.0 | accuracy: 0.91
step_num: 14000 | loss: 0.0719 | profit rate: 829557563082155624556218661715308887862187338498048.0 | accuracy: 0.91
step_num: 14200 | loss: 0.0730 | profit rate: 433322968390719305606513402942650410064081932808880128.0 | accuracy: 0.91
step_num: 14400 | loss: 0.0676 | profit rate: 1168225467814390755451349632255324860529708953004519981056.0 | accuracy: 0.91
model saved @ step:14592,performance:93038202171910290259556242183064106708438359095676504113152.000,accuracy:0.91
step_num: 14600 | loss: 0.0519 | profit rate:    2.6 | accuracy: 1.00
step_num: 14800 | loss: 0.0756 | profit rate: 1866955.4 | accuracy: 0.90
step_num: 15000 | loss: 0.1102 | profit rate: 1694857230.7 | accuracy: 0.90
step_num: 15200 | loss: 0.0893 | profit rate: 309182346017.0 | accuracy: 0.90
step_num: 15400 | loss: 0.0928 | profit rate: 362584482561906.8 | accuracy: 0.90
step_num: 15600 | loss: 0.0781 | profit rate: 54637747758733616.0 | accuracy: 0.90
step_num: 15800 | loss: 0.0654 | profit rate: 984176378064881319936.0 | accuracy: 0.90
step_num: 16000 | loss: 0.0788 | profit rate: 404236060311518017748992.0 | accuracy: 0.90
step_num: 16200 | loss: 0.0666 | profit rate: 106061064059521131855478784.0 | accuracy: 0.90
step_num: 16400 | loss: 0.0780 | profit rate: 1085155929547917165392558030848.0 | accuracy: 0.90
step_num: 16600 | loss: 0.0790 | profit rate: 63791345060291033392528826040320.0 | accuracy: 0.90
step_num: 16800 | loss: 0.0825 | profit rate: 74826350055272177842096729072074752.0 | accuracy: 0.90
step_num: 17000 | loss: 0.0532 | profit rate: 2846842686159608282197596257575055130624.0 | accuracy: 0.91
step_num: 17200 | loss: 0.0644 | profit rate: 52216294538848288355167704925877284892573696.0 | accuracy: 0.91
step_num: 17400 | loss: 0.0500 | profit rate: 157431692945037393269213150897338442585605144576.0 | accuracy: 0.91
step_num: 17600 | loss: 0.0611 | profit rate: 182225385256293869374422488194478091607726387888128.0 | accuracy: 0.92
step_num: 17800 | loss: 0.0523 | profit rate: 218216691911803948875348643334440124578204047359606784.0 | accuracy: 0.92
step_num: 18000 | loss: 0.0641 | profit rate: 410988760099371378735020724188846772625152517069879640064.0 | accuracy: 0.92
step_num: 18200 | loss: 0.0595 | profit rate: 95690349463093094828176462745534083190877116686603248467968.0 | accuracy: 0.92
episode:   5/5,耗时:1.59分/8.55分,训练集: | step: 18240 | average_treward: 3481.5 | max_treward: 3840.3366 | average profit rate: 87115514721111204098397993697627977370268263648041025667072.000
model saved @ step:18240,performance:184929621283808981137624772491534379845180732820945501159424.000,accuracy:0.92
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 13%|        | 50/391 [00:00<00:00, 495.05it/s] 28%|       | 111/391 [00:00<00:00, 558.74it/s] 44%|     | 172/391 [00:00<00:00, 579.38it/s] 60%|    | 234/391 [00:00<00:00, 592.99it/s] 76%|  | 299/391 [00:00<00:00, 611.23it/s] 94%|| 366/391 [00:00<00:00, 626.84it/s]100%|| 391/391 [00:00<00:00, 604.22it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 3524.66
2023-07-24T12:00:00 | net performance [%] = 252.4659
2023-07-24T12:00:00 | number of trades [#] = 90
==================================================
Trial 59 Complete [00h 09m 23s]
net_wealth: 3524.659456922284

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 09h 03m 51s

Search: Running Trial #60

Value             |Best Value So Far |Hyperparameter
13                |1                 |horizon
730               |225               |lookback
True              |False             |MarketFactor
10                |3                 |lags
0.5               |0.5               |gamma
5e-05             |0.001             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
0.1               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4288.000000   4301.000000
mean      0.000435    20113.607657  ...   20217.089827  20169.373185
std       0.027833    16040.642334  ...   16079.528271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7773.282593   7730.930176
50%       0.000642    11571.842969  ...   11761.935059  11751.469727
75%       0.011590    29894.706152  ...   30060.440430  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.6407 | profit rate:    0.9 | accuracy: 0.35
step_num: 400 | loss: 0.5964 | profit rate:    0.8 | accuracy: 0.33
step_num: 600 | loss: 0.7268 | profit rate:   19.1 | accuracy: 0.35
step_num: 800 | loss: 0.4694 | profit rate:  722.0 | accuracy: 0.36
step_num: 1000 | loss: 0.4392 | profit rate: 48117.7 | accuracy: 0.39
step_num: 1200 | loss: 0.4663 | profit rate: 353932401.0 | accuracy: 0.41
step_num: 1400 | loss: 0.3857 | profit rate: 48001010869.3 | accuracy: 0.43
step_num: 1600 | loss: 0.4354 | profit rate: 10341881164875.0 | accuracy: 0.45
step_num: 1800 | loss: 0.4804 | profit rate: 128359582366671486976.0 | accuracy: 0.48
step_num: 2000 | loss: 0.5818 | profit rate: 30371161204465299242352640.0 | accuracy: 0.51
step_num: 2200 | loss: 0.4962 | profit rate: 361601936591827655215126937600.0 | accuracy: 0.52
step_num: 2400 | loss: 0.5253 | profit rate: 2079883897270788160397017622773760.0 | accuracy: 0.53
step_num: 2600 | loss: 0.5087 | profit rate: 86769008937696610763030267737262784512.0 | accuracy: 0.55
step_num: 2800 | loss: 0.3834 | profit rate: 13691193351935553120004936441200215368663040.0 | accuracy: 0.56
step_num: 3000 | loss: 0.4825 | profit rate: 11833018912903913176668295480161047111987625984.0 | accuracy: 0.57
episode:   1/5,耗时:0.85分/0.85分,训练集: | step: 3153 | average_treward: 1581.3 | max_treward: 1581.3029 | average profit rate: 231422455828489451159364451282227743787537399808.000
model saved @ step:3153,performance:231422455828489451159364451282227743787537399808.000,accuracy:0.57
step_num: 3200 | loss: 0.4540 | profit rate:    3.0 | accuracy: 0.69
step_num: 3400 | loss: 0.4272 | profit rate: 525742.5 | accuracy: 0.74
step_num: 3600 | loss: 0.4614 | profit rate: 354616393.6 | accuracy: 0.73
step_num: 3800 | loss: 0.4249 | profit rate: 4204605042835261.0 | accuracy: 0.77
step_num: 4000 | loss: 0.4261 | profit rate: 78765638994991775744.0 | accuracy: 0.76
step_num: 4200 | loss: 0.4144 | profit rate: 283640670506074312278016.0 | accuracy: 0.76
step_num: 4400 | loss: 0.4191 | profit rate: 1116468133453122793864177909760.0 | accuracy: 0.75
step_num: 4600 | loss: 0.4133 | profit rate: 255489857231667287724816005595136.0 | accuracy: 0.75
step_num: 4800 | loss: 0.3926 | profit rate: 2324089526894020859481057789455892480.0 | accuracy: 0.75
step_num: 5000 | loss: 0.4062 | profit rate: 1305932673113650133503557801484522405322817536.0 | accuracy: 0.76
step_num: 5200 | loss: 0.4481 | profit rate: 2332903830883673053764099928523246774050074166034432.0 | accuracy: 0.77
step_num: 5400 | loss: 0.4055 | profit rate: 71904705303471682585953625770833928732102059879393394688.0 | accuracy: 0.76
step_num: 5600 | loss: 0.4472 | profit rate: 815368203496179839112438631505595187148262689609827070509056.0 | accuracy: 0.76
step_num: 5800 | loss: 0.3980 | profit rate: 32426367204085111975168615636596083645141527794516670016833716224.0 | accuracy: 0.77
step_num: 6000 | loss: 0.4515 | profit rate: 15511913651474793898347330760921300405133602384118048352783441202249728.0 | accuracy: 0.77
step_num: 6200 | loss: 0.4410 | profit rate: 3961458087449513674646257309346670354400586416198464810118387933829398528.0 | accuracy: 0.76
model saved @ step:6306,performance:53851069237696865852096562168988999824189810309699224292862088615083114496.000,accuracy:0.76
step_num: 6400 | loss: 0.4147 | profit rate:    8.1 | accuracy: 0.74
step_num: 6600 | loss: 0.3502 | profit rate: 5004033.7 | accuracy: 0.79
step_num: 6800 | loss: 0.4059 | profit rate: 57881830574.3 | accuracy: 0.79
step_num: 7000 | loss: 0.3917 | profit rate: 939144768926698496.0 | accuracy: 0.81
step_num: 7200 | loss: 0.3202 | profit rate: 9199324825191953989632.0 | accuracy: 0.79
step_num: 7400 | loss: 0.3274 | profit rate: 14414516050138845939761152.0 | accuracy: 0.78
step_num: 7600 | loss: 0.3086 | profit rate: 230410801136025567314810861780992.0 | accuracy: 0.79
step_num: 7800 | loss: 0.4012 | profit rate: 100580575481530565158004146212700160.0 | accuracy: 0.78
step_num: 8000 | loss: 0.3504 | profit rate: 66060996917633297327517585812540604022784.0 | accuracy: 0.79
step_num: 8200 | loss: 0.3904 | profit rate: 1546494075951605679096738542398290355738734755840.0 | accuracy: 0.79
step_num: 8400 | loss: 0.4463 | profit rate: 1782448418641603961560836292505090282548043758832713728.0 | accuracy: 0.79
step_num: 8600 | loss: 0.3904 | profit rate: 613254600469111455434465654991530026085285707868503596335104.0 | accuracy: 0.79
step_num: 8800 | loss: 0.3776 | profit rate: 4442778270729972032095154000455690827887925891948345830779387904.0 | accuracy: 0.79
step_num: 9000 | loss: 0.3585 | profit rate: 372396702944633640179802464654508587473803059374644140058735743598592.0 | accuracy: 0.79
step_num: 9200 | loss: 0.3882 | profit rate: 57776677212992683096974491963168594168063205653999870507947244156272771072.0 | accuracy: 0.79
step_num: 9400 | loss: 0.4269 | profit rate: 16851377550736437950774078897417489856868594886109115341250800263188984102912.0 | accuracy: 0.78
episode:   3/5,耗时:0.98分/3.32分,训练集: | step: 9459 | average_treward: 2290.1 | max_treward: 2716.1550 | average profit rate: 11473896398371930152649031978209687184216800607486375478871383875135020728320.000
model saved @ step:9459,performance:34367838125878092907890910215311869294725164882513787857164546090210217164800.000,accuracy:0.78
step_num: 9600 | loss: 0.4237 | profit rate:   40.9 | accuracy: 0.77
step_num: 9800 | loss: 0.2942 | profit rate: 13737205.3 | accuracy: 0.78
step_num: 10000 | loss: 0.3491 | profit rate: 849876527529.2 | accuracy: 0.79
step_num: 10200 | loss: 0.3096 | profit rate: 2284978187782814720.0 | accuracy: 0.80
step_num: 10400 | loss: 0.3937 | profit rate: 20543551379723606032384.0 | accuracy: 0.80
step_num: 10600 | loss: 0.3955 | profit rate: 104179253337552286948949753856.0 | accuracy: 0.80
step_num: 10800 | loss: 0.4136 | profit rate: 297980156226200616443651716808704.0 | accuracy: 0.79
step_num: 11000 | loss: 0.3270 | profit rate: 404036799324452360925356058352812032.0 | accuracy: 0.79
step_num: 11200 | loss: 0.2549 | profit rate: 16369626545258060440568745157343920668016640.0 | accuracy: 0.80
step_num: 11400 | loss: 0.3593 | profit rate: 59698604786651782724028932192427936080701805297664.0 | accuracy: 0.80
step_num: 11600 | loss: 0.3666 | profit rate: 311696791902992087154003573017616135403710219026297782272.0 | accuracy: 0.80
step_num: 11800 | loss: 0.4785 | profit rate: 4933308178177794882390028809431540529330516579997412239605760.0 | accuracy: 0.80
step_num: 12000 | loss: 0.4127 | profit rate: 140649496656479085013216403663524074983524960588391277661568106496.0 | accuracy: 0.79
step_num: 12200 | loss: 0.3975 | profit rate: 892823629881075817015548305837375825540447442851891562251811974807552.0 | accuracy: 0.79
step_num: 12400 | loss: 0.3580 | profit rate: 873112955736060479506974741661210644668320679888351425709107542470248366080.0 | accuracy: 0.80
step_num: 12600 | loss: 0.3570 | profit rate: 143401498076956385581920460328692488738746774103063114214764657438159349481472.0 | accuracy: 0.79
model saved @ step:12612,performance:157396069801014361185504161315367903934567900346189783263471057632233839919104.000,accuracy:0.79
step_num: 12800 | loss: 0.3647 | profit rate: 55186.9 | accuracy: 0.80
step_num: 13000 | loss: 0.3497 | profit rate: 38502883.8 | accuracy: 0.77
step_num: 13200 | loss: 0.3664 | profit rate: 218858545985583.5 | accuracy: 0.79
step_num: 13400 | loss: 0.2626 | profit rate: 81861916244652687360.0 | accuracy: 0.79
step_num: 13600 | loss: 0.3687 | profit rate: 189363488199283004407808.0 | accuracy: 0.79
step_num: 13800 | loss: 0.3418 | profit rate: 1680104090863847293085831659520.0 | accuracy: 0.79
step_num: 14000 | loss: 0.2850 | profit rate: 10489447613625763123167583382011904.0 | accuracy: 0.79
step_num: 14200 | loss: 0.2968 | profit rate: 40346405751347562797039815429424414720.0 | accuracy: 0.79
step_num: 14400 | loss: 0.2764 | profit rate: 8308695407257032502359824649071911059845021696.0 | accuracy: 0.80
step_num: 14600 | loss: 0.3791 | profit rate: 26725663288573560294549522088421983628968520543371264.0 | accuracy: 0.80
step_num: 14800 | loss: 0.3920 | profit rate: 2181273097014854350645247531220887626552458290996566818816.0 | accuracy: 0.80
step_num: 15000 | loss: 0.3966 | profit rate: 57360799104674694947053817101748013989850836053026423915413504.0 | accuracy: 0.79
step_num: 15200 | loss: 0.3701 | profit rate: 2665145615105435965576160583118029512089238243712061603342085783552.0 | accuracy: 0.79
step_num: 15400 | loss: 0.3625 | profit rate: 1207172574468426099330587382796970763654843685848730423595905816188682240.0 | accuracy: 0.79
step_num: 15600 | loss: 0.2853 | profit rate: 7655273899737341809087895130373185494011269336472422883790820497845190131712.0 | accuracy: 0.79
episode:   5/5,耗时:0.94分/5.23分,训练集: | step: 15765 | average_treward: 2484.8 | max_treward: 2777.7632 | average profit rate: 110414757245088930456126647161745503158632368453326846983933719394207410421760.000
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 13%|        | 54/401 [00:00<00:00, 535.95it/s] 30%|       | 120/401 [00:00<00:00, 605.14it/s] 46%|     | 185/401 [00:00<00:00, 622.70it/s] 63%|   | 252/401 [00:00<00:00, 638.76it/s] 80%|  | 319/401 [00:00<00:00, 649.36it/s] 96%|| 386/401 [00:00<00:00, 654.13it/s]100%|| 401/401 [00:00<00:00, 637.51it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 2825.46
2023-07-24T12:00:00 | net performance [%] = 182.5458
2023-07-24T12:00:00 | number of trades [#] = 52
==================================================
Trial 60 Complete [00h 05m 42s]
net_wealth: 2825.458303158246

Best net_wealth So Far: 8864.534520422041
Total elapsed time: 09h 09m 34s
Results summary
Results in saved_model\keras_tuner
Showing 10 best trials
Objective(name="net_wealth", direction="max")

Trial 00 summary
Hyperparameters:
horizon: 1
lookback: 225
MarketFactor: False
lags: 3
gamma: 0.5
DQN_lr: 0.001
memory_size: 64
batch_size: 16
gradient_clip_norm: 0.1
Score: 8864.534520422041

Trial 16 summary
Hyperparameters:
horizon: 1
lookback: 730
MarketFactor: False
lags: 3
gamma: 0.7
DQN_lr: 0.0005
memory_size: 256
batch_size: 64
gradient_clip_norm: 1.0
Score: 8707.05854011483

Trial 29 summary
Hyperparameters:
horizon: 1
lookback: 225
MarketFactor: True
lags: 20
gamma: 0.7
DQN_lr: 0.0001
memory_size: 256
batch_size: 32
gradient_clip_norm: 0.1
Score: 8638.331600821131

Trial 42 summary
Hyperparameters:
horizon: 1
lookback: 365
MarketFactor: False
lags: 8
gamma: 0.5
DQN_lr: 0.0001
memory_size: 64
batch_size: 16
gradient_clip_norm: 0.1
Score: 8551.24538636923

Trial 35 summary
Hyperparameters:
horizon: 1
lookback: 730
MarketFactor: False
lags: 14
gamma: 0.8
DQN_lr: 0.001
memory_size: 256
batch_size: 16
gradient_clip_norm: 0.5
Score: 8318.648328697951

Trial 06 summary
Hyperparameters:
horizon: 6
lookback: 225
MarketFactor: True
lags: 3
gamma: 0.5
DQN_lr: 0.0001
memory_size: 256
batch_size: 32
gradient_clip_norm: 10.0
Score: 6408.912017471113

Trial 55 summary
Hyperparameters:
horizon: 2
lookback: 365
MarketFactor: True
lags: 7
gamma: 0.9
DQN_lr: 1e-05
memory_size: 512
batch_size: 16
gradient_clip_norm: 5.0
Score: 6078.674107287357

Trial 26 summary
Hyperparameters:
horizon: 4
lookback: 730
MarketFactor: True
lags: 3
gamma: 0.8
DQN_lr: 0.001
memory_size: 256
batch_size: 32
gradient_clip_norm: 0.5
Score: 5817.023738005965

Trial 52 summary
Hyperparameters:
horizon: 7
lookback: 365
MarketFactor: True
lags: 3
gamma: 0.85
DQN_lr: 0.0001
memory_size: 512
batch_size: 16
gradient_clip_norm: 10.0
Score: 5601.730919777241

Trial 23 summary
Hyperparameters:
horizon: 4
lookback: 730
MarketFactor: True
lags: 3
gamma: 0.9
DQN_lr: 0.0005
memory_size: 2000
batch_size: 16
gradient_clip_norm: 1.0
Score: 5412.935476077635
None
Traceback (most recent call last):
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_KerasTuner.py", line 342, in <module>
    result_summary = result_summary_DataFrame(read_path, best_num=best_num, save_path=save_path)
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_KerasTuner.py", line 305, in result_summary_DataFrame
    sorted_trials = sorted(trials, key=lambda x: x['score'], reverse=True)
TypeError: '<' not supported between instances of 'NoneType' and 'float'
