<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4029 entries, 2017-08-17 00:00:00+00:00 to 2023-02-21 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4029 non-null   float64
 1   high        4029 non-null   float64
 2   low         4029 non-null   float64
 3   close       4029 non-null   float64
 4   volume      4029 non-null   float64
 5   amount      4029 non-null   float64
 6   num_trades  4029 non-null   int64  
 7   bid_volume  4029 non-null   float64
 8   bid_amount  4029 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.8 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  3995.000000     3995.000000  ...    3990.000000   3995.000000
mean      0.000427    19556.248858  ...   19622.229355  19603.051349
std       0.028524    16498.921043  ...   16534.439093  16532.968231
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009990     7388.269788  ...    7423.967529   7418.889893
50%       0.000792    10751.301465  ...   10920.140137  10915.540039
75%       0.012169    30390.989404  ...   30407.414551  30381.629883
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-02-21 08:00:00+08:00   -0.010902  ...  24572.830078
2023-02-21 20:00:00+08:00    0.002348  ...  24630.599609

[2 rows x 18 columns]
2023-06-01 22:03:53.251011: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-01 22:03:53.619076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5454 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6
2023-06-01 22:03:54.131689: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
  0%|          | 0/3612 [00:00<?, ?it/s]  2%|         | 64/3612 [00:00<00:05, 639.88it/s]  4%|         | 140/3612 [00:00<00:04, 708.57it/s]  6%|         | 220/3612 [00:00<00:04, 750.19it/s]  8%|         | 299/3612 [00:00<00:04, 762.00it/s] 10%|         | 376/3612 [00:00<00:04, 762.08it/s] 13%|        | 456/3612 [00:00<00:04, 773.07it/s] 15%|        | 534/3612 [00:00<00:04, 765.32it/s] 17%|        | 612/3612 [00:00<00:03, 769.88it/s] 19%|        | 692/3612 [00:00<00:03, 779.18it/s] 21%|       | 770/3612 [00:01<00:03, 776.90it/s] 24%|       | 849/3612 [00:01<00:03, 779.99it/s] 26%|       | 928/3612 [00:01<00:03, 766.73it/s] 28%|       | 1005/3612 [00:01<00:03, 762.52it/s] 30%|       | 1082/3612 [00:01<00:03, 757.81it/s] 32%|      | 1165/3612 [00:01<00:03, 776.83it/s] 34%|      | 1243/3612 [00:01<00:03, 770.87it/s] 37%|      | 1321/3612 [00:01<00:02, 764.48it/s] 39%|      | 1401/3612 [00:01<00:02, 773.94it/s] 41%|      | 1479/3612 [00:01<00:02, 768.53it/s] 43%|     | 1556/3612 [00:02<00:02, 766.68it/s] 45%|     | 1633/3612 [00:02<00:02, 763.08it/s] 47%|     | 1710/3612 [00:02<00:02, 758.35it/s] 50%|     | 1790/3612 [00:02<00:02, 770.61it/s] 52%|    | 1868/3612 [00:02<00:02, 771.08it/s] 54%|    | 1951/3612 [00:02<00:02, 788.51it/s] 56%|    | 2030/3612 [00:02<00:02, 786.36it/s] 58%|    | 2109/3612 [00:02<00:01, 775.86it/s] 61%|    | 2187/3612 [00:02<00:01, 770.20it/s] 63%|   | 2265/3612 [00:02<00:01, 770.68it/s] 65%|   | 2343/3612 [00:03<00:01, 768.82it/s] 67%|   | 2421/3612 [00:03<00:01, 772.09it/s] 69%|   | 2499/3612 [00:03<00:01, 771.70it/s] 71%|  | 2578/3612 [00:03<00:01, 777.09it/s] 74%|  | 2658/3612 [00:03<00:01, 782.99it/s] 76%|  | 2737/3612 [00:03<00:01, 775.23it/s] 78%|  | 2815/3612 [00:03<00:01, 776.60it/s] 80%|  | 2893/3612 [00:03<00:00, 777.57it/s] 82%| | 2973/3612 [00:03<00:00, 784.21it/s] 84%| | 3052/3612 [00:03<00:00, 780.09it/s] 87%| | 3131/3612 [00:04<00:00, 778.38it/s] 89%| | 3210/3612 [00:04<00:00, 779.45it/s] 91%| | 3288/3612 [00:04<00:00, 779.59it/s] 93%|| 3366/3612 [00:04<00:00, 770.48it/s] 95%|| 3444/3612 [00:04<00:00, 767.92it/s] 98%|| 3525/3612 [00:04<00:00, 778.02it/s]100%|| 3603/3612 [00:04<00:00, 767.17it/s]100%|| 3612/3612 [00:04<00:00, 770.25it/s]
  0%|          | 0/3612 [00:00<?, ?it/s]2023-06-01 22:04:02.082486: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
2023-06-01 22:04:03.437703: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
  0%|          | 1/3612 [00:03<3:09:12,  3.14s/it]  1%|          | 25/3612 [00:03<05:34, 10.73it/s]   1%|         | 46/3612 [00:03<02:39, 22.38it/s]  2%|         | 69/3612 [00:03<01:32, 38.31it/s]  3%|         | 91/3612 [00:03<01:02, 56.18it/s]  3%|         | 115/3612 [00:03<00:44, 78.92it/s]  4%|         | 139/3612 [00:03<00:33, 102.61it/s]  5%|         | 164/3612 [00:03<00:26, 128.54it/s]  5%|         | 188/3612 [00:03<00:22, 150.62it/s]  6%|         | 212/3612 [00:04<00:20, 168.63it/s]  7%|         | 236/3612 [00:04<00:18, 185.69it/s]  7%|         | 260/3612 [00:04<00:16, 199.24it/s]  8%|         | 286/3612 [00:04<00:15, 213.71it/s]  9%|         | 311/3612 [00:04<00:14, 221.82it/s]  9%|         | 336/3612 [00:04<00:14, 222.23it/s] 10%|         | 360/3612 [00:04<00:14, 224.38it/s] 11%|         | 384/3612 [00:04<00:14, 224.02it/s] 11%|        | 409/3612 [00:04<00:13, 230.71it/s] 12%|        | 433/3612 [00:04<00:13, 232.03it/s] 13%|        | 458/3612 [00:05<00:13, 237.15it/s] 13%|        | 484/3612 [00:05<00:12, 241.70it/s] 14%|        | 509/3612 [00:05<00:12, 243.39it/s] 15%|        | 535/3612 [00:05<00:12, 246.09it/s] 16%|        | 561/3612 [00:05<00:12, 246.28it/s] 16%|        | 587/3612 [00:05<00:12, 248.62it/s] 17%|        | 613/3612 [00:05<00:11, 250.26it/s] 18%|        | 639/3612 [00:05<00:11, 249.19it/s] 18%|        | 665/3612 [00:05<00:11, 250.14it/s] 19%|        | 691/3612 [00:06<00:11, 250.81it/s] 20%|        | 717/3612 [00:06<00:11, 252.44it/s] 21%|        | 744/3612 [00:06<00:11, 254.67it/s] 21%|       | 770/3612 [00:06<00:11, 249.62it/s] 22%|       | 796/3612 [00:06<00:11, 251.36it/s] 23%|       | 822/3612 [00:06<00:11, 250.90it/s] 23%|       | 848/3612 [00:06<00:10, 253.55it/s] 24%|       | 874/3612 [00:06<00:10, 251.73it/s] 25%|       | 900/3612 [00:06<00:10, 252.66it/s] 26%|       | 926/3612 [00:06<00:10, 252.57it/s] 26%|       | 952/3612 [00:07<00:10, 248.56it/s] 27%|       | 978/3612 [00:07<00:10, 251.48it/s] 28%|       | 1004/3612 [00:07<00:10, 253.96it/s] 29%|       | 1030/3612 [00:07<00:10, 254.23it/s] 29%|       | 1056/3612 [00:07<00:09, 255.81it/s] 30%|       | 1082/3612 [00:07<00:10, 250.35it/s] 31%|       | 1108/3612 [00:07<00:10, 249.51it/s] 31%|      | 1134/3612 [00:07<00:09, 250.37it/s] 32%|      | 1160/3612 [00:07<00:09, 250.97it/s] 33%|      | 1186/3612 [00:07<00:09, 251.36it/s] 34%|      | 1212/3612 [00:08<00:09, 253.13it/s] 34%|      | 1238/3612 [00:08<00:09, 251.81it/s] 35%|      | 1264/3612 [00:08<00:09, 249.13it/s] 36%|      | 1289/3612 [00:08<00:09, 249.01it/s] 36%|      | 1315/3612 [00:08<00:09, 250.76it/s] 37%|      | 1341/3612 [00:08<00:09, 250.81it/s] 38%|      | 1367/3612 [00:08<00:08, 252.83it/s] 39%|      | 1394/3612 [00:08<00:08, 255.29it/s] 39%|      | 1420/3612 [00:08<00:08, 253.67it/s] 40%|      | 1446/3612 [00:09<00:08, 254.03it/s] 41%|      | 1472/3612 [00:09<00:08, 255.01it/s] 42%|     | 1499/3612 [00:09<00:08, 257.08it/s] 42%|     | 1525/3612 [00:09<00:08, 257.16it/s] 43%|     | 1552/3612 [00:09<00:07, 258.60it/s] 44%|     | 1578/3612 [00:09<00:07, 257.48it/s] 44%|     | 1604/3612 [00:09<00:07, 258.20it/s] 45%|     | 1630/3612 [00:09<00:07, 257.91it/s] 46%|     | 1656/3612 [00:09<00:07, 257.74it/s] 47%|     | 1682/3612 [00:09<00:07, 257.56it/s] 47%|     | 1708/3612 [00:10<00:07, 252.86it/s] 48%|     | 1734/3612 [00:10<00:07, 253.38it/s] 49%|     | 1760/3612 [00:10<00:07, 250.16it/s] 49%|     | 1786/3612 [00:10<00:07, 241.79it/s] 50%|     | 1811/3612 [00:10<00:07, 244.12it/s] 51%|     | 1836/3612 [00:10<00:07, 240.24it/s] 52%|    | 1861/3612 [00:10<00:07, 237.57it/s] 52%|    | 1886/3612 [00:10<00:07, 240.43it/s] 53%|    | 1911/3612 [00:10<00:07, 237.68it/s] 54%|    | 1937/3612 [00:10<00:06, 242.10it/s] 54%|    | 1963/3612 [00:11<00:06, 243.81it/s] 55%|    | 1988/3612 [00:11<00:06, 241.39it/s] 56%|    | 2014/3612 [00:11<00:06, 245.27it/s] 56%|    | 2039/3612 [00:11<00:06, 245.90it/s] 57%|    | 2064/3612 [00:11<00:06, 242.43it/s] 58%|    | 2090/3612 [00:11<00:06, 246.19it/s] 59%|    | 2116/3612 [00:11<00:06, 249.33it/s] 59%|    | 2141/3612 [00:11<00:05, 248.05it/s] 60%|    | 2166/3612 [00:11<00:05, 242.77it/s] 61%|    | 2191/3612 [00:12<00:07, 179.52it/s] 61%|    | 2212/3612 [00:12<00:07, 180.31it/s] 62%|   | 2236/3612 [00:12<00:07, 194.34it/s] 63%|   | 2262/3612 [00:12<00:06, 209.73it/s] 63%|   | 2286/3612 [00:12<00:06, 215.51it/s] 64%|   | 2310/3612 [00:12<00:05, 221.62it/s] 65%|   | 2335/3612 [00:12<00:05, 228.94it/s] 65%|   | 2359/3612 [00:12<00:05, 227.45it/s] 66%|   | 2384/3612 [00:12<00:05, 231.89it/s] 67%|   | 2410/3612 [00:13<00:05, 237.86it/s] 67%|   | 2434/3612 [00:13<00:04, 236.40it/s] 68%|   | 2458/3612 [00:13<00:04, 235.38it/s] 69%|   | 2482/3612 [00:13<00:04, 234.66it/s] 69%|   | 2506/3612 [00:13<00:04, 234.16it/s] 70%|   | 2530/3612 [00:13<00:04, 233.80it/s] 71%|   | 2554/3612 [00:13<00:04, 235.60it/s] 71%|  | 2578/3612 [00:13<00:04, 236.89it/s] 72%|  | 2603/3612 [00:13<00:04, 240.37it/s] 73%|  | 2629/3612 [00:14<00:03, 246.19it/s] 73%|  | 2654/3612 [00:14<00:04, 238.09it/s] 74%|  | 2678/3612 [00:14<00:03, 234.84it/s] 75%|  | 2702/3612 [00:14<00:03, 234.61it/s] 75%|  | 2726/3612 [00:14<00:04, 197.48it/s] 76%|  | 2747/3612 [00:14<00:04, 178.01it/s] 77%|  | 2772/3612 [00:14<00:04, 194.30it/s] 77%|  | 2795/3612 [00:14<00:04, 202.90it/s] 78%|  | 2818/3612 [00:14<00:03, 209.68it/s] 79%|  | 2844/3612 [00:15<00:03, 222.39it/s] 79%|  | 2868/3612 [00:15<00:03, 225.41it/s] 80%|  | 2893/3612 [00:15<00:03, 231.11it/s] 81%|  | 2919/3612 [00:15<00:02, 238.06it/s] 82%| | 2944/3612 [00:15<00:02, 235.38it/s] 82%| | 2969/3612 [00:15<00:02, 238.16it/s] 83%| | 2995/3612 [00:15<00:02, 243.84it/s] 84%| | 3020/3612 [00:15<00:02, 245.62it/s] 84%| | 3046/3612 [00:15<00:02, 246.82it/s] 85%| | 3072/3612 [00:15<00:02, 249.94it/s] 86%| | 3098/3612 [00:16<00:02, 252.15it/s] 86%| | 3124/3612 [00:16<00:01, 252.97it/s] 87%| | 3151/3612 [00:16<00:01, 255.72it/s] 88%| | 3177/3612 [00:16<00:01, 253.96it/s] 89%| | 3203/3612 [00:16<00:01, 252.76it/s] 89%| | 3229/3612 [00:16<00:01, 251.91it/s] 90%| | 3255/3612 [00:16<00:01, 251.31it/s] 91%| | 3281/3612 [00:16<00:01, 250.90it/s] 92%|| 3307/3612 [00:16<00:01, 248.47it/s] 92%|| 3333/3612 [00:17<00:01, 249.58it/s] 93%|| 3358/3612 [00:17<00:01, 246.82it/s] 94%|| 3384/3612 [00:17<00:00, 248.47it/s] 94%|| 3409/3612 [00:17<00:00, 248.90it/s] 95%|| 3435/3612 [00:17<00:00, 250.68it/s] 96%|| 3461/3612 [00:17<00:00, 252.67it/s] 97%|| 3487/3612 [00:17<00:00, 248.94it/s] 97%|| 3513/3612 [00:17<00:00, 250.68it/s] 98%|| 3539/3612 [00:17<00:00, 250.47it/s] 99%|| 3565/3612 [00:17<00:00, 249.50it/s] 99%|| 3590/3612 [00:18<00:00, 249.63it/s]100%|| 3607/3612 [00:18<00:00, 199.20it/s]
AttributeError: 'float' object has no attribute 'exp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\Program Files\JetBrains\PyCharm Community Edition 2023.1.1\plugins\python-ce\helpers\pydev\pydevd.py", line 1496, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "D:\Program Files\JetBrains\PyCharm Community Edition 2023.1.1\plugins\python-ce\helpers\pydev\_pydev_imps\_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_Backtest.py", line 71, in <module>
    env_backtest_data ,cumsum_return = BacktestingVectorV2(Q,env,)
  File "L:\Python_WorkSpace\量化交易\FinanceRobot\FinanceRobot_Backtest_lib.py", line 607, in BacktestingVectorV2
    cum_return = np.exp(np.cumprod(strategy_return))
TypeError: loop of ufunc does not support argument 0 of type float which has no callable exp method
forrtl: error (200): program aborting due to control-C event
Image              PC                Routine            Line        Source             
libifcoremd.dll    00007FFABFC5DF54  Unknown               Unknown  Unknown
KERNELBASE.dll     00007FFB06D96717  Unknown               Unknown  Unknown
KERNEL32.DLL       00007FFB08BA26AD  Unknown               Unknown  Unknown
ntdll.dll          00007FFB093AA9F8  Unknown               Unknown  Unknown
