
Search: Running Trial #1

default configuration

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
2023-06-27 17:51:19.853236: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-27 17:51:20.695705: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5454 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6
2023-06-27 17:51:21.016892: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-06-27 17:51:23.675882: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
2023-06-27 17:51:24.764911: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
step_num: 200 | loss: 1.0253 | profit rate:    0.6 | accuracy: 0.36
step_num: 400 | loss: 0.9984 | profit rate:    0.5 | accuracy: 0.34
step_num: 600 | loss: 1.1920 | profit rate:    0.5 | accuracy: 0.33
step_num: 800 | loss: 0.2565 | profit rate:    0.4 | accuracy: 0.30
step_num: 1000 | loss: 0.9650 | profit rate:    0.3 | accuracy: 0.32
step_num: 1200 | loss: 0.7948 | profit rate:    0.2 | accuracy: 0.33
step_num: 1400 | loss: 0.4802 | profit rate:    0.1 | accuracy: 0.32
step_num: 1600 | loss: 0.4725 | profit rate:    0.2 | accuracy: 0.33
step_num: 1800 | loss: 0.4647 | profit rate:    0.3 | accuracy: 0.33
step_num: 2000 | loss: 0.4452 | profit rate:    0.5 | accuracy: 0.34
step_num: 2200 | loss: 0.5511 | profit rate:    0.2 | accuracy: 0.34
step_num: 2400 | loss: 0.3724 | profit rate:    0.3 | accuracy: 0.33
step_num: 2600 | loss: 0.3509 | profit rate:    0.2 | accuracy: 0.32
step_num: 2800 | loss: 0.4155 | profit rate:    0.3 | accuracy: 0.33
step_num: 3000 | loss: 0.5583 | profit rate:    0.1 | accuracy: 0.33
step_num: 3200 | loss: 0.2546 | profit rate:    0.1 | accuracy: 0.33
step_num: 3400 | loss: 0.4695 | profit rate:    0.2 | accuracy: 0.32
step_num: 3600 | loss: 0.4313 | profit rate:    0.1 | accuracy: 0.33
episode:   1/8,耗时:0.49分/0.49分,训练集: | step: 3677 | average_treward:  -20.5 | max_treward: 0.0000 | average profit rate:  0.100
step_num: 3800 | loss: 0.3349 | profit rate:    1.4 | accuracy: 0.17
step_num: 4000 | loss: 0.5963 | profit rate:    1.1 | accuracy: 0.35
step_num: 4200 | loss: 0.4507 | profit rate:    1.3 | accuracy: 0.34
step_num: 4400 | loss: 0.0967 | profit rate:    1.4 | accuracy: 0.33
step_num: 4600 | loss: 0.2853 | profit rate:    1.2 | accuracy: 0.32
step_num: 4800 | loss: 0.4611 | profit rate:    4.3 | accuracy: 0.33
step_num: 5000 | loss: 0.4606 | profit rate:    4.0 | accuracy: 0.34
step_num: 5200 | loss: 0.2634 | profit rate:    5.8 | accuracy: 0.34
step_num: 5400 | loss: 0.1344 | profit rate:    6.8 | accuracy: 0.33
step_num: 5600 | loss: 0.4716 | profit rate:    9.2 | accuracy: 0.34
step_num: 5800 | loss: 0.3408 | profit rate:    9.0 | accuracy: 0.35
step_num: 6000 | loss: 0.3700 | profit rate:   22.3 | accuracy: 0.35
step_num: 6200 | loss: 0.2926 | profit rate:   40.0 | accuracy: 0.35
step_num: 6400 | loss: 0.5221 | profit rate:   28.0 | accuracy: 0.35
step_num: 6600 | loss: 0.1929 | profit rate:   25.9 | accuracy: 0.35
step_num: 6800 | loss: 0.1790 | profit rate:   44.2 | accuracy: 0.35
step_num: 7000 | loss: 0.1527 | profit rate:   78.3 | accuracy: 0.34
step_num: 7200 | loss: 0.3941 | profit rate:  116.7 | accuracy: 0.34
model saved @ step:7354,performance:67.972,accuracy:0.34
step_num: 7400 | loss: 0.3816 | profit rate:    0.6 | accuracy: 0.19
step_num: 7600 | loss: 0.3791 | profit rate:    1.3 | accuracy: 0.34
step_num: 7800 | loss: 0.3813 | profit rate:    3.2 | accuracy: 0.35
step_num: 8000 | loss: 0.4039 | profit rate:    3.6 | accuracy: 0.35
step_num: 8200 | loss: 0.4658 | profit rate:    4.2 | accuracy: 0.33
step_num: 8400 | loss: 0.2064 | profit rate:    7.4 | accuracy: 0.33
step_num: 8600 | loss: 0.7026 | profit rate:    8.2 | accuracy: 0.34
step_num: 8800 | loss: 0.2734 | profit rate:   19.3 | accuracy: 0.35
step_num: 9000 | loss: 0.5211 | profit rate:   18.8 | accuracy: 0.35
step_num: 9200 | loss: 0.6001 | profit rate:   19.2 | accuracy: 0.34
step_num: 9400 | loss: 0.2970 | profit rate:   15.4 | accuracy: 0.35
step_num: 9600 | loss: 0.3594 | profit rate:   45.7 | accuracy: 0.35
step_num: 9800 | loss: 0.7602 | profit rate:   55.8 | accuracy: 0.36
step_num: 10000 | loss: 0.3919 | profit rate:  133.4 | accuracy: 0.36
step_num: 10200 | loss: 0.7342 | profit rate:  163.7 | accuracy: 0.36
step_num: 10400 | loss: 0.2417 | profit rate:  132.9 | accuracy: 0.36
step_num: 10600 | loss: 0.3756 | profit rate:  328.0 | accuracy: 0.35
step_num: 10800 | loss: 0.5101 | profit rate:  467.9 | accuracy: 0.35
step_num: 11000 | loss: 0.4105 | profit rate:  253.7 | accuracy: 0.35
episode:   3/8,耗时:0.46分/1.40分,训练集: | step: 11031 | average_treward:  150.5 | max_treward: 247.9363 | average profit rate: 111.691
model saved @ step:11031,performance:267.001,accuracy:0.35
step_num: 11200 | loss: 0.6151 | profit rate:    1.0 | accuracy: 0.28
step_num: 11400 | loss: 0.4412 | profit rate:    2.6 | accuracy: 0.34
step_num: 11600 | loss: 0.4064 | profit rate:    3.2 | accuracy: 0.31
step_num: 11800 | loss: 0.0669 | profit rate:    3.6 | accuracy: 0.30
step_num: 12000 | loss: 0.1261 | profit rate:    4.0 | accuracy: 0.28
step_num: 12200 | loss: 0.3730 | profit rate:    9.0 | accuracy: 0.29
step_num: 12400 | loss: 0.4978 | profit rate:    7.8 | accuracy: 0.30
step_num: 12600 | loss: 0.5549 | profit rate:   17.6 | accuracy: 0.30
step_num: 12800 | loss: 0.2513 | profit rate:   12.1 | accuracy: 0.29
step_num: 13000 | loss: 0.6519 | profit rate:   19.5 | accuracy: 0.31
step_num: 13200 | loss: 0.1673 | profit rate:   22.1 | accuracy: 0.30
step_num: 13400 | loss: 0.5754 | profit rate:   71.1 | accuracy: 0.31
step_num: 13600 | loss: 0.2496 | profit rate:   54.3 | accuracy: 0.31
step_num: 13800 | loss: 0.5149 | profit rate:   41.5 | accuracy: 0.31
step_num: 14000 | loss: 0.4727 | profit rate:   40.7 | accuracy: 0.32
step_num: 14200 | loss: 0.4979 | profit rate:   44.2 | accuracy: 0.31
step_num: 14400 | loss: 0.1985 | profit rate:  169.0 | accuracy: 0.32
step_num: 14600 | loss: 0.5166 | profit rate:  221.4 | accuracy: 0.32
model saved @ step:14708,performance:208.489,accuracy:0.33
step_num: 14800 | loss: 0.4429 | profit rate:    0.5 | accuracy: 0.26
step_num: 15000 | loss: 0.2338 | profit rate:    0.5 | accuracy: 0.33
step_num: 15200 | loss: 0.3306 | profit rate:    1.3 | accuracy: 0.36
step_num: 15400 | loss: 0.5529 | profit rate:    1.9 | accuracy: 0.37
step_num: 15600 | loss: 0.1953 | profit rate:    2.1 | accuracy: 0.35
step_num: 15800 | loss: 0.4465 | profit rate:    3.3 | accuracy: 0.33
step_num: 16000 | loss: 0.3448 | profit rate:    3.0 | accuracy: 0.33
step_num: 16200 | loss: 0.1631 | profit rate:    4.1 | accuracy: 0.33
step_num: 16400 | loss: 0.0042 | profit rate:    3.1 | accuracy: 0.32
step_num: 16600 | loss: 0.4806 | profit rate:    3.2 | accuracy: 0.33
step_num: 16800 | loss: 0.2047 | profit rate:    4.1 | accuracy: 0.33
step_num: 17000 | loss: 0.2461 | profit rate:   10.7 | accuracy: 0.33
step_num: 17200 | loss: 0.5718 | profit rate:   10.0 | accuracy: 0.34
step_num: 17400 | loss: 0.4768 | profit rate:   13.5 | accuracy: 0.34
step_num: 17600 | loss: 0.2581 | profit rate:    8.8 | accuracy: 0.34
step_num: 17800 | loss: 0.0464 | profit rate:   15.8 | accuracy: 0.34
step_num: 18000 | loss: 0.2820 | profit rate:   27.5 | accuracy: 0.33
step_num: 18200 | loss: 0.0883 | profit rate:   38.5 | accuracy: 0.33
episode:   5/8,耗时:0.47分/2.34分,训练集: | step: 18385 | average_treward:  194.0 | max_treward: 271.6994 | average profit rate: 114.198
step_num: 18400 | loss: 0.4611 | profit rate:    0.9 | accuracy: 0.25
step_num: 18600 | loss: 0.6431 | profit rate:    0.8 | accuracy: 0.31
step_num: 18800 | loss: 0.3185 | profit rate:    2.5 | accuracy: 0.36
step_num: 19000 | loss: 0.3225 | profit rate:    2.8 | accuracy: 0.35
step_num: 19200 | loss: 0.5184 | profit rate:    3.6 | accuracy: 0.36
step_num: 19400 | loss: 0.3051 | profit rate:    4.4 | accuracy: 0.33
step_num: 19600 | loss: 0.4278 | profit rate:    6.3 | accuracy: 0.34
step_num: 19800 | loss: 0.4740 | profit rate:    7.3 | accuracy: 0.35
step_num: 20000 | loss: 0.4212 | profit rate:   10.1 | accuracy: 0.35
step_num: 20200 | loss: 0.2574 | profit rate:   11.4 | accuracy: 0.34
step_num: 20400 | loss: 0.3281 | profit rate:    9.5 | accuracy: 0.34
step_num: 20600 | loss: 0.2365 | profit rate:   23.8 | accuracy: 0.34
step_num: 20800 | loss: 0.4284 | profit rate:   44.6 | accuracy: 0.35
step_num: 21000 | loss: 0.5153 | profit rate:   24.6 | accuracy: 0.35
step_num: 21200 | loss: 0.5596 | profit rate:   20.1 | accuracy: 0.35
step_num: 21400 | loss: 0.5150 | profit rate:   20.6 | accuracy: 0.35
step_num: 21600 | loss: 0.3603 | profit rate:   70.3 | accuracy: 0.35
step_num: 21800 | loss: 0.5049 | profit rate:  174.5 | accuracy: 0.35
step_num: 22000 | loss: 0.5089 | profit rate:  144.0 | accuracy: 0.36
model saved @ step:22062,performance:157.237,accuracy:0.36
step_num: 22200 | loss: 0.3061 | profit rate:    0.8 | accuracy: 0.33
step_num: 22400 | loss: 0.6285 | profit rate:    1.1 | accuracy: 0.39
step_num: 22600 | loss: 0.5133 | profit rate:    3.0 | accuracy: 0.40
step_num: 22800 | loss: 0.3531 | profit rate:    3.5 | accuracy: 0.40
step_num: 23000 | loss: 0.0207 | profit rate:    3.9 | accuracy: 0.36
step_num: 23200 | loss: 0.5352 | profit rate:    9.8 | accuracy: 0.36
step_num: 23400 | loss: 0.5074 | profit rate:    6.7 | accuracy: 0.36
step_num: 23600 | loss: 0.1260 | profit rate:   11.1 | accuracy: 0.36
step_num: 23800 | loss: 0.2989 | profit rate:    7.7 | accuracy: 0.35
step_num: 24000 | loss: 0.2458 | profit rate:   11.6 | accuracy: 0.37
step_num: 24200 | loss: 0.2698 | profit rate:   13.3 | accuracy: 0.36
step_num: 24400 | loss: 0.5272 | profit rate:   27.7 | accuracy: 0.36
step_num: 24600 | loss: 0.4296 | profit rate:   23.8 | accuracy: 0.37
step_num: 24800 | loss: 0.4481 | profit rate:   24.0 | accuracy: 0.36
step_num: 25000 | loss: 0.2842 | profit rate:   21.5 | accuracy: 0.37
step_num: 25200 | loss: 0.1980 | profit rate:   36.3 | accuracy: 0.36
step_num: 25400 | loss: 0.3312 | profit rate:  140.1 | accuracy: 0.37
step_num: 25600 | loss: 0.5217 | profit rate:  189.3 | accuracy: 0.37
episode:   7/8,耗时:0.47分/3.28分,训练集: | step: 25739 | average_treward:  224.8 | max_treward: 304.6874 | average profit rate: 123.950
model saved @ step:25739,performance:139.419,accuracy:0.37
step_num: 25800 | loss: 0.5897 | profit rate:    0.9 | accuracy: 0.37
step_num: 26000 | loss: 0.2943 | profit rate:    1.1 | accuracy: 0.38
step_num: 26200 | loss: 0.1781 | profit rate:    2.5 | accuracy: 0.36
step_num: 26400 | loss: 0.5281 | profit rate:    2.4 | accuracy: 0.35
step_num: 26600 | loss: 0.2213 | profit rate:    2.5 | accuracy: 0.33
step_num: 26800 | loss: 0.5248 | profit rate:    5.5 | accuracy: 0.34
step_num: 27000 | loss: 0.6104 | profit rate:    5.4 | accuracy: 0.36
step_num: 27200 | loss: 0.0667 | profit rate:    4.5 | accuracy: 0.35
step_num: 27400 | loss: 0.3744 | profit rate:    3.3 | accuracy: 0.34
step_num: 27600 | loss: 0.5946 | profit rate:    3.7 | accuracy: 0.34
step_num: 27800 | loss: 0.1207 | profit rate:    2.9 | accuracy: 0.34
step_num: 28000 | loss: 0.4545 | profit rate:    3.5 | accuracy: 0.33
step_num: 28200 | loss: 0.7837 | profit rate:    7.2 | accuracy: 0.34
step_num: 28400 | loss: 0.1900 | profit rate:    7.1 | accuracy: 0.34
step_num: 28600 | loss: 0.7244 | profit rate:    7.3 | accuracy: 0.35
step_num: 28800 | loss: 0.2927 | profit rate:   10.0 | accuracy: 0.34
step_num: 29000 | loss: 0.1832 | profit rate:   22.4 | accuracy: 0.34
step_num: 29200 | loss: 0.3305 | profit rate:   26.9 | accuracy: 0.34
step_num: 29400 | loss: 0.2475 | profit rate:   22.3 | accuracy: 0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/314 [00:00<?, ?it/s] 34%|      | 107/314 [00:00<00:00, 1069.92it/s] 69%|   | 217/314 [00:00<00:00, 1087.58it/s]100%|| 314/314 [00:00<00:00, 1115.40it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-14T12:00:00 | *** GOING LONG ***
2023-01-14T12:00:00's price 20954.9199, buy 0.04767376 units.
2023-01-14T12:00:00 | current balance = 0.00
2023-01-14T12:00:00 | balance:0.00+units:0.04767376*price:20954.9199=net_wealth:999.0010
--------------------------------------------------
2023-02-11T12:00:00 | *** GOING SHORT ***
2023-02-11T12:00:00's price 21862.5508, sell 0.04767376 units.
2023-02-11T12:00:00 | current balance = 1041.23
2023-02-11T12:00:00 | balance:1041.23+units:0.0*price:21862.5508=net_wealth:1041.2289
--------------------------------------------------
2023-02-12T00:00:00 | *** GOING LONG ***
2023-02-12T00:00:00's price 21888.3105, buy 0.04752252 units.
2023-02-12T00:00:00 | current balance = 0.00
2023-02-12T00:00:00 | balance:0.00+units:0.04752252*price:21888.3105=net_wealth:1040.1887
--------------------------------------------------
2023-02-15T00:00:00 | *** GOING SHORT ***
2023-02-15T00:00:00's price 22445.1309, sell 0.04752252 units.
2023-02-15T00:00:00 | current balance = 1065.58
2023-02-15T00:00:00 | balance:1065.58+units:0.0*price:22445.1309=net_wealth:1065.5836
--------------------------------------------------
2023-02-16T12:00:00 | *** GOING LONG ***
2023-02-16T12:00:00's price 23517.7207, buy 0.0452645 units.
2023-02-16T12:00:00 | current balance = 0.00
2023-02-16T12:00:00 | balance:0.00+units:0.0452645*price:23517.7207=net_wealth:1064.5191
--------------------------------------------------
2023-03-05T00:00:00 | *** GOING SHORT ***
2023-03-05T00:00:00's price 22389.7695, sell 0.0452645 units.
2023-03-05T00:00:00 | current balance = 1012.45
2023-03-05T00:00:00 | balance:1012.45+units:0.0*price:22389.7695=net_wealth:1012.4494
--------------------------------------------------
2023-03-05T12:00:00 | *** GOING LONG ***
2023-03-05T12:00:00's price 22430.2402, buy 0.045092560000000004 units.
2023-03-05T12:00:00 | current balance = 0.00
2023-03-05T12:00:00 | balance:0.00+units:0.045092560000000004*price:22430.2402=net_wealth:1011.4380
--------------------------------------------------
2023-03-11T00:00:00 | *** GOING SHORT ***
2023-03-11T00:00:00's price 20086.0703, sell 0.045092560000000004 units.
2023-03-11T00:00:00 | current balance = 904.83
2023-03-11T00:00:00 | balance:904.83+units:0.0*price:20086.0703=net_wealth:904.8277
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING LONG ***
2023-03-13T12:00:00's price 24113.4805, buy 0.037486200000000004 units.
2023-03-13T12:00:00 | current balance = 0.00
2023-03-13T12:00:00 | balance:0.00+units:0.037486200000000004*price:24113.4805=net_wealth:903.9237
--------------------------------------------------
2023-04-22T12:00:00 | *** GOING SHORT ***
2023-04-22T12:00:00's price 27816.8496, sell 0.037486200000000004 units.
2023-04-22T12:00:00 | current balance = 1041.71
2023-04-22T12:00:00 | balance:1041.71+units:0.0*price:27816.8496=net_wealth:1041.7062
--------------------------------------------------
2023-04-23T00:00:00 | *** GOING LONG ***
2023-04-23T00:00:00's price 27642.9004, buy 0.03764671 units.
2023-04-23T00:00:00 | current balance = 0.00
2023-04-23T00:00:00 | balance:0.00+units:0.03764671*price:27642.9004=net_wealth:1040.6656
--------------------------------------------------
2023-04-26T00:00:00 | *** GOING SHORT ***
2023-04-26T00:00:00's price 28952.3203, sell 0.03764671 units.
2023-04-26T00:00:00 | current balance = 1088.87
2023-04-26T00:00:00 | balance:1088.87+units:0.0*price:28952.3203=net_wealth:1088.8709
--------------------------------------------------
2023-04-26T12:00:00 | *** GOING LONG ***
2023-04-26T12:00:00's price 28415.2891, buy 0.03828157 units.
2023-04-26T12:00:00 | current balance = 0.00
2023-04-26T12:00:00 | balance:0.00+units:0.03828157*price:28415.2891=net_wealth:1087.7832
--------------------------------------------------
2023-05-12T12:00:00 | *** GOING SHORT ***
2023-05-12T12:00:00's price 26795.0098, sell 0.03828157 units.
2023-05-12T12:00:00 | current balance = 1024.73
2023-05-12T12:00:00 | balance:1024.73+units:0.0*price:26795.0098=net_wealth:1024.7306
--------------------------------------------------
2023-05-13T12:00:00 | *** GOING LONG ***
2023-05-13T12:00:00's price 26775.2793, buy 0.03823324 units.
2023-05-13T12:00:00 | current balance = 0.00
2023-05-13T12:00:00 | balance:0.00+units:0.03823324*price:26775.2793=net_wealth:1023.7069
--------------------------------------------------
2023-05-15T00:00:00 | *** GOING SHORT ***
2023-05-15T00:00:00's price 27336.1191, sell 0.03823324 units.
2023-05-15T00:00:00 | current balance = 1044.10
2023-05-15T00:00:00 | balance:1044.10+units:0.0*price:27336.1191=net_wealth:1044.1044
--------------------------------------------------
2023-05-15T12:00:00 | *** GOING LONG ***
2023-05-15T12:00:00's price 27162.1406, buy 0.03840125 units.
2023-05-15T12:00:00 | current balance = 0.00
2023-05-15T12:00:00 | balance:0.00+units:0.03840125*price:27162.1406=net_wealth:1043.0614
--------------------------------------------------
2023-05-17T12:00:00 | *** GOING SHORT ***
2023-05-17T12:00:00's price 27405.6094, sell 0.03840125 units.
2023-05-17T12:00:00 | current balance = 1051.36
2023-05-17T12:00:00 | balance:1051.36+units:0.0*price:27405.6094=net_wealth:1051.3585
--------------------------------------------------
2023-05-18T12:00:00 | *** GOING LONG ***
2023-05-18T12:00:00's price 26821.2793, buy 0.03915947 units.
2023-05-18T12:00:00 | current balance = 0.00
2023-05-18T12:00:00 | balance:0.00+units:0.03915947*price:26821.2793=net_wealth:1050.3082
--------------------------------------------------
2023-05-20T12:00:00 | *** GOING SHORT ***
2023-05-20T12:00:00's price 27102.4297, sell 0.03915947 units.
2023-05-20T12:00:00 | current balance = 1060.26
2023-05-20T12:00:00 | balance:1060.26+units:0.0*price:27102.4297=net_wealth:1060.2566
--------------------------------------------------
2023-05-21T00:00:00 | *** GOING LONG ***
2023-05-21T00:00:00's price 26829.9395, buy 0.03947814 units.
2023-05-21T00:00:00 | current balance = 0.00
2023-05-21T00:00:00 | balance:0.00+units:0.03947814*price:26829.9395=net_wealth:1059.1974
--------------------------------------------------
2023-05-22T12:00:00 | *** GOING SHORT ***
2023-05-22T12:00:00's price 26849.2695, sell 0.03947814 units.
2023-05-22T12:00:00 | current balance = 1058.90
2023-05-22T12:00:00 | balance:1058.90+units:0.0*price:26849.2695=net_wealth:1058.9005
--------------------------------------------------
2023-05-24T00:00:00 | *** GOING LONG ***
2023-05-24T00:00:00's price 26742.2402, buy 0.03955695 units.
2023-05-24T00:00:00 | current balance = 0.00
2023-05-24T00:00:00 | balance:0.00+units:0.03955695*price:26742.2402=net_wealth:1057.8427
--------------------------------------------------
2023-05-26T00:00:00 | *** GOING SHORT ***
2023-05-26T00:00:00's price 26463.2891, sell 0.03955695 units.
2023-05-26T00:00:00 | current balance = 1045.76
2023-05-26T00:00:00 | balance:1045.76+units:0.0*price:26463.2891=net_wealth:1045.7614
--------------------------------------------------
2023-05-29T12:00:00 | *** GOING LONG ***
2023-05-29T12:00:00's price 27736.4004, buy 0.037665870000000004 units.
2023-05-29T12:00:00 | current balance = 0.00
2023-05-29T12:00:00 | balance:0.00+units:0.037665870000000004*price:27736.4004=net_wealth:1044.7167
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.037665870000000004 units.
2023-06-08T12:00:00 | current balance = 1000.90
2023-06-08T12:00:00 | net performance [%] = 0.0903
2023-06-08T12:00:00 | number of trades [#] = 26
==================================================
Trial 1 Complete [00h 03m 49s]
net_wealth: 1001.9052426926945

Best net_wealth So Far: 1001.9052426926945
Total elapsed time: 00h 03m 49s

Search: Running Trial #2

Value             |Best Value So Far |Hyperparameter
8                 |2                 |horizon
365               |225               |lookback
True              |False             |MarketFactor
20                |5                 |lags
0.92              |0.5               |gamma
64                |32                |memory_size
16                |16                |batch_size
256               |5                 |n_steps
0.96              |0.96              |gae_lambda
5                 |0.2               |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4201.000000   4209.000000
mean      0.000424    19921.326125  ...   20001.002399  19971.309209
std       0.028069    16159.303521  ...   16195.567078  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7652.140137   7625.000000
50%       0.000696    11410.370947  ...   11503.139648  11477.000000
75%       0.011720    29502.909082  ...   29409.009766  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 0.4881 | profit rate:    0.5 | accuracy: 0.26
step_num: 400 | loss: 0.7670 | profit rate:    0.4 | accuracy: 0.30
step_num: 600 | loss: 0.6025 | profit rate:    1.8 | accuracy: 0.32
step_num: 800 | loss: 0.6225 | profit rate:    0.9 | accuracy: 0.30
step_num: 1000 | loss: 1.0281 | profit rate:    1.8 | accuracy: 0.32
step_num: 1200 | loss: 0.5820 | profit rate:    0.5 | accuracy: 0.32
step_num: 1400 | loss: 0.6256 | profit rate:    0.4 | accuracy: 0.32
step_num: 1600 | loss: 0.7876 | profit rate:    1.6 | accuracy: 0.33
step_num: 1800 | loss: 0.3168 | profit rate:    2.3 | accuracy: 0.32
step_num: 2000 | loss: 1.1947 | profit rate:   22.9 | accuracy: 0.32
step_num: 2200 | loss: 0.3990 | profit rate:  206.3 | accuracy: 0.32
step_num: 2400 | loss: 0.7782 | profit rate:   25.0 | accuracy: 0.31
step_num: 2600 | loss: 0.8579 | profit rate:  435.1 | accuracy: 0.33
step_num: 2800 | loss: 0.6042 | profit rate:  267.7 | accuracy: 0.33
step_num: 3000 | loss: 0.7343 | profit rate:  155.8 | accuracy: 0.34
step_num: 3200 | loss: 0.5081 | profit rate:    0.8 | accuracy: 0.33
step_num: 3400 | loss: 0.8382 | profit rate:    5.5 | accuracy: 0.33
episode:   1/8,耗时:0.49分/0.49分,训练集: | step: 3508 | average_treward:   35.8 | max_treward: 35.7756 | average profit rate:  7.065
model saved @ step:3508,performance:7.065,accuracy:0.33
step_num: 3600 | loss: 0.2713 | profit rate:    0.6 | accuracy: 0.12
step_num: 3800 | loss: 0.3299 | profit rate:    1.3 | accuracy: 0.14
step_num: 4000 | loss: 0.1799 | profit rate:    2.5 | accuracy: 0.13
step_num: 4200 | loss: 0.3293 | profit rate:    0.4 | accuracy: 0.13
step_num: 4400 | loss: 0.7547 | profit rate:    0.0 | accuracy: 0.16
step_num: 4600 | loss: 0.0448 | profit rate:    0.0 | accuracy: 0.15
step_num: 4800 | loss: 0.0168 | profit rate:    0.0 | accuracy: 0.13
step_num: 5000 | loss: 0.5548 | profit rate:    0.0 | accuracy: 0.13
step_num: 5200 | loss: 0.2509 | profit rate:    0.1 | accuracy: 0.15
step_num: 5400 | loss: 0.2013 | profit rate:    0.2 | accuracy: 0.16
step_num: 5600 | loss: 1.6530 | profit rate:    0.1 | accuracy: 0.18
step_num: 5800 | loss: 0.0641 | profit rate:    0.3 | accuracy: 0.19
step_num: 6000 | loss: 0.1801 | profit rate:    0.5 | accuracy: 0.18
step_num: 6200 | loss: 0.2528 | profit rate:    0.9 | accuracy: 0.18
step_num: 6400 | loss: 0.4502 | profit rate:    0.7 | accuracy: 0.17
step_num: 6600 | loss: 0.2753 | profit rate:    1.1 | accuracy: 0.18
step_num: 6800 | loss: 0.1600 | profit rate:    0.1 | accuracy: 0.18
step_num: 7000 | loss: 0.0344 | profit rate:    0.0 | accuracy: 0.17
step_num: 7200 | loss: 0.0330 | profit rate:    1.3 | accuracy: 0.03
step_num: 7400 | loss: 0.0339 | profit rate:    1.2 | accuracy: 0.05
step_num: 7600 | loss: 0.3706 | profit rate:    0.3 | accuracy: 0.05
step_num: 7800 | loss: 0.2189 | profit rate:    0.3 | accuracy: 0.05
step_num: 8000 | loss: 0.9690 | profit rate:   16.7 | accuracy: 0.15
step_num: 8200 | loss: 0.0821 | profit rate:    5.2 | accuracy: 0.14
step_num: 8400 | loss: 0.0494 | profit rate:    4.6 | accuracy: 0.13
step_num: 8600 | loss: 0.4925 | profit rate:   11.8 | accuracy: 0.14
step_num: 8800 | loss: 0.5417 | profit rate:   49.5 | accuracy: 0.16
step_num: 9000 | loss: 0.5761 | profit rate:  864.7 | accuracy: 0.19
step_num: 9200 | loss: 0.6365 | profit rate: 126431.3 | accuracy: 0.22
step_num: 9400 | loss: 0.0201 | profit rate: 16014.9 | accuracy: 0.22
step_num: 9600 | loss: 0.5695 | profit rate: 46247.7 | accuracy: 0.23
step_num: 9800 | loss: 0.2237 | profit rate: 60376.8 | accuracy: 0.23
step_num: 10000 | loss: 0.3996 | profit rate: 65000.7 | accuracy: 0.24
step_num: 10200 | loss: 0.7020 | profit rate: 8386.7 | accuracy: 0.23
step_num: 10400 | loss: 0.4643 | profit rate: 9951.0 | accuracy: 0.23
episode:   3/8,耗时:0.53分/1.55分,训练集: | step: 10524 | average_treward:   73.2 | max_treward: 206.1533 | average profit rate: 16851.370
model saved @ step:10524,performance:50546.998,accuracy:0.23
step_num: 10600 | loss: 0.4110 | profit rate:    1.0 | accuracy: 0.19
step_num: 10800 | loss: 0.1137 | profit rate:    1.5 | accuracy: 0.17
step_num: 11000 | loss: 0.2125 | profit rate:    3.0 | accuracy: 0.14
step_num: 11200 | loss: 0.0979 | profit rate:    3.5 | accuracy: 0.12
step_num: 11400 | loss: 0.7098 | profit rate:    0.1 | accuracy: 0.16
step_num: 11600 | loss: 0.3609 | profit rate:    0.6 | accuracy: 0.19
step_num: 11800 | loss: 0.0135 | profit rate:    0.3 | accuracy: 0.16
step_num: 12000 | loss: 0.4943 | profit rate:    3.3 | accuracy: 0.17
step_num: 12200 | loss: 0.1816 | profit rate:    3.5 | accuracy: 0.18
step_num: 12400 | loss: 0.2334 | profit rate:    9.1 | accuracy: 0.19
step_num: 12600 | loss: 0.9690 | profit rate:  162.6 | accuracy: 0.21
step_num: 12800 | loss: 0.1504 | profit rate:  338.7 | accuracy: 0.22
step_num: 13000 | loss: 0.2661 | profit rate:  220.9 | accuracy: 0.21
step_num: 13200 | loss: 0.5285 | profit rate:  628.6 | accuracy: 0.21
step_num: 13400 | loss: 0.3923 | profit rate:  878.6 | accuracy: 0.20
step_num: 13600 | loss: 0.1480 | profit rate: 1193.0 | accuracy: 0.20
step_num: 13800 | loss: 0.5064 | profit rate:  869.0 | accuracy: 0.20
step_num: 14000 | loss: 0.0285 | profit rate: 4465.9 | accuracy: 0.20
step_num: 14200 | loss: 0.0671 | profit rate:    2.3 | accuracy: 0.21
step_num: 14400 | loss: 0.2093 | profit rate:    1.3 | accuracy: 0.14
step_num: 14600 | loss: 0.0331 | profit rate:    1.1 | accuracy: 0.10
step_num: 14800 | loss: 0.0281 | profit rate:    0.9 | accuracy: 0.10
step_num: 15000 | loss: 0.8551 | profit rate:    7.0 | accuracy: 0.13
step_num: 15200 | loss: 0.1948 | profit rate:    5.8 | accuracy: 0.12
step_num: 15400 | loss: 0.0109 | profit rate:    5.8 | accuracy: 0.10
step_num: 15600 | loss: 0.0351 | profit rate:    5.0 | accuracy: 0.09
step_num: 15800 | loss: 0.0852 | profit rate:    7.6 | accuracy: 0.09
step_num: 16000 | loss: 0.5546 | profit rate:    1.8 | accuracy: 0.09
step_num: 16200 | loss: 0.5955 | profit rate:  107.1 | accuracy: 0.12
step_num: 16400 | loss: 0.1442 | profit rate:   89.8 | accuracy: 0.12
step_num: 16600 | loss: 0.1578 | profit rate:  143.4 | accuracy: 0.12
step_num: 16800 | loss: 0.0518 | profit rate:  233.3 | accuracy: 0.13
step_num: 17000 | loss: 0.7509 | profit rate:  228.7 | accuracy: 0.14
step_num: 17200 | loss: 0.2097 | profit rate:   96.6 | accuracy: 0.13
step_num: 17400 | loss: 0.6639 | profit rate:  233.9 | accuracy: 0.15
episode:   5/8,耗时:0.53分/2.63分,训练集: | step: 17540 | average_treward:   96.3 | max_treward: 206.1533 | average profit rate: 11068.783
step_num: 17600 | loss: 0.6251 | profit rate:    1.2 | accuracy: 0.33
step_num: 17800 | loss: 0.1679 | profit rate:    1.4 | accuracy: 0.17
step_num: 18000 | loss: 0.2760 | profit rate:    1.6 | accuracy: 0.12
step_num: 18200 | loss: 0.1911 | profit rate:    0.9 | accuracy: 0.10
step_num: 18400 | loss: 0.3964 | profit rate:    3.3 | accuracy: 0.12
step_num: 18600 | loss: 0.2461 | profit rate:    3.7 | accuracy: 0.12
step_num: 18800 | loss: 0.2110 | profit rate:    3.2 | accuracy: 0.11
step_num: 19000 | loss: 0.0198 | profit rate:    3.0 | accuracy: 0.10
step_num: 19200 | loss: 0.0741 | profit rate:    6.9 | accuracy: 0.11
step_num: 19400 | loss: 0.1257 | profit rate:    7.7 | accuracy: 0.10
step_num: 19600 | loss: 0.6022 | profit rate:  217.6 | accuracy: 0.13
step_num: 19800 | loss: 0.0828 | profit rate:  900.3 | accuracy: 0.13
step_num: 20000 | loss: 0.0110 | profit rate:  538.2 | accuracy: 0.13
step_num: 20200 | loss: 0.4199 | profit rate: 2245.7 | accuracy: 0.14
step_num: 20400 | loss: 0.3364 | profit rate: 2843.8 | accuracy: 0.13
step_num: 20600 | loss: 0.5185 | profit rate: 5358.5 | accuracy: 0.14
step_num: 20800 | loss: 0.4002 | profit rate: 2368.5 | accuracy: 0.15
step_num: 21000 | loss: 0.2191 | profit rate: 8895.8 | accuracy: 0.16
step_num: 21200 | loss: 0.3482 | profit rate:    1.4 | accuracy: 0.25
step_num: 21400 | loss: 0.2903 | profit rate:    1.4 | accuracy: 0.18
step_num: 21600 | loss: 0.0578 | profit rate:    1.1 | accuracy: 0.13
step_num: 21800 | loss: 0.1726 | profit rate:    0.9 | accuracy: 0.14
step_num: 22000 | loss: 0.6030 | profit rate:   10.3 | accuracy: 0.18
step_num: 22200 | loss: 0.0478 | profit rate:   11.0 | accuracy: 0.17
step_num: 22400 | loss: 0.2804 | profit rate:   11.8 | accuracy: 0.17
step_num: 22600 | loss: 0.2480 | profit rate:  578.3 | accuracy: 0.19
step_num: 22800 | loss: 0.4836 | profit rate: 4804.4 | accuracy: 0.21
step_num: 23000 | loss: 0.5534 | profit rate: 11471.8 | accuracy: 0.23
step_num: 23200 | loss: 0.8294 | profit rate: 1062056.4 | accuracy: 0.25
step_num: 23400 | loss: 0.3544 | profit rate: 432479.5 | accuracy: 0.24
step_num: 23600 | loss: 0.6007 | profit rate: 518353.3 | accuracy: 0.25
step_num: 23800 | loss: 0.0200 | profit rate: 1532279.2 | accuracy: 0.24
step_num: 24000 | loss: 0.5383 | profit rate: 883148.5 | accuracy: 0.24
step_num: 24200 | loss: 0.2851 | profit rate: 349997.2 | accuracy: 0.23
step_num: 24400 | loss: 0.3434 | profit rate: 723187.3 | accuracy: 0.24
episode:   7/8,耗时:0.54分/3.70分,训练集: | step: 24556 | average_treward:  137.4 | max_treward: 295.6310 | average profit rate: 247237.784
model saved @ step:24556,performance:1666424.729,accuracy:0.24
step_num: 24600 | loss: 0.4805 | profit rate:    4.4 | accuracy: 0.56
step_num: 24800 | loss: 0.3058 | profit rate:    0.8 | accuracy: 0.23
step_num: 25000 | loss: 0.0761 | profit rate:    1.4 | accuracy: 0.16
step_num: 25200 | loss: 0.0219 | profit rate:    0.9 | accuracy: 0.13
step_num: 25400 | loss: 0.0199 | profit rate:    0.7 | accuracy: 0.11
step_num: 25600 | loss: 0.0408 | profit rate:    0.2 | accuracy: 0.10
step_num: 25800 | loss: 0.0173 | profit rate:    0.2 | accuracy: 0.09
step_num: 26000 | loss: 0.1127 | profit rate:    0.2 | accuracy: 0.08
step_num: 26200 | loss: 0.0697 | profit rate:    0.2 | accuracy: 0.08
step_num: 26400 | loss: 0.0060 | profit rate:    0.3 | accuracy: 0.08
step_num: 26600 | loss: 0.2160 | profit rate:    1.0 | accuracy: 0.09
step_num: 26800 | loss: 0.3955 | profit rate:   60.7 | accuracy: 0.11
step_num: 27000 | loss: 0.0693 | profit rate:   24.0 | accuracy: 0.11
step_num: 27200 | loss: 0.4186 | profit rate:  203.7 | accuracy: 0.12
step_num: 27400 | loss: 0.0669 | profit rate:  225.8 | accuracy: 0.11
step_num: 27600 | loss: 0.1236 | profit rate:  285.8 | accuracy: 0.12
step_num: 27800 | loss: 0.7909 | profit rate:  261.1 | accuracy: 0.13
step_num: 28000 | loss: 0.1979 | profit rate:  977.2 | accuracy: 0.14
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 38%|      | 115/299 [00:00<00:00, 1150.00it/s] 80%|  | 239/299 [00:00<00:00, 1202.17it/s]100%|| 299/299 [00:00<00:00, 1200.28it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-13T00:00:00 | *** GOING LONG ***
2023-01-13T00:00:00's price 18920.9492, buy 0.05279861 units.
2023-01-13T00:00:00 | current balance = 0.00
2023-01-13T00:00:00 | balance:0.00+units:0.05279861*price:18920.9492=net_wealth:999.0010
--------------------------------------------------
2023-02-15T12:00:00 | *** GOING SHORT ***
2023-02-15T12:00:00's price 24324.0508, sell 0.05279861 units.
2023-02-15T12:00:00 | current balance = 1282.99
2023-02-15T12:00:00 | balance:1282.99+units:0.0*price:24324.0508=net_wealth:1282.9930
--------------------------------------------------
2023-02-20T12:00:00 | *** GOING LONG ***
2023-02-20T12:00:00's price 24842.1992, buy 0.051594060000000004 units.
2023-02-20T12:00:00 | current balance = 0.00
2023-02-20T12:00:00 | balance:0.00+units:0.051594060000000004*price:24842.1992=net_wealth:1281.7113
--------------------------------------------------
2023-03-01T00:00:00 | *** GOING SHORT ***
2023-03-01T00:00:00's price 23739.1699, sell 0.051594060000000004 units.
2023-03-01T00:00:00 | current balance = 1223.58
2023-03-01T00:00:00 | balance:1223.58+units:0.0*price:23739.1699=net_wealth:1223.5767
--------------------------------------------------
2023-03-17T12:00:00 | *** GOING LONG ***
2023-03-17T12:00:00's price 27395.1309, buy 0.04461935 units.
2023-03-17T12:00:00 | current balance = 0.00
2023-03-17T12:00:00 | balance:0.00+units:0.04461935*price:27395.1309=net_wealth:1222.3544
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.04461935 units.
2023-06-08T12:00:00 | current balance = 1185.68
2023-06-08T12:00:00 | net performance [%] = 18.5680
2023-06-08T12:00:00 | number of trades [#] = 6
==================================================
Trial 2 Complete [00h 04m 17s]
net_wealth: 1186.8667195638236

Best net_wealth So Far: 1186.8667195638236
Total elapsed time: 00h 08m 07s

Search: Running Trial #3

Value             |Best Value So Far |Hyperparameter
2                 |8                 |horizon
225               |365               |lookback
False             |True              |MarketFactor
30                |20                |lags
0.6               |0.92              |gamma
256               |64                |memory_size
16                |16                |batch_size
20                |256               |n_steps
0.97              |0.96              |gae_lambda
2                 |5                 |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.5601 | profit rate:    0.4 | accuracy: 0.30
step_num: 400 | loss: 0.4369 | profit rate:    0.3 | accuracy: 0.32
step_num: 600 | loss: 0.3773 | profit rate:    0.2 | accuracy: 0.33
step_num: 800 | loss: 0.4235 | profit rate:    0.3 | accuracy: 0.34
step_num: 1000 | loss: 0.3174 | profit rate:    0.3 | accuracy: 0.33
step_num: 1200 | loss: 0.2782 | profit rate:    0.2 | accuracy: 0.33
step_num: 1400 | loss: 0.3920 | profit rate:    0.1 | accuracy: 0.32
step_num: 1600 | loss: 0.3134 | profit rate:    0.1 | accuracy: 0.31
step_num: 1800 | loss: 0.1973 | profit rate:    0.0 | accuracy: 0.30
step_num: 2000 | loss: 0.1465 | profit rate:    0.0 | accuracy: 0.28
step_num: 2200 | loss: 0.1473 | profit rate:    0.0 | accuracy: 0.27
step_num: 2400 | loss: 0.1885 | profit rate:    0.0 | accuracy: 0.26
step_num: 2600 | loss: 0.2607 | profit rate:    0.0 | accuracy: 0.26
step_num: 2800 | loss: 0.1965 | profit rate:    0.0 | accuracy: 0.26
step_num: 3000 | loss: 0.2058 | profit rate:    0.0 | accuracy: 0.26
step_num: 3200 | loss: 0.1209 | profit rate:    0.0 | accuracy: 0.25
step_num: 3400 | loss: 0.0841 | profit rate:    0.0 | accuracy: 0.24
step_num: 3600 | loss: 0.1116 | profit rate:    0.1 | accuracy: 0.24
episode:   1/8,耗时:0.82分/0.82分,训练集: | step: 3652 | average_treward:   37.7 | max_treward: 37.6917 | average profit rate:  0.057
model saved @ step:3652,performance:0.057,accuracy:0.24
step_num: 3800 | loss: 0.1272 | profit rate:    0.6 | accuracy: 0.19
step_num: 4000 | loss: 0.1890 | profit rate:    0.6 | accuracy: 0.18
step_num: 4200 | loss: 0.0726 | profit rate:    0.8 | accuracy: 0.17
step_num: 4400 | loss: 0.1234 | profit rate:    0.9 | accuracy: 0.16
step_num: 4600 | loss: 0.2878 | profit rate:    0.7 | accuracy: 0.17
step_num: 4800 | loss: 0.1377 | profit rate:    0.5 | accuracy: 0.17
step_num: 5000 | loss: 0.1550 | profit rate:    0.4 | accuracy: 0.17
step_num: 5200 | loss: 0.1637 | profit rate:    0.3 | accuracy: 0.18
step_num: 5400 | loss: 0.0874 | profit rate:    0.2 | accuracy: 0.17
step_num: 5600 | loss: 0.0414 | profit rate:    0.2 | accuracy: 0.15
step_num: 5800 | loss: 0.0207 | profit rate:    0.2 | accuracy: 0.14
step_num: 6000 | loss: 0.0466 | profit rate:    0.2 | accuracy: 0.14
step_num: 6200 | loss: 0.0653 | profit rate:    0.2 | accuracy: 0.13
step_num: 6400 | loss: 0.0406 | profit rate:    0.2 | accuracy: 0.13
step_num: 6600 | loss: 0.0694 | profit rate:    0.2 | accuracy: 0.13
step_num: 6800 | loss: 0.0465 | profit rate:    0.2 | accuracy: 0.12
step_num: 7000 | loss: 0.0515 | profit rate:    0.2 | accuracy: 0.12
step_num: 7200 | loss: 0.1441 | profit rate:    0.3 | accuracy: 0.13
model saved @ step:7304,performance:0.280,accuracy:0.13
step_num: 7400 | loss: 0.1324 | profit rate:    0.7 | accuracy: 0.10
step_num: 7600 | loss: 0.1826 | profit rate:    1.1 | accuracy: 0.18
step_num: 7800 | loss: 0.0929 | profit rate:    1.6 | accuracy: 0.15
step_num: 8000 | loss: 0.0913 | profit rate:    2.3 | accuracy: 0.16
step_num: 8200 | loss: 0.0653 | profit rate:    2.3 | accuracy: 0.15
step_num: 8400 | loss: 0.1535 | profit rate:    0.9 | accuracy: 0.15
step_num: 8600 | loss: 0.0840 | profit rate:    0.9 | accuracy: 0.14
step_num: 8800 | loss: 0.0831 | profit rate:    0.9 | accuracy: 0.14
step_num: 9000 | loss: 0.0916 | profit rate:    0.7 | accuracy: 0.14
step_num: 9200 | loss: 0.2167 | profit rate:    1.0 | accuracy: 0.16
step_num: 9400 | loss: 0.1419 | profit rate:    1.1 | accuracy: 0.16
step_num: 9600 | loss: 0.0310 | profit rate:    1.2 | accuracy: 0.15
step_num: 9800 | loss: 0.1244 | profit rate:    0.9 | accuracy: 0.15
step_num: 10000 | loss: 0.2353 | profit rate:    0.7 | accuracy: 0.16
step_num: 10200 | loss: 0.0963 | profit rate:    0.5 | accuracy: 0.16
step_num: 10400 | loss: 0.1275 | profit rate:    0.8 | accuracy: 0.16
step_num: 10600 | loss: 0.0975 | profit rate:    0.9 | accuracy: 0.15
step_num: 10800 | loss: 0.0663 | profit rate:    1.4 | accuracy: 0.15
episode:   3/8,耗时:0.86分/2.54分,训练集: | step: 10956 | average_treward:   90.5 | max_treward: 151.0688 | average profit rate:  0.728
model saved @ step:10956,performance:1.847,accuracy:0.16
step_num: 11000 | loss: 0.1447 | profit rate:    0.6 | accuracy: 0.29
step_num: 11200 | loss: 0.1777 | profit rate:    0.6 | accuracy: 0.13
step_num: 11400 | loss: 0.0848 | profit rate:    0.6 | accuracy: 0.11
step_num: 11600 | loss: 0.0409 | profit rate:    0.7 | accuracy: 0.12
step_num: 11800 | loss: 0.0377 | profit rate:    0.7 | accuracy: 0.10
step_num: 12000 | loss: 0.2583 | profit rate:    1.2 | accuracy: 0.16
step_num: 12200 | loss: 0.1866 | profit rate:    1.4 | accuracy: 0.17
step_num: 12400 | loss: 0.0682 | profit rate:    1.0 | accuracy: 0.16
step_num: 12600 | loss: 0.0840 | profit rate:    0.9 | accuracy: 0.16
step_num: 12800 | loss: 0.0524 | profit rate:    0.8 | accuracy: 0.15
step_num: 13000 | loss: 0.0728 | profit rate:    0.9 | accuracy: 0.14
step_num: 13200 | loss: 0.1712 | profit rate:    1.5 | accuracy: 0.15
step_num: 13400 | loss: 0.1060 | profit rate:    2.8 | accuracy: 0.15
step_num: 13600 | loss: 0.2036 | profit rate:    5.0 | accuracy: 0.16
step_num: 13800 | loss: 0.1700 | profit rate:    3.5 | accuracy: 0.16
step_num: 14000 | loss: 0.0602 | profit rate:    4.7 | accuracy: 0.16
step_num: 14200 | loss: 0.0941 | profit rate:    6.8 | accuracy: 0.16
step_num: 14400 | loss: 0.0662 | profit rate:    7.1 | accuracy: 0.15
step_num: 14600 | loss: 0.1739 | profit rate:   10.8 | accuracy: 0.16
model saved @ step:14608,performance:10.923,accuracy:0.16
step_num: 14800 | loss: 0.1758 | profit rate:    1.1 | accuracy: 0.19
step_num: 15000 | loss: 0.0748 | profit rate:    0.9 | accuracy: 0.13
step_num: 15200 | loss: 0.0962 | profit rate:    1.0 | accuracy: 0.15
step_num: 15400 | loss: 0.0504 | profit rate:    1.1 | accuracy: 0.13
step_num: 15600 | loss: 0.2034 | profit rate:    0.7 | accuracy: 0.16
step_num: 15800 | loss: 0.1530 | profit rate:    1.4 | accuracy: 0.18
step_num: 16000 | loss: 0.0916 | profit rate:    0.7 | accuracy: 0.18
step_num: 16200 | loss: 0.0610 | profit rate:    0.8 | accuracy: 0.17
step_num: 16400 | loss: 0.1328 | profit rate:    0.5 | accuracy: 0.17
step_num: 16600 | loss: 0.0729 | profit rate:    0.5 | accuracy: 0.17
step_num: 16800 | loss: 0.1237 | profit rate:    1.5 | accuracy: 0.17
step_num: 17000 | loss: 0.2345 | profit rate:    1.3 | accuracy: 0.18
step_num: 17200 | loss: 0.2262 | profit rate:    2.7 | accuracy: 0.19
step_num: 17400 | loss: 0.1743 | profit rate:    1.6 | accuracy: 0.19
step_num: 17600 | loss: 0.1149 | profit rate:    2.4 | accuracy: 0.19
step_num: 17800 | loss: 0.1549 | profit rate:    3.5 | accuracy: 0.19
step_num: 18000 | loss: 0.0792 | profit rate:    5.8 | accuracy: 0.19
step_num: 18200 | loss: 0.1892 | profit rate:    6.8 | accuracy: 0.20
episode:   5/8,耗时:0.87分/4.29分,训练集: | step: 18260 | average_treward:  152.3 | max_treward: 285.1140 | average profit rate:  4.133
model saved @ step:18260,performance:7.559,accuracy:0.20
step_num: 18400 | loss: 0.2595 | profit rate:    1.3 | accuracy: 0.26
step_num: 18600 | loss: 0.1703 | profit rate:    2.0 | accuracy: 0.22
step_num: 18800 | loss: 0.1020 | profit rate:    2.8 | accuracy: 0.20
step_num: 19000 | loss: 0.1018 | profit rate:    2.3 | accuracy: 0.19
step_num: 19200 | loss: 0.1011 | profit rate:    1.5 | accuracy: 0.18
step_num: 19400 | loss: 0.1082 | profit rate:    1.7 | accuracy: 0.17
step_num: 19600 | loss: 0.0695 | profit rate:    1.4 | accuracy: 0.17
step_num: 19800 | loss: 0.0586 | profit rate:    1.6 | accuracy: 0.16
step_num: 20000 | loss: 0.0722 | profit rate:    1.7 | accuracy: 0.15
step_num: 20200 | loss: 0.1188 | profit rate:    1.8 | accuracy: 0.16
step_num: 20400 | loss: 0.0661 | profit rate:    1.2 | accuracy: 0.15
step_num: 20600 | loss: 0.0364 | profit rate:    1.2 | accuracy: 0.14
step_num: 20800 | loss: 0.0732 | profit rate:    1.2 | accuracy: 0.14
step_num: 21000 | loss: 0.0876 | profit rate:    1.0 | accuracy: 0.14
step_num: 21200 | loss: 0.1398 | profit rate:    0.8 | accuracy: 0.14
step_num: 21400 | loss: 0.0819 | profit rate:    1.1 | accuracy: 0.14
step_num: 21600 | loss: 0.0517 | profit rate:    1.2 | accuracy: 0.14
step_num: 21800 | loss: 0.0714 | profit rate:    1.6 | accuracy: 0.14
step_num: 22000 | loss: 0.1175 | profit rate:    0.7 | accuracy: 0.30
step_num: 22200 | loss: 0.1470 | profit rate:    1.0 | accuracy: 0.22
step_num: 22400 | loss: 0.0846 | profit rate:    1.3 | accuracy: 0.19
step_num: 22600 | loss: 0.0575 | profit rate:    1.9 | accuracy: 0.19
step_num: 22800 | loss: 0.0290 | profit rate:    1.9 | accuracy: 0.17
step_num: 23000 | loss: 0.1652 | profit rate:    3.4 | accuracy: 0.20
step_num: 23200 | loss: 0.1789 | profit rate:    3.6 | accuracy: 0.21
step_num: 23400 | loss: 0.0706 | profit rate:    3.8 | accuracy: 0.19
step_num: 23600 | loss: 0.0822 | profit rate:    7.6 | accuracy: 0.19
step_num: 23800 | loss: 0.0963 | profit rate:    8.4 | accuracy: 0.19
step_num: 24000 | loss: 0.1419 | profit rate:    7.8 | accuracy: 0.19
step_num: 24200 | loss: 0.1242 | profit rate:    9.9 | accuracy: 0.19
step_num: 24400 | loss: 0.1929 | profit rate:   15.8 | accuracy: 0.20
step_num: 24600 | loss: 0.1028 | profit rate:   13.9 | accuracy: 0.19
step_num: 24800 | loss: 0.1793 | profit rate:   14.0 | accuracy: 0.20
step_num: 25000 | loss: 0.0465 | profit rate:   17.9 | accuracy: 0.19
step_num: 25200 | loss: 0.0494 | profit rate:   26.0 | accuracy: 0.19
step_num: 25400 | loss: 0.0724 | profit rate:   56.1 | accuracy: 0.19
episode:   7/8,耗时:0.87分/6.04分,训练集: | step: 25564 | average_treward:  174.2 | max_treward: 292.0003 | average profit rate: 12.731
model saved @ step:25564,performance:66.691,accuracy:0.19
step_num: 25600 | loss: 0.2361 | profit rate:    0.8 | accuracy: 0.38
step_num: 25800 | loss: 0.1878 | profit rate:    1.5 | accuracy: 0.21
step_num: 26000 | loss: 0.1938 | profit rate:    3.2 | accuracy: 0.23
step_num: 26200 | loss: 0.1475 | profit rate:    6.4 | accuracy: 0.25
step_num: 26400 | loss: 0.0782 | profit rate:    6.0 | accuracy: 0.21
step_num: 26600 | loss: 0.1845 | profit rate:    9.3 | accuracy: 0.23
step_num: 26800 | loss: 0.1607 | profit rate:   16.1 | accuracy: 0.24
step_num: 27000 | loss: 0.0763 | profit rate:   16.9 | accuracy: 0.22
step_num: 27200 | loss: 0.0747 | profit rate:   17.0 | accuracy: 0.21
step_num: 27400 | loss: 0.0575 | profit rate:   17.8 | accuracy: 0.20
step_num: 27600 | loss: 0.1594 | profit rate:   16.4 | accuracy: 0.20
step_num: 27800 | loss: 0.0992 | profit rate:   26.7 | accuracy: 0.20
step_num: 28000 | loss: 0.1596 | profit rate:   44.2 | accuracy: 0.21
step_num: 28200 | loss: 0.1334 | profit rate:   77.2 | accuracy: 0.20
step_num: 28400 | loss: 0.1936 | profit rate:   52.6 | accuracy: 0.21
step_num: 28600 | loss: 0.1318 | profit rate:   71.5 | accuracy: 0.21
step_num: 28800 | loss: 0.1307 | profit rate:   88.8 | accuracy: 0.20
step_num: 29000 | loss: 0.1578 | profit rate:  154.1 | accuracy: 0.20
step_num: 29200 | loss: 0.1757 | profit rate:  205.7 | accuracy: 0.21
model saved @ step:29216,performance:206.698,accuracy:0.21
----------------------------------------finished----------------------------------------
  0%|          | 0/289 [00:00<?, ?it/s] 35%|      | 100/289 [00:00<00:00, 997.81it/s] 75%|  | 216/289 [00:00<00:00, 1093.12it/s]==================================================
100%|| 289/289 [00:00<00:00, 1106.35it/s]
2023-01-15T12:00:00 | *** START BACKTEST ***
2023-01-15T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-19T12:00:00 | *** GOING LONG ***
2023-01-19T12:00:00's price 21071.5898, buy 0.0474098 units.
2023-01-19T12:00:00 | current balance = 0.00
2023-01-19T12:00:00 | balance:0.00+units:0.0474098*price:21071.5898=net_wealth:999.0010
--------------------------------------------------
2023-01-20T12:00:00 | *** GOING SHORT ***
2023-01-20T12:00:00's price 22667.2109, sell 0.0474098 units.
2023-01-20T12:00:00 | current balance = 1073.57
2023-01-20T12:00:00 | balance:1073.57+units:0.0*price:22667.2109=net_wealth:1073.5744
--------------------------------------------------
2023-01-21T00:00:00 | *** GOING LONG ***
2023-01-21T00:00:00's price 22905.6504, buy 0.04682254 units.
2023-01-21T00:00:00 | current balance = 0.00
2023-01-21T00:00:00 | balance:0.00+units:0.04682254*price:22905.6504=net_wealth:1072.5019
--------------------------------------------------
2023-01-27T00:00:00 | *** GOING SHORT ***
2023-01-27T00:00:00's price 22967.4707, sell 0.04682254 units.
2023-01-27T00:00:00 | current balance = 1074.32
2023-01-27T00:00:00 | balance:1074.32+units:0.0*price:22967.4707=net_wealth:1074.3211
--------------------------------------------------
2023-02-02T12:00:00 | *** GOING LONG ***
2023-02-02T12:00:00's price 23488.9395, buy 0.04569158 units.
2023-02-02T12:00:00 | current balance = 0.00
2023-02-02T12:00:00 | balance:0.00+units:0.04569158*price:23488.9395=net_wealth:1073.2479
--------------------------------------------------
2023-02-03T12:00:00 | *** GOING SHORT ***
2023-02-03T12:00:00's price 23431.9004, sell 0.04569158 units.
2023-02-03T12:00:00 | current balance = 1069.57
2023-02-03T12:00:00 | balance:1069.57+units:0.0*price:23431.9004=net_wealth:1069.5710
--------------------------------------------------
2023-02-04T12:00:00 | *** GOING LONG ***
2023-02-04T12:00:00's price 23326.8398, buy 0.04580566 units.
2023-02-04T12:00:00 | current balance = 0.00
2023-02-04T12:00:00 | balance:0.00+units:0.04580566*price:23326.8398=net_wealth:1068.5025
--------------------------------------------------
2023-02-05T00:00:00 | *** GOING SHORT ***
2023-02-05T00:00:00's price 23356.3301, sell 0.04580566 units.
2023-02-05T00:00:00 | current balance = 1068.78
2023-02-05T00:00:00 | balance:1068.78+units:0.0*price:23356.3301=net_wealth:1068.7835
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING LONG ***
2023-02-07T00:00:00's price 22977.2402, buy 0.04646836 units.
2023-02-07T00:00:00 | current balance = 0.00
2023-02-07T00:00:00 | balance:0.00+units:0.04646836*price:22977.2402=net_wealth:1067.7158
--------------------------------------------------
2023-02-07T12:00:00 | *** GOING SHORT ***
2023-02-07T12:00:00's price 23240.4609, sell 0.04646836 units.
2023-02-07T12:00:00 | current balance = 1078.87
2023-02-07T12:00:00 | balance:1078.87+units:0.0*price:23240.4609=net_wealth:1078.8673
--------------------------------------------------
2023-02-08T00:00:00 | *** GOING LONG ***
2023-02-08T00:00:00's price 23159.0703, buy 0.046538500000000003 units.
2023-02-08T00:00:00 | current balance = 0.00
2023-02-08T00:00:00 | balance:0.00+units:0.046538500000000003*price:23159.0703=net_wealth:1077.7895
--------------------------------------------------
2023-02-10T12:00:00 | *** GOING SHORT ***
2023-02-10T12:00:00's price 21625.1895, sell 0.046538500000000003 units.
2023-02-10T12:00:00 | current balance = 1005.40
2023-02-10T12:00:00 | balance:1005.40+units:0.0*price:21625.1895=net_wealth:1005.3986
--------------------------------------------------
2023-02-13T12:00:00 | *** GOING LONG ***
2023-02-13T12:00:00's price 21773.9707, buy 0.04612815 units.
2023-02-13T12:00:00 | current balance = 0.00
2023-02-13T12:00:00 | balance:0.00+units:0.04612815*price:21773.9707=net_wealth:1004.3942
--------------------------------------------------
2023-02-17T12:00:00 | *** GOING SHORT ***
2023-02-17T12:00:00's price 24569.9707, sell 0.04612815 units.
2023-02-17T12:00:00 | current balance = 1132.24
2023-02-17T12:00:00 | balance:1132.24+units:0.0*price:24569.9707=net_wealth:1132.2351
--------------------------------------------------
2023-02-23T00:00:00 | *** GOING LONG ***
2023-02-23T00:00:00's price 23780.1992, buy 0.0475649 units.
2023-02-23T00:00:00 | current balance = 0.00
2023-02-23T00:00:00 | balance:0.00+units:0.0475649*price:23780.1992=net_wealth:1131.1040
--------------------------------------------------
2023-03-08T00:00:00 | *** GOING SHORT ***
2023-03-08T00:00:00's price 22072.4492, sell 0.0475649 units.
2023-03-08T00:00:00 | current balance = 1048.83
2023-03-08T00:00:00 | balance:1048.83+units:0.0*price:22072.4492=net_wealth:1048.8252
--------------------------------------------------
2023-03-10T00:00:00 | *** GOING LONG ***
2023-03-10T00:00:00's price 19760.7793, buy 0.053023020000000004 units.
2023-03-10T00:00:00 | current balance = 0.00
2023-03-10T00:00:00 | balance:0.00+units:0.053023020000000004*price:19760.7793=net_wealth:1047.7774
--------------------------------------------------
2023-03-17T00:00:00 | *** GOING SHORT ***
2023-03-17T00:00:00's price 26918.7305, sell 0.053023020000000004 units.
2023-03-17T00:00:00 | current balance = 1425.89
2023-03-17T00:00:00 | balance:1425.89+units:0.0*price:26918.7305=net_wealth:1425.8863
--------------------------------------------------
2023-03-21T12:00:00 | *** GOING LONG ***
2023-03-21T12:00:00's price 28105.4707, buy 0.05068267 units.
2023-03-21T12:00:00 | current balance = 0.00
2023-03-21T12:00:00 | balance:0.00+units:0.05068267*price:28105.4707=net_wealth:1424.4618
--------------------------------------------------
2023-03-31T12:00:00 | *** GOING SHORT ***
2023-03-31T12:00:00's price 28465.3594, sell 0.05068267 units.
2023-03-31T12:00:00 | current balance = 1441.26
2023-03-31T12:00:00 | balance:1441.26+units:0.0*price:28465.3594=net_wealth:1441.2592
--------------------------------------------------
2023-04-06T00:00:00 | *** GOING LONG ***
2023-04-06T00:00:00's price 27945.5195, buy 0.05152231 units.
2023-04-06T00:00:00 | current balance = 0.00
2023-04-06T00:00:00 | balance:0.00+units:0.05152231*price:27945.5195=net_wealth:1439.8194
--------------------------------------------------
2023-04-08T00:00:00 | *** GOING SHORT ***
2023-04-08T00:00:00's price 28016.0898, sell 0.05152231 units.
2023-04-08T00:00:00 | current balance = 1442.01
2023-04-08T00:00:00 | balance:1442.01+units:0.0*price:28016.0898=net_wealth:1442.0119
--------------------------------------------------
2023-04-10T00:00:00 | *** GOING LONG ***
2023-04-10T00:00:00's price 28305.5996, buy 0.05089345 units.
2023-04-10T00:00:00 | current balance = 0.00
2023-04-10T00:00:00 | balance:0.00+units:0.05089345*price:28305.5996=net_wealth:1440.5713
--------------------------------------------------
2023-04-10T12:00:00 | *** GOING SHORT ***
2023-04-10T12:00:00's price 29637.3398, sell 0.05089345 units.
2023-04-10T12:00:00 | current balance = 1506.84
2023-04-10T12:00:00 | balance:1506.84+units:0.0*price:29637.3398=net_wealth:1506.8398
--------------------------------------------------
2023-04-11T12:00:00 | *** GOING LONG ***
2023-04-11T12:00:00's price 30200.4199, buy 0.049844770000000004 units.
2023-04-11T12:00:00 | current balance = 0.00
2023-04-11T12:00:00 | balance:0.00+units:0.049844770000000004*price:30200.4199=net_wealth:1505.3345
--------------------------------------------------
2023-04-14T00:00:00 | *** GOING SHORT ***
2023-04-14T00:00:00's price 30801.8906, sell 0.049844770000000004 units.
2023-04-14T00:00:00 | current balance = 1533.78
2023-04-14T00:00:00 | balance:1533.78+units:0.0*price:30801.8906=net_wealth:1533.7794
--------------------------------------------------
2023-04-16T00:00:00 | *** GOING LONG ***
2023-04-16T00:00:00's price 30226.4492, buy 0.05069221 units.
2023-04-16T00:00:00 | current balance = 0.00
2023-04-16T00:00:00 | balance:0.00+units:0.05069221*price:30226.4492=net_wealth:1532.2471
--------------------------------------------------
2023-04-27T00:00:00 | *** GOING SHORT ***
2023-04-27T00:00:00's price 28934.2109, sell 0.05069221 units.
2023-04-27T00:00:00 | current balance = 1465.27
2023-04-27T00:00:00 | balance:1465.27+units:0.0*price:28934.2109=net_wealth:1465.2740
--------------------------------------------------
2023-04-28T12:00:00 | *** GOING LONG ***
2023-04-28T12:00:00's price 29311.6992, buy 0.0499394 units.
2023-04-28T12:00:00 | current balance = 0.00
2023-04-28T12:00:00 | balance:0.00+units:0.0499394*price:29311.6992=net_wealth:1463.8102
--------------------------------------------------
2023-05-02T12:00:00 | *** GOING SHORT ***
2023-05-02T12:00:00's price 28669.8594, sell 0.0499394 units.
2023-05-02T12:00:00 | current balance = 1430.33
2023-05-02T12:00:00 | balance:1430.33+units:0.0*price:28669.8594=net_wealth:1430.3253
--------------------------------------------------
2023-05-04T00:00:00 | *** GOING LONG ***
2023-05-04T00:00:00's price 29154.6602, buy 0.04901086 units.
2023-05-04T00:00:00 | current balance = 0.00
2023-05-04T00:00:00 | balance:0.00+units:0.04901086*price:29154.6602=net_wealth:1428.8964
--------------------------------------------------
2023-05-26T00:00:00 | *** GOING SHORT ***
2023-05-26T00:00:00's price 26463.2891, sell 0.04901086 units.
2023-05-26T00:00:00 | current balance = 1295.69
2023-05-26T00:00:00 | balance:1295.69+units:0.0*price:26463.2891=net_wealth:1295.6930
--------------------------------------------------
2023-05-27T12:00:00 | *** GOING LONG ***
2023-05-27T12:00:00's price 26854.2695, buy 0.0482008 units.
2023-05-27T12:00:00 | current balance = 0.00
2023-05-27T12:00:00 | balance:0.00+units:0.0482008*price:26854.2695=net_wealth:1294.3986
--------------------------------------------------
2023-05-30T00:00:00 | *** GOING SHORT ***
2023-05-30T00:00:00's price 28021.4004, sell 0.0482008 units.
2023-05-30T00:00:00 | current balance = 1349.30
2023-05-30T00:00:00 | balance:1349.30+units:0.0*price:28021.4004=net_wealth:1349.3046
--------------------------------------------------
2023-05-30T12:00:00 | *** GOING LONG ***
2023-05-30T12:00:00's price 27694.4004, buy 0.048672480000000004 units.
2023-05-30T12:00:00 | current balance = 0.00
2023-05-30T12:00:00 | balance:0.00+units:0.048672480000000004*price:27694.4004=net_wealth:1347.9566
--------------------------------------------------
2023-05-31T12:00:00 | *** GOING SHORT ***
2023-05-31T12:00:00's price 27210.3496, sell 0.048672480000000004 units.
2023-05-31T12:00:00 | current balance = 1323.07
2023-05-31T12:00:00 | balance:1323.07+units:0.0*price:27210.3496=net_wealth:1323.0723
--------------------------------------------------
2023-06-05T12:00:00 | *** GOING LONG ***
2023-06-05T12:00:00's price 25728.1992, buy 0.05137356 units.
2023-06-05T12:00:00 | current balance = 0.00
2023-06-05T12:00:00 | balance:0.00+units:0.05137356*price:25728.1992=net_wealth:1321.7505
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.05137356 units.
2023-06-08T12:00:00 | current balance = 1365.16
2023-06-08T12:00:00 | net performance [%] = 36.5161
2023-06-08T12:00:00 | number of trades [#] = 38
==================================================
Trial 3 Complete [00h 06m 58s]
net_wealth: 1366.5272203871461

Best net_wealth So Far: 1366.5272203871461
Total elapsed time: 00h 15m 05s

Search: Running Trial #4

Value             |Best Value So Far |Hyperparameter
4                 |2                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
5                 |30                |lags
0.6               |0.6               |gamma
64                |256               |memory_size
16                |16                |batch_size
128               |20                |n_steps
0.98              |0.97              |gae_lambda
5                 |2                 |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4205.000000   4209.000000
mean      0.000424    19921.326125  ...   19986.205058  19971.309209
std       0.028069    16159.303521  ...   16194.964155  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7628.430176   7625.000000
50%       0.000696    11410.370947  ...   11486.360352  11477.000000
75%       0.011720    29502.909082  ...   29332.109375  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 0.6431 | profit rate:    0.1 | accuracy: 0.29
step_num: 400 | loss: 0.5994 | profit rate:    0.5 | accuracy: 0.36
step_num: 600 | loss: 0.4850 | profit rate:    0.5 | accuracy: 0.35
step_num: 800 | loss: 0.4899 | profit rate:    0.4 | accuracy: 0.35
step_num: 1000 | loss: 0.6486 | profit rate:    0.2 | accuracy: 0.32
step_num: 1200 | loss: 0.4265 | profit rate:    0.2 | accuracy: 0.33
step_num: 1400 | loss: 0.2943 | profit rate:    0.1 | accuracy: 0.33
step_num: 1600 | loss: 0.5262 | profit rate:    0.1 | accuracy: 0.32
step_num: 1800 | loss: 0.3608 | profit rate:    0.1 | accuracy: 0.32
step_num: 2000 | loss: 0.6232 | profit rate:    0.0 | accuracy: 0.32
step_num: 2200 | loss: 0.5116 | profit rate:    0.7 | accuracy: 0.34
step_num: 2400 | loss: 0.6054 | profit rate:    8.8 | accuracy: 0.36
step_num: 2600 | loss: 0.5882 | profit rate:    1.9 | accuracy: 0.36
step_num: 2800 | loss: 0.1941 | profit rate:    0.9 | accuracy: 0.34
step_num: 3000 | loss: 0.4776 | profit rate:    0.6 | accuracy: 0.34
step_num: 3200 | loss: 0.0941 | profit rate:    0.3 | accuracy: 0.32
step_num: 3400 | loss: 0.0835 | profit rate:    0.3 | accuracy: 0.31
step_num: 3600 | loss: 0.0972 | profit rate:    0.2 | accuracy: 0.30
episode:   1/8,耗时:0.49分/0.49分,训练集: | step: 3663 | average_treward:   47.8 | max_treward: 47.7927 | average profit rate:  0.237
model saved @ step:3663,performance:0.237,accuracy:0.29
step_num: 3800 | loss: 0.0440 | profit rate:    0.4 | accuracy: 0.08
step_num: 4000 | loss: 0.0062 | profit rate:    0.4 | accuracy: 0.04
step_num: 4200 | loss: 0.0241 | profit rate:    0.4 | accuracy: 0.04
step_num: 4400 | loss: 0.0332 | profit rate:    0.4 | accuracy: 0.04
step_num: 4600 | loss: 0.0223 | profit rate:    0.4 | accuracy: 0.05
step_num: 4800 | loss: 0.0574 | profit rate:    0.4 | accuracy: 0.05
step_num: 5000 | loss: 0.0107 | profit rate:    0.4 | accuracy: 0.04
step_num: 5200 | loss: 0.0127 | profit rate:    0.4 | accuracy: 0.04
step_num: 5400 | loss: 0.0206 | profit rate:    0.4 | accuracy: 0.04
step_num: 5600 | loss: 0.0353 | profit rate:    0.4 | accuracy: 0.04
step_num: 5800 | loss: 0.0296 | profit rate:    0.4 | accuracy: 0.04
step_num: 6000 | loss: 0.4052 | profit rate:    1.9 | accuracy: 0.06
step_num: 6200 | loss: 0.0963 | profit rate:    2.0 | accuracy: 0.07
step_num: 6400 | loss: 0.2175 | profit rate:    3.2 | accuracy: 0.08
step_num: 6600 | loss: 0.4251 | profit rate:    4.8 | accuracy: 0.09
step_num: 6800 | loss: 0.4274 | profit rate:   11.2 | accuracy: 0.11
step_num: 7000 | loss: 0.0718 | profit rate:    9.3 | accuracy: 0.11
step_num: 7200 | loss: 0.1113 | profit rate:    9.1 | accuracy: 0.11
model saved @ step:7326,performance:7.614,accuracy:0.11
step_num: 7400 | loss: 0.2735 | profit rate:    2.3 | accuracy: 0.21
step_num: 7600 | loss: 0.3125 | profit rate:    5.3 | accuracy: 0.16
step_num: 7800 | loss: 0.1837 | profit rate:   11.4 | accuracy: 0.21
step_num: 8000 | loss: 0.6516 | profit rate:   13.1 | accuracy: 0.25
step_num: 8200 | loss: 0.2426 | profit rate:    7.2 | accuracy: 0.23
step_num: 8400 | loss: 0.0135 | profit rate:    1.8 | accuracy: 0.22
step_num: 8600 | loss: 0.0449 | profit rate:    2.0 | accuracy: 0.19
step_num: 8800 | loss: 0.1124 | profit rate:    2.0 | accuracy: 0.17
step_num: 9000 | loss: 0.0219 | profit rate:    2.1 | accuracy: 0.15
step_num: 9200 | loss: 0.0321 | profit rate:    2.1 | accuracy: 0.14
step_num: 9400 | loss: 0.0183 | profit rate:    2.3 | accuracy: 0.13
step_num: 9600 | loss: 0.5318 | profit rate:    5.3 | accuracy: 0.14
step_num: 9800 | loss: 0.2053 | profit rate:    5.6 | accuracy: 0.14
step_num: 10000 | loss: 0.0643 | profit rate:    3.0 | accuracy: 0.13
step_num: 10200 | loss: 0.1741 | profit rate:    5.8 | accuracy: 0.13
step_num: 10400 | loss: 0.2308 | profit rate:    6.0 | accuracy: 0.13
step_num: 10600 | loss: 0.0036 | profit rate:    7.3 | accuracy: 0.12
step_num: 10800 | loss: 0.0679 | profit rate:    7.2 | accuracy: 0.12
episode:   3/8,耗时:0.53分/1.55分,训练集: | step: 10989 | average_treward:   96.7 | max_treward: 130.1502 | average profit rate:  5.099
step_num: 11000 | loss: 0.1552 | profit rate:    1.3 | accuracy: 0.67
step_num: 11200 | loss: 0.0968 | profit rate:    4.3 | accuracy: 0.21
step_num: 11400 | loss: 0.0809 | profit rate:    7.1 | accuracy: 0.15
step_num: 11600 | loss: 0.3337 | profit rate:   20.5 | accuracy: 0.20
step_num: 11800 | loss: 0.0752 | profit rate:   18.5 | accuracy: 0.17
step_num: 12000 | loss: 0.3350 | profit rate:    5.7 | accuracy: 0.18
step_num: 12200 | loss: 0.0410 | profit rate:    4.7 | accuracy: 0.16
step_num: 12400 | loss: 0.0174 | profit rate:    4.8 | accuracy: 0.14
step_num: 12600 | loss: 0.0973 | profit rate:    4.8 | accuracy: 0.13
step_num: 12800 | loss: 0.0037 | profit rate:    4.0 | accuracy: 0.12
step_num: 13000 | loss: 0.0064 | profit rate:    3.9 | accuracy: 0.11
step_num: 13200 | loss: 0.0674 | profit rate:    5.1 | accuracy: 0.10
step_num: 13400 | loss: 0.1042 | profit rate:   17.2 | accuracy: 0.11
step_num: 13600 | loss: 0.0025 | profit rate:   12.2 | accuracy: 0.11
step_num: 13800 | loss: 0.0310 | profit rate:   12.4 | accuracy: 0.10
step_num: 14000 | loss: 0.0034 | profit rate:   13.8 | accuracy: 0.10
step_num: 14200 | loss: 0.0720 | profit rate:   10.3 | accuracy: 0.09
step_num: 14400 | loss: 0.0326 | profit rate:   10.2 | accuracy: 0.09
step_num: 14600 | loss: 0.1125 | profit rate:    9.7 | accuracy: 0.09
step_num: 14800 | loss: 0.0074 | profit rate:    0.3 | accuracy: 0.12
step_num: 15000 | loss: 0.0017 | profit rate:    0.3 | accuracy: 0.06
step_num: 15200 | loss: 0.0271 | profit rate:    0.3 | accuracy: 0.05
step_num: 15400 | loss: 0.0443 | profit rate:    0.3 | accuracy: 0.06
step_num: 15600 | loss: 0.0422 | profit rate:    0.3 | accuracy: 0.07
step_num: 15800 | loss: 0.4211 | profit rate:    0.4 | accuracy: 0.10
step_num: 16000 | loss: 0.0112 | profit rate:    0.3 | accuracy: 0.09
step_num: 16200 | loss: 0.0048 | profit rate:    0.3 | accuracy: 0.09
step_num: 16400 | loss: 0.0323 | profit rate:    0.3 | accuracy: 0.09
step_num: 16600 | loss: 0.0295 | profit rate:    0.3 | accuracy: 0.08
step_num: 16800 | loss: 0.0098 | profit rate:    0.3 | accuracy: 0.08
step_num: 17000 | loss: 0.0465 | profit rate:    0.4 | accuracy: 0.07
step_num: 17200 | loss: 0.0535 | profit rate:    0.4 | accuracy: 0.07
step_num: 17400 | loss: 0.0176 | profit rate:    0.6 | accuracy: 0.07
step_num: 17600 | loss: 0.0438 | profit rate:    0.7 | accuracy: 0.07
step_num: 17800 | loss: 0.0285 | profit rate:    0.7 | accuracy: 0.07
step_num: 18000 | loss: 0.0054 | profit rate:    0.7 | accuracy: 0.07
step_num: 18200 | loss: 0.0036 | profit rate:    0.6 | accuracy: 0.06
episode:   5/8,耗时:0.58分/2.65分,训练集: | step: 18315 | average_treward:   97.2 | max_treward: 130.1502 | average profit rate:  5.121
step_num: 18400 | loss: 0.1432 | profit rate:    1.3 | accuracy: 0.06
step_num: 18600 | loss: 0.0152 | profit rate:    1.0 | accuracy: 0.03
step_num: 18800 | loss: 0.0016 | profit rate:    1.1 | accuracy: 0.03
step_num: 19000 | loss: 0.1374 | profit rate:    1.3 | accuracy: 0.04
step_num: 19200 | loss: 0.1181 | profit rate:    1.4 | accuracy: 0.05
step_num: 19400 | loss: 0.0742 | profit rate:    1.5 | accuracy: 0.05
step_num: 19600 | loss: 0.0460 | profit rate:    1.2 | accuracy: 0.07
step_num: 19800 | loss: 0.0171 | profit rate:    1.0 | accuracy: 0.06
step_num: 20000 | loss: 0.0177 | profit rate:    1.2 | accuracy: 0.06
step_num: 20200 | loss: 0.0173 | profit rate:    1.0 | accuracy: 0.06
step_num: 20400 | loss: 0.0287 | profit rate:    1.5 | accuracy: 0.07
step_num: 20600 | loss: 0.5849 | profit rate:  107.1 | accuracy: 0.11
step_num: 20800 | loss: 0.3649 | profit rate:  459.8 | accuracy: 0.14
step_num: 21000 | loss: 0.0722 | profit rate:  477.9 | accuracy: 0.13
step_num: 21200 | loss: 0.4407 | profit rate:  956.3 | accuracy: 0.15
step_num: 21400 | loss: 0.0529 | profit rate: 1521.8 | accuracy: 0.15
step_num: 21600 | loss: 0.0273 | profit rate: 2621.9 | accuracy: 0.15
step_num: 21800 | loss: 0.0358 | profit rate: 2496.6 | accuracy: 0.14
model saved @ step:21978,performance:2365.523,accuracy:0.14
step_num: 22000 | loss: 0.3990 | profit rate:    0.5 | accuracy: 0.35
step_num: 22200 | loss: 0.0024 | profit rate:    0.3 | accuracy: 0.12
step_num: 22400 | loss: 0.0162 | profit rate:    0.4 | accuracy: 0.09
step_num: 22600 | loss: 0.4227 | profit rate:    0.8 | accuracy: 0.13
step_num: 22800 | loss: 0.1140 | profit rate:    1.0 | accuracy: 0.12
step_num: 23000 | loss: 0.2039 | profit rate:    0.4 | accuracy: 0.13
step_num: 23200 | loss: 0.3295 | profit rate:    0.4 | accuracy: 0.15
step_num: 23400 | loss: 0.0031 | profit rate:    0.4 | accuracy: 0.14
step_num: 23600 | loss: 0.0887 | profit rate:    0.6 | accuracy: 0.14
step_num: 23800 | loss: 0.2668 | profit rate:    0.6 | accuracy: 0.13
step_num: 24000 | loss: 0.1877 | profit rate:    0.5 | accuracy: 0.15
step_num: 24200 | loss: 0.1961 | profit rate:    2.3 | accuracy: 0.15
step_num: 24400 | loss: 0.5700 | profit rate:    9.7 | accuracy: 0.17
step_num: 24600 | loss: 0.0597 | profit rate:    9.6 | accuracy: 0.16
step_num: 24800 | loss: 0.1884 | profit rate:   17.6 | accuracy: 0.17
step_num: 25000 | loss: 0.0167 | profit rate:   11.3 | accuracy: 0.16
step_num: 25200 | loss: 0.0038 | profit rate:   12.6 | accuracy: 0.15
step_num: 25400 | loss: 0.0575 | profit rate:   17.6 | accuracy: 0.15
step_num: 25600 | loss: 0.0479 | profit rate:   19.4 | accuracy: 0.14
episode:   7/8,耗时:0.54分/3.72分,训练集: | step: 25641 | average_treward:  127.2 | max_treward: 251.8438 | average profit rate: 344.357
step_num: 25800 | loss: 0.0497 | profit rate:    1.5 | accuracy: 0.15
step_num: 26000 | loss: 0.0499 | profit rate:    2.0 | accuracy: 0.10
step_num: 26200 | loss: 0.1475 | profit rate:    2.7 | accuracy: 0.11
step_num: 26400 | loss: 0.1050 | profit rate:    3.2 | accuracy: 0.11
step_num: 26600 | loss: 0.3016 | profit rate:    3.3 | accuracy: 0.11
step_num: 26800 | loss: 0.3800 | profit rate:    6.3 | accuracy: 0.13
step_num: 27000 | loss: 0.0832 | profit rate:    3.9 | accuracy: 0.13
step_num: 27200 | loss: 0.0640 | profit rate:    3.1 | accuracy: 0.12
step_num: 27400 | loss: 0.0148 | profit rate:    2.9 | accuracy: 0.11
step_num: 27600 | loss: 0.0199 | profit rate:    2.9 | accuracy: 0.10
step_num: 27800 | loss: 0.4464 | profit rate:    8.1 | accuracy: 0.11
step_num: 28000 | loss: 0.3316 | profit rate:  235.5 | accuracy: 0.13
step_num: 28200 | loss: 0.1409 | profit rate:  238.0 | accuracy: 0.14
step_num: 28400 | loss: 0.2637 | profit rate:  325.5 | accuracy: 0.15
step_num: 28600 | loss: 0.1342 | profit rate:  237.7 | accuracy: 0.15
step_num: 28800 | loss: 0.0102 | profit rate:  215.7 | accuracy: 0.15
step_num: 29000 | loss: 0.0047 | profit rate:  226.4 | accuracy: 0.14
step_num: 29200 | loss: 0.0061 | profit rate:  278.0 | accuracy: 0.14
----------------------------------------finished----------------------------------------
  0%|          | 0/314 [00:00<?, ?it/s] 32%|      | 99/314 [00:00<00:00, 980.20it/s] 66%|   | 207/314 [00:00<00:00, 1032.61it/s]==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
100%|| 314/314 [00:00<00:00, 1046.66it/s]
--------------------------------------------------
2023-01-23T00:00:00 | *** GOING LONG ***
2023-01-23T00:00:00's price 22904.5801, buy 0.04361573 units.
2023-01-23T00:00:00 | current balance = 0.00
2023-01-23T00:00:00 | balance:0.00+units:0.04361573*price:22904.5801=net_wealth:999.0010
--------------------------------------------------
2023-03-11T12:00:00 | *** GOING SHORT ***
2023-03-11T12:00:00's price 20455.7305, sell 0.04361573 units.
2023-03-11T12:00:00 | current balance = 891.30
2023-03-11T12:00:00 | balance:891.30+units:0.0*price:20455.7305=net_wealth:891.3004
--------------------------------------------------
2023-03-15T12:00:00 | *** GOING LONG ***
2023-03-15T12:00:00's price 24285.6602, buy 0.03666398 units.
2023-03-15T12:00:00 | current balance = 0.00
2023-03-15T12:00:00 | balance:0.00+units:0.03666398*price:24285.6602=net_wealth:890.4100
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03666398 units.
2023-06-08T12:00:00 | current balance = 974.28
2023-06-08T12:00:00 | net performance [%] = -2.5720
2023-06-08T12:00:00 | number of trades [#] = 4
==================================================
Trial 4 Complete [00h 04m 17s]
net_wealth: 975.2552120072824

Best net_wealth So Far: 1366.5272203871461
Total elapsed time: 00h 19m 22s

Search: Running Trial #5

Value             |Best Value So Far |Hyperparameter
6                 |2                 |horizon
225               |225               |lookback
True              |False             |MarketFactor
7                 |30                |lags
0.98              |0.6               |gamma
64                |256               |memory_size
32                |16                |batch_size
10                |20                |n_steps
0.98              |0.97              |gae_lambda
2                 |2                 |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4203.000000   4209.000000
mean      0.000424    19921.326125  ...   19993.666186  19971.309209
std       0.028069    16159.303521  ...   16195.203792  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7637.519775   7625.000000
50%       0.000696    11410.370947  ...   11491.000000  11477.000000
75%       0.011720    29502.909082  ...   29370.559570  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 1.3874 | profit rate:    2.5 | accuracy: 0.35
step_num: 400 | loss: 1.2079 | profit rate:    2.0 | accuracy: 0.30
step_num: 600 | loss: 1.3007 | profit rate:    3.2 | accuracy: 0.33
step_num: 800 | loss: 0.5186 | profit rate:    7.9 | accuracy: 0.31
step_num: 1000 | loss: 1.0441 | profit rate:    4.4 | accuracy: 0.31
step_num: 1200 | loss: 0.7590 | profit rate:   10.8 | accuracy: 0.33
step_num: 1400 | loss: 0.7057 | profit rate:    1.0 | accuracy: 0.33
step_num: 1600 | loss: 0.9527 | profit rate:    1.3 | accuracy: 0.34
step_num: 1800 | loss: 0.3735 | profit rate:    3.1 | accuracy: 0.35
step_num: 2000 | loss: 0.6071 | profit rate:    2.7 | accuracy: 0.35
step_num: 2200 | loss: 0.6023 | profit rate:   49.0 | accuracy: 0.36
step_num: 2400 | loss: 0.7647 | profit rate:  974.2 | accuracy: 0.38
step_num: 2600 | loss: 0.6112 | profit rate:   33.8 | accuracy: 0.38
step_num: 2800 | loss: 0.5872 | profit rate:  277.7 | accuracy: 0.39
step_num: 3000 | loss: 0.5166 | profit rate:   44.0 | accuracy: 0.38
step_num: 3200 | loss: 0.6219 | profit rate:   36.0 | accuracy: 0.39
step_num: 3400 | loss: 0.7565 | profit rate:  142.1 | accuracy: 0.39
step_num: 3600 | loss: 0.5781 | profit rate:  214.4 | accuracy: 0.39
episode:   1/8,耗时:0.43分/0.43分,训练集: | step: 3661 | average_treward:  119.7 | max_treward: 119.6829 | average profit rate: 253.809
model saved @ step:3661,performance:253.809,accuracy:0.39
step_num: 3800 | loss: 0.6886 | profit rate:   10.1 | accuracy: 0.32
step_num: 4000 | loss: 0.4779 | profit rate:    2.7 | accuracy: 0.31
step_num: 4200 | loss: 0.4920 | profit rate:    1.9 | accuracy: 0.27
step_num: 4400 | loss: 0.1292 | profit rate:    1.9 | accuracy: 0.24
step_num: 4600 | loss: 0.5698 | profit rate:    0.6 | accuracy: 0.25
step_num: 4800 | loss: 0.9718 | profit rate:   44.6 | accuracy: 0.31
step_num: 5000 | loss: 0.4813 | profit rate:   18.9 | accuracy: 0.32
step_num: 5200 | loss: 0.5008 | profit rate:   44.6 | accuracy: 0.31
step_num: 5400 | loss: 0.3794 | profit rate:   21.6 | accuracy: 0.31
step_num: 5600 | loss: 0.5934 | profit rate:   23.3 | accuracy: 0.33
step_num: 5800 | loss: 0.7170 | profit rate:  386.0 | accuracy: 0.35
step_num: 6000 | loss: 0.6611 | profit rate: 250026.2 | accuracy: 0.38
step_num: 6200 | loss: 0.3674 | profit rate: 12984.8 | accuracy: 0.38
step_num: 6400 | loss: 0.7688 | profit rate: 12465.6 | accuracy: 0.37
step_num: 6600 | loss: 0.4832 | profit rate: 13436.3 | accuracy: 0.38
step_num: 6800 | loss: 0.4949 | profit rate: 3106.6 | accuracy: 0.36
step_num: 7000 | loss: 0.1605 | profit rate: 3980.4 | accuracy: 0.35
step_num: 7200 | loss: 0.1174 | profit rate: 6561.2 | accuracy: 0.33
model saved @ step:7322,performance:4030.048,accuracy:0.33
step_num: 7400 | loss: 0.7850 | profit rate:    0.1 | accuracy: 0.33
step_num: 7600 | loss: 0.1832 | profit rate:    0.0 | accuracy: 0.22
step_num: 7800 | loss: 0.2460 | profit rate:    0.0 | accuracy: 0.19
step_num: 8000 | loss: 0.1912 | profit rate:    0.1 | accuracy: 0.20
step_num: 8200 | loss: 0.5160 | profit rate:    0.1 | accuracy: 0.21
step_num: 8400 | loss: 0.6914 | profit rate:   20.1 | accuracy: 0.30
step_num: 8600 | loss: 0.3845 | profit rate:   11.5 | accuracy: 0.31
step_num: 8800 | loss: 0.4142 | profit rate:   18.0 | accuracy: 0.31
step_num: 9000 | loss: 0.3367 | profit rate:    3.4 | accuracy: 0.31
step_num: 9200 | loss: 0.5766 | profit rate:    2.1 | accuracy: 0.33
step_num: 9400 | loss: 0.7055 | profit rate:   13.4 | accuracy: 0.36
step_num: 9600 | loss: 1.1064 | profit rate: 14177.4 | accuracy: 0.39
step_num: 9800 | loss: 1.1839 | profit rate: 4404.6 | accuracy: 0.40
step_num: 10000 | loss: 0.6711 | profit rate: 4563.0 | accuracy: 0.38
step_num: 10200 | loss: 0.8831 | profit rate: 3723.7 | accuracy: 0.39
step_num: 10400 | loss: 0.4099 | profit rate:  339.6 | accuracy: 0.37
step_num: 10600 | loss: 0.4353 | profit rate:  434.3 | accuracy: 0.37
step_num: 10800 | loss: 0.3250 | profit rate: 1736.2 | accuracy: 0.36
episode:   3/8,耗时:0.47分/1.37分,训练集: | step: 10983 | average_treward:  201.3 | max_treward: 276.6747 | average profit rate: 3500.080
model saved @ step:10983,performance:6216.384,accuracy:0.37
step_num: 11000 | loss: 0.7108 | profit rate:    2.1 | accuracy: 0.67
step_num: 11200 | loss: 0.3846 | profit rate:    0.2 | accuracy: 0.26
step_num: 11400 | loss: 0.2898 | profit rate:    0.2 | accuracy: 0.26
step_num: 11600 | loss: 0.4409 | profit rate:    0.3 | accuracy: 0.25
step_num: 11800 | loss: 0.3635 | profit rate:    0.8 | accuracy: 0.25
step_num: 12000 | loss: 0.8614 | profit rate:   18.1 | accuracy: 0.31
step_num: 12200 | loss: 0.7802 | profit rate:   40.5 | accuracy: 0.34
step_num: 12400 | loss: 0.1833 | profit rate:   86.2 | accuracy: 0.32
step_num: 12600 | loss: 0.7142 | profit rate:   51.1 | accuracy: 0.33
step_num: 12800 | loss: 0.7330 | profit rate:   50.0 | accuracy: 0.32
step_num: 13000 | loss: 0.5823 | profit rate:   59.0 | accuracy: 0.34
step_num: 13200 | loss: 0.6720 | profit rate: 81942.9 | accuracy: 0.37
step_num: 13400 | loss: 1.1169 | profit rate: 792340.1 | accuracy: 0.39
step_num: 13600 | loss: 0.1531 | profit rate: 103606.5 | accuracy: 0.37
step_num: 13800 | loss: 0.7550 | profit rate: 1135417.7 | accuracy: 0.39
step_num: 14000 | loss: 0.3260 | profit rate: 166577.1 | accuracy: 0.38
step_num: 14200 | loss: 0.1399 | profit rate: 22417.5 | accuracy: 0.37
step_num: 14400 | loss: 0.3865 | profit rate: 76143.8 | accuracy: 0.36
step_num: 14600 | loss: 0.2755 | profit rate: 395588.1 | accuracy: 0.36
model saved @ step:14644,performance:518810.909,accuracy:0.36
step_num: 14800 | loss: 0.6155 | profit rate:    0.6 | accuracy: 0.25
step_num: 15000 | loss: 0.2123 | profit rate:    0.9 | accuracy: 0.26
step_num: 15200 | loss: 0.2671 | profit rate:    0.4 | accuracy: 0.21
step_num: 15400 | loss: 0.1785 | profit rate:    1.0 | accuracy: 0.18
step_num: 15600 | loss: 0.8897 | profit rate:    4.4 | accuracy: 0.25
step_num: 15800 | loss: 0.7969 | profit rate:  121.4 | accuracy: 0.30
step_num: 16000 | loss: 0.5832 | profit rate:  147.6 | accuracy: 0.31
step_num: 16200 | loss: 0.8222 | profit rate:  276.7 | accuracy: 0.31
step_num: 16400 | loss: 0.6866 | profit rate:   33.3 | accuracy: 0.30
step_num: 16600 | loss: 0.7063 | profit rate:  120.4 | accuracy: 0.33
step_num: 16800 | loss: 1.0299 | profit rate: 1585.2 | accuracy: 0.35
step_num: 17000 | loss: 0.9693 | profit rate: 965984.6 | accuracy: 0.38
step_num: 17200 | loss: 0.3064 | profit rate: 102460.5 | accuracy: 0.37
step_num: 17400 | loss: 1.0179 | profit rate: 286409.0 | accuracy: 0.38
step_num: 17600 | loss: 0.6061 | profit rate: 71816.3 | accuracy: 0.38
step_num: 17800 | loss: 0.6993 | profit rate: 8639.0 | accuracy: 0.36
step_num: 18000 | loss: 0.3495 | profit rate: 16251.6 | accuracy: 0.36
step_num: 18200 | loss: 0.3564 | profit rate: 94165.5 | accuracy: 0.36
episode:   5/8,耗时:0.46分/2.29分,训练集: | step: 18305 | average_treward:  255.5 | max_treward: 345.7965 | average profit rate: 138456.149
step_num: 18400 | loss: 0.6831 | profit rate:    0.3 | accuracy: 0.27
step_num: 18600 | loss: 0.3644 | profit rate:    0.5 | accuracy: 0.31
step_num: 18800 | loss: 0.2345 | profit rate:    0.1 | accuracy: 0.26
step_num: 19000 | loss: 0.2958 | profit rate:    0.5 | accuracy: 0.25
step_num: 19200 | loss: 0.2934 | profit rate:    1.3 | accuracy: 0.26
step_num: 19400 | loss: 0.9488 | profit rate:  616.3 | accuracy: 0.34
step_num: 19600 | loss: 0.3656 | profit rate:  182.3 | accuracy: 0.34
step_num: 19800 | loss: 0.4972 | profit rate:  269.2 | accuracy: 0.34
step_num: 20000 | loss: 0.2838 | profit rate:  158.2 | accuracy: 0.34
step_num: 20200 | loss: 0.6676 | profit rate:  180.2 | accuracy: 0.36
step_num: 20400 | loss: 1.0568 | profit rate:  889.4 | accuracy: 0.38
step_num: 20600 | loss: 1.3628 | profit rate: 1262614.5 | accuracy: 0.41
step_num: 20800 | loss: 0.5368 | profit rate: 393095.3 | accuracy: 0.41
step_num: 21000 | loss: 0.7837 | profit rate: 666625.1 | accuracy: 0.40
step_num: 21200 | loss: 0.5255 | profit rate: 375537.1 | accuracy: 0.40
step_num: 21400 | loss: 0.5269 | profit rate: 58394.7 | accuracy: 0.38
step_num: 21600 | loss: 0.0642 | profit rate: 98604.6 | accuracy: 0.37
step_num: 21800 | loss: 0.2458 | profit rate: 241614.2 | accuracy: 0.37
step_num: 22000 | loss: 0.8584 | profit rate:    0.6 | accuracy: 0.40
step_num: 22200 | loss: 0.7755 | profit rate:    0.3 | accuracy: 0.29
step_num: 22400 | loss: 0.7555 | profit rate:    0.3 | accuracy: 0.28
step_num: 22600 | loss: 0.4203 | profit rate:    0.8 | accuracy: 0.27
step_num: 22800 | loss: 0.4768 | profit rate:    2.4 | accuracy: 0.25
step_num: 23000 | loss: 1.2324 | profit rate:  171.8 | accuracy: 0.32
step_num: 23200 | loss: 0.4989 | profit rate:  183.6 | accuracy: 0.34
step_num: 23400 | loss: 0.3013 | profit rate:  945.7 | accuracy: 0.34
step_num: 23600 | loss: 0.5306 | profit rate:  351.3 | accuracy: 0.34
step_num: 23800 | loss: 0.8501 | profit rate:  158.2 | accuracy: 0.34
step_num: 24000 | loss: 0.4283 | profit rate:   95.9 | accuracy: 0.35
step_num: 24200 | loss: 1.2570 | profit rate: 56158.2 | accuracy: 0.38
step_num: 24400 | loss: 0.8421 | profit rate: 446527.6 | accuracy: 0.40
step_num: 24600 | loss: 0.6622 | profit rate: 185966.1 | accuracy: 0.38
step_num: 24800 | loss: 0.7741 | profit rate: 1485555.3 | accuracy: 0.39
step_num: 25000 | loss: 0.1208 | profit rate: 168300.8 | accuracy: 0.37
step_num: 25200 | loss: 0.1931 | profit rate: 59459.7 | accuracy: 0.36
step_num: 25400 | loss: 0.5397 | profit rate: 63202.5 | accuracy: 0.35
step_num: 25600 | loss: 0.6225 | profit rate: 334339.8 | accuracy: 0.35
episode:   7/8,耗时:0.46分/3.21分,训练集: | step: 25627 | average_treward:  276.2 | max_treward: 345.7965 | average profit rate: 246988.657
step_num: 25800 | loss: 0.3479 | profit rate:    0.2 | accuracy: 0.21
step_num: 26000 | loss: 0.2564 | profit rate:    0.5 | accuracy: 0.25
step_num: 26200 | loss: 0.3949 | profit rate:    0.3 | accuracy: 0.24
step_num: 26400 | loss: 0.1544 | profit rate:    0.7 | accuracy: 0.22
step_num: 26600 | loss: 1.6647 | profit rate:    2.4 | accuracy: 0.28
step_num: 26800 | loss: 1.0354 | profit rate:  119.2 | accuracy: 0.33
step_num: 27000 | loss: 0.4050 | profit rate:   53.4 | accuracy: 0.32
step_num: 27200 | loss: 0.8289 | profit rate:   87.7 | accuracy: 0.32
step_num: 27400 | loss: 0.6649 | profit rate:   37.9 | accuracy: 0.31
step_num: 27600 | loss: 1.0141 | profit rate:   20.5 | accuracy: 0.32
step_num: 27800 | loss: 1.0489 | profit rate: 1131.0 | accuracy: 0.34
step_num: 28000 | loss: 1.1039 | profit rate: 203391.5 | accuracy: 0.37
step_num: 28200 | loss: 0.0473 | profit rate: 46014.5 | accuracy: 0.36
step_num: 28400 | loss: 0.8409 | profit rate: 212712.8 | accuracy: 0.37
step_num: 28600 | loss: 0.1209 | profit rate: 47619.4 | accuracy: 0.36
step_num: 28800 | loss: 0.2822 | profit rate: 4271.1 | accuracy: 0.34
step_num: 29000 | loss: 0.2912 | profit rate: 4036.6 | accuracy: 0.33
step_num: 29200 | loss: 0.4428 | profit rate: 19841.3 | accuracy: 0.33
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 33%|      | 104/312 [00:00<00:00, 1029.79it/s] 70%|   | 217/312 [00:00<00:00, 1088.50it/s]100%|| 312/312 [00:00<00:00, 1109.85it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-12T00:00:00 | *** GOING LONG ***
2023-01-12T00:00:00's price 18200.8008, buy 0.05488769 units.
2023-01-12T00:00:00 | current balance = 0.00
2023-01-12T00:00:00 | balance:0.00+units:0.05488769*price:18200.8008=net_wealth:999.0010
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.05488769 units.
2023-06-08T12:00:00 | current balance = 1458.54
2023-06-08T12:00:00 | net performance [%] = 45.8542
2023-06-08T12:00:00 | number of trades [#] = 2
==================================================
Trial 5 Complete [00h 03m 43s]
net_wealth: 1460.00206518385

Best net_wealth So Far: 1460.00206518385
Total elapsed time: 00h 23m 06s

Search: Running Trial #6

Value             |Best Value So Far |Hyperparameter
12                |6                 |horizon
365               |225               |lookback
False             |True              |MarketFactor
20                |7                 |lags
0.9               |0.98              |gamma
2000              |64                |memory_size
32                |32                |batch_size
64                |10                |n_steps
0.97              |0.98              |gae_lambda
2                 |2                 |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4211.000000   4223.000000
mean      0.000429    19869.492402  ...   19963.985421  19920.121151
std       0.028054    16157.511856  ...   16194.110629  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7611.790039   7559.520020
50%       0.000696    11383.668066  ...   11474.980469  11460.440430
75%       0.011799    29453.128320  ...   29322.589844  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 1000 | loss: 1.0169 | profit rate:    0.7 | accuracy: 0.34
step_num: 1200 | loss: 0.5416 | profit rate:    0.3 | accuracy: 0.33
step_num: 1400 | loss: 0.5268 | profit rate:    0.2 | accuracy: 0.33
step_num: 1600 | loss: 0.5191 | profit rate:    0.1 | accuracy: 0.33
step_num: 1800 | loss: 0.5266 | profit rate:    0.0 | accuracy: 0.33
step_num: 2000 | loss: 0.4954 | profit rate:    0.9 | accuracy: 0.35
step_num: 2200 | loss: 0.5245 | profit rate:    5.1 | accuracy: 0.35
step_num: 2400 | loss: 0.5299 | profit rate:    0.2 | accuracy: 0.34
step_num: 2600 | loss: 0.5394 | profit rate:    4.3 | accuracy: 0.34
step_num: 2800 | loss: 0.4972 | profit rate:    2.6 | accuracy: 0.34
step_num: 3000 | loss: 0.5053 | profit rate:    0.4 | accuracy: 0.34
step_num: 3200 | loss: 0.5237 | profit rate:    0.3 | accuracy: 0.34
step_num: 3400 | loss: 0.4763 | profit rate:    0.5 | accuracy: 0.34
episode:   1/8,耗时:1.53分/1.53分,训练集: | step: 3522 | average_treward:   64.3 | max_treward: 64.3171 | average profit rate:  7.873
model saved @ step:3522,performance:7.873,accuracy:0.34
step_num: 3600 | loss: 0.4930 | profit rate:    0.6 | accuracy: 0.13
step_num: 3800 | loss: 0.4936 | profit rate:    0.7 | accuracy: 0.26
step_num: 4000 | loss: 0.4722 | profit rate:    0.4 | accuracy: 0.29
step_num: 4200 | loss: 0.4564 | profit rate:    8.8 | accuracy: 0.33
step_num: 4400 | loss: 0.4991 | profit rate:    0.0 | accuracy: 0.34
step_num: 4600 | loss: 0.4738 | profit rate:    0.1 | accuracy: 0.32
step_num: 4800 | loss: 0.4402 | profit rate:    0.0 | accuracy: 0.31
step_num: 5000 | loss: 0.4274 | profit rate:    0.0 | accuracy: 0.29
step_num: 5200 | loss: 0.4178 | profit rate:    0.0 | accuracy: 0.29
step_num: 5400 | loss: 0.3701 | profit rate:    0.0 | accuracy: 0.28
step_num: 5600 | loss: 0.3931 | profit rate:    1.7 | accuracy: 0.28
step_num: 5800 | loss: 0.3885 | profit rate:   38.1 | accuracy: 0.28
step_num: 6000 | loss: 0.3866 | profit rate:    0.8 | accuracy: 0.27
step_num: 6200 | loss: 0.3351 | profit rate:   21.1 | accuracy: 0.28
step_num: 6400 | loss: 0.3303 | profit rate:   50.8 | accuracy: 0.27
step_num: 6600 | loss: 0.3024 | profit rate:   55.3 | accuracy: 0.27
step_num: 6800 | loss: 0.3071 | profit rate:  679.2 | accuracy: 0.27
step_num: 7000 | loss: 0.3115 | profit rate: 11037.9 | accuracy: 0.27
model saved @ step:7044,performance:19139.479,accuracy:0.28
step_num: 7200 | loss: 0.3538 | profit rate:    0.3 | accuracy: 0.22
step_num: 7400 | loss: 0.3583 | profit rate:    0.1 | accuracy: 0.24
step_num: 7600 | loss: 0.4057 | profit rate:    4.4 | accuracy: 0.33
step_num: 7800 | loss: 0.3502 | profit rate:    7.1 | accuracy: 0.35
step_num: 8000 | loss: 0.3953 | profit rate:    6.1 | accuracy: 0.35
step_num: 8200 | loss: 0.3948 | profit rate:    6.3 | accuracy: 0.32
step_num: 8400 | loss: 0.3922 | profit rate:    4.1 | accuracy: 0.31
step_num: 8600 | loss: 0.4280 | profit rate:    0.7 | accuracy: 0.31
step_num: 8800 | loss: 0.4168 | profit rate:    1.1 | accuracy: 0.28
step_num: 9000 | loss: 0.4059 | profit rate:    6.6 | accuracy: 0.28
step_num: 9200 | loss: 0.3987 | profit rate: 504613.4 | accuracy: 0.30
step_num: 9400 | loss: 0.4032 | profit rate: 250671.8 | accuracy: 0.30
step_num: 9600 | loss: 0.3424 | profit rate: 329517.8 | accuracy: 0.30
step_num: 9800 | loss: 0.3424 | profit rate: 2998490.1 | accuracy: 0.30
step_num: 10000 | loss: 0.3429 | profit rate: 3330967.5 | accuracy: 0.30
step_num: 10200 | loss: 0.3745 | profit rate: 20033868.1 | accuracy: 0.29
step_num: 10400 | loss: 0.3742 | profit rate: 1179262925.6 | accuracy: 0.30
episode:   3/8,耗时:2.11分/5.79分,训练集: | step: 10566 | average_treward:  244.3 | max_treward: 440.3313 | average profit rate: 1904806827.570
model saved @ step:10566,performance:5714401335.357,accuracy:0.30
step_num: 10600 | loss: 0.4065 | profit rate:    0.4 | accuracy: 0.14
step_num: 10800 | loss: 0.3748 | profit rate:    0.9 | accuracy: 0.23
step_num: 11000 | loss: 0.3961 | profit rate:    0.5 | accuracy: 0.24
step_num: 11200 | loss: 0.3621 | profit rate:  649.4 | accuracy: 0.33
step_num: 11400 | loss: 0.3775 | profit rate:   32.1 | accuracy: 0.32
step_num: 11600 | loss: 0.3880 | profit rate:  786.5 | accuracy: 0.32
step_num: 11800 | loss: 0.3692 | profit rate: 1332.5 | accuracy: 0.30
step_num: 12000 | loss: 0.3808 | profit rate: 10164.0 | accuracy: 0.30
step_num: 12200 | loss: 0.3837 | profit rate: 14874.7 | accuracy: 0.30
step_num: 12400 | loss: 0.3730 | profit rate: 8954.8 | accuracy: 0.29
step_num: 12600 | loss: 0.3752 | profit rate: 691738.1 | accuracy: 0.29
step_num: 12800 | loss: 0.3823 | profit rate: 3220613636.5 | accuracy: 0.31
step_num: 13000 | loss: 0.3599 | profit rate: 2038431382.7 | accuracy: 0.30
step_num: 13200 | loss: 0.3524 | profit rate: 28959272190.4 | accuracy: 0.31
step_num: 13400 | loss: 0.3370 | profit rate: 70351035705.3 | accuracy: 0.31
step_num: 13600 | loss: 0.4321 | profit rate: 683324392002.0 | accuracy: 0.30
step_num: 13800 | loss: 0.4321 | profit rate: 15477266989078.2 | accuracy: 0.30
step_num: 14000 | loss: 0.4358 | profit rate: 739522488920108.0 | accuracy: 0.30
model saved @ step:14088,performance:1387000451416811.000,accuracy:0.31
step_num: 14200 | loss: 0.3696 | profit rate:    0.5 | accuracy: 0.11
step_num: 14400 | loss: 0.3828 | profit rate:    2.3 | accuracy: 0.22
step_num: 14600 | loss: 0.3899 | profit rate:  386.8 | accuracy: 0.31
step_num: 14800 | loss: 0.4116 | profit rate: 32998.3 | accuracy: 0.35
step_num: 15000 | loss: 0.3860 | profit rate: 25331.9 | accuracy: 0.35
step_num: 15200 | loss: 0.3754 | profit rate: 646372.6 | accuracy: 0.33
step_num: 15400 | loss: 0.4151 | profit rate: 586278.7 | accuracy: 0.31
step_num: 15600 | loss: 0.4067 | profit rate: 793668.6 | accuracy: 0.32
step_num: 15800 | loss: 0.4129 | profit rate: 2052983.2 | accuracy: 0.31
step_num: 16000 | loss: 0.3953 | profit rate: 24866593.5 | accuracy: 0.31
step_num: 16200 | loss: 0.4380 | profit rate: 7658368993.2 | accuracy: 0.32
step_num: 16400 | loss: 0.4118 | profit rate: 5064388743319.3 | accuracy: 0.33
step_num: 16600 | loss: 0.4017 | profit rate: 4001652969441.4 | accuracy: 0.32
step_num: 16800 | loss: 0.3980 | profit rate: 48003167534605.3 | accuracy: 0.33
step_num: 17000 | loss: 0.4099 | profit rate: 1290124532383967.8 | accuracy: 0.33
step_num: 17200 | loss: 0.4578 | profit rate: 67823968266389384.0 | accuracy: 0.33
step_num: 17400 | loss: 0.4307 | profit rate: 36127534858588741632.0 | accuracy: 0.34
step_num: 17600 | loss: 0.4249 | profit rate: 440606690953819193344.0 | accuracy: 0.34
episode:   5/8,耗时:2.14分/10.07分,训练集: | step: 17610 | average_treward:  414.0 | max_treward: 752.6809 | average profit rate: 88252952265181134848.000
model saved @ step:17610,performance:441263374319739797504.000,accuracy:0.34
step_num: 17800 | loss: 0.3841 | profit rate:    2.0 | accuracy: 0.24
step_num: 18000 | loss: 0.4240 | profit rate:    0.8 | accuracy: 0.25
step_num: 18200 | loss: 0.4142 | profit rate: 23612.7 | accuracy: 0.37
step_num: 18400 | loss: 0.4174 | profit rate:  581.6 | accuracy: 0.35
step_num: 18600 | loss: 0.4211 | profit rate: 13381.8 | accuracy: 0.35
step_num: 18800 | loss: 0.3813 | profit rate: 84074.5 | accuracy: 0.33
step_num: 19000 | loss: 0.4143 | profit rate: 464912.0 | accuracy: 0.32
step_num: 19200 | loss: 0.4367 | profit rate: 160483.0 | accuracy: 0.32
step_num: 19400 | loss: 0.3819 | profit rate: 419251.9 | accuracy: 0.30
step_num: 19600 | loss: 0.3894 | profit rate: 10349754.0 | accuracy: 0.31
step_num: 19800 | loss: 0.4636 | profit rate: 507496262726.3 | accuracy: 0.32
step_num: 20000 | loss: 0.4353 | profit rate: 1539798949359.9 | accuracy: 0.33
step_num: 20200 | loss: 0.3671 | profit rate: 2119477834847.6 | accuracy: 0.33
step_num: 20400 | loss: 0.4177 | profit rate: 8598531411990.1 | accuracy: 0.33
step_num: 20600 | loss: 0.4004 | profit rate: 265056274335300.0 | accuracy: 0.33
step_num: 20800 | loss: 0.4322 | profit rate: 494436999302084736.0 | accuracy: 0.34
step_num: 21000 | loss: 0.4216 | profit rate: 4916569644379766784.0 | accuracy: 0.34
model saved @ step:21132,performance:77264139631521398784.000,accuracy:0.34
step_num: 21200 | loss: 0.4262 | profit rate:    2.9 | accuracy: 0.23
step_num: 21400 | loss: 0.3540 | profit rate:    3.6 | accuracy: 0.25
step_num: 21600 | loss: 0.3783 | profit rate:   12.7 | accuracy: 0.30
step_num: 21800 | loss: 0.4055 | profit rate: 129465.7 | accuracy: 0.38
step_num: 22000 | loss: 0.4403 | profit rate: 113718.2 | accuracy: 0.37
step_num: 22200 | loss: 0.4719 | profit rate: 2911766.7 | accuracy: 0.38
step_num: 22400 | loss: 0.4322 | profit rate: 3104772.0 | accuracy: 0.35
step_num: 22600 | loss: 0.4305 | profit rate: 889400.1 | accuracy: 0.35
step_num: 22800 | loss: 0.4531 | profit rate: 3321778.6 | accuracy: 0.35
step_num: 23000 | loss: 0.3987 | profit rate: 13256085.6 | accuracy: 0.34
step_num: 23200 | loss: 0.4319 | profit rate: 3671899630.5 | accuracy: 0.34
step_num: 23400 | loss: 0.4159 | profit rate: 6470065910767.4 | accuracy: 0.36
step_num: 23600 | loss: 0.4415 | profit rate: 8831037449379.4 | accuracy: 0.35
step_num: 23800 | loss: 0.3836 | profit rate: 117781158032760.8 | accuracy: 0.36
step_num: 24000 | loss: 0.4042 | profit rate: 1214283845638808.5 | accuracy: 0.35
step_num: 24200 | loss: 0.3535 | profit rate: 44171183098395912.0 | accuracy: 0.35
step_num: 24400 | loss: 0.4097 | profit rate: 583648688614089687040.0 | accuracy: 0.36
step_num: 24600 | loss: 0.3772 | profit rate: 3996595563516020654080.0 | accuracy: 0.35
episode:   7/8,耗时:2.14分/14.34分,训练集: | step: 24654 | average_treward:  524.0 | max_treward: 826.3204 | average profit rate: 1038602826075854864384.000
model saved @ step:24654,performance:6751690881573557633024.000,accuracy:0.36
step_num: 24800 | loss: 0.3816 | profit rate:    4.3 | accuracy: 0.35
step_num: 25000 | loss: 0.3651 | profit rate:    6.3 | accuracy: 0.26
step_num: 25200 | loss: 0.4183 | profit rate: 28180.7 | accuracy: 0.37
step_num: 25400 | loss: 0.4054 | profit rate: 169375.2 | accuracy: 0.40
step_num: 25600 | loss: 0.4089 | profit rate: 863541.4 | accuracy: 0.38
step_num: 25800 | loss: 0.4137 | profit rate: 7434252.7 | accuracy: 0.37
step_num: 26000 | loss: 0.4492 | profit rate: 11443466.4 | accuracy: 0.35
step_num: 26200 | loss: 0.4418 | profit rate: 1773176.0 | accuracy: 0.36
step_num: 26400 | loss: 0.3688 | profit rate: 12053818.7 | accuracy: 0.34
step_num: 26600 | loss: 0.3963 | profit rate: 264225877.1 | accuracy: 0.35
step_num: 26800 | loss: 0.3918 | profit rate: 1765618166145.8 | accuracy: 0.35
step_num: 27000 | loss: 0.3984 | profit rate: 50756413537705.0 | accuracy: 0.36
step_num: 27200 | loss: 0.4026 | profit rate: 143893362321704.0 | accuracy: 0.36
step_num: 27400 | loss: 0.3825 | profit rate: 2504844962419855.0 | accuracy: 0.36
step_num: 27600 | loss: 0.3757 | profit rate: 112512372703395072.0 | accuracy: 0.35
step_num: 27800 | loss: 0.4065 | profit rate: 480317060714964779008.0 | accuracy: 0.36
step_num: 28000 | loss: 0.3993 | profit rate: 70523004644184316444672.0 | accuracy: 0.37
model saved @ step:28176,performance:396105209525905632788480.000,accuracy:0.36
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 34%|      | 102/299 [00:00<00:00, 1009.96it/s] 72%|  | 216/299 [00:00<00:00, 1086.14it/s]100%|| 299/299 [00:00<00:00, 1084.95it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-11T12:00:00 | *** GOING LONG ***
2023-01-11T12:00:00's price 17943.2598, buy 0.0556755 units.
2023-01-11T12:00:00 | current balance = 0.00
2023-01-11T12:00:00 | balance:0.00+units:0.0556755*price:17943.2598=net_wealth:999.0010
--------------------------------------------------
2023-01-17T12:00:00 | *** GOING SHORT ***
2023-01-17T12:00:00's price 21134.8105, sell 0.0556755 units.
2023-01-17T12:00:00 | current balance = 1175.52
2023-01-17T12:00:00 | balance:1175.52+units:0.0*price:21134.8105=net_wealth:1175.5155
--------------------------------------------------
2023-01-24T00:00:00 | *** GOING LONG ***
2023-01-24T00:00:00's price 22917.6602, buy 0.0512417 units.
2023-01-24T00:00:00 | current balance = 0.00
2023-01-24T00:00:00 | balance:0.00+units:0.0512417*price:22917.6602=net_wealth:1174.3412
--------------------------------------------------
2023-01-30T12:00:00 | *** GOING SHORT ***
2023-01-30T12:00:00's price 22826.1504, sell 0.0512417 units.
2023-01-30T12:00:00 | current balance = 1168.48
2023-01-30T12:00:00 | balance:1168.48+units:0.0*price:22826.1504=net_wealth:1168.4824
--------------------------------------------------
2023-01-31T00:00:00 | *** GOING LONG ***
2023-01-31T00:00:00's price 22865.4297, buy 0.05105147 units.
2023-01-31T00:00:00 | current balance = 0.00
2023-01-31T00:00:00 | balance:0.00+units:0.05105147*price:22865.4297=net_wealth:1167.3151
--------------------------------------------------
2023-02-01T12:00:00 | *** GOING SHORT ***
2023-02-01T12:00:00's price 23732.6602, sell 0.05105147 units.
2023-02-01T12:00:00 | current balance = 1210.38
2023-02-01T12:00:00 | balance:1210.38+units:0.0*price:23732.6602=net_wealth:1210.3769
--------------------------------------------------
2023-02-02T12:00:00 | *** GOING LONG ***
2023-02-02T12:00:00's price 23488.9395, buy 0.05147812 units.
2023-02-02T12:00:00 | current balance = 0.00
2023-02-02T12:00:00 | balance:0.00+units:0.05147812*price:23488.9395=net_wealth:1209.1677
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING SHORT ***
2023-02-07T00:00:00's price 22977.2402, sell 0.05147812 units.
2023-02-07T00:00:00 | current balance = 1181.64
2023-02-07T00:00:00 | balance:1181.64+units:0.0*price:22977.2402=net_wealth:1181.6436
--------------------------------------------------
2023-02-17T00:00:00 | *** GOING LONG ***
2023-02-17T00:00:00's price 23789.8203, buy 0.04962046 units.
2023-02-17T00:00:00 | current balance = 0.00
2023-02-17T00:00:00 | balance:0.00+units:0.04962046*price:23789.8203=net_wealth:1180.4631
--------------------------------------------------
2023-03-07T12:00:00 | *** GOING SHORT ***
2023-03-07T12:00:00's price 22197.9609, sell 0.04962046 units.
2023-03-07T12:00:00 | current balance = 1100.37
2023-03-07T12:00:00 | balance:1100.37+units:0.0*price:22197.9609=net_wealth:1100.3728
--------------------------------------------------
2023-03-09T00:00:00 | *** GOING LONG ***
2023-03-09T00:00:00's price 21669.3809, buy 0.05072929 units.
2023-03-09T00:00:00 | current balance = 0.00
2023-03-09T00:00:00 | balance:0.00+units:0.05072929*price:21669.3809=net_wealth:1099.2736
--------------------------------------------------
2023-03-10T12:00:00 | *** GOING SHORT ***
2023-03-10T12:00:00's price 20150.6895, sell 0.05072929 units.
2023-03-10T12:00:00 | current balance = 1021.21
2023-03-10T12:00:00 | balance:1021.21+units:0.0*price:20150.6895=net_wealth:1021.2092
--------------------------------------------------
2023-03-19T00:00:00 | *** GOING LONG ***
2023-03-19T00:00:00's price 27160.9805, buy 0.037560790000000004 units.
2023-03-19T00:00:00 | current balance = 0.00
2023-03-19T00:00:00 | balance:0.00+units:0.037560790000000004*price:27160.9805=net_wealth:1020.1890
--------------------------------------------------
2023-03-30T00:00:00 | *** GOING SHORT ***
2023-03-30T00:00:00's price 28644.7891, sell 0.037560790000000004 units.
2023-03-30T00:00:00 | current balance = 1074.85
2023-03-30T00:00:00 | balance:1074.85+units:0.0*price:28644.7891=net_wealth:1074.8461
--------------------------------------------------
2023-04-26T00:00:00 | *** GOING LONG ***
2023-04-26T00:00:00's price 28952.3203, buy 0.03708757 units.
2023-04-26T00:00:00 | current balance = 0.00
2023-04-26T00:00:00 | balance:0.00+units:0.03708757*price:28952.3203=net_wealth:1073.7723
--------------------------------------------------
2023-05-17T12:00:00 | *** GOING SHORT ***
2023-05-17T12:00:00's price 27405.6094, sell 0.03708757 units.
2023-05-17T12:00:00 | current balance = 1015.39
2023-05-17T12:00:00 | balance:1015.39+units:0.0*price:27405.6094=net_wealth:1015.3922
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1015.39
2023-06-08T12:00:00 | net performance [%] = 1.5392
2023-06-08T12:00:00 | number of trades [#] = 16
==================================================
Trial 6 Complete [00h 16m 31s]
net_wealth: 1015.3921885833896

Best net_wealth So Far: 1460.00206518385
Total elapsed time: 00h 39m 37s

Search: Running Trial #7

Value             |Best Value So Far |Hyperparameter
2                 |6                 |horizon
365               |225               |lookback
False             |True              |MarketFactor
5                 |7                 |lags
0.95              |0.98              |gamma
32                |64                |memory_size
32                |32                |batch_size
32                |10                |n_steps
0.98              |0.98              |gae_lambda
1                 |2                 |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.5615 | profit rate:    0.7 | accuracy: 0.37
step_num: 400 | loss: 0.6101 | profit rate:    0.6 | accuracy: 0.34
step_num: 600 | loss: 0.8320 | profit rate:    0.8 | accuracy: 0.32
step_num: 800 | loss: 0.5963 | profit rate:    0.6 | accuracy: 0.32
step_num: 1000 | loss: 0.8412 | profit rate:    1.1 | accuracy: 0.34
step_num: 1200 | loss: 0.2893 | profit rate:    0.6 | accuracy: 0.35
step_num: 1400 | loss: 0.4544 | profit rate:    0.4 | accuracy: 0.35
step_num: 1600 | loss: 0.5318 | profit rate:    0.4 | accuracy: 0.35
step_num: 1800 | loss: 0.4868 | profit rate:    0.3 | accuracy: 0.36
step_num: 2000 | loss: 0.3252 | profit rate:    0.4 | accuracy: 0.36
step_num: 2200 | loss: 0.9084 | profit rate:    0.5 | accuracy: 0.36
step_num: 2400 | loss: 0.7734 | profit rate:    0.4 | accuracy: 0.37
step_num: 2600 | loss: 0.5713 | profit rate:    0.4 | accuracy: 0.37
step_num: 2800 | loss: 0.4582 | profit rate:    0.2 | accuracy: 0.37
step_num: 3000 | loss: 0.5011 | profit rate:    0.2 | accuracy: 0.37
step_num: 3200 | loss: 0.5403 | profit rate:    0.2 | accuracy: 0.38
step_num: 3400 | loss: 0.5206 | profit rate:    0.3 | accuracy: 0.38
episode:   1/8,耗时:0.41分/0.41分,训练集: | step: 3537 | average_treward:   84.4 | max_treward: 84.3670 | average profit rate:  0.217
model saved @ step:3537,performance:0.217,accuracy:0.39
step_num: 3600 | loss: 0.6295 | profit rate:    0.6 | accuracy: 0.42
step_num: 3800 | loss: 0.4789 | profit rate:    0.7 | accuracy: 0.46
step_num: 4000 | loss: 0.5291 | profit rate:    0.6 | accuracy: 0.45
step_num: 4200 | loss: 0.5431 | profit rate:    0.7 | accuracy: 0.46
step_num: 4400 | loss: 0.5811 | profit rate:    0.6 | accuracy: 0.46
step_num: 4600 | loss: 0.4570 | profit rate:    1.6 | accuracy: 0.48
step_num: 4800 | loss: 0.5256 | profit rate:    0.5 | accuracy: 0.47
step_num: 5000 | loss: 0.5668 | profit rate:    0.4 | accuracy: 0.46
step_num: 5200 | loss: 0.5352 | profit rate:    0.3 | accuracy: 0.46
step_num: 5400 | loss: 0.5722 | profit rate:    0.3 | accuracy: 0.47
step_num: 5600 | loss: 0.4766 | profit rate:    1.5 | accuracy: 0.48
step_num: 5800 | loss: 0.6171 | profit rate:    6.7 | accuracy: 0.49
step_num: 6000 | loss: 0.5251 | profit rate:    1.8 | accuracy: 0.49
step_num: 6200 | loss: 0.5276 | profit rate:    5.5 | accuracy: 0.49
step_num: 6400 | loss: 0.6866 | profit rate:    1.7 | accuracy: 0.49
step_num: 6600 | loss: 0.5380 | profit rate:    0.7 | accuracy: 0.49
step_num: 6800 | loss: 0.4675 | profit rate:    0.4 | accuracy: 0.48
step_num: 7000 | loss: 0.3968 | profit rate:    0.3 | accuracy: 0.48
model saved @ step:7074,performance:0.282,accuracy:0.48
step_num: 7200 | loss: 0.5188 | profit rate:    0.3 | accuracy: 0.39
step_num: 7400 | loss: 0.4885 | profit rate:    0.2 | accuracy: 0.41
step_num: 7600 | loss: 0.4658 | profit rate:    0.3 | accuracy: 0.39
step_num: 7800 | loss: 0.4708 | profit rate:    0.4 | accuracy: 0.42
step_num: 8000 | loss: 0.5113 | profit rate:    0.8 | accuracy: 0.44
step_num: 8200 | loss: 0.3775 | profit rate:    1.2 | accuracy: 0.46
step_num: 8400 | loss: 0.1103 | profit rate:    0.5 | accuracy: 0.45
step_num: 8600 | loss: 0.5651 | profit rate:    0.2 | accuracy: 0.45
step_num: 8800 | loss: 0.4753 | profit rate:    0.2 | accuracy: 0.46
step_num: 9000 | loss: 0.3879 | profit rate:    0.2 | accuracy: 0.47
step_num: 9200 | loss: 0.5691 | profit rate:    1.5 | accuracy: 0.48
step_num: 9400 | loss: 0.5372 | profit rate:    3.7 | accuracy: 0.49
step_num: 9600 | loss: 0.5036 | profit rate:    1.4 | accuracy: 0.48
step_num: 9800 | loss: 0.5318 | profit rate:    1.7 | accuracy: 0.48
step_num: 10000 | loss: 0.5400 | profit rate:    0.6 | accuracy: 0.48
step_num: 10200 | loss: 0.3936 | profit rate:    0.6 | accuracy: 0.48
step_num: 10400 | loss: 0.6610 | profit rate:    0.6 | accuracy: 0.47
step_num: 10600 | loss: 0.4814 | profit rate:    0.5 | accuracy: 0.47
episode:   3/8,耗时:0.45分/1.32分,训练集: | step: 10611 | average_treward:  125.0 | max_treward: 191.8813 | average profit rate:  0.345
model saved @ step:10611,performance:0.536,accuracy:0.47
step_num: 10800 | loss: 0.5501 | profit rate:    0.3 | accuracy: 0.43
step_num: 11000 | loss: 0.5077 | profit rate:    0.3 | accuracy: 0.43
step_num: 11200 | loss: 0.6247 | profit rate:    0.5 | accuracy: 0.43
step_num: 11400 | loss: 0.5399 | profit rate:    0.6 | accuracy: 0.44
step_num: 11600 | loss: 0.4457 | profit rate:    2.1 | accuracy: 0.47
step_num: 11800 | loss: 0.5116 | profit rate:    0.9 | accuracy: 0.46
step_num: 12000 | loss: 0.4711 | profit rate:    0.4 | accuracy: 0.46
step_num: 12200 | loss: 0.6049 | profit rate:    0.1 | accuracy: 0.46
step_num: 12400 | loss: 0.4658 | profit rate:    0.1 | accuracy: 0.47
step_num: 12600 | loss: 0.4293 | profit rate:    0.2 | accuracy: 0.48
step_num: 12800 | loss: 0.5447 | profit rate:    1.1 | accuracy: 0.49
step_num: 13000 | loss: 0.5840 | profit rate:    0.5 | accuracy: 0.49
step_num: 13200 | loss: 0.5175 | profit rate:    0.4 | accuracy: 0.49
step_num: 13400 | loss: 0.4281 | profit rate:    0.4 | accuracy: 0.49
step_num: 13600 | loss: 0.5722 | profit rate:    0.2 | accuracy: 0.48
step_num: 13800 | loss: 0.4354 | profit rate:    0.4 | accuracy: 0.48
step_num: 14000 | loss: 0.5993 | profit rate:    0.6 | accuracy: 0.48
step_num: 14200 | loss: 0.6162 | profit rate:    0.6 | accuracy: 0.42
step_num: 14400 | loss: 0.4987 | profit rate:    0.6 | accuracy: 0.43
step_num: 14600 | loss: 0.3828 | profit rate:    0.4 | accuracy: 0.44
step_num: 14800 | loss: 0.5406 | profit rate:    1.0 | accuracy: 0.46
step_num: 15000 | loss: 0.5004 | profit rate:    0.7 | accuracy: 0.45
step_num: 15200 | loss: 0.5719 | profit rate:    3.0 | accuracy: 0.48
step_num: 15400 | loss: 0.4536 | profit rate:    0.8 | accuracy: 0.46
step_num: 15600 | loss: 0.4607 | profit rate:    0.6 | accuracy: 0.47
step_num: 15800 | loss: 0.4066 | profit rate:    0.1 | accuracy: 0.47
step_num: 16000 | loss: 0.5395 | profit rate:    0.1 | accuracy: 0.47
step_num: 16200 | loss: 0.5423 | profit rate:    0.5 | accuracy: 0.49
step_num: 16400 | loss: 0.4871 | profit rate:    2.6 | accuracy: 0.49
step_num: 16600 | loss: 0.5228 | profit rate:    0.6 | accuracy: 0.49
step_num: 16800 | loss: 0.5603 | profit rate:    0.7 | accuracy: 0.49
step_num: 17000 | loss: 0.3057 | profit rate:    0.3 | accuracy: 0.49
step_num: 17200 | loss: 0.4052 | profit rate:    0.3 | accuracy: 0.48
step_num: 17400 | loss: 0.5962 | profit rate:    0.6 | accuracy: 0.49
step_num: 17600 | loss: 0.6544 | profit rate:    1.2 | accuracy: 0.49
episode:   5/8,耗时:0.47分/2.26分,训练集: | step: 17685 | average_treward:  137.2 | max_treward: 191.8813 | average profit rate:  0.568
step_num: 17800 | loss: 0.5969 | profit rate:    0.3 | accuracy: 0.41
step_num: 18000 | loss: 0.5393 | profit rate:    0.5 | accuracy: 0.44
step_num: 18200 | loss: 0.2373 | profit rate:    0.4 | accuracy: 0.41
step_num: 18400 | loss: 0.5140 | profit rate:    0.8 | accuracy: 0.44
step_num: 18600 | loss: 0.8823 | profit rate:    1.5 | accuracy: 0.45
step_num: 18800 | loss: 0.3913 | profit rate:    1.8 | accuracy: 0.47
step_num: 19000 | loss: 0.4955 | profit rate:    0.8 | accuracy: 0.45
step_num: 19200 | loss: 0.8255 | profit rate:    0.1 | accuracy: 0.45
step_num: 19400 | loss: 0.5298 | profit rate:    0.1 | accuracy: 0.45
step_num: 19600 | loss: 0.4842 | profit rate:    0.1 | accuracy: 0.47
step_num: 19800 | loss: 0.6440 | profit rate:    0.7 | accuracy: 0.48
step_num: 20000 | loss: 0.5778 | profit rate:    1.7 | accuracy: 0.48
step_num: 20200 | loss: 0.5695 | profit rate:    0.3 | accuracy: 0.48
step_num: 20400 | loss: 0.6874 | profit rate:    0.4 | accuracy: 0.48
step_num: 20600 | loss: 0.4622 | profit rate:    0.2 | accuracy: 0.47
step_num: 20800 | loss: 0.6064 | profit rate:    0.3 | accuracy: 0.47
step_num: 21000 | loss: 0.4333 | profit rate:    0.6 | accuracy: 0.48
step_num: 21200 | loss: 0.5412 | profit rate:    0.9 | accuracy: 0.48
step_num: 21400 | loss: 0.2693 | profit rate:    0.4 | accuracy: 0.32
step_num: 21600 | loss: 0.3787 | profit rate:    0.3 | accuracy: 0.36
step_num: 21800 | loss: 0.5523 | profit rate:    0.8 | accuracy: 0.38
step_num: 22000 | loss: 0.4612 | profit rate:    0.7 | accuracy: 0.39
step_num: 22200 | loss: 0.6245 | profit rate:    1.6 | accuracy: 0.43
step_num: 22400 | loss: 0.4574 | profit rate:    0.9 | accuracy: 0.43
step_num: 22600 | loss: 0.5683 | profit rate:    0.5 | accuracy: 0.42
step_num: 22800 | loss: 0.5529 | profit rate:    0.1 | accuracy: 0.42
step_num: 23000 | loss: 0.5422 | profit rate:    0.1 | accuracy: 0.43
step_num: 23200 | loss: 0.4874 | profit rate:    0.2 | accuracy: 0.45
step_num: 23400 | loss: 0.5053 | profit rate:    2.0 | accuracy: 0.46
step_num: 23600 | loss: 0.6222 | profit rate:    0.7 | accuracy: 0.46
step_num: 23800 | loss: 0.6784 | profit rate:    0.6 | accuracy: 0.46
step_num: 24000 | loss: 0.5472 | profit rate:    0.5 | accuracy: 0.47
step_num: 24200 | loss: 0.5495 | profit rate:    0.3 | accuracy: 0.46
step_num: 24400 | loss: 0.5252 | profit rate:    1.2 | accuracy: 0.46
step_num: 24600 | loss: 0.4900 | profit rate:    1.5 | accuracy: 0.46
episode:   7/8,耗时:0.46分/3.17分,训练集: | step: 24759 | average_treward:  139.7 | max_treward: 191.8813 | average profit rate:  0.821
step_num: 24800 | loss: 0.6716 | profit rate:    0.7 | accuracy: 0.48
step_num: 25000 | loss: 0.4614 | profit rate:    0.6 | accuracy: 0.30
step_num: 25200 | loss: 0.3861 | profit rate:    0.3 | accuracy: 0.32
step_num: 25400 | loss: 0.4378 | profit rate:    0.7 | accuracy: 0.33
step_num: 25600 | loss: 0.4445 | profit rate:    0.8 | accuracy: 0.36
step_num: 25800 | loss: 0.4745 | profit rate:    2.0 | accuracy: 0.40
step_num: 26000 | loss: 0.4059 | profit rate:    0.9 | accuracy: 0.39
step_num: 26200 | loss: 0.4945 | profit rate:    1.0 | accuracy: 0.39
step_num: 26400 | loss: 0.4833 | profit rate:    0.2 | accuracy: 0.39
step_num: 26600 | loss: 0.6248 | profit rate:    0.1 | accuracy: 0.41
step_num: 26800 | loss: 0.3369 | profit rate:    0.4 | accuracy: 0.43
step_num: 27000 | loss: 0.6127 | profit rate:    2.4 | accuracy: 0.44
step_num: 27200 | loss: 0.1310 | profit rate:    1.1 | accuracy: 0.43
step_num: 27400 | loss: 0.5139 | profit rate:    0.8 | accuracy: 0.43
step_num: 27600 | loss: 0.1991 | profit rate:    0.4 | accuracy: 0.43
step_num: 27800 | loss: 0.1441 | profit rate:    0.3 | accuracy: 0.42
step_num: 28000 | loss: 0.5379 | profit rate:    0.6 | accuracy: 0.42
step_num: 28200 | loss: 0.3651 | profit rate:    1.0 | accuracy: 0.41
----------------------------------------finished----------------------------------------
  0%|          | 0/314 [00:00<?, ?it/s] 32%|      | 101/314 [00:00<00:00, 1009.99it/s] 67%|   | 209/314 [00:00<00:00, 1051.17it/s]100%|| 314/314 [00:00<00:00, 1063.64it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-21T12:00:00 | *** GOING LONG ***
2023-01-21T12:00:00's price 22783.5508, buy 0.04384742 units.
2023-01-21T12:00:00 | current balance = 0.00
2023-01-21T12:00:00 | balance:0.00+units:0.04384742*price:22783.5508=net_wealth:999.0010
--------------------------------------------------
2023-01-22T00:00:00 | *** GOING SHORT ***
2023-01-22T00:00:00's price 22783.6094, sell 0.04384742 units.
2023-01-22T00:00:00 | current balance = 998.00
2023-01-22T00:00:00 | balance:998.00+units:0.0*price:22783.6094=net_wealth:998.0046
--------------------------------------------------
2023-01-22T12:00:00 | *** GOING LONG ***
2023-01-22T12:00:00's price 22707.8809, buy 0.04390575 units.
2023-01-22T12:00:00 | current balance = 0.00
2023-01-22T12:00:00 | balance:0.00+units:0.04390575*price:22707.8809=net_wealth:997.0076
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.04390575 units.
2023-06-08T12:00:00 | current balance = 1166.72
2023-06-08T12:00:00 | net performance [%] = 16.6717
2023-06-08T12:00:00 | number of trades [#] = 4
==================================================
Trial 7 Complete [00h 03m 40s]
net_wealth: 1167.8847088245016

Best net_wealth So Far: 1460.00206518385
Total elapsed time: 00h 43m 17s

Search: Running Trial #8

Value             |Best Value So Far |Hyperparameter
6                 |6                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
20                |7                 |lags
0.7               |0.98              |gamma
512               |64                |memory_size
16                |32                |batch_size
5                 |10                |n_steps
0.97              |0.98              |gae_lambda
10                |2                 |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4217.000000   4223.000000
mean      0.000429    19869.492402  ...   19942.230868  19920.121151
std       0.028054    16157.511856  ...   16192.845577  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7581.100098   7559.520020
50%       0.000696    11383.668066  ...   11465.839844  11460.440430
75%       0.011799    29453.128320  ...   29311.699219  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 400 | loss: 0.3935 | profit rate:    2.3 | accuracy: 0.33
step_num: 600 | loss: 0.4006 | profit rate:    7.2 | accuracy: 0.34
step_num: 800 | loss: 0.4542 | profit rate:    2.3 | accuracy: 0.34
step_num: 1000 | loss: 0.4646 | profit rate:    1.0 | accuracy: 0.33
step_num: 1200 | loss: 0.3368 | profit rate:    3.5 | accuracy: 0.34
step_num: 1400 | loss: 0.4036 | profit rate:    1.4 | accuracy: 0.34
step_num: 1600 | loss: 0.3791 | profit rate:    2.4 | accuracy: 0.34
step_num: 1800 | loss: 0.4270 | profit rate:    2.6 | accuracy: 0.34
step_num: 2000 | loss: 0.4486 | profit rate:    6.0 | accuracy: 0.35
step_num: 2200 | loss: 0.4112 | profit rate:    6.3 | accuracy: 0.35
step_num: 2400 | loss: 0.4621 | profit rate:    1.3 | accuracy: 0.35
step_num: 2600 | loss: 0.3510 | profit rate:    1.3 | accuracy: 0.34
step_num: 2800 | loss: 0.1801 | profit rate:    0.7 | accuracy: 0.33
step_num: 3000 | loss: 0.1017 | profit rate:    0.7 | accuracy: 0.31
episode:   1/8,耗时:1.00分/1.00分,训练集: | step: 3157 | average_treward:   10.8 | max_treward: 10.8445 | average profit rate:  0.650
model saved @ step:3157,performance:0.650,accuracy:0.30
step_num: 3200 | loss: 0.0669 | profit rate:    1.0 | accuracy: 0.00
step_num: 3400 | loss: 0.0675 | profit rate:    1.1 | accuracy: 0.10
step_num: 3600 | loss: 0.1323 | profit rate:    0.9 | accuracy: 0.18
step_num: 3800 | loss: 0.2300 | profit rate:    0.8 | accuracy: 0.22
step_num: 4000 | loss: 0.1685 | profit rate:    0.5 | accuracy: 0.18
step_num: 4200 | loss: 0.1087 | profit rate:    0.4 | accuracy: 0.17
step_num: 4400 | loss: 0.1364 | profit rate:    1.6 | accuracy: 0.18
step_num: 4600 | loss: 0.1351 | profit rate:    1.6 | accuracy: 0.17
step_num: 4800 | loss: 0.0998 | profit rate:    1.4 | accuracy: 0.16
step_num: 5000 | loss: 0.0638 | profit rate:    1.3 | accuracy: 0.15
step_num: 5200 | loss: 0.1147 | profit rate:    1.8 | accuracy: 0.15
step_num: 5400 | loss: 0.1311 | profit rate:    1.7 | accuracy: 0.15
step_num: 5600 | loss: 0.1586 | profit rate:    1.4 | accuracy: 0.15
step_num: 5800 | loss: 0.1230 | profit rate:    1.1 | accuracy: 0.15
step_num: 6000 | loss: 0.0848 | profit rate:    1.4 | accuracy: 0.15
step_num: 6200 | loss: 0.0721 | profit rate:    1.8 | accuracy: 0.14
model saved @ step:6314,performance:1.490,accuracy:0.14
step_num: 6400 | loss: 0.0585 | profit rate:    1.1 | accuracy: 0.02
step_num: 6600 | loss: 0.0777 | profit rate:    0.8 | accuracy: 0.11
step_num: 6800 | loss: 0.0970 | profit rate:    0.5 | accuracy: 0.10
step_num: 7000 | loss: 0.1738 | profit rate:    1.5 | accuracy: 0.14
step_num: 7200 | loss: 0.2345 | profit rate:    0.4 | accuracy: 0.16
step_num: 7400 | loss: 0.1622 | profit rate:    0.4 | accuracy: 0.15
step_num: 7600 | loss: 0.1247 | profit rate:    1.1 | accuracy: 0.16
step_num: 7800 | loss: 0.1161 | profit rate:    1.4 | accuracy: 0.15
step_num: 8000 | loss: 0.1272 | profit rate:    3.3 | accuracy: 0.16
step_num: 8200 | loss: 0.2085 | profit rate:   12.4 | accuracy: 0.17
step_num: 8400 | loss: 0.2679 | profit rate:   10.3 | accuracy: 0.18
step_num: 8600 | loss: 0.2027 | profit rate:   30.1 | accuracy: 0.18
step_num: 8800 | loss: 0.1719 | profit rate:   40.0 | accuracy: 0.18
step_num: 9000 | loss: 0.1314 | profit rate:    9.6 | accuracy: 0.18
step_num: 9200 | loss: 0.1063 | profit rate:   32.4 | accuracy: 0.17
step_num: 9400 | loss: 0.0533 | profit rate:   20.4 | accuracy: 0.17
episode:   3/8,耗时:1.11分/3.25分,训练集: | step: 9471 | average_treward:   65.0 | max_treward: 105.1688 | average profit rate:  7.639
model saved @ step:9471,performance:20.775,accuracy:0.16
step_num: 9600 | loss: 0.0277 | profit rate:    0.9 | accuracy: 0.00
step_num: 9800 | loss: 0.0330 | profit rate:    0.8 | accuracy: 0.05
step_num: 10000 | loss: 0.0938 | profit rate:    1.9 | accuracy: 0.11
step_num: 10200 | loss: 0.0765 | profit rate:    0.9 | accuracy: 0.10
step_num: 10400 | loss: 0.0856 | profit rate:    0.9 | accuracy: 0.09
step_num: 10600 | loss: 0.0232 | profit rate:    0.8 | accuracy: 0.08
step_num: 10800 | loss: 0.1064 | profit rate:    5.6 | accuracy: 0.11
step_num: 11000 | loss: 0.1338 | profit rate:   19.3 | accuracy: 0.13
step_num: 11200 | loss: 0.1007 | profit rate:   47.0 | accuracy: 0.13
step_num: 11400 | loss: 0.1207 | profit rate:  140.4 | accuracy: 0.14
step_num: 11600 | loss: 0.1832 | profit rate:  162.1 | accuracy: 0.15
step_num: 11800 | loss: 0.2303 | profit rate:  289.5 | accuracy: 0.16
step_num: 12000 | loss: 0.2593 | profit rate:   98.4 | accuracy: 0.16
step_num: 12200 | loss: 0.1204 | profit rate:  131.1 | accuracy: 0.15
step_num: 12400 | loss: 0.0705 | profit rate:  256.5 | accuracy: 0.15
step_num: 12600 | loss: 0.1438 | profit rate:  378.7 | accuracy: 0.15
model saved @ step:12628,performance:380.375,accuracy:0.15
step_num: 12800 | loss: 0.1049 | profit rate:    2.6 | accuracy: 0.10
step_num: 13000 | loss: 0.0995 | profit rate:    2.1 | accuracy: 0.12
step_num: 13200 | loss: 0.1378 | profit rate:    5.3 | accuracy: 0.15
step_num: 13400 | loss: 0.2070 | profit rate:    0.7 | accuracy: 0.17
step_num: 13600 | loss: 0.1958 | profit rate:    0.5 | accuracy: 0.16
step_num: 13800 | loss: 0.1344 | profit rate:    1.1 | accuracy: 0.17
step_num: 14000 | loss: 0.1249 | profit rate:    6.9 | accuracy: 0.19
step_num: 14200 | loss: 0.1631 | profit rate:   29.3 | accuracy: 0.20
step_num: 14400 | loss: 0.1160 | profit rate:   31.1 | accuracy: 0.18
step_num: 14600 | loss: 0.1209 | profit rate:   84.1 | accuracy: 0.19
step_num: 14800 | loss: 0.1843 | profit rate:  140.7 | accuracy: 0.19
step_num: 15000 | loss: 0.1457 | profit rate:  211.2 | accuracy: 0.19
step_num: 15200 | loss: 0.1174 | profit rate:  376.4 | accuracy: 0.18
step_num: 15400 | loss: 0.0969 | profit rate:  479.6 | accuracy: 0.18
step_num: 15600 | loss: 0.0849 | profit rate: 2397.8 | accuracy: 0.18
episode:   5/8,耗时:1.12分/5.50分,训练集: | step: 15785 | average_treward:  118.2 | max_treward: 217.3381 | average profit rate: 718.560
model saved @ step:15785,performance:3189.512,accuracy:0.18
step_num: 15800 | loss: 0.0692 | profit rate:    1.0 | accuracy: 0.00
step_num: 16000 | loss: 0.0642 | profit rate:    1.4 | accuracy: 0.06
step_num: 16200 | loss: 0.0538 | profit rate:    2.2 | accuracy: 0.10
step_num: 16400 | loss: 0.0975 | profit rate:    9.6 | accuracy: 0.14
step_num: 16600 | loss: 0.0869 | profit rate:    7.6 | accuracy: 0.12
step_num: 16800 | loss: 0.0434 | profit rate:    9.1 | accuracy: 0.11
step_num: 17000 | loss: 0.0928 | profit rate:   55.7 | accuracy: 0.13
step_num: 17200 | loss: 0.1662 | profit rate:  233.3 | accuracy: 0.15
step_num: 17400 | loss: 0.1502 | profit rate:  646.8 | accuracy: 0.16
step_num: 17600 | loss: 0.1112 | profit rate: 1461.3 | accuracy: 0.16
step_num: 17800 | loss: 0.0974 | profit rate: 2918.7 | accuracy: 0.16
step_num: 18000 | loss: 0.1084 | profit rate: 5681.9 | accuracy: 0.16
step_num: 18200 | loss: 0.1330 | profit rate: 6778.1 | accuracy: 0.16
step_num: 18400 | loss: 0.1365 | profit rate: 3209.5 | accuracy: 0.17
step_num: 18600 | loss: 0.1107 | profit rate: 9185.3 | accuracy: 0.16
step_num: 18800 | loss: 0.1354 | profit rate: 61058.3 | accuracy: 0.18
model saved @ step:18942,performance:266741.918,accuracy:0.18
step_num: 19000 | loss: 0.1605 | profit rate:    0.8 | accuracy: 0.10
step_num: 19200 | loss: 0.2224 | profit rate:    4.5 | accuracy: 0.18
step_num: 19400 | loss: 0.1870 | profit rate:    1.5 | accuracy: 0.20
step_num: 19600 | loss: 0.1682 | profit rate:    4.9 | accuracy: 0.21
step_num: 19800 | loss: 0.1236 | profit rate:    5.5 | accuracy: 0.20
step_num: 20000 | loss: 0.0655 | profit rate:    3.9 | accuracy: 0.18
step_num: 20200 | loss: 0.1367 | profit rate:   91.4 | accuracy: 0.21
step_num: 20400 | loss: 0.1333 | profit rate:  240.2 | accuracy: 0.21
step_num: 20600 | loss: 0.0776 | profit rate:  267.8 | accuracy: 0.20
step_num: 20800 | loss: 0.1008 | profit rate:  168.9 | accuracy: 0.18
step_num: 21000 | loss: 0.0896 | profit rate:  547.6 | accuracy: 0.18
step_num: 21200 | loss: 0.0797 | profit rate: 1369.9 | accuracy: 0.17
step_num: 21400 | loss: 0.1114 | profit rate: 1967.2 | accuracy: 0.17
step_num: 21600 | loss: 0.0781 | profit rate: 2009.9 | accuracy: 0.17
step_num: 21800 | loss: 0.1057 | profit rate: 8006.6 | accuracy: 0.17
step_num: 22000 | loss: 0.1200 | profit rate: 56680.4 | accuracy: 0.18
episode:   7/8,耗时:1.13分/7.77分,训练集: | step: 22099 | average_treward:  176.2 | max_treward: 336.4702 | average profit rate: 50493.381
step_num: 22200 | loss: 0.1431 | profit rate:    1.0 | accuracy: 0.22
step_num: 22400 | loss: 0.2121 | profit rate:   56.6 | accuracy: 0.33
step_num: 22600 | loss: 0.1786 | profit rate:   16.0 | accuracy: 0.28
step_num: 22800 | loss: 0.2072 | profit rate:   22.3 | accuracy: 0.27
step_num: 23000 | loss: 0.1338 | profit rate:   13.3 | accuracy: 0.25
step_num: 23200 | loss: 0.0993 | profit rate:   18.8 | accuracy: 0.23
step_num: 23400 | loss: 0.1564 | profit rate:  372.1 | accuracy: 0.25
step_num: 23600 | loss: 0.1615 | profit rate:  605.5 | accuracy: 0.24
step_num: 23800 | loss: 0.1719 | profit rate: 3189.9 | accuracy: 0.24
step_num: 24000 | loss: 0.2524 | profit rate: 14721.9 | accuracy: 0.26
step_num: 24200 | loss: 0.2452 | profit rate: 14356.8 | accuracy: 0.26
step_num: 24400 | loss: 0.2212 | profit rate: 15276.7 | accuracy: 0.25
step_num: 24600 | loss: 0.1866 | profit rate: 15929.1 | accuracy: 0.25
step_num: 24800 | loss: 0.1350 | profit rate: 12605.2 | accuracy: 0.24
step_num: 25000 | loss: 0.0706 | profit rate: 48304.2 | accuracy: 0.23
step_num: 25200 | loss: 0.0555 | profit rate: 41271.4 | accuracy: 0.22
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 40%|      | 119/299 [00:00<00:00, 1182.53it/s] 85%| | 254/299 [00:00<00:00, 1273.32it/s]100%|| 299/299 [00:00<00:00, 1268.93it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-25T00:00:00 | *** GOING LONG ***
2023-01-25T00:00:00's price 22598.4707, buy 0.04420653 units.
2023-01-25T00:00:00 | current balance = 0.00
2023-01-25T00:00:00 | balance:0.00+units:0.04420653*price:22598.4707=net_wealth:999.0010
--------------------------------------------------
2023-03-13T00:00:00 | *** GOING SHORT ***
2023-03-13T00:00:00's price 22106.6406, sell 0.04420653 units.
2023-03-13T00:00:00 | current balance = 976.28
2023-03-13T00:00:00 | balance:976.28+units:0.0*price:22106.6406=net_wealth:976.2816
--------------------------------------------------
2023-03-21T00:00:00 | *** GOING LONG ***
2023-03-21T00:00:00's price 28040.1309, buy 0.03478248 units.
2023-03-21T00:00:00 | current balance = 0.00
2023-03-21T00:00:00 | balance:0.00+units:0.03478248*price:28040.1309=net_wealth:975.3063
--------------------------------------------------
2023-04-25T12:00:00 | *** GOING SHORT ***
2023-04-25T12:00:00's price 28300.7891, sell 0.03478248 units.
2023-04-25T12:00:00 | current balance = 983.39
2023-04-25T12:00:00 | balance:983.39+units:0.0*price:28300.7891=net_wealth:983.3883
--------------------------------------------------
2023-05-09T12:00:00 | *** GOING LONG ***
2023-05-09T12:00:00's price 27628.2695, buy 0.03555796 units.
2023-05-09T12:00:00 | current balance = 0.00
2023-05-09T12:00:00 | balance:0.00+units:0.03555796*price:27628.2695=net_wealth:982.4059
--------------------------------------------------
2023-05-16T12:00:00 | *** GOING SHORT ***
2023-05-16T12:00:00's price 27033.8398, sell 0.03555796 units.
2023-05-16T12:00:00 | current balance = 960.31
2023-05-16T12:00:00 | balance:960.31+units:0.0*price:27033.8398=net_wealth:960.3079
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 960.31
2023-06-08T12:00:00 | net performance [%] = -3.9692
2023-06-08T12:00:00 | number of trades [#] = 6
==================================================
Trial 8 Complete [00h 08m 56s]
net_wealth: 960.3079227184428

Best net_wealth So Far: 1460.00206518385
Total elapsed time: 00h 52m 13s

Search: Running Trial #9

Value             |Best Value So Far |Hyperparameter
8                 |6                 |horizon
225               |225               |lookback
True              |True              |MarketFactor
14                |7                 |lags
0.98              |0.98              |gamma
32                |64                |memory_size
16                |32                |batch_size
32                |10                |n_steps
0.98              |0.98              |gae_lambda
2                 |2                 |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4201.000000   4209.000000
mean      0.000424    19921.326125  ...   20001.002399  19971.309209
std       0.028069    16159.303521  ...   16195.567078  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7652.140137   7625.000000
50%       0.000696    11410.370947  ...   11503.139648  11477.000000
75%       0.011720    29502.909082  ...   29409.009766  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 1.1340 | profit rate:    1.0 | accuracy: 0.37
step_num: 400 | loss: 1.0265 | profit rate:    0.6 | accuracy: 0.35
step_num: 600 | loss: 0.8398 | profit rate:    0.6 | accuracy: 0.33
step_num: 800 | loss: 0.3364 | profit rate:    0.1 | accuracy: 0.33
step_num: 1000 | loss: 1.2383 | profit rate:    0.1 | accuracy: 0.31
step_num: 1200 | loss: 0.8270 | profit rate:    0.2 | accuracy: 0.30
step_num: 1400 | loss: 0.8695 | profit rate:    0.2 | accuracy: 0.29
step_num: 1600 | loss: 1.0926 | profit rate:    0.6 | accuracy: 0.29
step_num: 1800 | loss: 0.4007 | profit rate:    0.2 | accuracy: 0.29
step_num: 2000 | loss: 0.4886 | profit rate:    0.2 | accuracy: 0.29
step_num: 2200 | loss: 0.2803 | profit rate:   11.5 | accuracy: 0.31
step_num: 2400 | loss: 0.6727 | profit rate:  154.6 | accuracy: 0.32
step_num: 2600 | loss: 0.3410 | profit rate:    1.3 | accuracy: 0.32
step_num: 2800 | loss: 0.7355 | profit rate:   80.9 | accuracy: 0.34
step_num: 3000 | loss: 0.6811 | profit rate:   15.2 | accuracy: 0.33
step_num: 3200 | loss: 0.7217 | profit rate:    1.1 | accuracy: 0.33
step_num: 3400 | loss: 0.5450 | profit rate:    0.2 | accuracy: 0.33
step_num: 3600 | loss: 0.4661 | profit rate:    0.0 | accuracy: 0.32
episode:   1/8,耗时:0.43分/0.43分,训练集: | step: 3654 | average_treward:  -26.3 | max_treward: 0.0000 | average profit rate:  0.057
step_num: 3800 | loss: 0.3399 | profit rate:    0.2 | accuracy: 0.12
step_num: 4000 | loss: 0.1372 | profit rate:    0.2 | accuracy: 0.10
step_num: 4200 | loss: 0.1759 | profit rate:    0.1 | accuracy: 0.13
step_num: 4400 | loss: 0.7941 | profit rate:    0.0 | accuracy: 0.15
step_num: 4600 | loss: 0.2736 | profit rate:    0.0 | accuracy: 0.20
step_num: 4800 | loss: 1.2870 | profit rate:    4.6 | accuracy: 0.27
step_num: 5000 | loss: 0.5453 | profit rate:    1.7 | accuracy: 0.27
step_num: 5200 | loss: 0.6727 | profit rate:    4.4 | accuracy: 0.27
step_num: 5400 | loss: 0.8623 | profit rate:    1.9 | accuracy: 0.29
step_num: 5600 | loss: 0.6057 | profit rate:    0.9 | accuracy: 0.31
step_num: 5800 | loss: 1.3383 | profit rate:   24.5 | accuracy: 0.34
step_num: 6000 | loss: 0.8790 | profit rate: 210527.3 | accuracy: 0.37
step_num: 6200 | loss: 0.9522 | profit rate: 2940.6 | accuracy: 0.38
step_num: 6400 | loss: 0.9396 | profit rate: 71651.2 | accuracy: 0.39
step_num: 6600 | loss: 0.5708 | profit rate: 9855.6 | accuracy: 0.39
step_num: 6800 | loss: 0.8446 | profit rate: 6525.3 | accuracy: 0.40
step_num: 7000 | loss: 0.7965 | profit rate:   47.0 | accuracy: 0.40
step_num: 7200 | loss: 0.5063 | profit rate:    1.0 | accuracy: 0.39
model saved @ step:7308,performance:0.868,accuracy:0.39
step_num: 7400 | loss: 1.1008 | profit rate:    0.1 | accuracy: 0.43
step_num: 7600 | loss: 0.0840 | profit rate:    0.1 | accuracy: 0.17
step_num: 7800 | loss: 0.3028 | profit rate:    0.0 | accuracy: 0.17
step_num: 8000 | loss: 0.1307 | profit rate:    0.0 | accuracy: 0.14
step_num: 8200 | loss: 0.0787 | profit rate:    0.0 | accuracy: 0.14
step_num: 8400 | loss: 0.6814 | profit rate:   57.4 | accuracy: 0.24
step_num: 8600 | loss: 0.0561 | profit rate:   23.9 | accuracy: 0.24
step_num: 8800 | loss: 0.7555 | profit rate:   47.0 | accuracy: 0.23
step_num: 9000 | loss: 0.0693 | profit rate:    2.6 | accuracy: 0.24
step_num: 9200 | loss: 0.5522 | profit rate:    5.1 | accuracy: 0.25
step_num: 9400 | loss: 0.4045 | profit rate:   43.2 | accuracy: 0.29
step_num: 9600 | loss: 0.4706 | profit rate: 648284.9 | accuracy: 0.32
step_num: 9800 | loss: 1.1188 | profit rate: 28858.6 | accuracy: 0.33
step_num: 10000 | loss: 0.7571 | profit rate: 97831.7 | accuracy: 0.33
step_num: 10200 | loss: 0.8254 | profit rate: 104217.8 | accuracy: 0.34
step_num: 10400 | loss: 0.7260 | profit rate: 263484.1 | accuracy: 0.34
step_num: 10600 | loss: 0.3684 | profit rate: 76987.1 | accuracy: 0.32
step_num: 10800 | loss: 0.3037 | profit rate: 41319.8 | accuracy: 0.32
episode:   3/8,耗时:0.49分/1.39分,训练集: | step: 10962 | average_treward:  121.9 | max_treward: 277.8298 | average profit rate: 3894.909
model saved @ step:10962,performance:11683.802,accuracy:0.31
step_num: 11000 | loss: 1.0244 | profit rate:    0.3 | accuracy: 0.41
step_num: 11200 | loss: 0.0170 | profit rate:    0.0 | accuracy: 0.13
step_num: 11400 | loss: 0.9105 | profit rate:    0.0 | accuracy: 0.11
step_num: 11600 | loss: 0.0399 | profit rate:    0.0 | accuracy: 0.11
step_num: 11800 | loss: 0.3733 | profit rate:    0.0 | accuracy: 0.11
step_num: 12000 | loss: 1.7337 | profit rate:    1.6 | accuracy: 0.20
step_num: 12200 | loss: 0.1247 | profit rate:    8.7 | accuracy: 0.24
step_num: 12400 | loss: 0.0160 | profit rate:    5.5 | accuracy: 0.21
step_num: 12600 | loss: 0.4327 | profit rate:    0.4 | accuracy: 0.23
step_num: 12800 | loss: 0.4181 | profit rate:    1.0 | accuracy: 0.25
step_num: 13000 | loss: 0.6335 | profit rate:    1.5 | accuracy: 0.27
step_num: 13200 | loss: 1.9479 | profit rate: 4959.5 | accuracy: 0.31
step_num: 13400 | loss: 0.6199 | profit rate: 323645.2 | accuracy: 0.33
step_num: 13600 | loss: 0.8159 | profit rate: 48291.8 | accuracy: 0.32
step_num: 13800 | loss: 0.9734 | profit rate: 244087.7 | accuracy: 0.34
step_num: 14000 | loss: 0.4427 | profit rate: 24312.8 | accuracy: 0.33
step_num: 14200 | loss: 0.0341 | profit rate: 14263.7 | accuracy: 0.32
step_num: 14400 | loss: 0.1979 | profit rate: 19589.8 | accuracy: 0.31
step_num: 14600 | loss: 0.1047 | profit rate: 15787.0 | accuracy: 0.30
step_num: 14800 | loss: 0.0138 | profit rate:    0.2 | accuracy: 0.06
step_num: 15000 | loss: 0.0269 | profit rate:    0.2 | accuracy: 0.04
step_num: 15200 | loss: 0.1215 | profit rate:    0.2 | accuracy: 0.08
step_num: 15400 | loss: 0.0481 | profit rate:    0.2 | accuracy: 0.09
step_num: 15600 | loss: 0.8957 | profit rate:    3.3 | accuracy: 0.15
step_num: 15800 | loss: 1.1147 | profit rate:  154.8 | accuracy: 0.22
step_num: 16000 | loss: 0.0158 | profit rate:   73.0 | accuracy: 0.20
step_num: 16200 | loss: 0.9628 | profit rate:  120.0 | accuracy: 0.21
step_num: 16400 | loss: 0.6413 | profit rate:  157.4 | accuracy: 0.23
step_num: 16600 | loss: 0.6729 | profit rate:   98.3 | accuracy: 0.24
step_num: 16800 | loss: 0.4969 | profit rate: 99738.2 | accuracy: 0.28
step_num: 17000 | loss: 0.7589 | profit rate: 22038029.8 | accuracy: 0.31
step_num: 17200 | loss: 0.0720 | profit rate: 140942.2 | accuracy: 0.30
step_num: 17400 | loss: 0.4801 | profit rate: 4830568.0 | accuracy: 0.32
step_num: 17600 | loss: 0.3244 | profit rate: 423744.3 | accuracy: 0.31
step_num: 17800 | loss: 0.2867 | profit rate: 242260.0 | accuracy: 0.31
step_num: 18000 | loss: 0.1991 | profit rate: 172073.0 | accuracy: 0.31
step_num: 18200 | loss: 0.5590 | profit rate: 105444.3 | accuracy: 0.30
episode:   5/8,耗时:0.47分/2.35分,训练集: | step: 18270 | average_treward:  183.2 | max_treward: 281.0609 | average profit rate: 27581.387
model saved @ step:18270,performance:110435.194,accuracy:0.29
step_num: 18400 | loss: 0.0603 | profit rate:    0.1 | accuracy: 0.20
step_num: 18600 | loss: 0.1137 | profit rate:    0.1 | accuracy: 0.09
step_num: 18800 | loss: 0.0422 | profit rate:    0.0 | accuracy: 0.10
step_num: 19000 | loss: 0.4559 | profit rate:    0.0 | accuracy: 0.10
step_num: 19200 | loss: 1.2676 | profit rate:    0.0 | accuracy: 0.14
step_num: 19400 | loss: 0.7917 | profit rate:   12.3 | accuracy: 0.24
step_num: 19600 | loss: 0.5335 | profit rate:    5.7 | accuracy: 0.22
step_num: 19800 | loss: 0.8713 | profit rate:   12.9 | accuracy: 0.22
step_num: 20000 | loss: 0.9965 | profit rate:    4.8 | accuracy: 0.23
step_num: 20200 | loss: 0.9857 | profit rate:    6.8 | accuracy: 0.24
step_num: 20400 | loss: 0.8638 | profit rate:  246.0 | accuracy: 0.28
step_num: 20600 | loss: 1.0655 | profit rate: 1547069.3 | accuracy: 0.32
step_num: 20800 | loss: 0.8934 | profit rate: 28970.9 | accuracy: 0.32
step_num: 21000 | loss: 0.9501 | profit rate: 35161.2 | accuracy: 0.32
step_num: 21200 | loss: 0.4441 | profit rate: 46274.0 | accuracy: 0.32
step_num: 21400 | loss: 1.1982 | profit rate: 23825.7 | accuracy: 0.32
step_num: 21600 | loss: 0.7159 | profit rate: 9945.3 | accuracy: 0.31
step_num: 21800 | loss: 0.0324 | profit rate: 15623.9 | accuracy: 0.29
step_num: 22000 | loss: 0.0270 | profit rate:    0.2 | accuracy: 0.12
step_num: 22200 | loss: 0.2849 | profit rate:    0.2 | accuracy: 0.08
step_num: 22400 | loss: 0.2049 | profit rate:    0.1 | accuracy: 0.09
step_num: 22600 | loss: 0.0917 | profit rate:    0.2 | accuracy: 0.12
step_num: 22800 | loss: 0.7241 | profit rate:    0.1 | accuracy: 0.16
step_num: 23000 | loss: 1.2108 | profit rate:  292.6 | accuracy: 0.26
step_num: 23200 | loss: 0.0551 | profit rate:  109.3 | accuracy: 0.27
step_num: 23400 | loss: 0.4337 | profit rate:   46.7 | accuracy: 0.25
step_num: 23600 | loss: 0.0234 | profit rate:  106.6 | accuracy: 0.26
step_num: 23800 | loss: 0.4057 | profit rate:   69.0 | accuracy: 0.27
step_num: 24000 | loss: 0.6109 | profit rate:  640.3 | accuracy: 0.30
step_num: 24200 | loss: 2.0685 | profit rate: 4238783.7 | accuracy: 0.34
step_num: 24400 | loss: 0.4795 | profit rate: 1488154.7 | accuracy: 0.35
step_num: 24600 | loss: 0.8793 | profit rate: 1893566.2 | accuracy: 0.34
step_num: 24800 | loss: 1.0415 | profit rate: 1717523.7 | accuracy: 0.36
step_num: 25000 | loss: 0.7093 | profit rate: 252575.2 | accuracy: 0.35
step_num: 25200 | loss: 0.1166 | profit rate: 211527.3 | accuracy: 0.33
step_num: 25400 | loss: 0.0483 | profit rate: 192271.4 | accuracy: 0.32
episode:   7/8,耗时:0.48分/3.31分,训练集: | step: 25578 | average_treward:  203.6 | max_treward: 281.0609 | average profit rate: 49244.067
step_num: 25600 | loss: 0.7030 | profit rate:    0.7 | accuracy: 0.30
step_num: 25800 | loss: 0.3823 | profit rate:    0.2 | accuracy: 0.06
step_num: 26000 | loss: 0.6968 | profit rate:    0.1 | accuracy: 0.08
step_num: 26200 | loss: 0.2237 | profit rate:    0.2 | accuracy: 0.11
step_num: 26400 | loss: 0.1332 | profit rate:    0.2 | accuracy: 0.11
step_num: 26600 | loss: 0.7955 | profit rate:   76.0 | accuracy: 0.22
step_num: 26800 | loss: 0.3264 | profit rate:  111.5 | accuracy: 0.25
step_num: 27000 | loss: 0.1100 | profit rate:   78.4 | accuracy: 0.23
step_num: 27200 | loss: 0.6160 | profit rate:   93.6 | accuracy: 0.24
step_num: 27400 | loss: 0.5257 | profit rate:   51.3 | accuracy: 0.25
step_num: 27600 | loss: 0.4665 | profit rate:   15.5 | accuracy: 0.27
step_num: 27800 | loss: 1.9268 | profit rate: 178043.1 | accuracy: 0.31
step_num: 28000 | loss: 1.1077 | profit rate: 2107665.7 | accuracy: 0.33
step_num: 28200 | loss: 0.8040 | profit rate: 280520.3 | accuracy: 0.32
step_num: 28400 | loss: 1.1119 | profit rate: 10749492.7 | accuracy: 0.34
step_num: 28600 | loss: 1.2841 | profit rate: 270654.2 | accuracy: 0.32
step_num: 28800 | loss: 0.1321 | profit rate: 144990.0 | accuracy: 0.32
step_num: 29000 | loss: 1.0074 | profit rate: 140530.6 | accuracy: 0.30
step_num: 29200 | loss: 0.4345 | profit rate: 173644.6 | accuracy: 0.29
----------------------------------------finished----------------------------------------
  0%|          | 0/305 [00:00<?, ?it/s] 31%|      | 96/305 [00:00<00:00, 958.18it/s] 68%|   | 206/305 [00:00<00:00, 1036.02it/s]100%|| 305/305 [00:00<00:00, 1030.07it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-11T00:00:00 | *** GOING LONG ***
2023-01-11T00:00:00's price 17437.7500, buy 0.0572895 units.
2023-01-11T00:00:00 | current balance = 0.00
2023-01-11T00:00:00 | balance:0.00+units:0.0572895*price:17437.7500=net_wealth:999.0010
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.0572895 units.
2023-06-08T12:00:00 | current balance = 1522.37
2023-06-08T12:00:00 | net performance [%] = 52.2366
2023-06-08T12:00:00 | number of trades [#] = 2
==================================================
Trial 9 Complete [00h 03m 49s]
net_wealth: 1523.8896368924688

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 00h 56m 02s

Search: Running Trial #10

Value             |Best Value So Far |Hyperparameter
8                 |8                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
30                |14                |lags
0.95              |0.98              |gamma
2000              |32                |memory_size
32                |16                |batch_size
32                |32                |n_steps
0.96              |0.98              |gae_lambda
0.2               |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4215.000000   4223.000000
mean      0.000429    19869.492402  ...   19949.545452  19920.121151
std       0.028054    16157.511856  ...   16193.203995  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7594.050049   7559.520020
50%       0.000696    11383.668066  ...   11469.940430  11460.440430
75%       0.011799    29453.128320  ...   29312.594727  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9012 | profit rate:   98.1 | accuracy: 0.35
step_num: 1200 | loss: 0.4837 | profit rate:  396.6 | accuracy: 0.35
step_num: 1400 | loss: 0.4697 | profit rate:  249.9 | accuracy: 0.35
step_num: 1600 | loss: 0.4679 | profit rate:  229.9 | accuracy: 0.35
step_num: 1800 | loss: 0.4874 | profit rate:  359.2 | accuracy: 0.35
step_num: 2000 | loss: 0.4839 | profit rate:  331.4 | accuracy: 0.36
step_num: 2200 | loss: 0.4841 | profit rate: 1899.7 | accuracy: 0.36
step_num: 2400 | loss: 0.5133 | profit rate: 1051.2 | accuracy: 0.36
step_num: 2600 | loss: 0.4949 | profit rate:   57.2 | accuracy: 0.35
step_num: 2800 | loss: 0.4536 | profit rate:  103.5 | accuracy: 0.35
step_num: 3000 | loss: 0.4498 | profit rate:  175.8 | accuracy: 0.35
episode:   1/8,耗时:1.32分/1.32分,训练集: | step: 3147 | average_treward:   83.5 | max_treward: 83.5409 | average profit rate: 40.779
model saved @ step:3147,performance:40.779,accuracy:0.34
step_num: 3200 | loss: 0.4126 | profit rate:    1.1 | accuracy: 0.19
step_num: 3400 | loss: 0.4385 | profit rate:    2.3 | accuracy: 0.35
step_num: 3600 | loss: 0.4247 | profit rate:    0.7 | accuracy: 0.33
step_num: 3800 | loss: 0.4206 | profit rate:   37.9 | accuracy: 0.35
step_num: 4000 | loss: 0.4224 | profit rate:   13.1 | accuracy: 0.34
step_num: 4200 | loss: 0.3845 | profit rate:   69.1 | accuracy: 0.35
step_num: 4400 | loss: 0.3968 | profit rate: 38910.4 | accuracy: 0.39
step_num: 4600 | loss: 0.3891 | profit rate: 105416.9 | accuracy: 0.38
step_num: 4800 | loss: 0.3788 | profit rate: 3984275.5 | accuracy: 0.40
step_num: 5000 | loss: 0.4048 | profit rate: 860961548.4 | accuracy: 0.42
step_num: 5200 | loss: 0.4168 | profit rate: 5053349983.8 | accuracy: 0.42
step_num: 5400 | loss: 0.4168 | profit rate: 1287945966.7 | accuracy: 0.41
step_num: 5600 | loss: 0.4150 | profit rate: 45244903937.6 | accuracy: 0.41
step_num: 5800 | loss: 0.4141 | profit rate: 1117410887786.0 | accuracy: 0.41
step_num: 6000 | loss: 0.4270 | profit rate: 47478727066217.3 | accuracy: 0.41
step_num: 6200 | loss: 0.4303 | profit rate: 63474065499474.5 | accuracy: 0.42
model saved @ step:6294,performance:58877130275625.781,accuracy:0.42
step_num: 6400 | loss: 0.4051 | profit rate:    1.0 | accuracy: 0.43
step_num: 6600 | loss: 0.4177 | profit rate:    1.1 | accuracy: 0.36
step_num: 6800 | loss: 0.4264 | profit rate:    0.4 | accuracy: 0.33
step_num: 7000 | loss: 0.4124 | profit rate:    3.2 | accuracy: 0.34
step_num: 7200 | loss: 0.4337 | profit rate:    0.5 | accuracy: 0.33
step_num: 7400 | loss: 0.4491 | profit rate:  763.0 | accuracy: 0.35
step_num: 7600 | loss: 0.4395 | profit rate: 40719.5 | accuracy: 0.37
step_num: 7800 | loss: 0.4379 | profit rate: 103730.0 | accuracy: 0.37
step_num: 8000 | loss: 0.4729 | profit rate: 247396015.6 | accuracy: 0.40
step_num: 8200 | loss: 0.4710 | profit rate: 17749923572.7 | accuracy: 0.41
step_num: 8400 | loss: 0.4868 | profit rate: 226607786136.5 | accuracy: 0.41
step_num: 8600 | loss: 0.4678 | profit rate: 314268881699.6 | accuracy: 0.40
step_num: 8800 | loss: 0.4693 | profit rate: 66822233420838.6 | accuracy: 0.41
step_num: 9000 | loss: 0.4495 | profit rate: 49621202380915.4 | accuracy: 0.41
step_num: 9200 | loss: 0.4363 | profit rate: 9917905419055546.0 | accuracy: 0.41
step_num: 9400 | loss: 0.4408 | profit rate: 17348032471088284.0 | accuracy: 0.41
episode:   3/8,耗时:1.95分/5.21分,训练集: | step: 9441 | average_treward:  478.3 | max_treward: 678.7869 | average profit rate: 4591823654637097.000
model saved @ step:9441,performance:13716593833635624.000,accuracy:0.41
step_num: 9600 | loss: 0.3973 | profit rate:    1.6 | accuracy: 0.41
step_num: 9800 | loss: 0.3770 | profit rate:    2.2 | accuracy: 0.31
step_num: 10000 | loss: 0.3735 | profit rate:   31.1 | accuracy: 0.32
step_num: 10200 | loss: 0.3963 | profit rate:  745.1 | accuracy: 0.34
step_num: 10400 | loss: 0.3815 | profit rate: 2858.8 | accuracy: 0.36
step_num: 10600 | loss: 0.4328 | profit rate: 5449264.6 | accuracy: 0.38
step_num: 10800 | loss: 0.4149 | profit rate: 42174343.8 | accuracy: 0.37
step_num: 11000 | loss: 0.4037 | profit rate: 784933234.3 | accuracy: 0.39
step_num: 11200 | loss: 0.4568 | profit rate: 1719296667301.4 | accuracy: 0.42
step_num: 11400 | loss: 0.4375 | profit rate: 191744778676334.9 | accuracy: 0.42
step_num: 11600 | loss: 0.4828 | profit rate: 285741202521614.8 | accuracy: 0.42
step_num: 11800 | loss: 0.5110 | profit rate: 6533236334589357.0 | accuracy: 0.42
step_num: 12000 | loss: 0.5111 | profit rate: 1469871418847143424.0 | accuracy: 0.43
step_num: 12200 | loss: 0.4612 | profit rate: 25091291416474730496.0 | accuracy: 0.43
step_num: 12400 | loss: 0.4356 | profit rate: 789167505156564451328.0 | accuracy: 0.43
model saved @ step:12588,performance:1056018770646749282304.000,accuracy:0.42
step_num: 12600 | loss: 0.4235 | profit rate:    1.0 | accuracy: 0.00
step_num: 12800 | loss: 0.4411 | profit rate:    5.4 | accuracy: 0.38
step_num: 13000 | loss: 0.4926 | profit rate:    3.7 | accuracy: 0.31
step_num: 13200 | loss: 0.4163 | profit rate:  492.4 | accuracy: 0.36
step_num: 13400 | loss: 0.4182 | profit rate: 2186.1 | accuracy: 0.37
step_num: 13600 | loss: 0.4152 | profit rate: 4092.2 | accuracy: 0.37
step_num: 13800 | loss: 0.4404 | profit rate: 14099136.7 | accuracy: 0.39
step_num: 14000 | loss: 0.4705 | profit rate: 187749512.8 | accuracy: 0.39
step_num: 14200 | loss: 0.4871 | profit rate: 6677425492.6 | accuracy: 0.41
step_num: 14400 | loss: 0.4630 | profit rate: 534473146898.6 | accuracy: 0.42
step_num: 14600 | loss: 0.4786 | profit rate: 255099941129286.6 | accuracy: 0.44
step_num: 14800 | loss: 0.5008 | profit rate: 87461969374688.0 | accuracy: 0.43
step_num: 15000 | loss: 0.5142 | profit rate: 4687653093982369.0 | accuracy: 0.43
step_num: 15200 | loss: 0.4925 | profit rate: 300921160526513792.0 | accuracy: 0.44
step_num: 15400 | loss: 0.4942 | profit rate: 34849236025451671552.0 | accuracy: 0.44
step_num: 15600 | loss: 0.4315 | profit rate: 1171998724364331515904.0 | accuracy: 0.44
episode:   5/8,耗时:1.92分/9.07分,训练集: | step: 15735 | average_treward:  653.5 | max_treward: 923.8301 | average profit rate: 346852120312761745408.000
model saved @ step:15735,performance:678228055446095659008.000,accuracy:0.44
step_num: 15800 | loss: 0.4493 | profit rate:    1.1 | accuracy: 0.35
step_num: 16000 | loss: 0.4435 | profit rate:    6.1 | accuracy: 0.36
step_num: 16200 | loss: 0.4401 | profit rate:   29.4 | accuracy: 0.37
step_num: 16400 | loss: 0.4540 | profit rate: 26307.5 | accuracy: 0.39
step_num: 16600 | loss: 0.4220 | profit rate: 10908.3 | accuracy: 0.38
step_num: 16800 | loss: 0.4817 | profit rate: 73378.8 | accuracy: 0.39
step_num: 17000 | loss: 0.4739 | profit rate: 207836440.7 | accuracy: 0.40
step_num: 17200 | loss: 0.4808 | profit rate: 2065177431.8 | accuracy: 0.41
step_num: 17400 | loss: 0.4449 | profit rate: 756529643661.9 | accuracy: 0.44
step_num: 17600 | loss: 0.4868 | profit rate: 538086948806214.6 | accuracy: 0.45
step_num: 17800 | loss: 0.5347 | profit rate: 127860872834775712.0 | accuracy: 0.45
step_num: 18000 | loss: 0.4906 | profit rate: 2799294143923146752.0 | accuracy: 0.45
step_num: 18200 | loss: 0.5216 | profit rate: 352602292445169188864.0 | accuracy: 0.46
step_num: 18400 | loss: 0.5457 | profit rate: 23917913841237720301568.0 | accuracy: 0.46
step_num: 18600 | loss: 0.4601 | profit rate: 2348229269280841392979968.0 | accuracy: 0.45
step_num: 18800 | loss: 0.4774 | profit rate: 7150001931245525059764224.0 | accuracy: 0.46
model saved @ step:18882,performance:6846397976139259925495808.000,accuracy:0.46
step_num: 19000 | loss: 0.4513 | profit rate:    1.5 | accuracy: 0.44
step_num: 19200 | loss: 0.4195 | profit rate:    7.5 | accuracy: 0.40
step_num: 19400 | loss: 0.4359 | profit rate:  286.7 | accuracy: 0.42
step_num: 19600 | loss: 0.4381 | profit rate: 52559.1 | accuracy: 0.43
step_num: 19800 | loss: 0.4504 | profit rate: 27573.7 | accuracy: 0.43
step_num: 20000 | loss: 0.4724 | profit rate: 2506290.7 | accuracy: 0.42
step_num: 20200 | loss: 0.5055 | profit rate: 46630275.5 | accuracy: 0.41
step_num: 20400 | loss: 0.4981 | profit rate: 244033184.8 | accuracy: 0.42
step_num: 20600 | loss: 0.4736 | profit rate: 594676635209.8 | accuracy: 0.44
step_num: 20800 | loss: 0.4564 | profit rate: 108184542823895.8 | accuracy: 0.46
step_num: 21000 | loss: 0.5489 | profit rate: 18586547010197652.0 | accuracy: 0.45
step_num: 21200 | loss: 0.5000 | profit rate: 446534675950350336.0 | accuracy: 0.45
step_num: 21400 | loss: 0.4944 | profit rate: 194511684644123934720.0 | accuracy: 0.46
step_num: 21600 | loss: 0.5064 | profit rate: 4176648172503092953088.0 | accuracy: 0.46
step_num: 21800 | loss: 0.4891 | profit rate: 127346561428476380839936.0 | accuracy: 0.45
step_num: 22000 | loss: 0.4739 | profit rate: 431272253314939452653568.0 | accuracy: 0.46
episode:   7/8,耗时:1.94分/12.98分,训练集: | step: 22029 | average_treward:  765.4 | max_treward: 1061.9288 | average profit rate: 1039409129032483606626304.000
step_num: 22200 | loss: 0.4745 | profit rate:    5.2 | accuracy: 0.40
step_num: 22400 | loss: 0.4121 | profit rate:    6.1 | accuracy: 0.37
step_num: 22600 | loss: 0.4587 | profit rate:  231.0 | accuracy: 0.39
step_num: 22800 | loss: 0.4427 | profit rate: 1249.6 | accuracy: 0.38
step_num: 23000 | loss: 0.4339 | profit rate: 1034.9 | accuracy: 0.38
step_num: 23200 | loss: 0.4591 | profit rate: 330977.4 | accuracy: 0.38
step_num: 23400 | loss: 0.4977 | profit rate: 7836097.7 | accuracy: 0.38
step_num: 23600 | loss: 0.5162 | profit rate: 81002784.5 | accuracy: 0.41
step_num: 23800 | loss: 0.5424 | profit rate: 166541835304.1 | accuracy: 0.42
step_num: 24000 | loss: 0.5973 | profit rate: 7878454162772.7 | accuracy: 0.43
step_num: 24200 | loss: 0.5674 | profit rate: 74285944123721.8 | accuracy: 0.42
step_num: 24400 | loss: 0.5386 | profit rate: 9451237681267846.0 | accuracy: 0.43
step_num: 24600 | loss: 0.5469 | profit rate: 1217036009844265216.0 | accuracy: 0.43
step_num: 24800 | loss: 0.4949 | profit rate: 367372191807217532928.0 | accuracy: 0.44
step_num: 25000 | loss: 0.4836 | profit rate: 2664891173165869301760.0 | accuracy: 0.44
----------------------------------------finished----------------------------------------
  0%|          | 0/289 [00:00<?, ?it/s] 35%|      | 101/289 [00:00<00:00, 1000.00it/s] 75%|  | 216/289 [00:00<00:00, 1087.87it/s]100%|| 289/289 [00:00<00:00, 1066.39it/s]
==================================================
2023-01-15T12:00:00 | *** START BACKTEST ***
2023-01-15T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-18T12:00:00 | *** GOING LONG ***
2023-01-18T12:00:00's price 20677.4707, buy 0.04831345 units.
2023-01-18T12:00:00 | current balance = 0.00
2023-01-18T12:00:00 | balance:0.00+units:0.04831345*price:20677.4707=net_wealth:999.0010
--------------------------------------------------
2023-02-15T12:00:00 | *** GOING SHORT ***
2023-02-15T12:00:00's price 24324.0508, sell 0.04831345 units.
2023-02-15T12:00:00 | current balance = 1174.00
2023-02-15T12:00:00 | balance:1174.00+units:0.0*price:24324.0508=net_wealth:1174.0047
--------------------------------------------------
2023-02-26T00:00:00 | *** GOING LONG ***
2023-02-26T00:00:00's price 23253.4395, buy 0.05043686 units.
2023-02-26T00:00:00 | current balance = 0.00
2023-02-26T00:00:00 | balance:0.00+units:0.05043686*price:23253.4395=net_wealth:1172.8319
--------------------------------------------------
2023-03-10T12:00:00 | *** GOING SHORT ***
2023-03-10T12:00:00's price 20150.6895, sell 0.05043686 units.
2023-03-10T12:00:00 | current balance = 1015.32
2023-03-10T12:00:00 | balance:1015.32+units:0.0*price:20150.6895=net_wealth:1015.3226
--------------------------------------------------
2023-03-19T12:00:00 | *** GOING LONG ***
2023-03-19T12:00:00's price 27972.8691, buy 0.03626039 units.
2023-03-19T12:00:00 | current balance = 0.00
2023-03-19T12:00:00 | balance:0.00+units:0.03626039*price:27972.8691=net_wealth:1014.3082
--------------------------------------------------
2023-04-15T12:00:00 | *** GOING SHORT ***
2023-04-15T12:00:00's price 30295.0898, sell 0.03626039 units.
2023-04-15T12:00:00 | current balance = 1097.41
2023-04-15T12:00:00 | balance:1097.41+units:0.0*price:30295.0898=net_wealth:1097.4144
--------------------------------------------------
2023-04-29T00:00:00 | *** GOING LONG ***
2023-04-29T00:00:00's price 29332.1094, buy 0.037376 units.
2023-04-29T00:00:00 | current balance = 0.00
2023-04-29T00:00:00 | balance:0.00+units:0.037376*price:29332.1094=net_wealth:1096.3180
--------------------------------------------------
2023-05-08T00:00:00 | *** GOING SHORT ***
2023-05-08T00:00:00's price 27934.0898, sell 0.037376 units.
2023-05-08T00:00:00 | current balance = 1043.02
2023-05-08T00:00:00 | balance:1043.02+units:0.0*price:27934.0898=net_wealth:1043.0216
--------------------------------------------------
2023-05-15T12:00:00 | *** GOING LONG ***
2023-05-15T12:00:00's price 27162.1406, buy 0.03836143 units.
2023-05-15T12:00:00 | current balance = 0.00
2023-05-15T12:00:00 | balance:0.00+units:0.03836143*price:27162.1406=net_wealth:1041.9796
--------------------------------------------------
2023-05-19T00:00:00 | *** GOING SHORT ***
2023-05-19T00:00:00's price 26855.8906, sell 0.03836143 units.
2023-05-19T00:00:00 | current balance = 1029.20
2023-05-19T00:00:00 | balance:1029.20+units:0.0*price:26855.8906=net_wealth:1029.2012
--------------------------------------------------
2023-05-29T00:00:00 | *** GOING LONG ***
2023-05-29T00:00:00's price 27913.8691, buy 0.03683373 units.
2023-05-29T00:00:00 | current balance = 0.00
2023-05-29T00:00:00 | balance:0.00+units:0.03683373*price:27913.8691=net_wealth:1028.1730
--------------------------------------------------
2023-06-04T00:00:00 | *** GOING SHORT ***
2023-06-04T00:00:00's price 27198.5508, sell 0.03683373 units.
2023-06-04T00:00:00 | current balance = 1000.82
2023-06-04T00:00:00 | balance:1000.82+units:0.0*price:27198.5508=net_wealth:1000.8234
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1000.82
2023-06-08T12:00:00 | net performance [%] = 0.0823
2023-06-08T12:00:00 | number of trades [#] = 12
==================================================
Trial 10 Complete [00h 14m 58s]
net_wealth: 1000.8233639910269

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 11m 00s

Search: Running Trial #11

Value             |Best Value So Far |Hyperparameter
8                 |8                 |horizon
225               |225               |lookback
False             |True              |MarketFactor
20                |14                |lags
0.92              |0.98              |gamma
256               |32                |memory_size
32                |16                |batch_size
256               |32                |n_steps
0.98              |0.98              |gae_lambda
1                 |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4215.000000   4223.000000
mean      0.000429    19869.492402  ...   19949.545452  19920.121151
std       0.028054    16157.511856  ...   16193.203995  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7594.050049   7559.520020
50%       0.000696    11383.668066  ...   11469.940430  11460.440430
75%       0.011799    29453.128320  ...   29312.594727  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.7550 | profit rate:    0.1 | accuracy: 0.30
step_num: 400 | loss: 0.5224 | profit rate:    0.1 | accuracy: 0.36
step_num: 600 | loss: 0.5713 | profit rate:    0.1 | accuracy: 0.35
step_num: 800 | loss: 0.5759 | profit rate:    0.0 | accuracy: 0.35
step_num: 1000 | loss: 0.5434 | profit rate:    0.0 | accuracy: 0.33
step_num: 1200 | loss: 0.3466 | profit rate:    0.0 | accuracy: 0.31
step_num: 1400 | loss: 0.4637 | profit rate:    0.0 | accuracy: 0.30
step_num: 1600 | loss: 0.3288 | profit rate:    0.0 | accuracy: 0.29
step_num: 1800 | loss: 0.3695 | profit rate:    0.0 | accuracy: 0.28
step_num: 2000 | loss: 0.1907 | profit rate:    0.0 | accuracy: 0.26
step_num: 2200 | loss: 0.4004 | profit rate:    5.1 | accuracy: 0.30
step_num: 2400 | loss: 0.7256 | profit rate:    6.1 | accuracy: 0.31
step_num: 2600 | loss: 0.7593 | profit rate:    0.1 | accuracy: 0.32
step_num: 2800 | loss: 0.3930 | profit rate:    0.5 | accuracy: 0.32
step_num: 3000 | loss: 0.3038 | profit rate:    0.2 | accuracy: 0.31
step_num: 3200 | loss: 0.4133 | profit rate:    0.2 | accuracy: 0.31
step_num: 3400 | loss: 0.5340 | profit rate:    0.5 | accuracy: 0.32
step_num: 3600 | loss: 0.5208 | profit rate:    1.5 | accuracy: 0.33
episode:   1/8,耗时:0.62分/0.62分,训练集: | step: 3662 | average_treward:   77.2 | max_treward: 77.2006 | average profit rate:  1.553
model saved @ step:3662,performance:1.553,accuracy:0.33
step_num: 3800 | loss: 0.4839 | profit rate:   40.3 | accuracy: 0.28
step_num: 4000 | loss: 0.5671 | profit rate:   23.3 | accuracy: 0.35
step_num: 4200 | loss: 0.4346 | profit rate:  230.2 | accuracy: 0.37
step_num: 4400 | loss: 0.4305 | profit rate:   15.9 | accuracy: 0.35
step_num: 4600 | loss: 0.6448 | profit rate:    5.8 | accuracy: 0.34
step_num: 4800 | loss: 0.3847 | profit rate:    0.9 | accuracy: 0.32
step_num: 5000 | loss: 0.2587 | profit rate:    0.7 | accuracy: 0.29
step_num: 5200 | loss: 0.2558 | profit rate:    0.3 | accuracy: 0.28
step_num: 5400 | loss: 0.3107 | profit rate:    0.3 | accuracy: 0.27
step_num: 5600 | loss: 0.1665 | profit rate:    0.6 | accuracy: 0.26
step_num: 5800 | loss: 0.4832 | profit rate:    9.9 | accuracy: 0.27
step_num: 6000 | loss: 0.5479 | profit rate:  256.1 | accuracy: 0.27
step_num: 6200 | loss: 0.2561 | profit rate:    8.5 | accuracy: 0.26
step_num: 6400 | loss: 0.4740 | profit rate:   32.1 | accuracy: 0.27
step_num: 6600 | loss: 0.1686 | profit rate:   16.4 | accuracy: 0.26
step_num: 6800 | loss: 0.3977 | profit rate:   22.0 | accuracy: 0.26
step_num: 7000 | loss: 0.4412 | profit rate:    4.4 | accuracy: 0.27
step_num: 7200 | loss: 0.4015 | profit rate:   11.3 | accuracy: 0.27
model saved @ step:7324,performance:56.376,accuracy:0.26
step_num: 7400 | loss: 0.4119 | profit rate:   44.1 | accuracy: 0.39
step_num: 7600 | loss: 0.6090 | profit rate:  103.0 | accuracy: 0.31
step_num: 7800 | loss: 0.3919 | profit rate: 1478.2 | accuracy: 0.31
step_num: 8000 | loss: 0.5017 | profit rate:  230.6 | accuracy: 0.32
step_num: 8200 | loss: 0.3459 | profit rate:  235.4 | accuracy: 0.30
step_num: 8400 | loss: 0.5882 | profit rate:    0.3 | accuracy: 0.29
step_num: 8600 | loss: 0.3674 | profit rate:    0.1 | accuracy: 0.28
step_num: 8800 | loss: 0.1062 | profit rate:    0.1 | accuracy: 0.26
step_num: 9000 | loss: 0.3752 | profit rate:    0.2 | accuracy: 0.26
step_num: 9200 | loss: 0.1724 | profit rate:    0.7 | accuracy: 0.25
step_num: 9400 | loss: 0.3344 | profit rate:    0.5 | accuracy: 0.25
step_num: 9600 | loss: 0.6250 | profit rate:    0.5 | accuracy: 0.26
step_num: 9800 | loss: 0.4064 | profit rate:    0.1 | accuracy: 0.25
step_num: 10000 | loss: 0.2847 | profit rate:    0.1 | accuracy: 0.25
step_num: 10200 | loss: 0.2490 | profit rate:    0.3 | accuracy: 0.25
step_num: 10400 | loss: 0.2031 | profit rate:    0.2 | accuracy: 0.25
step_num: 10600 | loss: 0.2045 | profit rate:    0.3 | accuracy: 0.24
step_num: 10800 | loss: 0.2893 | profit rate:    0.9 | accuracy: 0.24
episode:   3/8,耗时:0.68分/1.98分,训练集: | step: 10986 | average_treward:   66.6 | max_treward: 100.1602 | average profit rate: 21.069
step_num: 11000 | loss: 0.2010 | profit rate:    1.0 | accuracy: 0.00
step_num: 11200 | loss: 0.1428 | profit rate:    0.5 | accuracy: 0.05
step_num: 11400 | loss: 0.3671 | profit rate:   29.5 | accuracy: 0.23
step_num: 11600 | loss: 0.3639 | profit rate:   31.9 | accuracy: 0.25
step_num: 11800 | loss: 0.3258 | profit rate:    2.2 | accuracy: 0.24
step_num: 12000 | loss: 0.4924 | profit rate:    0.0 | accuracy: 0.24
step_num: 12200 | loss: 0.2033 | profit rate:    0.0 | accuracy: 0.22
step_num: 12400 | loss: 0.1547 | profit rate:    0.1 | accuracy: 0.20
step_num: 12600 | loss: 0.1997 | profit rate:    0.2 | accuracy: 0.20
step_num: 12800 | loss: 0.2658 | profit rate:    0.3 | accuracy: 0.21
step_num: 13000 | loss: 0.1802 | profit rate:    0.5 | accuracy: 0.21
step_num: 13200 | loss: 0.3294 | profit rate:    2.6 | accuracy: 0.21
step_num: 13400 | loss: 0.4037 | profit rate:    0.7 | accuracy: 0.21
step_num: 13600 | loss: 0.3218 | profit rate:    0.0 | accuracy: 0.21
step_num: 13800 | loss: 0.2888 | profit rate:    0.0 | accuracy: 0.21
step_num: 14000 | loss: 0.2078 | profit rate:    0.1 | accuracy: 0.20
step_num: 14200 | loss: 0.1997 | profit rate:    0.0 | accuracy: 0.20
step_num: 14400 | loss: 0.1765 | profit rate:    0.0 | accuracy: 0.20
step_num: 14600 | loss: 0.2713 | profit rate:    0.0 | accuracy: 0.21
step_num: 14800 | loss: 0.3460 | profit rate:    1.3 | accuracy: 0.18
step_num: 15000 | loss: 0.3735 | profit rate:    4.7 | accuracy: 0.24
step_num: 15200 | loss: 0.3407 | profit rate:   12.5 | accuracy: 0.27
step_num: 15400 | loss: 0.4504 | profit rate:   26.2 | accuracy: 0.30
step_num: 15600 | loss: 0.6220 | profit rate:    2.5 | accuracy: 0.29
step_num: 15800 | loss: 0.3355 | profit rate:    1.2 | accuracy: 0.27
step_num: 16000 | loss: 0.1092 | profit rate:    1.7 | accuracy: 0.24
step_num: 16200 | loss: 0.1991 | profit rate:    2.3 | accuracy: 0.23
step_num: 16400 | loss: 0.3336 | profit rate:    1.0 | accuracy: 0.22
step_num: 16600 | loss: 0.1324 | profit rate:    0.8 | accuracy: 0.21
step_num: 16800 | loss: 0.1221 | profit rate:    0.4 | accuracy: 0.20
step_num: 17000 | loss: 0.3431 | profit rate:    0.3 | accuracy: 0.19
step_num: 17200 | loss: 0.1212 | profit rate:    0.3 | accuracy: 0.18
step_num: 17400 | loss: 0.3002 | profit rate:    0.4 | accuracy: 0.18
step_num: 17600 | loss: 0.0772 | profit rate:    0.3 | accuracy: 0.17
step_num: 17800 | loss: 0.1741 | profit rate:    0.3 | accuracy: 0.17
step_num: 18000 | loss: 0.2962 | profit rate:    0.1 | accuracy: 0.17
step_num: 18200 | loss: 0.2664 | profit rate:    0.1 | accuracy: 0.17
episode:   5/8,耗时:0.66分/3.30分,训练集: | step: 18310 | average_treward:   35.4 | max_treward: 100.1602 | average profit rate: 12.666
step_num: 18400 | loss: 0.0825 | profit rate:    0.5 | accuracy: 0.03
step_num: 18600 | loss: 0.1428 | profit rate:    0.2 | accuracy: 0.08
step_num: 18800 | loss: 0.0895 | profit rate:    0.5 | accuracy: 0.10
step_num: 19000 | loss: 0.1827 | profit rate:    1.4 | accuracy: 0.12
step_num: 19200 | loss: 0.2077 | profit rate:    5.7 | accuracy: 0.15
step_num: 19400 | loss: 0.2219 | profit rate:    4.7 | accuracy: 0.14
step_num: 19600 | loss: 0.0770 | profit rate:    5.3 | accuracy: 0.13
step_num: 19800 | loss: 0.2620 | profit rate:   25.9 | accuracy: 0.15
step_num: 20000 | loss: 0.3549 | profit rate:   16.1 | accuracy: 0.16
step_num: 20200 | loss: 0.2061 | profit rate:   16.1 | accuracy: 0.16
step_num: 20400 | loss: 0.2031 | profit rate:   14.1 | accuracy: 0.15
step_num: 20600 | loss: 0.1633 | profit rate:    4.9 | accuracy: 0.14
step_num: 20800 | loss: 0.2026 | profit rate:    0.7 | accuracy: 0.14
step_num: 21000 | loss: 0.5092 | profit rate:    1.5 | accuracy: 0.16
step_num: 21200 | loss: 0.0615 | profit rate:    1.3 | accuracy: 0.15
step_num: 21400 | loss: 0.3147 | profit rate:    0.7 | accuracy: 0.16
step_num: 21600 | loss: 0.3544 | profit rate:    0.4 | accuracy: 0.17
step_num: 21800 | loss: 0.2515 | profit rate:    1.8 | accuracy: 0.17
step_num: 22000 | loss: 0.1201 | profit rate:    1.0 | accuracy: 0.00
step_num: 22200 | loss: 0.1176 | profit rate:    0.1 | accuracy: 0.10
step_num: 22400 | loss: 0.1645 | profit rate:    0.2 | accuracy: 0.13
step_num: 22600 | loss: 0.1934 | profit rate:    0.3 | accuracy: 0.15
step_num: 22800 | loss: 0.2690 | profit rate:    0.7 | accuracy: 0.18
step_num: 23000 | loss: 0.2344 | profit rate:    0.5 | accuracy: 0.17
step_num: 23200 | loss: 0.1165 | profit rate:    1.1 | accuracy: 0.15
step_num: 23400 | loss: 0.2313 | profit rate:    5.0 | accuracy: 0.16
step_num: 23600 | loss: 0.2133 | profit rate:    2.0 | accuracy: 0.16
step_num: 23800 | loss: 0.1451 | profit rate:    3.4 | accuracy: 0.16
step_num: 24000 | loss: 0.0281 | profit rate:    3.5 | accuracy: 0.15
step_num: 24200 | loss: 0.1025 | profit rate:    4.0 | accuracy: 0.14
step_num: 24400 | loss: 0.0931 | profit rate:    8.8 | accuracy: 0.13
step_num: 24600 | loss: 0.4001 | profit rate:   46.8 | accuracy: 0.15
step_num: 24800 | loss: 0.2377 | profit rate:   27.9 | accuracy: 0.15
step_num: 25000 | loss: 0.3943 | profit rate:    5.0 | accuracy: 0.16
step_num: 25200 | loss: 0.3342 | profit rate:   25.9 | accuracy: 0.16
step_num: 25400 | loss: 0.3267 | profit rate:   53.8 | accuracy: 0.17
step_num: 25600 | loss: 0.1792 | profit rate:   51.6 | accuracy: 0.17
episode:   7/8,耗时:0.66分/4.63分,训练集: | step: 25634 | average_treward:   59.3 | max_treward: 144.7174 | average profit rate: 16.693
model saved @ step:25634,performance:51.598,accuracy:0.17
step_num: 25800 | loss: 0.2418 | profit rate:    0.1 | accuracy: 0.10
step_num: 26000 | loss: 0.0750 | profit rate:    0.0 | accuracy: 0.08
step_num: 26200 | loss: 0.1779 | profit rate:    0.1 | accuracy: 0.11
step_num: 26400 | loss: 0.1698 | profit rate:    0.1 | accuracy: 0.12
step_num: 26600 | loss: 0.1988 | profit rate:    0.0 | accuracy: 0.11
step_num: 26800 | loss: 0.0628 | profit rate:    0.0 | accuracy: 0.10
step_num: 27000 | loss: 0.1129 | profit rate:    0.1 | accuracy: 0.10
step_num: 27200 | loss: 0.2010 | profit rate:    0.1 | accuracy: 0.11
step_num: 27400 | loss: 0.2508 | profit rate:    0.0 | accuracy: 0.12
step_num: 27600 | loss: 0.0957 | profit rate:    0.0 | accuracy: 0.11
step_num: 27800 | loss: 0.0864 | profit rate:    0.0 | accuracy: 0.11
step_num: 28000 | loss: 0.0487 | profit rate:    0.0 | accuracy: 0.10
step_num: 28200 | loss: 0.1399 | profit rate:    0.0 | accuracy: 0.11
step_num: 28400 | loss: 0.2881 | profit rate:    0.0 | accuracy: 0.11
step_num: 28600 | loss: 0.1789 | profit rate:    0.0 | accuracy: 0.12
step_num: 28800 | loss: 0.3148 | profit rate:    0.0 | accuracy: 0.13
step_num: 29000 | loss: 0.2688 | profit rate:    0.0 | accuracy: 0.14
step_num: 29200 | loss: 0.2146 | profit rate:    0.1 | accuracy: 0.15
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 36%|      | 107/299 [00:00<00:00, 1059.52it/s] 80%|  | 238/299 [00:00<00:00, 1205.35it/s]100%|| 299/299 [00:00<00:00, 1190.67it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-02-04T00:00:00 | *** GOING LONG ***
2023-02-04T00:00:00's price 23363.7598, buy 0.04275852 units.
2023-02-04T00:00:00 | current balance = 0.00
2023-02-04T00:00:00 | balance:0.00+units:0.04275852*price:23363.7598=net_wealth:999.0010
--------------------------------------------------
2023-03-20T12:00:00 | *** GOING SHORT ***
2023-03-20T12:00:00's price 27717.0098, sell 0.04275852 units.
2023-03-20T12:00:00 | current balance = 1183.95
2023-03-20T12:00:00 | balance:1183.95+units:0.0*price:27717.0098=net_wealth:1183.9544
--------------------------------------------------
2023-03-30T12:00:00 | *** GOING LONG ***
2023-03-30T12:00:00's price 28028.5293, buy 0.0421988 units.
2023-03-30T12:00:00 | current balance = 0.00
2023-03-30T12:00:00 | balance:0.00+units:0.0421988*price:28028.5293=net_wealth:1182.7716
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.0421988 units.
2023-06-08T12:00:00 | current balance = 1121.36
2023-06-08T12:00:00 | net performance [%] = 12.1358
2023-06-08T12:00:00 | number of trades [#] = 4
==================================================
Trial 11 Complete [00h 05m 20s]
net_wealth: 1122.480495379946

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 16m 21s

Search: Running Trial #12

Value             |Best Value So Far |Hyperparameter
4                 |8                 |horizon
225               |225               |lookback
False             |True              |MarketFactor
30                |14                |lags
0.5               |0.98              |gamma
32                |32                |memory_size
32                |16                |batch_size
32                |32                |n_steps
0.98              |0.98              |gae_lambda
1                 |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4219.000000   4223.000000
mean      0.000429    19869.492402  ...   19934.900107  19920.121151
std       0.028054    16157.511856  ...   16192.506388  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7576.504883   7559.520020
50%       0.000696    11383.668066  ...   11464.480469  11460.440430
75%       0.011799    29453.128320  ...   29311.174805  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.8356 | profit rate:    3.0 | accuracy: 0.33
step_num: 400 | loss: 0.6492 | profit rate:    3.4 | accuracy: 0.31
step_num: 600 | loss: 0.5533 | profit rate:    1.4 | accuracy: 0.30
step_num: 800 | loss: 0.4259 | profit rate:    0.6 | accuracy: 0.31
step_num: 1000 | loss: 0.7529 | profit rate:    0.6 | accuracy: 0.31
step_num: 1200 | loss: 0.8187 | profit rate:    1.3 | accuracy: 0.34
step_num: 1400 | loss: 0.2786 | profit rate:    1.0 | accuracy: 0.34
step_num: 1600 | loss: 0.5701 | profit rate:    0.3 | accuracy: 0.34
step_num: 1800 | loss: 0.6183 | profit rate:    0.0 | accuracy: 0.34
step_num: 2000 | loss: 0.4648 | profit rate:    0.1 | accuracy: 0.35
step_num: 2200 | loss: 0.3152 | profit rate:    3.8 | accuracy: 0.37
step_num: 2400 | loss: 0.6000 | profit rate:    6.2 | accuracy: 0.38
step_num: 2600 | loss: 0.2654 | profit rate:    2.4 | accuracy: 0.39
step_num: 2800 | loss: 0.1193 | profit rate:    1.5 | accuracy: 0.38
step_num: 3000 | loss: 0.4849 | profit rate:    0.7 | accuracy: 0.37
step_num: 3200 | loss: 0.4207 | profit rate:    0.8 | accuracy: 0.37
step_num: 3400 | loss: 0.7073 | profit rate:    1.3 | accuracy: 0.37
step_num: 3600 | loss: 0.3185 | profit rate:    3.1 | accuracy: 0.37
episode:   1/8,耗时:0.43分/0.43分,训练集: | step: 3652 | average_treward:  122.1 | max_treward: 122.1427 | average profit rate:  3.416
model saved @ step:3652,performance:3.416,accuracy:0.37
step_num: 3800 | loss: 0.3181 | profit rate:    0.3 | accuracy: 0.24
step_num: 4000 | loss: 0.6200 | profit rate:    1.2 | accuracy: 0.28
step_num: 4200 | loss: 0.2801 | profit rate:    1.1 | accuracy: 0.27
step_num: 4400 | loss: 0.1198 | profit rate:    2.1 | accuracy: 0.26
step_num: 4600 | loss: 0.5358 | profit rate:    0.9 | accuracy: 0.25
step_num: 4800 | loss: 0.4106 | profit rate:    4.6 | accuracy: 0.29
step_num: 5000 | loss: 0.6727 | profit rate:    1.8 | accuracy: 0.30
step_num: 5200 | loss: 0.4351 | profit rate:    3.9 | accuracy: 0.32
step_num: 5400 | loss: 0.1989 | profit rate:    0.1 | accuracy: 0.31
step_num: 5600 | loss: 0.5977 | profit rate:    0.1 | accuracy: 0.30
step_num: 5800 | loss: 0.5457 | profit rate:    0.2 | accuracy: 0.30
step_num: 6000 | loss: 0.5908 | profit rate:   14.0 | accuracy: 0.33
step_num: 6200 | loss: 0.4864 | profit rate:    8.1 | accuracy: 0.34
step_num: 6400 | loss: 0.4321 | profit rate:    4.1 | accuracy: 0.34
step_num: 6600 | loss: 0.2085 | profit rate:    4.2 | accuracy: 0.33
step_num: 6800 | loss: 0.0319 | profit rate:    7.9 | accuracy: 0.33
step_num: 7000 | loss: 0.6045 | profit rate:   16.9 | accuracy: 0.33
step_num: 7200 | loss: 0.3529 | profit rate:   19.8 | accuracy: 0.33
model saved @ step:7304,performance:20.756,accuracy:0.32
step_num: 7400 | loss: 0.1632 | profit rate:    0.3 | accuracy: 0.31
step_num: 7600 | loss: 0.2930 | profit rate:    0.3 | accuracy: 0.14
step_num: 7800 | loss: 0.0792 | profit rate:    0.6 | accuracy: 0.11
step_num: 8000 | loss: 0.0981 | profit rate:    0.8 | accuracy: 0.11
step_num: 8200 | loss: 0.0808 | profit rate:    0.9 | accuracy: 0.13
step_num: 8400 | loss: 0.6165 | profit rate:   18.6 | accuracy: 0.21
step_num: 8600 | loss: 0.5089 | profit rate:    4.2 | accuracy: 0.25
step_num: 8800 | loss: 0.3986 | profit rate:    5.0 | accuracy: 0.25
step_num: 9000 | loss: 0.5874 | profit rate:    0.2 | accuracy: 0.25
step_num: 9200 | loss: 0.0350 | profit rate:    0.2 | accuracy: 0.23
step_num: 9400 | loss: 0.4608 | profit rate:    0.1 | accuracy: 0.22
step_num: 9600 | loss: 0.7374 | profit rate:    0.3 | accuracy: 0.23
step_num: 9800 | loss: 0.3637 | profit rate:    0.1 | accuracy: 0.24
step_num: 10000 | loss: 0.0598 | profit rate:    0.2 | accuracy: 0.25
step_num: 10200 | loss: 0.4953 | profit rate:    0.1 | accuracy: 0.24
step_num: 10400 | loss: 0.4895 | profit rate:    0.1 | accuracy: 0.24
step_num: 10600 | loss: 1.2581 | profit rate:    1.1 | accuracy: 0.25
step_num: 10800 | loss: 0.2315 | profit rate:    1.4 | accuracy: 0.25
episode:   3/8,耗时:0.49分/1.39分,训练集: | step: 10956 | average_treward:  139.7 | max_treward: 151.1641 | average profit rate:  8.631
step_num: 11000 | loss: 0.8372 | profit rate:    0.4 | accuracy: 0.27
step_num: 11200 | loss: 0.0364 | profit rate:    0.2 | accuracy: 0.09
step_num: 11400 | loss: 0.0100 | profit rate:    0.2 | accuracy: 0.05
step_num: 11600 | loss: 0.0080 | profit rate:    0.3 | accuracy: 0.06
step_num: 11800 | loss: 0.0794 | profit rate:    0.5 | accuracy: 0.07
step_num: 12000 | loss: 0.0057 | profit rate:    0.5 | accuracy: 0.07
step_num: 12200 | loss: 0.1140 | profit rate:    0.7 | accuracy: 0.08
step_num: 12400 | loss: 0.5749 | profit rate:    2.1 | accuracy: 0.14
step_num: 12600 | loss: 0.3222 | profit rate:    0.4 | accuracy: 0.15
step_num: 12800 | loss: 0.0007 | profit rate:    0.2 | accuracy: 0.14
step_num: 13000 | loss: 0.0015 | profit rate:    0.2 | accuracy: 0.14
step_num: 13200 | loss: 0.4747 | profit rate:    0.6 | accuracy: 0.15
step_num: 13400 | loss: 0.4249 | profit rate:    2.8 | accuracy: 0.17
step_num: 13600 | loss: 0.2495 | profit rate:    1.1 | accuracy: 0.18
step_num: 13800 | loss: 0.2989 | profit rate:    0.6 | accuracy: 0.18
step_num: 14000 | loss: 0.3992 | profit rate:    2.0 | accuracy: 0.19
step_num: 14200 | loss: 0.8165 | profit rate:    3.3 | accuracy: 0.19
step_num: 14400 | loss: 0.1429 | profit rate:    7.2 | accuracy: 0.20
step_num: 14600 | loss: 0.3141 | profit rate:   13.2 | accuracy: 0.21
model saved @ step:14608,performance:13.146,accuracy:0.21
step_num: 14800 | loss: 0.0811 | profit rate:    0.2 | accuracy: 0.06
step_num: 15000 | loss: 0.1000 | profit rate:    0.2 | accuracy: 0.05
step_num: 15200 | loss: 0.1607 | profit rate:    0.2 | accuracy: 0.06
step_num: 15400 | loss: 0.0639 | profit rate:    0.2 | accuracy: 0.08
step_num: 15600 | loss: 0.0379 | profit rate:    0.3 | accuracy: 0.08
step_num: 15800 | loss: 0.0473 | profit rate:    0.5 | accuracy: 0.10
step_num: 16000 | loss: 0.0691 | profit rate:    0.5 | accuracy: 0.10
step_num: 16200 | loss: 0.6391 | profit rate:    0.4 | accuracy: 0.13
step_num: 16400 | loss: 0.0030 | profit rate:    0.1 | accuracy: 0.14
step_num: 16600 | loss: 0.0769 | profit rate:    0.1 | accuracy: 0.13
step_num: 16800 | loss: 0.3272 | profit rate:    1.2 | accuracy: 0.16
step_num: 17000 | loss: 0.1604 | profit rate:    6.9 | accuracy: 0.19
step_num: 17200 | loss: 0.4833 | profit rate:    9.3 | accuracy: 0.19
step_num: 17400 | loss: 0.3730 | profit rate:    6.0 | accuracy: 0.19
step_num: 17600 | loss: 0.0644 | profit rate:    3.3 | accuracy: 0.19
step_num: 17800 | loss: 0.3979 | profit rate:   10.4 | accuracy: 0.19
step_num: 18000 | loss: 0.5598 | profit rate:   37.3 | accuracy: 0.21
step_num: 18200 | loss: 0.2660 | profit rate:  106.1 | accuracy: 0.22
episode:   5/8,耗时:0.48分/2.35分,训练集: | step: 18260 | average_treward:  172.8 | max_treward: 252.0363 | average profit rate: 32.287
model saved @ step:18260,performance:122.396,accuracy:0.23
step_num: 18400 | loss: 0.3789 | profit rate:    0.2 | accuracy: 0.23
step_num: 18600 | loss: 0.0038 | profit rate:    0.1 | accuracy: 0.15
step_num: 18800 | loss: 0.0396 | profit rate:    0.1 | accuracy: 0.11
step_num: 19000 | loss: 0.2565 | profit rate:    0.3 | accuracy: 0.12
step_num: 19200 | loss: 0.2852 | profit rate:    0.2 | accuracy: 0.11
step_num: 19400 | loss: 0.1120 | profit rate:    0.3 | accuracy: 0.11
step_num: 19600 | loss: 0.6481 | profit rate:    0.2 | accuracy: 0.12
step_num: 19800 | loss: 0.0250 | profit rate:    0.3 | accuracy: 0.14
step_num: 20000 | loss: 0.0919 | profit rate:    0.7 | accuracy: 0.14
step_num: 20200 | loss: 0.1635 | profit rate:    0.7 | accuracy: 0.13
step_num: 20400 | loss: 0.6350 | profit rate:    1.7 | accuracy: 0.14
step_num: 20600 | loss: 0.5083 | profit rate:   93.9 | accuracy: 0.18
step_num: 20800 | loss: 0.1150 | profit rate:   95.0 | accuracy: 0.20
step_num: 21000 | loss: 0.2104 | profit rate:   66.4 | accuracy: 0.19
step_num: 21200 | loss: 0.4001 | profit rate:   72.0 | accuracy: 0.20
step_num: 21400 | loss: 0.2174 | profit rate:  181.5 | accuracy: 0.21
step_num: 21600 | loss: 0.3939 | profit rate: 2552.1 | accuracy: 0.23
step_num: 21800 | loss: 0.9225 | profit rate: 5430.0 | accuracy: 0.24
model saved @ step:21912,performance:9314.386,accuracy:0.24
step_num: 22000 | loss: 0.6523 | profit rate:    0.3 | accuracy: 0.30
step_num: 22200 | loss: 0.3301 | profit rate:    0.3 | accuracy: 0.21
step_num: 22400 | loss: 0.0619 | profit rate:    0.7 | accuracy: 0.19
step_num: 22600 | loss: 2.0782 | profit rate:    0.2 | accuracy: 0.17
step_num: 22800 | loss: 0.0337 | profit rate:    0.4 | accuracy: 0.16
step_num: 23000 | loss: 0.5091 | profit rate:    1.8 | accuracy: 0.19
step_num: 23200 | loss: 0.1036 | profit rate:    1.6 | accuracy: 0.20
step_num: 23400 | loss: 0.0080 | profit rate:    1.8 | accuracy: 0.18
step_num: 23600 | loss: 0.0028 | profit rate:    3.0 | accuracy: 0.19
step_num: 23800 | loss: 0.2266 | profit rate:    2.6 | accuracy: 0.18
step_num: 24000 | loss: 0.1254 | profit rate:    2.1 | accuracy: 0.18
step_num: 24200 | loss: 0.4559 | profit rate:  105.4 | accuracy: 0.21
step_num: 24400 | loss: 0.4446 | profit rate:   92.5 | accuracy: 0.22
step_num: 24600 | loss: 0.0491 | profit rate:  135.2 | accuracy: 0.21
step_num: 24800 | loss: 0.4036 | profit rate:  127.2 | accuracy: 0.21
step_num: 25000 | loss: 0.1737 | profit rate:  147.5 | accuracy: 0.20
step_num: 25200 | loss: 0.4911 | profit rate:  172.1 | accuracy: 0.20
step_num: 25400 | loss: 0.0509 | profit rate:  239.5 | accuracy: 0.19
episode:   7/8,耗时:0.47分/3.29分,训练集: | step: 25564 | average_treward:  194.9 | max_treward: 286.6966 | average profit rate: 1389.344
step_num: 25600 | loss: 0.8223 | profit rate:    0.4 | accuracy: 0.27
step_num: 25800 | loss: 0.0023 | profit rate:    0.5 | accuracy: 0.13
step_num: 26000 | loss: 0.0158 | profit rate:    1.2 | accuracy: 0.14
step_num: 26200 | loss: 0.4439 | profit rate:    2.7 | accuracy: 0.16
step_num: 26400 | loss: 0.0344 | profit rate:    3.1 | accuracy: 0.14
step_num: 26600 | loss: 0.1383 | profit rate:    6.2 | accuracy: 0.15
step_num: 26800 | loss: 0.1686 | profit rate:   10.8 | accuracy: 0.19
step_num: 27000 | loss: 0.5903 | profit rate:   16.5 | accuracy: 0.20
step_num: 27200 | loss: 0.0613 | profit rate:    7.9 | accuracy: 0.20
step_num: 27400 | loss: 0.0049 | profit rate:    4.0 | accuracy: 0.18
step_num: 27600 | loss: 0.0319 | profit rate:    3.2 | accuracy: 0.17
step_num: 27800 | loss: 0.1883 | profit rate:   21.9 | accuracy: 0.18
step_num: 28000 | loss: 0.2939 | profit rate:  192.5 | accuracy: 0.20
step_num: 28200 | loss: 0.1541 | profit rate:  201.2 | accuracy: 0.20
step_num: 28400 | loss: 0.3303 | profit rate:  123.1 | accuracy: 0.20
step_num: 28600 | loss: 0.1198 | profit rate:  191.4 | accuracy: 0.20
step_num: 28800 | loss: 0.2736 | profit rate:  477.1 | accuracy: 0.20
step_num: 29000 | loss: 0.7937 | profit rate: 1525.0 | accuracy: 0.21
step_num: 29200 | loss: 0.2527 | profit rate: 3119.5 | accuracy: 0.22
----------------------------------------finished----------------------------------------
  0%|          | 0/289 [00:00<?, ?it/s] 33%|      | 95/289 [00:00<00:00, 944.59it/s] 73%|  | 211/289 [00:00<00:00, 1066.74it/s]100%|| 289/289 [00:00<00:00, 1114.56it/s]
==================================================
2023-01-15T12:00:00 | *** START BACKTEST ***
2023-01-15T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-22T12:00:00 | *** GOING LONG ***
2023-01-22T12:00:00's price 22707.8809, buy 0.04399353 units.
2023-01-22T12:00:00 | current balance = 0.00
2023-01-22T12:00:00 | balance:0.00+units:0.04399353*price:22707.8809=net_wealth:999.0010
--------------------------------------------------
2023-02-11T00:00:00 | *** GOING SHORT ***
2023-02-11T00:00:00's price 21697.4395, sell 0.04399353 units.
2023-02-11T00:00:00 | current balance = 953.59
2023-02-11T00:00:00 | balance:953.59+units:0.0*price:21697.4395=net_wealth:953.5936
--------------------------------------------------
2023-02-16T00:00:00 | *** GOING LONG ***
2023-02-16T00:00:00's price 24568.5508, buy 0.03877477 units.
2023-02-16T00:00:00 | current balance = 0.00
2023-02-16T00:00:00 | balance:0.00+units:0.03877477*price:24568.5508=net_wealth:952.6409
--------------------------------------------------
2023-02-18T00:00:00 | *** GOING SHORT ***
2023-02-18T00:00:00's price 24519.4199, sell 0.03877477 units.
2023-02-18T00:00:00 | current balance = 949.79
2023-02-18T00:00:00 | balance:949.79+units:0.0*price:24519.4199=net_wealth:949.7852
--------------------------------------------------
2023-02-24T12:00:00 | *** GOING LONG ***
2023-02-24T12:00:00's price 23185.2891, buy 0.04092402 units.
2023-02-24T12:00:00 | current balance = 0.00
2023-02-24T12:00:00 | balance:0.00+units:0.04092402*price:23185.2891=net_wealth:948.8363
--------------------------------------------------
2023-03-11T00:00:00 | *** GOING SHORT ***
2023-03-11T00:00:00's price 20086.0703, sell 0.04092402 units.
2023-03-11T00:00:00 | current balance = 821.18
2023-03-11T00:00:00 | balance:821.18+units:0.0*price:20086.0703=net_wealth:821.1818
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING LONG ***
2023-03-13T12:00:00's price 24113.4805, buy 0.03402083 units.
2023-03-13T12:00:00 | current balance = 0.00
2023-03-13T12:00:00 | balance:0.00+units:0.03402083*price:24113.4805=net_wealth:820.3615
--------------------------------------------------
2023-05-01T12:00:00 | *** GOING SHORT ***
2023-05-01T12:00:00's price 28068.2598, sell 0.03402083 units.
2023-05-01T12:00:00 | current balance = 953.95
2023-05-01T12:00:00 | balance:953.95+units:0.0*price:28068.2598=net_wealth:953.9514
--------------------------------------------------
2023-05-05T00:00:00 | *** GOING LONG ***
2023-05-05T00:00:00's price 29149.3594, buy 0.03269359 units.
2023-05-05T00:00:00 | current balance = 0.00
2023-05-05T00:00:00 | balance:0.00+units:0.03269359*price:29149.3594=net_wealth:952.9984
--------------------------------------------------
2023-05-16T12:00:00 | *** GOING SHORT ***
2023-05-16T12:00:00's price 27033.8398, sell 0.03269359 units.
2023-05-16T12:00:00 | current balance = 882.95
2023-05-16T12:00:00 | balance:882.95+units:0.0*price:27033.8398=net_wealth:882.9507
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 882.95
2023-06-08T12:00:00 | net performance [%] = -11.7049
2023-06-08T12:00:00 | number of trades [#] = 10
==================================================
Trial 12 Complete [00h 03m 48s]
net_wealth: 882.9506776188188

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 20m 09s

Search: Running Trial #13

Value             |Best Value So Far |Hyperparameter
2                 |8                 |horizon
365               |225               |lookback
False             |True              |MarketFactor
20                |14                |lags
0.95              |0.98              |gamma
256               |32                |memory_size
32                |16                |batch_size
5                 |32                |n_steps
0.97              |0.98              |gae_lambda
0.5               |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.5500 | profit rate:    0.9 | accuracy: 0.31
step_num: 400 | loss: 0.4405 | profit rate:    1.3 | accuracy: 0.35
step_num: 600 | loss: 0.4133 | profit rate:    0.6 | accuracy: 0.33
step_num: 800 | loss: 0.3377 | profit rate:    0.9 | accuracy: 0.33
step_num: 1000 | loss: 0.4448 | profit rate:    1.4 | accuracy: 0.33
step_num: 1200 | loss: 0.4626 | profit rate:    1.1 | accuracy: 0.34
step_num: 1400 | loss: 0.3432 | profit rate:    0.8 | accuracy: 0.32
step_num: 1600 | loss: 0.2312 | profit rate:    0.3 | accuracy: 0.30
step_num: 1800 | loss: 0.3356 | profit rate:    0.3 | accuracy: 0.30
step_num: 2000 | loss: 0.3474 | profit rate:    0.6 | accuracy: 0.30
step_num: 2200 | loss: 0.4928 | profit rate:    1.6 | accuracy: 0.31
step_num: 2400 | loss: 0.3796 | profit rate:    0.8 | accuracy: 0.31
step_num: 2600 | loss: 0.3349 | profit rate:    1.6 | accuracy: 0.31
step_num: 2800 | loss: 0.3007 | profit rate:    1.1 | accuracy: 0.31
step_num: 3000 | loss: 0.3685 | profit rate:    0.8 | accuracy: 0.31
step_num: 3200 | loss: 0.4193 | profit rate:    1.9 | accuracy: 0.32
step_num: 3400 | loss: 0.3750 | profit rate:    2.5 | accuracy: 0.32
episode:   1/8,耗时:0.58分/0.58分,训练集: | step: 3522 | average_treward:  142.3 | max_treward: 142.2663 | average profit rate:  3.502
model saved @ step:3522,performance:3.502,accuracy:0.33
step_num: 3600 | loss: 0.4270 | profit rate:    1.1 | accuracy: 0.34
step_num: 3800 | loss: 0.3741 | profit rate:    1.1 | accuracy: 0.31
step_num: 4000 | loss: 0.3007 | profit rate:    0.7 | accuracy: 0.29
step_num: 4200 | loss: 0.3072 | profit rate:    0.6 | accuracy: 0.29
step_num: 4400 | loss: 0.2714 | profit rate:    0.2 | accuracy: 0.27
step_num: 4600 | loss: 0.2485 | profit rate:    0.2 | accuracy: 0.25
step_num: 4800 | loss: 0.0856 | profit rate:    0.1 | accuracy: 0.23
step_num: 5000 | loss: 0.1355 | profit rate:    0.2 | accuracy: 0.22
step_num: 5200 | loss: 0.2949 | profit rate:    0.5 | accuracy: 0.23
step_num: 5400 | loss: 0.3519 | profit rate:    0.4 | accuracy: 0.23
step_num: 5600 | loss: 0.3269 | profit rate:    1.5 | accuracy: 0.25
step_num: 5800 | loss: 0.3833 | profit rate:    0.8 | accuracy: 0.26
step_num: 6000 | loss: 0.3280 | profit rate:    0.8 | accuracy: 0.26
step_num: 6200 | loss: 0.3844 | profit rate:    1.4 | accuracy: 0.26
step_num: 6400 | loss: 0.2805 | profit rate:    1.0 | accuracy: 0.26
step_num: 6600 | loss: 0.2033 | profit rate:    1.0 | accuracy: 0.26
step_num: 6800 | loss: 0.3220 | profit rate:    1.5 | accuracy: 0.27
step_num: 7000 | loss: 0.2798 | profit rate:    1.9 | accuracy: 0.27
model saved @ step:7044,performance:2.214,accuracy:0.27
step_num: 7200 | loss: 0.3516 | profit rate:    0.7 | accuracy: 0.27
step_num: 7400 | loss: 0.2576 | profit rate:    1.1 | accuracy: 0.28
step_num: 7600 | loss: 0.2518 | profit rate:    0.4 | accuracy: 0.27
step_num: 7800 | loss: 0.2374 | profit rate:    0.6 | accuracy: 0.25
step_num: 8000 | loss: 0.3667 | profit rate:    0.2 | accuracy: 0.25
step_num: 8200 | loss: 0.1910 | profit rate:    0.2 | accuracy: 0.24
step_num: 8400 | loss: 0.1166 | profit rate:    0.2 | accuracy: 0.22
step_num: 8600 | loss: 0.0922 | profit rate:    0.2 | accuracy: 0.20
step_num: 8800 | loss: 0.1068 | profit rate:    0.2 | accuracy: 0.20
step_num: 9000 | loss: 0.1712 | profit rate:    0.2 | accuracy: 0.20
step_num: 9200 | loss: 0.4468 | profit rate:    1.4 | accuracy: 0.22
step_num: 9400 | loss: 0.4247 | profit rate:    1.3 | accuracy: 0.23
step_num: 9600 | loss: 0.2589 | profit rate:    1.2 | accuracy: 0.23
step_num: 9800 | loss: 0.1685 | profit rate:    1.2 | accuracy: 0.23
step_num: 10000 | loss: 0.0934 | profit rate:    1.7 | accuracy: 0.22
step_num: 10200 | loss: 0.1166 | profit rate:    1.8 | accuracy: 0.21
step_num: 10400 | loss: 0.0707 | profit rate:    2.1 | accuracy: 0.21
episode:   3/8,耗时:0.63分/1.85分,训练集: | step: 10566 | average_treward:  142.7 | max_treward: 152.9751 | average profit rate:  2.632
step_num: 10600 | loss: 0.0823 | profit rate:    0.8 | accuracy: 0.11
step_num: 10800 | loss: 0.0530 | profit rate:    0.7 | accuracy: 0.04
step_num: 11000 | loss: 0.1026 | profit rate:    0.8 | accuracy: 0.09
step_num: 11200 | loss: 0.2849 | profit rate:    1.2 | accuracy: 0.15
step_num: 11400 | loss: 0.3459 | profit rate:    1.3 | accuracy: 0.17
step_num: 11600 | loss: 0.4147 | profit rate:    1.1 | accuracy: 0.20
step_num: 11800 | loss: 0.2289 | profit rate:    0.6 | accuracy: 0.20
step_num: 12000 | loss: 0.1018 | profit rate:    0.6 | accuracy: 0.19
step_num: 12200 | loss: 0.1648 | profit rate:    0.7 | accuracy: 0.19
step_num: 12400 | loss: 0.1624 | profit rate:    0.8 | accuracy: 0.18
step_num: 12600 | loss: 0.3035 | profit rate:    1.3 | accuracy: 0.19
step_num: 12800 | loss: 0.3144 | profit rate:    1.4 | accuracy: 0.20
step_num: 13000 | loss: 0.2812 | profit rate:    2.2 | accuracy: 0.21
step_num: 13200 | loss: 0.1561 | profit rate:    1.9 | accuracy: 0.20
step_num: 13400 | loss: 0.1341 | profit rate:    2.2 | accuracy: 0.20
step_num: 13600 | loss: 0.0858 | profit rate:    3.2 | accuracy: 0.19
step_num: 13800 | loss: 0.1329 | profit rate:    5.7 | accuracy: 0.19
step_num: 14000 | loss: 0.1735 | profit rate:    5.5 | accuracy: 0.19
step_num: 14200 | loss: 0.2288 | profit rate:    0.8 | accuracy: 0.13
step_num: 14400 | loss: 0.2576 | profit rate:    0.6 | accuracy: 0.15
step_num: 14600 | loss: 0.1952 | profit rate:    0.9 | accuracy: 0.17
step_num: 14800 | loss: 0.0811 | profit rate:    0.6 | accuracy: 0.16
step_num: 15000 | loss: 0.1963 | profit rate:    0.3 | accuracy: 0.16
step_num: 15200 | loss: 0.2456 | profit rate:    0.5 | accuracy: 0.19
step_num: 15400 | loss: 0.2192 | profit rate:    0.4 | accuracy: 0.19
step_num: 15600 | loss: 0.3764 | profit rate:    0.3 | accuracy: 0.20
step_num: 15800 | loss: 0.2826 | profit rate:    0.4 | accuracy: 0.21
step_num: 16000 | loss: 0.1851 | profit rate:    0.4 | accuracy: 0.22
step_num: 16200 | loss: 0.2435 | profit rate:    0.7 | accuracy: 0.23
step_num: 16400 | loss: 0.3086 | profit rate:    0.5 | accuracy: 0.23
step_num: 16600 | loss: 0.2078 | profit rate:    0.4 | accuracy: 0.23
step_num: 16800 | loss: 0.1717 | profit rate:    0.4 | accuracy: 0.23
step_num: 17000 | loss: 0.2036 | profit rate:    0.4 | accuracy: 0.22
step_num: 17200 | loss: 0.1649 | profit rate:    0.6 | accuracy: 0.22
step_num: 17400 | loss: 0.3059 | profit rate:    0.8 | accuracy: 0.23
step_num: 17600 | loss: 0.2451 | profit rate:    0.9 | accuracy: 0.23
episode:   5/8,耗时:0.63分/3.12分,训练集: | step: 17610 | average_treward:  153.5 | max_treward: 202.3857 | average profit rate:  2.927
model saved @ step:17610,performance:0.884,accuracy:0.23
step_num: 17800 | loss: 0.2170 | profit rate:    1.0 | accuracy: 0.17
step_num: 18000 | loss: 0.1232 | profit rate:    0.6 | accuracy: 0.16
step_num: 18200 | loss: 0.2167 | profit rate:    0.7 | accuracy: 0.19
step_num: 18400 | loss: 0.2135 | profit rate:    0.7 | accuracy: 0.19
step_num: 18600 | loss: 0.2220 | profit rate:    1.4 | accuracy: 0.20
step_num: 18800 | loss: 0.2313 | profit rate:    0.7 | accuracy: 0.20
step_num: 19000 | loss: 0.1174 | profit rate:    0.7 | accuracy: 0.19
step_num: 19200 | loss: 0.0790 | profit rate:    0.8 | accuracy: 0.18
step_num: 19400 | loss: 0.1290 | profit rate:    1.1 | accuracy: 0.18
step_num: 19600 | loss: 0.2745 | profit rate:    1.2 | accuracy: 0.19
step_num: 19800 | loss: 0.3091 | profit rate:    3.7 | accuracy: 0.20
step_num: 20000 | loss: 0.2669 | profit rate:    5.2 | accuracy: 0.21
step_num: 20200 | loss: 0.1978 | profit rate:    4.9 | accuracy: 0.21
step_num: 20400 | loss: 0.2268 | profit rate:    6.5 | accuracy: 0.21
step_num: 20600 | loss: 0.1979 | profit rate:    7.6 | accuracy: 0.21
step_num: 20800 | loss: 0.1133 | profit rate:   10.0 | accuracy: 0.21
step_num: 21000 | loss: 0.1846 | profit rate:   14.4 | accuracy: 0.21
step_num: 21200 | loss: 0.2371 | profit rate:    1.0 | accuracy: 0.17
step_num: 21400 | loss: 0.2586 | profit rate:    1.3 | accuracy: 0.23
step_num: 21600 | loss: 0.2225 | profit rate:    1.4 | accuracy: 0.24
step_num: 21800 | loss: 0.2097 | profit rate:    1.2 | accuracy: 0.22
step_num: 22000 | loss: 0.2196 | profit rate:    0.6 | accuracy: 0.22
step_num: 22200 | loss: 0.5116 | profit rate:    1.7 | accuracy: 0.26
step_num: 22400 | loss: 0.2749 | profit rate:    1.0 | accuracy: 0.25
step_num: 22600 | loss: 0.1135 | profit rate:    1.0 | accuracy: 0.23
step_num: 22800 | loss: 0.1355 | profit rate:    3.3 | accuracy: 0.23
step_num: 23000 | loss: 0.2718 | profit rate:    3.6 | accuracy: 0.23
step_num: 23200 | loss: 0.2232 | profit rate:    5.7 | accuracy: 0.23
step_num: 23400 | loss: 0.2560 | profit rate:    9.3 | accuracy: 0.23
step_num: 23600 | loss: 0.1214 | profit rate:   14.1 | accuracy: 0.23
step_num: 23800 | loss: 0.1340 | profit rate:   22.5 | accuracy: 0.22
step_num: 24000 | loss: 0.3154 | profit rate:   21.8 | accuracy: 0.23
step_num: 24200 | loss: 0.1206 | profit rate:   24.5 | accuracy: 0.23
step_num: 24400 | loss: 0.0600 | profit rate:   17.3 | accuracy: 0.22
step_num: 24600 | loss: 0.1942 | profit rate:   18.2 | accuracy: 0.22
episode:   7/8,耗时:0.64分/4.42分,训练集: | step: 24654 | average_treward:  168.4 | max_treward: 215.7286 | average profit rate:  7.375
model saved @ step:24654,performance:19.024,accuracy:0.22
step_num: 24800 | loss: 0.2044 | profit rate:    1.6 | accuracy: 0.21
step_num: 25000 | loss: 0.2163 | profit rate:    1.4 | accuracy: 0.18
step_num: 25200 | loss: 0.1747 | profit rate:    1.5 | accuracy: 0.23
step_num: 25400 | loss: 0.1607 | profit rate:    1.6 | accuracy: 0.20
step_num: 25600 | loss: 0.3865 | profit rate:    0.9 | accuracy: 0.24
step_num: 25800 | loss: 0.3080 | profit rate:    0.6 | accuracy: 0.25
step_num: 26000 | loss: 0.1219 | profit rate:    0.7 | accuracy: 0.23
step_num: 26200 | loss: 0.1467 | profit rate:    0.3 | accuracy: 0.22
step_num: 26400 | loss: 0.0614 | profit rate:    0.2 | accuracy: 0.21
step_num: 26600 | loss: 0.1113 | profit rate:    0.2 | accuracy: 0.21
step_num: 26800 | loss: 0.2599 | profit rate:    0.8 | accuracy: 0.21
step_num: 27000 | loss: 0.1965 | profit rate:    1.5 | accuracy: 0.21
step_num: 27200 | loss: 0.0745 | profit rate:    1.6 | accuracy: 0.20
step_num: 27400 | loss: 0.1636 | profit rate:    1.6 | accuracy: 0.20
step_num: 27600 | loss: 0.3386 | profit rate:    1.9 | accuracy: 0.20
step_num: 27800 | loss: 0.1872 | profit rate:    3.4 | accuracy: 0.20
step_num: 28000 | loss: 0.3839 | profit rate:    6.1 | accuracy: 0.21
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 31%|       | 93/299 [00:00<00:00, 928.95it/s] 68%|   | 203/299 [00:00<00:00, 1029.48it/s]100%|| 299/299 [00:00<00:00, 1082.89it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-19T12:00:00 | *** GOING LONG ***
2023-01-19T12:00:00's price 21071.5898, buy 0.0474098 units.
2023-01-19T12:00:00 | current balance = 0.00
2023-01-19T12:00:00 | balance:0.00+units:0.0474098*price:21071.5898=net_wealth:999.0010
--------------------------------------------------
2023-01-20T12:00:00 | *** GOING SHORT ***
2023-01-20T12:00:00's price 22667.2109, sell 0.0474098 units.
2023-01-20T12:00:00 | current balance = 1073.57
2023-01-20T12:00:00 | balance:1073.57+units:0.0*price:22667.2109=net_wealth:1073.5744
--------------------------------------------------
2023-02-01T12:00:00 | *** GOING LONG ***
2023-02-01T12:00:00's price 23732.6602, buy 0.04519092 units.
2023-02-01T12:00:00 | current balance = 0.00
2023-02-01T12:00:00 | balance:0.00+units:0.04519092*price:23732.6602=net_wealth:1072.5019
--------------------------------------------------
2023-02-03T00:00:00 | *** GOING SHORT ***
2023-02-03T00:00:00's price 23534.1309, sell 0.04519092 units.
2023-02-03T00:00:00 | current balance = 1062.47
2023-02-03T00:00:00 | balance:1062.47+units:0.0*price:23534.1309=net_wealth:1062.4667
--------------------------------------------------
2023-02-06T12:00:00 | *** GOING LONG ***
2023-02-06T12:00:00's price 22762.5195, buy 0.04662946 units.
2023-02-06T12:00:00 | current balance = 0.00
2023-02-06T12:00:00 | balance:0.00+units:0.04662946*price:22762.5195=net_wealth:1061.4053
--------------------------------------------------
2023-02-15T12:00:00 | *** GOING SHORT ***
2023-02-15T12:00:00's price 24324.0508, sell 0.04662946 units.
2023-02-15T12:00:00 | current balance = 1133.08
2023-02-15T12:00:00 | balance:1133.08+units:0.0*price:24324.0508=net_wealth:1133.0844
--------------------------------------------------
2023-02-21T00:00:00 | *** GOING LONG ***
2023-02-21T00:00:00's price 24572.8301, buy 0.04606515 units.
2023-02-21T00:00:00 | current balance = 0.00
2023-02-21T00:00:00 | balance:0.00+units:0.04606515*price:24572.8301=net_wealth:1131.9525
--------------------------------------------------
2023-03-02T00:00:00 | *** GOING SHORT ***
2023-03-02T00:00:00's price 23414.7305, sell 0.04606515 units.
2023-03-02T00:00:00 | current balance = 1077.53
2023-03-02T00:00:00 | balance:1077.53+units:0.0*price:23414.7305=net_wealth:1077.5258
--------------------------------------------------
2023-03-03T00:00:00 | *** GOING LONG ***
2023-03-03T00:00:00's price 22342.9199, buy 0.048178490000000004 units.
2023-03-03T00:00:00 | current balance = 0.00
2023-03-03T00:00:00 | balance:0.00+units:0.048178490000000004*price:22342.9199=net_wealth:1076.4494
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING SHORT ***
2023-03-13T12:00:00's price 24113.4805, sell 0.048178490000000004 units.
2023-03-13T12:00:00 | current balance = 1160.59
2023-03-13T12:00:00 | balance:1160.59+units:0.0*price:24113.4805=net_wealth:1160.5906
--------------------------------------------------
2023-03-20T00:00:00 | *** GOING LONG ***
2023-03-20T00:00:00's price 28188.9297, buy 0.04113068 units.
2023-03-20T00:00:00 | current balance = 0.00
2023-03-20T00:00:00 | balance:0.00+units:0.04113068*price:28188.9297=net_wealth:1159.4311
--------------------------------------------------
2023-03-21T00:00:00 | *** GOING SHORT ***
2023-03-21T00:00:00's price 28040.1309, sell 0.04113068 units.
2023-03-21T00:00:00 | current balance = 1152.16
2023-03-21T00:00:00 | balance:1152.16+units:0.0*price:28040.1309=net_wealth:1152.1576
--------------------------------------------------
2023-03-21T12:00:00 | *** GOING LONG ***
2023-03-21T12:00:00's price 28105.4707, buy 0.04095307 units.
2023-03-21T12:00:00 | current balance = 0.00
2023-03-21T12:00:00 | balance:0.00+units:0.04095307*price:28105.4707=net_wealth:1151.0066
--------------------------------------------------
2023-03-27T00:00:00 | *** GOING SHORT ***
2023-03-27T00:00:00's price 27892.6895, sell 0.04095307 units.
2023-03-27T00:00:00 | current balance = 1141.15
2023-03-27T00:00:00 | balance:1141.15+units:0.0*price:27892.6895=net_wealth:1141.1503
--------------------------------------------------
2023-04-03T12:00:00 | *** GOING LONG ***
2023-04-03T12:00:00's price 27800.0000, buy 0.04100752 units.
2023-04-03T12:00:00 | current balance = 0.00
2023-04-03T12:00:00 | balance:0.00+units:0.04100752*price:27800.0000=net_wealth:1140.0103
--------------------------------------------------
2023-04-12T12:00:00 | *** GOING SHORT ***
2023-04-12T12:00:00's price 29888.0703, sell 0.04100752 units.
2023-04-12T12:00:00 | current balance = 1224.41
2023-04-12T12:00:00 | balance:1224.41+units:0.0*price:29888.0703=net_wealth:1224.4112
--------------------------------------------------
2023-04-15T00:00:00 | *** GOING LONG ***
2023-04-15T00:00:00's price 30385.3008, buy 0.04025587 units.
2023-04-15T00:00:00 | current balance = 0.00
2023-04-15T00:00:00 | balance:0.00+units:0.04025587*price:30385.3008=net_wealth:1223.1880
--------------------------------------------------
2023-04-25T12:00:00 | *** GOING SHORT ***
2023-04-25T12:00:00's price 28300.7891, sell 0.04025587 units.
2023-04-25T12:00:00 | current balance = 1138.13
2023-04-25T12:00:00 | balance:1138.13+units:0.0*price:28300.7891=net_wealth:1138.1349
--------------------------------------------------
2023-04-26T12:00:00 | *** GOING LONG ***
2023-04-26T12:00:00's price 28415.2891, buy 0.04001355 units.
2023-04-26T12:00:00 | current balance = 0.00
2023-04-26T12:00:00 | balance:0.00+units:0.04001355*price:28415.2891=net_wealth:1136.9979
--------------------------------------------------
2023-04-27T00:00:00 | *** GOING SHORT ***
2023-04-27T00:00:00's price 28934.2109, sell 0.04001355 units.
2023-04-27T00:00:00 | current balance = 1156.60
2023-04-27T00:00:00 | balance:1156.60+units:0.0*price:28934.2109=net_wealth:1156.6041
--------------------------------------------------
2023-04-28T00:00:00 | *** GOING LONG ***
2023-04-28T00:00:00's price 29235.3594, buy 0.039522260000000003 units.
2023-04-28T00:00:00 | current balance = 0.00
2023-04-28T00:00:00 | balance:0.00+units:0.039522260000000003*price:29235.3594=net_wealth:1155.4486
--------------------------------------------------
2023-04-29T00:00:00 | *** GOING SHORT ***
2023-04-29T00:00:00's price 29332.1094, sell 0.039522260000000003 units.
2023-04-29T00:00:00 | current balance = 1158.11
2023-04-29T00:00:00 | balance:1158.11+units:0.0*price:29332.1094=net_wealth:1158.1131
--------------------------------------------------
2023-04-29T12:00:00 | *** GOING LONG ***
2023-04-29T12:00:00's price 29230.4492, buy 0.03958047 units.
2023-04-29T12:00:00 | current balance = 0.00
2023-04-29T12:00:00 | balance:0.00+units:0.03958047*price:29230.4492=net_wealth:1156.9562
--------------------------------------------------
2023-05-28T12:00:00 | *** GOING SHORT ***
2023-05-28T12:00:00's price 28065.0000, sell 0.03958047 units.
2023-05-28T12:00:00 | current balance = 1109.72
2023-05-28T12:00:00 | balance:1109.72+units:0.0*price:28065.0000=net_wealth:1109.7163
--------------------------------------------------
2023-05-31T00:00:00 | *** GOING LONG ***
2023-05-31T00:00:00's price 27097.1797, buy 0.040912250000000004 units.
2023-05-31T00:00:00 | current balance = 0.00
2023-05-31T00:00:00 | balance:0.00+units:0.040912250000000004*price:27097.1797=net_wealth:1108.6077
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.040912250000000004 units.
2023-06-08T12:00:00 | current balance = 1087.17
2023-06-08T12:00:00 | net performance [%] = 8.7170
2023-06-08T12:00:00 | number of trades [#] = 26
==================================================
Trial 13 Complete [00h 05m 07s]
net_wealth: 1088.2583573436098

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 25m 16s

Search: Running Trial #14

Value             |Best Value So Far |Hyperparameter
10                |8                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
7                 |14                |lags
0.97              |0.98              |gamma
1024              |32                |memory_size
16                |16                |batch_size
5                 |32                |n_steps
0.98              |0.98              |gae_lambda
10                |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4213.000000   4223.000000
mean      0.000429    19869.492402  ...   19956.789110  19920.121151
std       0.028054    16157.511856  ...   16193.633252  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7603.439941   7559.520020
50%       0.000696    11383.668066  ...   11471.990234  11460.440430
75%       0.011799    29453.128320  ...   29313.490234  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 600 | loss: 0.5174 | profit rate:   11.6 | accuracy: 0.34
step_num: 800 | loss: 0.6122 | profit rate:   18.2 | accuracy: 0.34
step_num: 1000 | loss: 0.6111 | profit rate:   33.6 | accuracy: 0.34
step_num: 1200 | loss: 0.6503 | profit rate:   27.4 | accuracy: 0.35
step_num: 1400 | loss: 0.5673 | profit rate:  104.8 | accuracy: 0.36
step_num: 1600 | loss: 0.5593 | profit rate:   21.4 | accuracy: 0.36
step_num: 1800 | loss: 0.5999 | profit rate:    9.1 | accuracy: 0.35
step_num: 2000 | loss: 0.5646 | profit rate:    0.7 | accuracy: 0.35
step_num: 2200 | loss: 0.5299 | profit rate:    6.1 | accuracy: 0.35
step_num: 2400 | loss: 0.5232 | profit rate:    1.5 | accuracy: 0.35
step_num: 2600 | loss: 0.5631 | profit rate:    0.7 | accuracy: 0.35
step_num: 2800 | loss: 0.5184 | profit rate:    0.0 | accuracy: 0.34
step_num: 3000 | loss: 0.4888 | profit rate:    0.0 | accuracy: 0.33
episode:   1/8,耗时:1.55分/1.55分,训练集: | step: 3170 | average_treward:  -26.3 | max_treward: 0.0000 | average profit rate:  0.031
step_num: 3200 | loss: 0.4231 | profit rate:    1.2 | accuracy: 0.10
step_num: 3400 | loss: 0.3479 | profit rate:    0.7 | accuracy: 0.10
step_num: 3600 | loss: 0.3177 | profit rate:    1.1 | accuracy: 0.11
step_num: 3800 | loss: 0.3259 | profit rate:    0.0 | accuracy: 0.14
step_num: 4000 | loss: 0.2040 | profit rate:    0.0 | accuracy: 0.11
step_num: 4200 | loss: 0.2140 | profit rate:    0.0 | accuracy: 0.11
step_num: 4400 | loss: 0.2277 | profit rate:    0.0 | accuracy: 0.12
step_num: 4600 | loss: 0.2937 | profit rate:    0.0 | accuracy: 0.13
step_num: 4800 | loss: 0.2441 | profit rate:    0.1 | accuracy: 0.13
step_num: 5000 | loss: 0.3470 | profit rate:    1.7 | accuracy: 0.14
step_num: 5200 | loss: 0.3076 | profit rate:    0.3 | accuracy: 0.15
step_num: 5400 | loss: 0.4087 | profit rate:    0.5 | accuracy: 0.16
step_num: 5600 | loss: 0.4202 | profit rate:    0.3 | accuracy: 0.17
step_num: 5800 | loss: 0.4597 | profit rate:    0.0 | accuracy: 0.17
step_num: 6000 | loss: 0.3517 | profit rate:    0.0 | accuracy: 0.16
step_num: 6200 | loss: 0.3606 | profit rate:    0.1 | accuracy: 0.17
model saved @ step:6340,performance:0.142,accuracy:0.17
step_num: 6400 | loss: 0.3600 | profit rate:    1.3 | accuracy: 0.18
step_num: 6600 | loss: 0.3284 | profit rate:    2.4 | accuracy: 0.15
step_num: 6800 | loss: 0.3307 | profit rate:    0.5 | accuracy: 0.18
step_num: 7000 | loss: 0.4106 | profit rate:    0.0 | accuracy: 0.25
step_num: 7200 | loss: 0.4699 | profit rate:    0.0 | accuracy: 0.26
step_num: 7400 | loss: 0.4330 | profit rate:    0.0 | accuracy: 0.24
step_num: 7600 | loss: 0.4718 | profit rate:    0.0 | accuracy: 0.25
step_num: 7800 | loss: 0.4370 | profit rate:    0.1 | accuracy: 0.24
step_num: 8000 | loss: 0.3614 | profit rate:    0.8 | accuracy: 0.24
step_num: 8200 | loss: 0.5218 | profit rate:   74.3 | accuracy: 0.26
step_num: 8400 | loss: 0.4592 | profit rate:    2.0 | accuracy: 0.26
step_num: 8600 | loss: 0.5109 | profit rate:   16.8 | accuracy: 0.26
step_num: 8800 | loss: 0.4806 | profit rate:   12.1 | accuracy: 0.27
step_num: 9000 | loss: 0.5375 | profit rate:   14.0 | accuracy: 0.26
step_num: 9200 | loss: 0.4509 | profit rate:   77.2 | accuracy: 0.26
step_num: 9400 | loss: 0.3858 | profit rate:  197.4 | accuracy: 0.26
episode:   3/8,耗时:1.88分/5.34分,训练集: | step: 9510 | average_treward:   49.2 | max_treward: 168.5990 | average profit rate: 68.172
model saved @ step:9510,performance:204.342,accuracy:0.26
step_num: 9600 | loss: 0.3990 | profit rate:    1.6 | accuracy: 0.20
step_num: 9800 | loss: 0.3525 | profit rate:    4.9 | accuracy: 0.23
step_num: 10000 | loss: 0.3165 | profit rate:    1.5 | accuracy: 0.20
step_num: 10200 | loss: 0.3496 | profit rate:    0.0 | accuracy: 0.23
step_num: 10400 | loss: 0.3127 | profit rate:    0.0 | accuracy: 0.20
step_num: 10600 | loss: 0.2743 | profit rate:    0.0 | accuracy: 0.18
step_num: 10800 | loss: 0.4493 | profit rate:    0.5 | accuracy: 0.20
step_num: 11000 | loss: 0.5281 | profit rate:    1.0 | accuracy: 0.21
step_num: 11200 | loss: 0.4624 | profit rate:    3.5 | accuracy: 0.22
step_num: 11400 | loss: 0.6239 | profit rate:   82.2 | accuracy: 0.24
step_num: 11600 | loss: 0.5280 | profit rate:    2.3 | accuracy: 0.24
step_num: 11800 | loss: 0.5291 | profit rate:  107.6 | accuracy: 0.25
step_num: 12000 | loss: 0.5586 | profit rate:   15.1 | accuracy: 0.25
step_num: 12200 | loss: 0.5433 | profit rate:   14.9 | accuracy: 0.25
step_num: 12400 | loss: 0.4053 | profit rate:    4.8 | accuracy: 0.26
step_num: 12600 | loss: 0.4609 | profit rate:   14.1 | accuracy: 0.25
model saved @ step:12680,performance:18.636,accuracy:0.25
step_num: 12800 | loss: 0.4248 | profit rate:    1.7 | accuracy: 0.15
step_num: 13000 | loss: 0.3867 | profit rate:    0.4 | accuracy: 0.18
step_num: 13200 | loss: 0.3512 | profit rate:    0.0 | accuracy: 0.19
step_num: 13400 | loss: 0.3893 | profit rate:    0.0 | accuracy: 0.21
step_num: 13600 | loss: 0.2631 | profit rate:    0.0 | accuracy: 0.18
step_num: 13800 | loss: 0.2843 | profit rate:    0.0 | accuracy: 0.17
step_num: 14000 | loss: 0.2228 | profit rate:    0.1 | accuracy: 0.18
step_num: 14200 | loss: 0.3723 | profit rate:    0.1 | accuracy: 0.18
step_num: 14400 | loss: 0.5643 | profit rate:   40.3 | accuracy: 0.21
step_num: 14600 | loss: 0.6396 | profit rate:   16.8 | accuracy: 0.21
step_num: 14800 | loss: 0.5374 | profit rate:   13.5 | accuracy: 0.20
step_num: 15000 | loss: 0.4964 | profit rate:  164.0 | accuracy: 0.21
step_num: 15200 | loss: 0.4935 | profit rate:   47.5 | accuracy: 0.21
step_num: 15400 | loss: 0.4331 | profit rate:  174.2 | accuracy: 0.22
step_num: 15600 | loss: 0.4361 | profit rate: 4856.8 | accuracy: 0.23
step_num: 15800 | loss: 0.4789 | profit rate: 6417.8 | accuracy: 0.24
episode:   5/8,耗时:1.88分/9.10分,训练集: | step: 15850 | average_treward:  115.1 | max_treward: 242.5529 | average profit rate: 1526.608
model saved @ step:15850,performance:7409.890,accuracy:0.24
step_num: 16000 | loss: 0.4819 | profit rate:    1.2 | accuracy: 0.26
step_num: 16200 | loss: 0.6197 | profit rate:    4.0 | accuracy: 0.32
step_num: 16400 | loss: 0.5404 | profit rate:    0.2 | accuracy: 0.30
step_num: 16600 | loss: 0.4384 | profit rate:    0.2 | accuracy: 0.26
step_num: 16800 | loss: 0.3858 | profit rate:    0.1 | accuracy: 0.23
step_num: 17000 | loss: 0.3379 | profit rate:    0.1 | accuracy: 0.22
step_num: 17200 | loss: 0.3283 | profit rate:    0.3 | accuracy: 0.21
step_num: 17400 | loss: 0.2849 | profit rate:    0.4 | accuracy: 0.20
step_num: 17600 | loss: 0.4151 | profit rate:    0.7 | accuracy: 0.19
step_num: 17800 | loss: 0.5796 | profit rate:    9.1 | accuracy: 0.20
step_num: 18000 | loss: 0.4273 | profit rate:    6.4 | accuracy: 0.21
step_num: 18200 | loss: 0.5250 | profit rate:   32.5 | accuracy: 0.21
step_num: 18400 | loss: 0.4614 | profit rate:   17.2 | accuracy: 0.22
step_num: 18600 | loss: 0.4750 | profit rate:   17.9 | accuracy: 0.22
step_num: 18800 | loss: 0.5662 | profit rate:   14.2 | accuracy: 0.24
step_num: 19000 | loss: 0.5310 | profit rate:   23.5 | accuracy: 0.24
step_num: 19200 | loss: 0.4267 | profit rate:    1.5 | accuracy: 0.13
step_num: 19400 | loss: 0.4299 | profit rate:    9.9 | accuracy: 0.23
step_num: 19600 | loss: 0.4383 | profit rate:    7.5 | accuracy: 0.24
step_num: 19800 | loss: 0.3701 | profit rate:    5.9 | accuracy: 0.21
step_num: 20000 | loss: 0.2907 | profit rate:    4.3 | accuracy: 0.20
step_num: 20200 | loss: 0.4109 | profit rate:    7.5 | accuracy: 0.20
step_num: 20400 | loss: 0.3915 | profit rate:   11.3 | accuracy: 0.19
step_num: 20600 | loss: 0.3348 | profit rate:   18.9 | accuracy: 0.19
step_num: 20800 | loss: 0.3692 | profit rate:   30.4 | accuracy: 0.18
step_num: 21000 | loss: 0.3892 | profit rate:  325.5 | accuracy: 0.18
step_num: 21200 | loss: 0.3475 | profit rate:  728.5 | accuracy: 0.18
step_num: 21400 | loss: 0.3258 | profit rate: 1884.2 | accuracy: 0.18
step_num: 21600 | loss: 0.4042 | profit rate: 2494.8 | accuracy: 0.19
step_num: 21800 | loss: 0.3817 | profit rate:  181.6 | accuracy: 0.19
step_num: 22000 | loss: 0.4510 | profit rate: 1812.0 | accuracy: 0.20
episode:   7/8,耗时:1.83分/12.79分,训练集: | step: 22190 | average_treward:  134.0 | max_treward: 242.5529 | average profit rate: 1242.487
step_num: 22200 | loss: 0.4459 | profit rate:    1.0 | accuracy: 0.00
step_num: 22400 | loss: 0.5438 | profit rate:    3.3 | accuracy: 0.14
step_num: 22600 | loss: 0.3795 | profit rate:    9.4 | accuracy: 0.18
step_num: 22800 | loss: 0.4233 | profit rate:    2.9 | accuracy: 0.21
step_num: 23000 | loss: 0.3153 | profit rate:    3.6 | accuracy: 0.19
step_num: 23200 | loss: 0.3165 | profit rate:    2.7 | accuracy: 0.19
step_num: 23400 | loss: 0.4515 | profit rate:   26.9 | accuracy: 0.21
step_num: 23600 | loss: 0.3977 | profit rate:   71.4 | accuracy: 0.21
step_num: 23800 | loss: 0.3971 | profit rate:   69.6 | accuracy: 0.19
step_num: 24000 | loss: 0.4214 | profit rate:   77.9 | accuracy: 0.18
step_num: 24200 | loss: 0.4472 | profit rate:  158.3 | accuracy: 0.18
step_num: 24400 | loss: 0.4096 | profit rate: 1333.0 | accuracy: 0.19
step_num: 24600 | loss: 0.4007 | profit rate: 1504.1 | accuracy: 0.19
step_num: 24800 | loss: 0.4596 | profit rate:  976.5 | accuracy: 0.21
step_num: 25000 | loss: 0.4821 | profit rate:   25.2 | accuracy: 0.22
step_num: 25200 | loss: 0.5591 | profit rate:  113.3 | accuracy: 0.23
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 37%|      | 116/312 [00:00<00:00, 1156.01it/s] 81%|  | 252/312 [00:00<00:00, 1275.83it/s]100%|| 312/312 [00:00<00:00, 1246.28it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-17T12:00:00 | *** GOING LONG ***
2023-01-17T12:00:00's price 21134.8105, buy 0.04726798 units.
2023-01-17T12:00:00 | current balance = 0.00
2023-01-17T12:00:00 | balance:0.00+units:0.04726798*price:21134.8105=net_wealth:999.0010
--------------------------------------------------
2023-01-19T12:00:00 | *** GOING SHORT ***
2023-01-19T12:00:00's price 21071.5898, sell 0.04726798 units.
2023-01-19T12:00:00 | current balance = 995.02
2023-01-19T12:00:00 | balance:995.02+units:0.0*price:21071.5898=net_wealth:995.0167
--------------------------------------------------
2023-01-20T00:00:00 | *** GOING LONG ***
2023-01-20T00:00:00's price 20963.5098, buy 0.04741675 units.
2023-01-20T00:00:00 | current balance = 0.00
2023-01-20T00:00:00 | balance:0.00+units:0.04741675*price:20963.5098=net_wealth:994.0227
--------------------------------------------------
2023-01-20T12:00:00 | *** GOING SHORT ***
2023-01-20T12:00:00's price 22667.2109, sell 0.04741675 units.
2023-01-20T12:00:00 | current balance = 1073.73
2023-01-20T12:00:00 | balance:1073.73+units:0.0*price:22667.2109=net_wealth:1073.7318
--------------------------------------------------
2023-01-22T00:00:00 | *** GOING LONG ***
2023-01-22T00:00:00's price 22783.6094, buy 0.047080250000000004 units.
2023-01-22T00:00:00 | current balance = 0.00
2023-01-22T00:00:00 | balance:0.00+units:0.047080250000000004*price:22783.6094=net_wealth:1072.6592
--------------------------------------------------
2023-02-18T12:00:00 | *** GOING SHORT ***
2023-02-18T12:00:00's price 24631.9492, sell 0.047080250000000004 units.
2023-02-18T12:00:00 | current balance = 1158.52
2023-02-18T12:00:00 | balance:1158.52+units:0.0*price:24631.9492=net_wealth:1158.5198
--------------------------------------------------
2023-02-22T00:00:00 | *** GOING LONG ***
2023-02-22T00:00:00's price 24160.8691, buy 0.0479023 units.
2023-02-22T00:00:00 | current balance = 0.00
2023-02-22T00:00:00 | balance:0.00+units:0.0479023*price:24160.8691=net_wealth:1157.3624
--------------------------------------------------
2023-03-13T00:00:00 | *** GOING SHORT ***
2023-03-13T00:00:00's price 22106.6406, sell 0.0479023 units.
2023-03-13T00:00:00 | current balance = 1057.90
2023-03-13T00:00:00 | balance:1057.90+units:0.0*price:22106.6406=net_wealth:1057.9012
--------------------------------------------------
2023-03-18T00:00:00 | *** GOING LONG ***
2023-03-18T00:00:00's price 27443.0898, buy 0.03851036 units.
2023-03-18T00:00:00 | current balance = 0.00
2023-03-18T00:00:00 | balance:0.00+units:0.03851036*price:27443.0898=net_wealth:1056.8444
--------------------------------------------------
2023-03-19T00:00:00 | *** GOING SHORT ***
2023-03-19T00:00:00's price 27160.9805, sell 0.03851036 units.
2023-03-19T00:00:00 | current balance = 1044.93
2023-03-19T00:00:00 | balance:1044.93+units:0.0*price:27160.9805=net_wealth:1044.9342
--------------------------------------------------
2023-03-22T12:00:00 | *** GOING LONG ***
2023-03-22T12:00:00's price 27250.9707, buy 0.03830649 units.
2023-03-22T12:00:00 | current balance = 0.00
2023-03-22T12:00:00 | balance:0.00+units:0.03830649*price:27250.9707=net_wealth:1043.8903
--------------------------------------------------
2023-04-30T00:00:00 | *** GOING SHORT ***
2023-04-30T00:00:00's price 29197.0098, sell 0.03830649 units.
2023-04-30T00:00:00 | current balance = 1117.32
2023-04-30T00:00:00 | balance:1117.32+units:0.0*price:29197.0098=net_wealth:1117.3178
--------------------------------------------------
2023-05-06T00:00:00 | *** GOING LONG ***
2023-05-06T00:00:00's price 29266.1504, buy 0.03813964 units.
2023-05-06T00:00:00 | current balance = 0.00
2023-05-06T00:00:00 | balance:0.00+units:0.03813964*price:29266.1504=net_wealth:1116.2016
--------------------------------------------------
2023-05-18T00:00:00 | *** GOING SHORT ***
2023-05-18T00:00:00's price 27398.9707, sell 0.03813964 units.
2023-05-18T00:00:00 | current balance = 1043.94
2023-05-18T00:00:00 | balance:1043.94+units:0.0*price:27398.9707=net_wealth:1043.9431
--------------------------------------------------
2023-05-31T00:00:00 | *** GOING LONG ***
2023-05-31T00:00:00's price 27097.1797, buy 0.03848736 units.
2023-05-31T00:00:00 | current balance = 0.00
2023-05-31T00:00:00 | balance:0.00+units:0.03848736*price:27097.1797=net_wealth:1042.9002
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03848736 units.
2023-06-08T12:00:00 | current balance = 1022.73
2023-06-08T12:00:00 | net performance [%] = 2.2733
2023-06-08T12:00:00 | number of trades [#] = 16
==================================================
Trial 14 Complete [00h 14m 43s]
net_wealth: 1023.7569406861711

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 39m 59s

Search: Running Trial #15

Value             |Best Value So Far |Hyperparameter
12                |8                 |horizon
225               |225               |lookback
True              |True              |MarketFactor
7                 |14                |lags
0.9               |0.98              |gamma
256               |32                |memory_size
32                |16                |batch_size
10                |32                |n_steps
0.97              |0.98              |gae_lambda
1                 |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4197.000000   4209.000000
mean      0.000424    19921.326125  ...   20015.719609  19971.309209
std       0.028069    16159.303521  ...   16196.261229  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7658.839844   7625.000000
50%       0.000696    11410.370947  ...   11515.000000  11477.000000
75%       0.011720    29502.909082  ...   29430.269531  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 1.0299 | profit rate:    8.5 | accuracy: 0.36
step_num: 400 | loss: 0.5636 | profit rate:   18.2 | accuracy: 0.35
step_num: 600 | loss: 0.5904 | profit rate:  119.4 | accuracy: 0.37
step_num: 800 | loss: 0.5720 | profit rate:   11.5 | accuracy: 0.35
step_num: 1000 | loss: 0.5154 | profit rate:    2.2 | accuracy: 0.35
step_num: 1200 | loss: 0.5417 | profit rate:    7.3 | accuracy: 0.34
step_num: 1400 | loss: 0.6001 | profit rate:    4.5 | accuracy: 0.35
step_num: 1600 | loss: 0.6431 | profit rate:    1.5 | accuracy: 0.36
step_num: 1800 | loss: 0.5586 | profit rate:   14.4 | accuracy: 0.37
step_num: 2000 | loss: 0.4547 | profit rate:    1.2 | accuracy: 0.37
step_num: 2200 | loss: 0.5482 | profit rate:   52.3 | accuracy: 0.37
step_num: 2400 | loss: 0.5635 | profit rate: 1623.5 | accuracy: 0.38
step_num: 2600 | loss: 0.8266 | profit rate:    1.5 | accuracy: 0.38
step_num: 2800 | loss: 0.6111 | profit rate:   11.2 | accuracy: 0.37
step_num: 3000 | loss: 0.5545 | profit rate:    0.4 | accuracy: 0.37
step_num: 3200 | loss: 0.2794 | profit rate:    1.6 | accuracy: 0.36
step_num: 3400 | loss: 0.4274 | profit rate:    0.8 | accuracy: 0.36
step_num: 3600 | loss: 0.5009 | profit rate:    2.3 | accuracy: 0.35
episode:   1/8,耗时:0.59分/0.59分,训练集: | step: 3661 | average_treward:   38.2 | max_treward: 38.1523 | average profit rate:  2.802
model saved @ step:3661,performance:2.802,accuracy:0.35
step_num: 3800 | loss: 0.4946 | profit rate:   32.6 | accuracy: 0.46
step_num: 4000 | loss: 0.5948 | profit rate:  521.4 | accuracy: 0.39
step_num: 4200 | loss: 0.4725 | profit rate: 1826.2 | accuracy: 0.32
step_num: 4400 | loss: 0.5453 | profit rate:  816.5 | accuracy: 0.33
step_num: 4600 | loss: 0.5846 | profit rate:   18.8 | accuracy: 0.32
step_num: 4800 | loss: 0.2607 | profit rate:    0.1 | accuracy: 0.28
step_num: 5000 | loss: 0.1945 | profit rate:    0.1 | accuracy: 0.26
step_num: 5200 | loss: 0.2169 | profit rate:    0.1 | accuracy: 0.24
step_num: 5400 | loss: 0.2606 | profit rate:    1.6 | accuracy: 0.24
step_num: 5600 | loss: 0.4377 | profit rate:    3.3 | accuracy: 0.25
step_num: 5800 | loss: 0.4944 | profit rate:    2.2 | accuracy: 0.26
step_num: 6000 | loss: 0.3952 | profit rate:  267.0 | accuracy: 0.27
step_num: 6200 | loss: 0.9107 | profit rate:    0.7 | accuracy: 0.28
step_num: 6400 | loss: 0.4601 | profit rate:    1.5 | accuracy: 0.28
step_num: 6600 | loss: 0.5209 | profit rate:    0.1 | accuracy: 0.28
step_num: 6800 | loss: 0.3416 | profit rate:    0.2 | accuracy: 0.28
step_num: 7000 | loss: 0.5383 | profit rate:    1.1 | accuracy: 0.28
step_num: 7200 | loss: 0.5691 | profit rate:    3.3 | accuracy: 0.29
model saved @ step:7322,performance:40.535,accuracy:0.29
step_num: 7400 | loss: 0.6911 | profit rate:  573.1 | accuracy: 0.72
step_num: 7600 | loss: 0.7118 | profit rate:  911.0 | accuracy: 0.56
step_num: 7800 | loss: 0.4859 | profit rate: 184498.3 | accuracy: 0.53
step_num: 8000 | loss: 0.6474 | profit rate: 37507.9 | accuracy: 0.51
step_num: 8200 | loss: 0.6281 | profit rate: 31386.4 | accuracy: 0.46
step_num: 8400 | loss: 0.4624 | profit rate:    5.2 | accuracy: 0.39
step_num: 8600 | loss: 0.3785 | profit rate:    2.2 | accuracy: 0.37
step_num: 8800 | loss: 0.2611 | profit rate:    0.9 | accuracy: 0.34
step_num: 9000 | loss: 0.1426 | profit rate:    0.6 | accuracy: 0.31
step_num: 9200 | loss: 0.0562 | profit rate:    0.8 | accuracy: 0.28
step_num: 9400 | loss: 0.1051 | profit rate:    1.5 | accuracy: 0.26
step_num: 9600 | loss: 0.2367 | profit rate:    7.9 | accuracy: 0.25
step_num: 9800 | loss: 0.5712 | profit rate:    1.9 | accuracy: 0.27
step_num: 10000 | loss: 0.4004 | profit rate:    4.5 | accuracy: 0.26
step_num: 10200 | loss: 0.5349 | profit rate:    2.5 | accuracy: 0.27
step_num: 10400 | loss: 0.2949 | profit rate:    0.4 | accuracy: 0.26
step_num: 10600 | loss: 0.1159 | profit rate:    0.2 | accuracy: 0.25
step_num: 10800 | loss: 0.3115 | profit rate:    0.9 | accuracy: 0.24
episode:   3/8,耗时:0.68分/1.92分,训练集: | step: 10983 | average_treward:   68.5 | max_treward: 86.8451 | average profit rate: 16.401
model saved @ step:10983,performance:5.865,accuracy:0.24
step_num: 11000 | loss: 0.2943 | profit rate:    0.2 | accuracy: 0.28
step_num: 11200 | loss: 0.6209 | profit rate:  829.7 | accuracy: 0.50
step_num: 11400 | loss: 0.4969 | profit rate: 4750.6 | accuracy: 0.42
step_num: 11600 | loss: 0.4178 | profit rate: 101761.0 | accuracy: 0.41
step_num: 11800 | loss: 0.4761 | profit rate: 83215.5 | accuracy: 0.39
step_num: 12000 | loss: 0.3999 | profit rate:  283.3 | accuracy: 0.35
step_num: 12200 | loss: 0.2855 | profit rate:   84.4 | accuracy: 0.32
step_num: 12400 | loss: 0.1049 | profit rate:   64.0 | accuracy: 0.29
step_num: 12600 | loss: 0.1004 | profit rate:   38.1 | accuracy: 0.26
step_num: 12800 | loss: 0.0742 | profit rate:   46.5 | accuracy: 0.24
step_num: 13000 | loss: 0.0679 | profit rate:   40.3 | accuracy: 0.22
step_num: 13200 | loss: 0.1055 | profit rate:  123.1 | accuracy: 0.21
step_num: 13400 | loss: 0.4193 | profit rate:  811.5 | accuracy: 0.22
step_num: 13600 | loss: 0.3191 | profit rate:  858.6 | accuracy: 0.22
step_num: 13800 | loss: 0.3638 | profit rate: 3947.3 | accuracy: 0.23
step_num: 14000 | loss: 0.3371 | profit rate:  205.7 | accuracy: 0.22
step_num: 14200 | loss: 0.0780 | profit rate:  195.2 | accuracy: 0.22
step_num: 14400 | loss: 0.2336 | profit rate:  434.5 | accuracy: 0.22
step_num: 14600 | loss: 0.2754 | profit rate:  808.1 | accuracy: 0.21
model saved @ step:14644,performance:793.372,accuracy:0.21
step_num: 14800 | loss: 0.4810 | profit rate:  207.0 | accuracy: 0.40
step_num: 15000 | loss: 0.4398 | profit rate: 5840.5 | accuracy: 0.37
step_num: 15200 | loss: 0.3588 | profit rate: 14080.3 | accuracy: 0.32
step_num: 15400 | loss: 0.4511 | profit rate: 33597.1 | accuracy: 0.32
step_num: 15600 | loss: 0.5065 | profit rate:  902.9 | accuracy: 0.31
step_num: 15800 | loss: 0.3543 | profit rate:  335.5 | accuracy: 0.30
step_num: 16000 | loss: 0.2785 | profit rate:  947.4 | accuracy: 0.28
step_num: 16200 | loss: 0.3226 | profit rate:  338.7 | accuracy: 0.27
step_num: 16400 | loss: 0.0645 | profit rate:  257.9 | accuracy: 0.25
step_num: 16600 | loss: 0.0343 | profit rate:  170.3 | accuracy: 0.22
step_num: 16800 | loss: 0.0218 | profit rate:  176.5 | accuracy: 0.20
step_num: 17000 | loss: 0.0810 | profit rate:  210.2 | accuracy: 0.19
step_num: 17200 | loss: 0.2873 | profit rate:  490.9 | accuracy: 0.20
step_num: 17400 | loss: 0.4781 | profit rate: 6224.3 | accuracy: 0.20
step_num: 17600 | loss: 0.3873 | profit rate:  543.7 | accuracy: 0.21
step_num: 17800 | loss: 0.1951 | profit rate:  709.8 | accuracy: 0.20
step_num: 18000 | loss: 0.2981 | profit rate:  728.4 | accuracy: 0.20
step_num: 18200 | loss: 0.4058 | profit rate: 10051.4 | accuracy: 0.21
episode:   5/8,耗时:0.66分/3.24分,训练集: | step: 18305 | average_treward:  105.3 | max_treward: 182.8204 | average profit rate: 2500.913
model saved @ step:18305,performance:11661.988,accuracy:0.21
step_num: 18400 | loss: 0.3184 | profit rate:    0.4 | accuracy: 0.19
step_num: 18600 | loss: 0.4611 | profit rate:    3.9 | accuracy: 0.24
step_num: 18800 | loss: 0.3866 | profit rate:   46.0 | accuracy: 0.23
step_num: 19000 | loss: 0.3765 | profit rate:  450.1 | accuracy: 0.25
step_num: 19200 | loss: 0.2975 | profit rate:  537.6 | accuracy: 0.26
step_num: 19400 | loss: 0.2191 | profit rate:   96.0 | accuracy: 0.25
step_num: 19600 | loss: 0.2706 | profit rate:   90.2 | accuracy: 0.24
step_num: 19800 | loss: 0.2032 | profit rate:   85.9 | accuracy: 0.23
step_num: 20000 | loss: 0.2128 | profit rate:  107.8 | accuracy: 0.22
step_num: 20200 | loss: 0.1359 | profit rate:   20.7 | accuracy: 0.20
step_num: 20400 | loss: 0.1547 | profit rate:   48.9 | accuracy: 0.19
step_num: 20600 | loss: 0.8307 | profit rate: 48770.5 | accuracy: 0.21
step_num: 20800 | loss: 0.4760 | profit rate: 15180.6 | accuracy: 0.22
step_num: 21000 | loss: 0.2513 | profit rate: 110255.9 | accuracy: 0.21
step_num: 21200 | loss: 0.5151 | profit rate: 3495803.9 | accuracy: 0.23
step_num: 21400 | loss: 0.4018 | profit rate: 8268690.3 | accuracy: 0.24
step_num: 21600 | loss: 0.3158 | profit rate: 3783778.0 | accuracy: 0.23
step_num: 21800 | loss: 0.4989 | profit rate: 39448228.3 | accuracy: 0.24
model saved @ step:21966,performance:329649559.856,accuracy:0.24
step_num: 22000 | loss: 0.4118 | profit rate:    0.6 | accuracy: 0.43
step_num: 22200 | loss: 0.5662 | profit rate:   81.1 | accuracy: 0.34
step_num: 22400 | loss: 0.4518 | profit rate: 7126.2 | accuracy: 0.36
step_num: 22600 | loss: 0.3658 | profit rate: 52380.3 | accuracy: 0.35
step_num: 22800 | loss: 0.3998 | profit rate: 316943.5 | accuracy: 0.34
step_num: 23000 | loss: 0.3994 | profit rate: 4772.5 | accuracy: 0.32
step_num: 23200 | loss: 0.5653 | profit rate: 43747.4 | accuracy: 0.33
step_num: 23400 | loss: 0.3161 | profit rate: 25738.0 | accuracy: 0.32
step_num: 23600 | loss: 0.2010 | profit rate: 10085.8 | accuracy: 0.29
step_num: 23800 | loss: 0.1429 | profit rate: 6300.4 | accuracy: 0.27
step_num: 24000 | loss: 0.1277 | profit rate: 2815.0 | accuracy: 0.25
step_num: 24200 | loss: 0.5400 | profit rate: 31387.1 | accuracy: 0.24
step_num: 24400 | loss: 0.6205 | profit rate: 22038815.2 | accuracy: 0.26
step_num: 24600 | loss: 0.3540 | profit rate: 3262486.6 | accuracy: 0.26
step_num: 24800 | loss: 0.3177 | profit rate: 54149276.4 | accuracy: 0.27
step_num: 25000 | loss: 0.3643 | profit rate: 4810568.7 | accuracy: 0.26
step_num: 25200 | loss: 0.2279 | profit rate: 16504531.3 | accuracy: 0.25
step_num: 25400 | loss: 0.3077 | profit rate: 26531589.2 | accuracy: 0.26
step_num: 25600 | loss: 0.3747 | profit rate: 620036138.9 | accuracy: 0.26
episode:   7/8,耗时:0.65分/4.55分,训练集: | step: 25627 | average_treward:  168.0 | max_treward: 339.2264 | average profit rate: 135671171.902
model saved @ step:25627,performance:620036138.893,accuracy:0.26
step_num: 25800 | loss: 0.3944 | profit rate:   20.1 | accuracy: 0.37
step_num: 26000 | loss: 0.4735 | profit rate:  873.7 | accuracy: 0.32
step_num: 26200 | loss: 0.3184 | profit rate: 8211.4 | accuracy: 0.31
step_num: 26400 | loss: 0.3347 | profit rate: 203792.7 | accuracy: 0.31
step_num: 26600 | loss: 0.3057 | profit rate: 15381.6 | accuracy: 0.31
step_num: 26800 | loss: 0.4999 | profit rate: 77609.0 | accuracy: 0.32
step_num: 27000 | loss: 0.2798 | profit rate: 57033.8 | accuracy: 0.31
step_num: 27200 | loss: 0.2810 | profit rate: 66903.8 | accuracy: 0.29
step_num: 27400 | loss: 0.1269 | profit rate: 93496.2 | accuracy: 0.26
step_num: 27600 | loss: 0.3255 | profit rate: 16110.8 | accuracy: 0.26
step_num: 27800 | loss: 0.2233 | profit rate: 320765.6 | accuracy: 0.25
step_num: 28000 | loss: 0.4779 | profit rate: 108399343.7 | accuracy: 0.27
step_num: 28200 | loss: 0.4787 | profit rate: 20180485.7 | accuracy: 0.28
step_num: 28400 | loss: 0.3412 | profit rate: 465204199.3 | accuracy: 0.28
step_num: 28600 | loss: 0.3573 | profit rate: 41980247.3 | accuracy: 0.28
step_num: 28800 | loss: 0.2069 | profit rate: 289686892.9 | accuracy: 0.27
step_num: 29000 | loss: 0.3362 | profit rate: 347195917.9 | accuracy: 0.26
step_num: 29200 | loss: 0.4248 | profit rate: 65545480794.4 | accuracy: 0.27
model saved @ step:29288,performance:81535621786.602,accuracy:0.27
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 33%|      | 103/312 [00:00<00:00, 1020.08it/s] 70%|   | 218/312 [00:00<00:00, 1096.20it/s]100%|| 312/312 [00:00<00:00, 1137.61it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING LONG ***
2023-02-07T00:00:00's price 22977.2402, buy 0.043477800000000004 units.
2023-02-07T00:00:00 | current balance = 0.00
2023-02-07T00:00:00 | balance:0.00+units:0.043477800000000004*price:22977.2402=net_wealth:999.0010
--------------------------------------------------
2023-02-07T12:00:00 | *** GOING SHORT ***
2023-02-07T12:00:00's price 23240.4609, sell 0.043477800000000004 units.
2023-02-07T12:00:00 | current balance = 1009.43
2023-02-07T12:00:00 | balance:1009.43+units:0.0*price:23240.4609=net_wealth:1009.4348
--------------------------------------------------
2023-02-10T12:00:00 | *** GOING LONG ***
2023-02-10T12:00:00's price 21625.1895, buy 0.04663197 units.
2023-02-10T12:00:00 | current balance = 0.00
2023-02-10T12:00:00 | balance:0.00+units:0.04663197*price:21625.1895=net_wealth:1008.4264
--------------------------------------------------
2023-02-14T12:00:00 | *** GOING SHORT ***
2023-02-14T12:00:00's price 22199.8398, sell 0.04663197 units.
2023-02-14T12:00:00 | current balance = 1034.19
2023-02-14T12:00:00 | balance:1034.19+units:0.0*price:22199.8398=net_wealth:1034.1882
--------------------------------------------------
2023-03-03T00:00:00 | *** GOING LONG ***
2023-03-03T00:00:00's price 22342.9199, buy 0.04624078 units.
2023-03-03T00:00:00 | current balance = 0.00
2023-03-03T00:00:00 | balance:0.00+units:0.04624078*price:22342.9199=net_wealth:1033.1551
--------------------------------------------------
2023-03-12T12:00:00 | *** GOING SHORT ***
2023-03-12T12:00:00's price 21997.1094, sell 0.04624078 units.
2023-03-12T12:00:00 | current balance = 1016.15
2023-03-12T12:00:00 | balance:1016.15+units:0.0*price:21997.1094=net_wealth:1016.1474
--------------------------------------------------
2023-03-19T00:00:00 | *** GOING LONG ***
2023-03-19T00:00:00's price 27160.9805, buy 0.03737461 units.
2023-03-19T00:00:00 | current balance = 0.00
2023-03-19T00:00:00 | balance:0.00+units:0.03737461*price:27160.9805=net_wealth:1015.1322
--------------------------------------------------
2023-03-21T00:00:00 | *** GOING SHORT ***
2023-03-21T00:00:00's price 28040.1309, sell 0.03737461 units.
2023-03-21T00:00:00 | current balance = 1046.94
2023-03-21T00:00:00 | balance:1046.94+units:0.0*price:28040.1309=net_wealth:1046.9422
--------------------------------------------------
2023-03-22T12:00:00 | *** GOING LONG ***
2023-03-22T12:00:00's price 27250.9707, buy 0.0383801 units.
2023-03-22T12:00:00 | current balance = 0.00
2023-03-22T12:00:00 | balance:0.00+units:0.0383801*price:27250.9707=net_wealth:1045.8963
--------------------------------------------------
2023-04-11T12:00:00 | *** GOING SHORT ***
2023-04-11T12:00:00's price 30200.4199, sell 0.0383801 units.
2023-04-11T12:00:00 | current balance = 1157.94
2023-04-11T12:00:00 | balance:1157.94+units:0.0*price:30200.4199=net_wealth:1157.9373
--------------------------------------------------
2023-04-12T00:00:00 | *** GOING LONG ***
2023-04-12T00:00:00's price 30016.3008, buy 0.03853837 units.
2023-04-12T00:00:00 | current balance = 0.00
2023-04-12T00:00:00 | balance:0.00+units:0.03853837*price:30016.3008=net_wealth:1156.7805
--------------------------------------------------
2023-05-28T00:00:00 | *** GOING SHORT ***
2023-05-28T00:00:00's price 27153.7598, sell 0.03853837 units.
2023-05-28T00:00:00 | current balance = 1045.42
2023-05-28T00:00:00 | balance:1045.42+units:0.0*price:27153.7598=net_wealth:1045.4164
--------------------------------------------------
2023-06-01T00:00:00 | *** GOING LONG ***
2023-06-01T00:00:00's price 26892.9609, buy 0.03883436 units.
2023-06-01T00:00:00 | current balance = 0.00
2023-06-01T00:00:00 | balance:0.00+units:0.03883436*price:26892.9609=net_wealth:1044.3721
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03883436 units.
2023-06-08T12:00:00 | current balance = 1031.95
2023-06-08T12:00:00 | net performance [%] = 3.1954
2023-06-08T12:00:00 | number of trades [#] = 14
==================================================
Trial 15 Complete [00h 05m 15s]
net_wealth: 1032.9869084913478

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 45m 14s

Search: Running Trial #16

Value             |Best Value So Far |Hyperparameter
2                 |8                 |horizon
225               |225               |lookback
False             |True              |MarketFactor
7                 |14                |lags
0.5               |0.98              |gamma
32                |32                |memory_size
32                |16                |batch_size
20                |32                |n_steps
0.97              |0.98              |gae_lambda
10                |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.8691 | profit rate:    1.0 | accuracy: 0.37
step_num: 400 | loss: 0.6585 | profit rate:    0.6 | accuracy: 0.36
step_num: 600 | loss: 0.5778 | profit rate:    0.7 | accuracy: 0.36
step_num: 800 | loss: 0.6480 | profit rate:    0.8 | accuracy: 0.35
step_num: 1000 | loss: 0.1164 | profit rate:    0.8 | accuracy: 0.32
step_num: 1200 | loss: 0.3243 | profit rate:    0.6 | accuracy: 0.31
step_num: 1400 | loss: 0.4547 | profit rate:    0.5 | accuracy: 0.30
step_num: 1600 | loss: 0.3721 | profit rate:    0.3 | accuracy: 0.30
step_num: 1800 | loss: 0.1244 | profit rate:    0.1 | accuracy: 0.30
step_num: 2000 | loss: 0.3076 | profit rate:    0.1 | accuracy: 0.28
step_num: 2200 | loss: 0.7766 | profit rate:    0.2 | accuracy: 0.30
step_num: 2400 | loss: 0.5973 | profit rate:    1.3 | accuracy: 0.32
step_num: 2600 | loss: 0.2747 | profit rate:    0.8 | accuracy: 0.32
step_num: 2800 | loss: 0.5189 | profit rate:    1.4 | accuracy: 0.32
step_num: 3000 | loss: 0.2163 | profit rate:    1.4 | accuracy: 0.32
step_num: 3200 | loss: 0.7240 | profit rate:    0.8 | accuracy: 0.32
step_num: 3400 | loss: 0.2262 | profit rate:    1.0 | accuracy: 0.33
step_num: 3600 | loss: 0.4030 | profit rate:    0.9 | accuracy: 0.32
episode:   1/8,耗时:0.42分/0.42分,训练集: | step: 3675 | average_treward:   73.2 | max_treward: 73.1745 | average profit rate:  0.848
model saved @ step:3675,performance:0.848,accuracy:0.32
step_num: 3800 | loss: 0.5707 | profit rate:    0.2 | accuracy: 0.42
step_num: 4000 | loss: 0.0837 | profit rate:    0.2 | accuracy: 0.23
step_num: 4200 | loss: 0.2868 | profit rate:    0.1 | accuracy: 0.22
step_num: 4400 | loss: 0.7854 | profit rate:    0.1 | accuracy: 0.21
step_num: 4600 | loss: 0.5357 | profit rate:    0.1 | accuracy: 0.23
step_num: 4800 | loss: 0.6877 | profit rate:    0.3 | accuracy: 0.28
step_num: 5000 | loss: 0.0654 | profit rate:    0.2 | accuracy: 0.30
step_num: 5200 | loss: 0.1062 | profit rate:    0.1 | accuracy: 0.28
step_num: 5400 | loss: 0.2176 | profit rate:    0.0 | accuracy: 0.28
step_num: 5600 | loss: 0.1232 | profit rate:    0.0 | accuracy: 0.27
step_num: 5800 | loss: 0.4390 | profit rate:    0.0 | accuracy: 0.28
step_num: 6000 | loss: 0.7836 | profit rate:    0.2 | accuracy: 0.30
step_num: 6200 | loss: 0.3229 | profit rate:    0.2 | accuracy: 0.31
step_num: 6400 | loss: 0.5633 | profit rate:    0.2 | accuracy: 0.30
step_num: 6600 | loss: 0.4189 | profit rate:    0.2 | accuracy: 0.31
step_num: 6800 | loss: 0.1175 | profit rate:    0.2 | accuracy: 0.30
step_num: 7000 | loss: 0.0586 | profit rate:    0.0 | accuracy: 0.30
step_num: 7200 | loss: 0.0029 | profit rate:    0.0 | accuracy: 0.28
model saved @ step:7350,performance:0.028,accuracy:0.28
step_num: 7400 | loss: 0.8205 | profit rate:    0.6 | accuracy: 0.53
step_num: 7600 | loss: 0.0087 | profit rate:    0.2 | accuracy: 0.20
step_num: 7800 | loss: 0.3140 | profit rate:    0.2 | accuracy: 0.16
step_num: 8000 | loss: 0.0409 | profit rate:    0.1 | accuracy: 0.15
step_num: 8200 | loss: 0.0585 | profit rate:    0.1 | accuracy: 0.14
step_num: 8400 | loss: 0.6949 | profit rate:    0.3 | accuracy: 0.19
step_num: 8600 | loss: 0.3604 | profit rate:    0.4 | accuracy: 0.25
step_num: 8800 | loss: 0.0320 | profit rate:    0.3 | accuracy: 0.23
step_num: 9000 | loss: 0.5066 | profit rate:    0.1 | accuracy: 0.23
step_num: 9200 | loss: 0.5107 | profit rate:    0.1 | accuracy: 0.22
step_num: 9400 | loss: 0.0522 | profit rate:    0.0 | accuracy: 0.23
step_num: 9600 | loss: 0.8191 | profit rate:    0.2 | accuracy: 0.24
step_num: 9800 | loss: 0.5336 | profit rate:    0.4 | accuracy: 0.26
step_num: 10000 | loss: 0.0460 | profit rate:    0.3 | accuracy: 0.25
step_num: 10200 | loss: 0.4917 | profit rate:    0.4 | accuracy: 0.26
step_num: 10400 | loss: 0.0027 | profit rate:    0.2 | accuracy: 0.25
step_num: 10600 | loss: 0.0031 | profit rate:    0.1 | accuracy: 0.24
step_num: 10800 | loss: 0.0028 | profit rate:    0.1 | accuracy: 0.23
step_num: 11000 | loss: 0.0537 | profit rate:    0.1 | accuracy: 0.22
episode:   3/8,耗时:0.46分/1.35分,训练集: | step: 11025 | average_treward:  126.0 | max_treward: 160.6940 | average profit rate:  0.320
model saved @ step:11025,performance:0.085,accuracy:0.22
step_num: 11200 | loss: 0.0027 | profit rate:    0.3 | accuracy: 0.26
step_num: 11400 | loss: 0.0707 | profit rate:    0.2 | accuracy: 0.17
step_num: 11600 | loss: 0.0525 | profit rate:    0.1 | accuracy: 0.13
step_num: 11800 | loss: 0.0447 | profit rate:    0.2 | accuracy: 0.14
step_num: 12000 | loss: 0.1094 | profit rate:    0.4 | accuracy: 0.15
step_num: 12200 | loss: 0.6178 | profit rate:    0.8 | accuracy: 0.21
step_num: 12400 | loss: 0.0373 | profit rate:    0.5 | accuracy: 0.22
step_num: 12600 | loss: 0.2883 | profit rate:    0.6 | accuracy: 0.21
step_num: 12800 | loss: 0.0684 | profit rate:    0.1 | accuracy: 0.20
step_num: 13000 | loss: 0.5274 | profit rate:    0.1 | accuracy: 0.20
step_num: 13200 | loss: 0.5517 | profit rate:    0.2 | accuracy: 0.21
step_num: 13400 | loss: 0.4874 | profit rate:    0.8 | accuracy: 0.23
step_num: 13600 | loss: 0.0054 | profit rate:    0.5 | accuracy: 0.23
step_num: 13800 | loss: 0.3813 | profit rate:    0.5 | accuracy: 0.23
step_num: 14000 | loss: 0.0331 | profit rate:    0.3 | accuracy: 0.24
step_num: 14200 | loss: 0.2295 | profit rate:    0.2 | accuracy: 0.23
step_num: 14400 | loss: 0.0010 | profit rate:    0.2 | accuracy: 0.22
step_num: 14600 | loss: 0.2260 | profit rate:    0.2 | accuracy: 0.21
model saved @ step:14700,performance:0.184,accuracy:0.21
step_num: 14800 | loss: 0.5732 | profit rate:    0.4 | accuracy: 0.46
step_num: 15000 | loss: 0.2889 | profit rate:    0.3 | accuracy: 0.18
step_num: 15200 | loss: 0.0782 | profit rate:    0.3 | accuracy: 0.14
step_num: 15400 | loss: 0.1772 | profit rate:    0.2 | accuracy: 0.12
step_num: 15600 | loss: 0.0693 | profit rate:    0.3 | accuracy: 0.11
step_num: 15800 | loss: 0.3174 | profit rate:    0.8 | accuracy: 0.17
step_num: 16000 | loss: 0.7034 | profit rate:    0.4 | accuracy: 0.20
step_num: 16200 | loss: 0.0346 | profit rate:    0.3 | accuracy: 0.20
step_num: 16400 | loss: 0.0022 | profit rate:    0.1 | accuracy: 0.20
step_num: 16600 | loss: 0.0773 | profit rate:    0.1 | accuracy: 0.19
step_num: 16800 | loss: 0.1909 | profit rate:    0.1 | accuracy: 0.19
step_num: 17000 | loss: 0.4865 | profit rate:    0.1 | accuracy: 0.20
step_num: 17200 | loss: 0.4824 | profit rate:    0.1 | accuracy: 0.22
step_num: 17400 | loss: 0.4796 | profit rate:    0.1 | accuracy: 0.21
step_num: 17600 | loss: 0.4760 | profit rate:    0.1 | accuracy: 0.23
step_num: 17800 | loss: 0.0022 | profit rate:    0.1 | accuracy: 0.22
step_num: 18000 | loss: 0.1725 | profit rate:    0.0 | accuracy: 0.21
step_num: 18200 | loss: 0.0508 | profit rate:    0.0 | accuracy: 0.20
episode:   5/8,耗时:0.48分/2.28分,训练集: | step: 18375 | average_treward:  147.3 | max_treward: 183.5248 | average profit rate:  0.237
step_num: 18400 | loss: 0.9666 | profit rate:    0.7 | accuracy: 0.50
step_num: 18600 | loss: 0.0087 | profit rate:    0.3 | accuracy: 0.20
step_num: 18800 | loss: 0.0446 | profit rate:    0.3 | accuracy: 0.15
step_num: 19000 | loss: 0.1761 | profit rate:    0.2 | accuracy: 0.13
step_num: 19200 | loss: 0.0015 | profit rate:    0.2 | accuracy: 0.11
step_num: 19400 | loss: 0.1570 | profit rate:    0.3 | accuracy: 0.15
step_num: 19600 | loss: 0.4337 | profit rate:    0.4 | accuracy: 0.19
step_num: 19800 | loss: 0.0011 | profit rate:    0.2 | accuracy: 0.19
step_num: 20000 | loss: 0.3322 | profit rate:    0.1 | accuracy: 0.19
step_num: 20200 | loss: 0.2749 | profit rate:    0.2 | accuracy: 0.18
step_num: 20400 | loss: 0.0610 | profit rate:    0.1 | accuracy: 0.19
step_num: 20600 | loss: 0.0428 | profit rate:    0.4 | accuracy: 0.19
step_num: 20800 | loss: 0.5900 | profit rate:    0.6 | accuracy: 0.21
step_num: 21000 | loss: 0.0425 | profit rate:    0.3 | accuracy: 0.20
step_num: 21200 | loss: 0.4610 | profit rate:    0.4 | accuracy: 0.21
step_num: 21400 | loss: 0.0033 | profit rate:    0.3 | accuracy: 0.21
step_num: 21600 | loss: 0.2009 | profit rate:    0.2 | accuracy: 0.20
step_num: 21800 | loss: 0.0908 | profit rate:    0.1 | accuracy: 0.20
step_num: 22000 | loss: 0.1853 | profit rate:    0.1 | accuracy: 0.19
step_num: 22200 | loss: 0.0016 | profit rate:    0.3 | accuracy: 0.32
step_num: 22400 | loss: 0.0829 | profit rate:    0.2 | accuracy: 0.20
step_num: 22600 | loss: 0.0998 | profit rate:    0.2 | accuracy: 0.16
step_num: 22800 | loss: 0.0293 | profit rate:    0.1 | accuracy: 0.13
step_num: 23000 | loss: 0.3749 | profit rate:    0.1 | accuracy: 0.13
step_num: 23200 | loss: 0.8420 | profit rate:    0.3 | accuracy: 0.18
step_num: 23400 | loss: 0.0558 | profit rate:    0.1 | accuracy: 0.19
step_num: 23600 | loss: 0.0838 | profit rate:    0.2 | accuracy: 0.17
step_num: 23800 | loss: 0.0009 | profit rate:    0.1 | accuracy: 0.16
step_num: 24000 | loss: 0.0582 | profit rate:    0.1 | accuracy: 0.15
step_num: 24200 | loss: 0.2059 | profit rate:    0.2 | accuracy: 0.15
step_num: 24400 | loss: 0.4702 | profit rate:    0.3 | accuracy: 0.17
step_num: 24600 | loss: 0.0285 | profit rate:    0.2 | accuracy: 0.18
step_num: 24800 | loss: 0.6141 | profit rate:    0.2 | accuracy: 0.18
step_num: 25000 | loss: 0.0006 | profit rate:    0.2 | accuracy: 0.19
step_num: 25200 | loss: 0.3620 | profit rate:    0.2 | accuracy: 0.18
step_num: 25400 | loss: 0.0513 | profit rate:    0.1 | accuracy: 0.18
step_num: 25600 | loss: 0.0404 | profit rate:    0.1 | accuracy: 0.17
episode:   7/8,耗时:0.47分/3.23分,训练集: | step: 25725 | average_treward:  155.6 | max_treward: 183.5248 | average profit rate:  0.203
step_num: 25800 | loss: 0.6799 | profit rate:    0.5 | accuracy: 0.53
step_num: 26000 | loss: 0.5316 | profit rate:    0.5 | accuracy: 0.33
step_num: 26200 | loss: 0.4726 | profit rate:    0.7 | accuracy: 0.28
step_num: 26400 | loss: 0.1929 | profit rate:    1.1 | accuracy: 0.26
step_num: 26600 | loss: 0.1702 | profit rate:    1.1 | accuracy: 0.22
step_num: 26800 | loss: 0.4892 | profit rate:    1.8 | accuracy: 0.25
step_num: 27000 | loss: 0.3286 | profit rate:    1.7 | accuracy: 0.26
step_num: 27200 | loss: 0.0516 | profit rate:    0.9 | accuracy: 0.24
step_num: 27400 | loss: 0.0095 | profit rate:    0.9 | accuracy: 0.23
step_num: 27600 | loss: 0.1885 | profit rate:    0.9 | accuracy: 0.22
step_num: 27800 | loss: 0.0544 | profit rate:    1.2 | accuracy: 0.21
step_num: 28000 | loss: 0.6785 | profit rate:    1.6 | accuracy: 0.22
step_num: 28200 | loss: 0.0735 | profit rate:    3.9 | accuracy: 0.23
step_num: 28400 | loss: 0.1208 | profit rate:    2.6 | accuracy: 0.22
step_num: 28600 | loss: 0.5046 | profit rate:    4.1 | accuracy: 0.23
step_num: 28800 | loss: 0.0029 | profit rate:    4.0 | accuracy: 0.22
step_num: 29000 | loss: 0.1438 | profit rate:    2.6 | accuracy: 0.22
step_num: 29200 | loss: 0.0337 | profit rate:    2.7 | accuracy: 0.21
model saved @ step:29400,performance:2.301,accuracy:0.20
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 31%|       | 96/312 [00:00<00:00, 959.29it/s] 64%|   | 200/312 [00:00<00:00, 1001.40it/s]100%|| 312/312 [00:00<00:00, 1072.23it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-24T12:00:00 | *** GOING LONG ***
2023-01-24T12:00:00's price 22632.8906, buy 0.0441393 units.
2023-01-24T12:00:00 | current balance = 0.00
2023-01-24T12:00:00 | balance:0.00+units:0.0441393*price:22632.8906=net_wealth:999.0010
--------------------------------------------------
2023-02-16T12:00:00 | *** GOING SHORT ***
2023-02-16T12:00:00's price 23517.7207, sell 0.0441393 units.
2023-02-16T12:00:00 | current balance = 1037.02
2023-02-16T12:00:00 | balance:1037.02+units:0.0*price:23517.7207=net_wealth:1037.0187
--------------------------------------------------
2023-02-21T00:00:00 | *** GOING LONG ***
2023-02-21T00:00:00's price 24572.8301, buy 0.04215964 units.
2023-02-21T00:00:00 | current balance = 0.00
2023-02-21T00:00:00 | balance:0.00+units:0.04215964*price:24572.8301=net_wealth:1035.9827
--------------------------------------------------
2023-02-22T12:00:00 | *** GOING SHORT ***
2023-02-22T12:00:00's price 24182.2109, sell 0.04215964 units.
2023-02-22T12:00:00 | current balance = 1018.49
2023-02-22T12:00:00 | balance:1018.49+units:0.0*price:24182.2109=net_wealth:1018.4949
--------------------------------------------------
2023-02-23T00:00:00 | *** GOING LONG ***
2023-02-23T00:00:00's price 23780.1992, buy 0.042786700000000004 units.
2023-02-23T00:00:00 | current balance = 0.00
2023-02-23T00:00:00 | balance:0.00+units:0.042786700000000004*price:23780.1992=net_wealth:1017.4774
--------------------------------------------------
2023-03-04T00:00:00 | *** GOING SHORT ***
2023-03-04T00:00:00's price 22349.4609, sell 0.042786700000000004 units.
2023-03-04T00:00:00 | current balance = 955.30
2023-03-04T00:00:00 | balance:955.30+units:0.0*price:22349.4609=net_wealth:955.3046
--------------------------------------------------
2023-03-04T12:00:00 | *** GOING LONG ***
2023-03-04T12:00:00's price 22346.5703, buy 0.04270674 units.
2023-03-04T12:00:00 | current balance = 0.00
2023-03-04T12:00:00 | balance:0.00+units:0.04270674*price:22346.5703=net_wealth:954.3502
--------------------------------------------------
2023-03-10T12:00:00 | *** GOING SHORT ***
2023-03-10T12:00:00's price 20150.6895, sell 0.04270674 units.
2023-03-10T12:00:00 | current balance = 859.71
2023-03-10T12:00:00 | balance:859.71+units:0.0*price:20150.6895=net_wealth:859.7107
--------------------------------------------------
2023-03-11T00:00:00 | *** GOING LONG ***
2023-03-11T00:00:00's price 20086.0703, buy 0.04275853 units.
2023-03-11T00:00:00 | current balance = 0.00
2023-03-11T00:00:00 | balance:0.00+units:0.04275853*price:20086.0703=net_wealth:858.8519
--------------------------------------------------
2023-03-12T00:00:00 | *** GOING SHORT ***
2023-03-12T00:00:00's price 20445.4297, sell 0.04275853 units.
2023-03-12T00:00:00 | current balance = 873.34
2023-03-12T00:00:00 | balance:873.34+units:0.0*price:20445.4297=net_wealth:873.3433
--------------------------------------------------
2023-03-24T00:00:00 | *** GOING LONG ***
2023-03-24T00:00:00's price 28080.0000, buy 0.031070860000000002 units.
2023-03-24T00:00:00 | current balance = 0.00
2023-03-24T00:00:00 | balance:0.00+units:0.031070860000000002*price:28080.0000=net_wealth:872.4709
--------------------------------------------------
2023-04-11T00:00:00 | *** GOING SHORT ***
2023-04-11T00:00:00's price 30055.1504, sell 0.031070860000000002 units.
2023-04-11T00:00:00 | current balance = 932.91
2023-04-11T00:00:00 | balance:932.91+units:0.0*price:30055.1504=net_wealth:932.9067
--------------------------------------------------
2023-04-14T12:00:00 | *** GOING LONG ***
2023-04-14T12:00:00's price 30466.9297, buy 0.03058968 units.
2023-04-14T12:00:00 | current balance = 0.00
2023-04-14T12:00:00 | balance:0.00+units:0.03058968*price:30466.9297=net_wealth:931.9747
--------------------------------------------------
2023-04-15T00:00:00 | *** GOING SHORT ***
2023-04-15T00:00:00's price 30385.3008, sell 0.03058968 units.
2023-04-15T00:00:00 | current balance = 928.55
2023-04-15T00:00:00 | balance:928.55+units:0.0*price:30385.3008=net_wealth:928.5482
--------------------------------------------------
2023-04-16T00:00:00 | *** GOING LONG ***
2023-04-16T00:00:00's price 30226.4492, buy 0.030689 units.
2023-04-16T00:00:00 | current balance = 0.00
2023-04-16T00:00:00 | balance:0.00+units:0.030689*price:30226.4492=net_wealth:927.6206
--------------------------------------------------
2023-04-18T12:00:00 | *** GOING SHORT ***
2023-04-18T12:00:00's price 30380.0098, sell 0.030689 units.
2023-04-18T12:00:00 | current balance = 931.40
2023-04-18T12:00:00 | balance:931.40+units:0.0*price:30380.0098=net_wealth:931.4009
--------------------------------------------------
2023-04-19T00:00:00 | *** GOING LONG ***
2023-04-19T00:00:00's price 29310.6504, buy 0.031745090000000004 units.
2023-04-19T00:00:00 | current balance = 0.00
2023-04-19T00:00:00 | balance:0.00+units:0.031745090000000004*price:29310.6504=net_wealth:930.4704
--------------------------------------------------
2023-04-27T12:00:00 | *** GOING SHORT ***
2023-04-27T12:00:00's price 29472.7695, sell 0.031745090000000004 units.
2023-04-27T12:00:00 | current balance = 934.68
2023-04-27T12:00:00 | balance:934.68+units:0.0*price:29472.7695=net_wealth:934.6813
--------------------------------------------------
2023-04-29T12:00:00 | *** GOING LONG ***
2023-04-29T12:00:00's price 29230.4492, buy 0.031944310000000004 units.
2023-04-29T12:00:00 | current balance = 0.00
2023-04-29T12:00:00 | balance:0.00+units:0.031944310000000004*price:29230.4492=net_wealth:933.7475
--------------------------------------------------
2023-05-02T00:00:00 | *** GOING SHORT ***
2023-05-02T00:00:00's price 28084.8301, sell 0.031944310000000004 units.
2023-05-02T00:00:00 | current balance = 896.25
2023-05-02T00:00:00 | balance:896.25+units:0.0*price:28084.8301=net_wealth:896.2544
--------------------------------------------------
2023-05-02T12:00:00 | *** GOING LONG ***
2023-05-02T12:00:00's price 28669.8594, buy 0.03122994 units.
2023-05-02T12:00:00 | current balance = 0.00
2023-05-02T12:00:00 | balance:0.00+units:0.03122994*price:28669.8594=net_wealth:895.3590
--------------------------------------------------
2023-05-03T12:00:00 | *** GOING SHORT ***
2023-05-03T12:00:00's price 29026.1602, sell 0.03122994 units.
2023-05-03T12:00:00 | current balance = 905.58
2023-05-03T12:00:00 | balance:905.58+units:0.0*price:29026.1602=net_wealth:905.5798
--------------------------------------------------
2023-05-06T00:00:00 | *** GOING LONG ***
2023-05-06T00:00:00's price 29266.1504, buy 0.030911960000000002 units.
2023-05-06T00:00:00 | current balance = 0.00
2023-05-06T00:00:00 | balance:0.00+units:0.030911960000000002*price:29266.1504=net_wealth:904.6751
--------------------------------------------------
2023-05-13T00:00:00 | *** GOING SHORT ***
2023-05-13T00:00:00's price 26823.9395, sell 0.030911960000000002 units.
2023-05-13T00:00:00 | current balance = 828.35
2023-05-13T00:00:00 | balance:828.35+units:0.0*price:26823.9395=net_wealth:828.3524
--------------------------------------------------
2023-05-14T00:00:00 | *** GOING LONG ***
2023-05-14T00:00:00's price 26805.9805, buy 0.03087087 units.
2023-05-14T00:00:00 | current balance = 0.00
2023-05-14T00:00:00 | balance:0.00+units:0.03087087*price:26805.9805=net_wealth:827.5249
--------------------------------------------------
2023-05-14T12:00:00 | *** GOING SHORT ***
2023-05-14T12:00:00's price 26917.6191, sell 0.03087087 units.
2023-05-14T12:00:00 | current balance = 830.14
2023-05-14T12:00:00 | balance:830.14+units:0.0*price:26917.6191=net_wealth:830.1403
--------------------------------------------------
2023-05-17T00:00:00 | *** GOING LONG ***
2023-05-17T00:00:00's price 26637.6191, buy 0.03113304 units.
2023-05-17T00:00:00 | current balance = 0.00
2023-05-17T00:00:00 | balance:0.00+units:0.03113304*price:26637.6191=net_wealth:829.3110
--------------------------------------------------
2023-05-18T00:00:00 | *** GOING SHORT ***
2023-05-18T00:00:00's price 27398.9707, sell 0.03113304 units.
2023-05-18T00:00:00 | current balance = 852.16
2023-05-18T00:00:00 | balance:852.16+units:0.0*price:27398.9707=net_wealth:852.1611
--------------------------------------------------
2023-05-21T00:00:00 | *** GOING LONG ***
2023-05-21T00:00:00's price 26829.9395, buy 0.031729810000000004 units.
2023-05-21T00:00:00 | current balance = 0.00
2023-05-21T00:00:00 | balance:0.00+units:0.031729810000000004*price:26829.9395=net_wealth:851.3098
--------------------------------------------------
2023-05-25T12:00:00 | *** GOING SHORT ***
2023-05-25T12:00:00's price 26473.7891, sell 0.031729810000000004 units.
2023-05-25T12:00:00 | current balance = 839.17
2023-05-25T12:00:00 | balance:839.17+units:0.0*price:26473.7891=net_wealth:839.1692
--------------------------------------------------
2023-05-26T12:00:00 | *** GOING LONG ***
2023-05-26T12:00:00's price 26705.9199, buy 0.03139116 units.
2023-05-26T12:00:00 | current balance = 0.00
2023-05-26T12:00:00 | balance:0.00+units:0.03139116*price:26705.9199=net_wealth:838.3309
--------------------------------------------------
2023-05-27T00:00:00 | *** GOING SHORT ***
2023-05-27T00:00:00's price 26699.0195, sell 0.03139116 units.
2023-05-27T00:00:00 | current balance = 837.28
2023-05-27T00:00:00 | balance:837.28+units:0.0*price:26699.0195=net_wealth:837.2762
--------------------------------------------------
2023-06-05T12:00:00 | *** GOING LONG ***
2023-06-05T12:00:00's price 25728.1992, buy 0.03251058 units.
2023-06-05T12:00:00 | current balance = 0.00
2023-06-05T12:00:00 | balance:0.00+units:0.03251058*price:25728.1992=net_wealth:836.4397
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03251058 units.
2023-06-08T12:00:00 | current balance = 863.91
2023-06-08T12:00:00 | net performance [%] = -13.6089
2023-06-08T12:00:00 | number of trades [#] = 34
==================================================
Trial 16 Complete [00h 03m 44s]
net_wealth: 864.7756384899577

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 01h 48m 59s

Search: Running Trial #17

Value             |Best Value So Far |Hyperparameter
2                 |8                 |horizon
730               |225               |lookback
True              |True              |MarketFactor
14                |14                |lags
0.7               |0.98              |gamma
2000              |32                |memory_size
16                |16                |batch_size
64                |32                |n_steps
0.96              |0.98              |gae_lambda
0.5               |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4207.000000   4209.000000
mean      0.000424    19921.326125  ...   19978.665410  19971.309209
std       0.028069    16159.303521  ...   16194.804614  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7627.935059   7625.000000
50%       0.000696    11410.370947  ...   11481.690430  11477.000000
75%       0.011720    29502.909082  ...   29331.899414  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 1000 | loss: 0.8649 | profit rate:    0.3 | accuracy: 0.34
step_num: 1200 | loss: 0.2982 | profit rate:    0.2 | accuracy: 0.34
step_num: 1400 | loss: 0.2458 | profit rate:    0.1 | accuracy: 0.34
step_num: 1600 | loss: 0.2115 | profit rate:    0.1 | accuracy: 0.34
step_num: 1800 | loss: 0.2286 | profit rate:    0.1 | accuracy: 0.35
step_num: 2000 | loss: 0.2240 | profit rate:    0.1 | accuracy: 0.35
step_num: 2200 | loss: 0.1859 | profit rate:    0.1 | accuracy: 0.34
step_num: 2400 | loss: 0.1918 | profit rate:    0.1 | accuracy: 0.34
step_num: 2600 | loss: 0.1685 | profit rate:    0.1 | accuracy: 0.33
step_num: 2800 | loss: 0.1794 | profit rate:    0.0 | accuracy: 0.32
step_num: 3000 | loss: 0.1944 | profit rate:    0.0 | accuracy: 0.33
episode:   1/8,耗时:2.20分/2.20分,训练集: | step: 3149 | average_treward:   40.2 | max_treward: 40.1784 | average profit rate:  0.052
model saved @ step:3149,performance:0.052,accuracy:0.33
step_num: 3200 | loss: 0.1442 | profit rate:    0.8 | accuracy: 0.21
step_num: 3400 | loss: 0.1115 | profit rate:    1.2 | accuracy: 0.22
step_num: 3600 | loss: 0.1041 | profit rate:    1.1 | accuracy: 0.21
step_num: 3800 | loss: 0.1191 | profit rate:    3.5 | accuracy: 0.24
step_num: 4000 | loss: 0.1135 | profit rate:    6.3 | accuracy: 0.27
step_num: 4200 | loss: 0.0918 | profit rate:    7.8 | accuracy: 0.28
step_num: 4400 | loss: 0.0987 | profit rate:   19.6 | accuracy: 0.29
step_num: 4600 | loss: 0.1024 | profit rate:   28.5 | accuracy: 0.29
step_num: 4800 | loss: 0.0971 | profit rate:  130.1 | accuracy: 0.30
step_num: 5000 | loss: 0.0886 | profit rate: 1261.2 | accuracy: 0.31
step_num: 5200 | loss: 0.0852 | profit rate: 3924.7 | accuracy: 0.31
step_num: 5400 | loss: 0.0920 | profit rate: 11570.9 | accuracy: 0.31
step_num: 5600 | loss: 0.0936 | profit rate: 28924.0 | accuracy: 0.32
step_num: 5800 | loss: 0.0750 | profit rate: 47119.0 | accuracy: 0.31
step_num: 6000 | loss: 0.0727 | profit rate: 71713.2 | accuracy: 0.30
step_num: 6200 | loss: 0.0784 | profit rate: 176893.8 | accuracy: 0.31
model saved @ step:6298,performance:192573.848,accuracy:0.31
step_num: 6400 | loss: 0.0572 | profit rate:    1.4 | accuracy: 0.29
step_num: 6600 | loss: 0.0682 | profit rate:    2.9 | accuracy: 0.22
step_num: 6800 | loss: 0.0653 | profit rate:    6.7 | accuracy: 0.26
step_num: 7000 | loss: 0.0724 | profit rate:   42.7 | accuracy: 0.31
step_num: 7200 | loss: 0.0552 | profit rate:  101.3 | accuracy: 0.32
step_num: 7400 | loss: 0.0660 | profit rate:  294.2 | accuracy: 0.32
step_num: 7600 | loss: 0.0573 | profit rate:  703.0 | accuracy: 0.31
step_num: 7800 | loss: 0.0690 | profit rate: 1833.1 | accuracy: 0.32
step_num: 8000 | loss: 0.0811 | profit rate: 12649.9 | accuracy: 0.34
step_num: 8200 | loss: 0.0584 | profit rate: 121469.7 | accuracy: 0.35
step_num: 8400 | loss: 0.0634 | profit rate: 477020.9 | accuracy: 0.34
step_num: 8600 | loss: 0.0549 | profit rate: 2722025.1 | accuracy: 0.35
step_num: 8800 | loss: 0.0586 | profit rate: 5887909.7 | accuracy: 0.35
step_num: 9000 | loss: 0.0521 | profit rate: 20056406.8 | accuracy: 0.34
step_num: 9200 | loss: 0.0609 | profit rate: 36111250.8 | accuracy: 0.34
step_num: 9400 | loss: 0.0550 | profit rate: 112742036.2 | accuracy: 0.34
episode:   3/8,耗时:3.26分/8.73分,训练集: | step: 9447 | average_treward:  455.1 | max_treward: 812.3504 | average profit rate: 42839212.146
model saved @ step:9447,performance:128325062.538,accuracy:0.34
step_num: 9600 | loss: 0.0575 | profit rate:    1.9 | accuracy: 0.35
step_num: 9800 | loss: 0.0512 | profit rate:    6.8 | accuracy: 0.32
step_num: 10000 | loss: 0.0580 | profit rate:   30.7 | accuracy: 0.34
step_num: 10200 | loss: 0.0484 | profit rate:  363.0 | accuracy: 0.37
step_num: 10400 | loss: 0.0492 | profit rate: 1093.3 | accuracy: 0.38
step_num: 10600 | loss: 0.0545 | profit rate: 5810.4 | accuracy: 0.38
step_num: 10800 | loss: 0.0547 | profit rate: 14177.4 | accuracy: 0.38
step_num: 11000 | loss: 0.0529 | profit rate: 50293.3 | accuracy: 0.39
step_num: 11200 | loss: 0.0585 | profit rate: 765397.1 | accuracy: 0.40
step_num: 11400 | loss: 0.0581 | profit rate: 5671962.1 | accuracy: 0.41
step_num: 11600 | loss: 0.0525 | profit rate: 41111567.5 | accuracy: 0.40
step_num: 11800 | loss: 0.0590 | profit rate: 232957194.0 | accuracy: 0.41
step_num: 12000 | loss: 0.0532 | profit rate: 456316395.4 | accuracy: 0.40
step_num: 12200 | loss: 0.0541 | profit rate: 1923407873.5 | accuracy: 0.40
step_num: 12400 | loss: 0.0578 | profit rate: 3417903703.5 | accuracy: 0.39
model saved @ step:12596,performance:8105021188.193,accuracy:0.39
step_num: 12600 | loss: 0.0358 | profit rate:    1.0 | accuracy: 0.20
step_num: 12800 | loss: 0.0453 | profit rate:    5.1 | accuracy: 0.41
step_num: 13000 | loss: 0.0484 | profit rate:   11.5 | accuracy: 0.38
step_num: 13200 | loss: 0.0468 | profit rate:  165.5 | accuracy: 0.40
step_num: 13400 | loss: 0.0463 | profit rate:  729.3 | accuracy: 0.42
step_num: 13600 | loss: 0.0510 | profit rate: 1975.4 | accuracy: 0.42
step_num: 13800 | loss: 0.0458 | profit rate: 14507.0 | accuracy: 0.42
step_num: 14000 | loss: 0.0379 | profit rate: 42172.6 | accuracy: 0.42
step_num: 14200 | loss: 0.0416 | profit rate: 211111.2 | accuracy: 0.43
step_num: 14400 | loss: 0.0537 | profit rate: 7932646.5 | accuracy: 0.44
step_num: 14600 | loss: 0.0554 | profit rate: 74738052.6 | accuracy: 0.45
step_num: 14800 | loss: 0.0460 | profit rate: 782800160.4 | accuracy: 0.45
step_num: 15000 | loss: 0.0514 | profit rate: 3282661914.9 | accuracy: 0.45
step_num: 15200 | loss: 0.0363 | profit rate: 17561056424.0 | accuracy: 0.45
step_num: 15400 | loss: 0.0516 | profit rate: 85611522969.2 | accuracy: 0.44
step_num: 15600 | loss: 0.0404 | profit rate: 284257348143.4 | accuracy: 0.44
episode:   5/8,耗时:3.26分/15.22分,训练集: | step: 15745 | average_treward:  710.6 | max_treward: 1201.7161 | average profit rate: 151627429774.681
model saved @ step:15745,performance:749903610048.777,accuracy:0.44
step_num: 15800 | loss: 0.0301 | profit rate:    1.3 | accuracy: 0.50
step_num: 16000 | loss: 0.0484 | profit rate:    8.6 | accuracy: 0.43
step_num: 16200 | loss: 0.0426 | profit rate:   24.7 | accuracy: 0.45
step_num: 16400 | loss: 0.0511 | profit rate:  314.9 | accuracy: 0.45
step_num: 16600 | loss: 0.0349 | profit rate: 2365.8 | accuracy: 0.47
step_num: 16800 | loss: 0.0378 | profit rate: 11795.5 | accuracy: 0.48
step_num: 17000 | loss: 0.0439 | profit rate: 42543.0 | accuracy: 0.48
step_num: 17200 | loss: 0.0389 | profit rate: 182279.5 | accuracy: 0.48
step_num: 17400 | loss: 0.0456 | profit rate: 1666290.6 | accuracy: 0.50
step_num: 17600 | loss: 0.0405 | profit rate: 86587621.8 | accuracy: 0.51
step_num: 17800 | loss: 0.0412 | profit rate: 1489806457.5 | accuracy: 0.51
step_num: 18000 | loss: 0.0507 | profit rate: 11378103948.8 | accuracy: 0.51
step_num: 18200 | loss: 0.0467 | profit rate: 59574107672.2 | accuracy: 0.51
step_num: 18400 | loss: 0.0397 | profit rate: 441360031485.4 | accuracy: 0.51
step_num: 18600 | loss: 0.0399 | profit rate: 1694485813258.6 | accuracy: 0.50
step_num: 18800 | loss: 0.0401 | profit rate: 12954197613279.7 | accuracy: 0.50
model saved @ step:18894,performance:14564934559857.166,accuracy:0.50
step_num: 19000 | loss: 0.0312 | profit rate:    1.8 | accuracy: 0.51
step_num: 19200 | loss: 0.0370 | profit rate:   13.6 | accuracy: 0.47
step_num: 19400 | loss: 0.0375 | profit rate:   68.5 | accuracy: 0.46
step_num: 19600 | loss: 0.0451 | profit rate: 1074.5 | accuracy: 0.47
step_num: 19800 | loss: 0.0440 | profit rate: 4217.0 | accuracy: 0.49
step_num: 20000 | loss: 0.0370 | profit rate: 24065.2 | accuracy: 0.49
step_num: 20200 | loss: 0.0458 | profit rate: 176514.7 | accuracy: 0.50
step_num: 20400 | loss: 0.0399 | profit rate: 855222.4 | accuracy: 0.51
step_num: 20600 | loss: 0.0470 | profit rate: 7427358.2 | accuracy: 0.52
step_num: 20800 | loss: 0.0408 | profit rate: 147466126.9 | accuracy: 0.52
step_num: 21000 | loss: 0.0434 | profit rate: 1510955747.8 | accuracy: 0.52
step_num: 21200 | loss: 0.0362 | profit rate: 15415545905.9 | accuracy: 0.52
step_num: 21400 | loss: 0.0433 | profit rate: 126252148994.1 | accuracy: 0.53
step_num: 21600 | loss: 0.0486 | profit rate: 1128509215329.8 | accuracy: 0.52
step_num: 21800 | loss: 0.0530 | profit rate: 9009591803563.1 | accuracy: 0.52
step_num: 22000 | loss: 0.0400 | profit rate: 51220199526305.9 | accuracy: 0.52
episode:   7/8,耗时:3.29分/21.80分,训练集: | step: 22043 | average_treward:  900.9 | max_treward: 1422.4308 | average profit rate: 10430821874894.457
model saved @ step:22043,performance:57692681415530.633,accuracy:0.52
step_num: 22200 | loss: 0.0456 | profit rate:    4.9 | accuracy: 0.54
step_num: 22400 | loss: 0.0374 | profit rate:   34.9 | accuracy: 0.50
step_num: 22600 | loss: 0.0380 | profit rate:  283.4 | accuracy: 0.51
step_num: 22800 | loss: 0.0322 | profit rate: 5857.5 | accuracy: 0.53
step_num: 23000 | loss: 0.0324 | profit rate: 41328.6 | accuracy: 0.54
step_num: 23200 | loss: 0.0506 | profit rate: 314265.0 | accuracy: 0.53
step_num: 23400 | loss: 0.0380 | profit rate: 2552585.8 | accuracy: 0.55
step_num: 23600 | loss: 0.0378 | profit rate: 23262773.7 | accuracy: 0.57
step_num: 23800 | loss: 0.0459 | profit rate: 1104304518.0 | accuracy: 0.58
step_num: 24000 | loss: 0.0435 | profit rate: 48540180720.2 | accuracy: 0.59
step_num: 24200 | loss: 0.0369 | profit rate: 911675704471.0 | accuracy: 0.58
step_num: 24400 | loss: 0.0389 | profit rate: 15343859779032.6 | accuracy: 0.59
step_num: 24600 | loss: 0.0387 | profit rate: 208362239918772.0 | accuracy: 0.59
step_num: 24800 | loss: 0.0492 | profit rate: 2915418443771243.0 | accuracy: 0.59
step_num: 25000 | loss: 0.0468 | profit rate: 16979129713855516.0 | accuracy: 0.58
model saved @ step:25192,performance:71081589672381440.000,accuracy:0.58
----------------------------------------finished----------------------------------------
  0%|          | 0/305 [00:00<?, ?it/s] 34%|      | 105/305 [00:00<00:00, 1039.61it/s] 76%|  | 231/305 [00:00<00:00, 1161.91it/s]100%|| 305/305 [00:00<00:00, 1186.18it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-07T12:00:00 | *** GOING LONG ***
2023-01-07T12:00:00's price 16943.5703, buy 0.05896041 units.
2023-01-07T12:00:00 | current balance = 0.00
2023-01-07T12:00:00 | balance:0.00+units:0.05896041*price:16943.5703=net_wealth:999.0010
--------------------------------------------------
2023-01-10T00:00:00 | *** GOING SHORT ***
2023-01-10T00:00:00's price 17252.8906, sell 0.05896041 units.
2023-01-10T00:00:00 | current balance = 1016.22
2023-01-10T00:00:00 | balance:1016.22+units:0.0*price:17252.8906=net_wealth:1016.2214
--------------------------------------------------
2023-01-12T00:00:00 | *** GOING LONG ***
2023-01-12T00:00:00's price 18200.8008, buy 0.05577805 units.
2023-01-12T00:00:00 | current balance = 0.00
2023-01-12T00:00:00 | balance:0.00+units:0.05577805*price:18200.8008=net_wealth:1015.2062
--------------------------------------------------
2023-01-12T12:00:00 | *** GOING SHORT ***
2023-01-12T12:00:00's price 18846.6191, sell 0.05577805 units.
2023-01-12T12:00:00 | current balance = 1050.18
2023-01-12T12:00:00 | balance:1050.18+units:0.0*price:18846.6191=net_wealth:1050.1775
--------------------------------------------------
2023-01-13T00:00:00 | *** GOING LONG ***
2023-01-13T00:00:00's price 18920.9492, buy 0.05544792 units.
2023-01-13T00:00:00 | current balance = 0.00
2023-01-13T00:00:00 | balance:0.00+units:0.05544792*price:18920.9492=net_wealth:1049.1283
--------------------------------------------------
2023-01-14T00:00:00 | *** GOING SHORT ***
2023-01-14T00:00:00's price 20721.7305, sell 0.05544792 units.
2023-01-14T00:00:00 | current balance = 1147.83
2023-01-14T00:00:00 | balance:1147.83+units:0.0*price:20721.7305=net_wealth:1147.8289
--------------------------------------------------
2023-01-16T00:00:00 | *** GOING LONG ***
2023-01-16T00:00:00's price 20817.5605, buy 0.05508239 units.
2023-01-16T00:00:00 | current balance = 0.00
2023-01-16T00:00:00 | balance:0.00+units:0.05508239*price:20817.5605=net_wealth:1146.6823
--------------------------------------------------
2023-01-17T00:00:00 | *** GOING SHORT ***
2023-01-17T00:00:00's price 21219.7500, sell 0.05508239 units.
2023-01-17T00:00:00 | current balance = 1167.67
2023-01-17T00:00:00 | balance:1167.67+units:0.0*price:21219.7500=net_wealth:1167.6670
--------------------------------------------------
2023-01-19T00:00:00 | *** GOING LONG ***
2023-01-19T00:00:00's price 20743.7207, buy 0.05623385 units.
2023-01-19T00:00:00 | current balance = 0.00
2023-01-19T00:00:00 | balance:0.00+units:0.05623385*price:20743.7207=net_wealth:1166.5005
--------------------------------------------------
2023-01-20T00:00:00 | *** GOING SHORT ***
2023-01-20T00:00:00's price 20963.5098, sell 0.05623385 units.
2023-01-20T00:00:00 | current balance = 1177.68
2023-01-20T00:00:00 | balance:1177.68+units:0.0*price:20963.5098=net_wealth:1177.6812
--------------------------------------------------
2023-01-21T12:00:00 | *** GOING LONG ***
2023-01-21T12:00:00's price 22783.5508, buy 0.05163828 units.
2023-01-21T12:00:00 | current balance = 0.00
2023-01-21T12:00:00 | balance:0.00+units:0.05163828*price:22783.5508=net_wealth:1176.5047
--------------------------------------------------
2023-01-22T00:00:00 | *** GOING SHORT ***
2023-01-22T00:00:00's price 22783.6094, sell 0.05163828 units.
2023-01-22T00:00:00 | current balance = 1175.33
2023-01-22T00:00:00 | balance:1175.33+units:0.0*price:22783.6094=net_wealth:1175.3312
--------------------------------------------------
2023-01-27T12:00:00 | *** GOING LONG ***
2023-01-27T12:00:00's price 23074.1602, buy 0.05088618 units.
2023-01-27T12:00:00 | current balance = 0.00
2023-01-27T12:00:00 | balance:0.00+units:0.05088618*price:23074.1602=net_wealth:1174.1571
--------------------------------------------------
2023-01-28T00:00:00 | *** GOING SHORT ***
2023-01-28T00:00:00's price 22981.5098, sell 0.05088618 units.
2023-01-28T00:00:00 | current balance = 1168.27
2023-01-28T00:00:00 | balance:1168.27+units:0.0*price:22981.5098=net_wealth:1168.2730
--------------------------------------------------
2023-01-28T12:00:00 | *** GOING LONG ***
2023-01-28T12:00:00's price 23022.5996, buy 0.05069387 units.
2023-01-28T12:00:00 | current balance = 0.00
2023-01-28T12:00:00 | balance:0.00+units:0.05069387*price:23022.5996=net_wealth:1167.1059
--------------------------------------------------
2023-01-29T00:00:00 | *** GOING SHORT ***
2023-01-29T00:00:00's price 23432.1699, sell 0.05069387 units.
2023-01-29T00:00:00 | current balance = 1186.68
2023-01-29T00:00:00 | balance:1186.68+units:0.0*price:23432.1699=net_wealth:1186.6807
--------------------------------------------------
2023-01-31T00:00:00 | *** GOING LONG ***
2023-01-31T00:00:00's price 22865.4297, buy 0.05184656 units.
2023-01-31T00:00:00 | current balance = 0.00
2023-01-31T00:00:00 | balance:0.00+units:0.05184656*price:22865.4297=net_wealth:1185.4952
--------------------------------------------------
2023-02-03T12:00:00 | *** GOING SHORT ***
2023-02-03T12:00:00's price 23431.9004, sell 0.05184656 units.
2023-02-03T12:00:00 | current balance = 1213.65
2023-02-03T12:00:00 | balance:1213.65+units:0.0*price:23431.9004=net_wealth:1213.6499
--------------------------------------------------
2023-02-04T12:00:00 | *** GOING LONG ***
2023-02-04T12:00:00's price 23326.8398, buy 0.05197601 units.
2023-02-04T12:00:00 | current balance = 0.00
2023-02-04T12:00:00 | balance:0.00+units:0.05197601*price:23326.8398=net_wealth:1212.4375
--------------------------------------------------
2023-02-05T12:00:00 | *** GOING SHORT ***
2023-02-05T12:00:00's price 22932.9102, sell 0.05197601 units.
2023-02-05T12:00:00 | current balance = 1190.77
2023-02-05T12:00:00 | balance:1190.77+units:0.0*price:22932.9102=net_wealth:1190.7706
--------------------------------------------------
2023-02-06T12:00:00 | *** GOING LONG ***
2023-02-06T12:00:00's price 22762.5195, buy 0.05226046 units.
2023-02-06T12:00:00 | current balance = 0.00
2023-02-06T12:00:00 | balance:0.00+units:0.05226046*price:22762.5195=net_wealth:1189.5811
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING SHORT ***
2023-02-07T00:00:00's price 22977.2402, sell 0.05226046 units.
2023-02-07T00:00:00 | current balance = 1199.60
2023-02-07T00:00:00 | balance:1199.60+units:0.0*price:22977.2402=net_wealth:1199.6017
--------------------------------------------------
2023-02-08T00:00:00 | *** GOING LONG ***
2023-02-08T00:00:00's price 23159.0703, buy 0.05174655 units.
2023-02-08T00:00:00 | current balance = 0.00
2023-02-08T00:00:00 | balance:0.00+units:0.05174655*price:23159.0703=net_wealth:1198.4033
--------------------------------------------------
2023-02-09T00:00:00 | *** GOING SHORT ***
2023-02-09T00:00:00's price 22685.7891, sell 0.05174655 units.
2023-02-09T00:00:00 | current balance = 1172.74
2023-02-09T00:00:00 | balance:1172.74+units:0.0*price:22685.7891=net_wealth:1172.7387
--------------------------------------------------
2023-02-12T12:00:00 | *** GOING LONG ***
2023-02-12T12:00:00's price 21783.5391, buy 0.05378216 units.
2023-02-12T12:00:00 | current balance = 0.00
2023-02-12T12:00:00 | balance:0.00+units:0.05378216*price:21783.5391=net_wealth:1171.5671
--------------------------------------------------
2023-02-13T00:00:00 | *** GOING SHORT ***
2023-02-13T00:00:00's price 21603.1094, sell 0.05378216 units.
2023-02-13T00:00:00 | current balance = 1160.70
2023-02-13T00:00:00 | balance:1160.70+units:0.0*price:21603.1094=net_wealth:1160.7014
--------------------------------------------------
2023-02-14T00:00:00 | *** GOING LONG ***
2023-02-14T00:00:00's price 21809.8105, buy 0.05316601 units.
2023-02-14T00:00:00 | current balance = 0.00
2023-02-14T00:00:00 | balance:0.00+units:0.05316601*price:21809.8105=net_wealth:1159.5418
--------------------------------------------------
2023-02-15T12:00:00 | *** GOING SHORT ***
2023-02-15T12:00:00's price 24324.0508, sell 0.05316601 units.
2023-02-15T12:00:00 | current balance = 1291.92
2023-02-15T12:00:00 | balance:1291.92+units:0.0*price:24324.0508=net_wealth:1291.9207
--------------------------------------------------
2023-02-16T00:00:00 | *** GOING LONG ***
2023-02-16T00:00:00's price 24568.5508, buy 0.05253174 units.
2023-02-16T00:00:00 | current balance = 0.00
2023-02-16T00:00:00 | balance:0.00+units:0.05253174*price:24568.5508=net_wealth:1290.6301
--------------------------------------------------
2023-02-17T00:00:00 | *** GOING SHORT ***
2023-02-17T00:00:00's price 23789.8203, sell 0.05253174 units.
2023-02-17T00:00:00 | current balance = 1248.47
2023-02-17T00:00:00 | balance:1248.47+units:0.0*price:23789.8203=net_wealth:1248.4723
--------------------------------------------------
2023-02-17T12:00:00 | *** GOING LONG ***
2023-02-17T12:00:00's price 24569.9707, buy 0.05076212 units.
2023-02-17T12:00:00 | current balance = 0.00
2023-02-17T12:00:00 | balance:0.00+units:0.05076212*price:24569.9707=net_wealth:1247.2251
--------------------------------------------------
2023-02-18T12:00:00 | *** GOING SHORT ***
2023-02-18T12:00:00's price 24631.9492, sell 0.05076212 units.
2023-02-18T12:00:00 | current balance = 1249.12
2023-02-18T12:00:00 | balance:1249.12+units:0.0*price:24631.9492=net_wealth:1249.1209
--------------------------------------------------
2023-02-21T12:00:00 | *** GOING LONG ***
2023-02-21T12:00:00's price 24452.1602, buy 0.05103319 units.
2023-02-21T12:00:00 | current balance = 0.00
2023-02-21T12:00:00 | balance:0.00+units:0.05103319*price:24452.1602=net_wealth:1247.8730
--------------------------------------------------
2023-02-23T12:00:00 | *** GOING SHORT ***
2023-02-23T12:00:00's price 23940.1992, sell 0.05103319 units.
2023-02-23T12:00:00 | current balance = 1220.52
2023-02-23T12:00:00 | balance:1220.52+units:0.0*price:23940.1992=net_wealth:1220.5243
--------------------------------------------------
2023-02-24T12:00:00 | *** GOING LONG ***
2023-02-24T12:00:00's price 23185.2891, buy 0.052589540000000004 units.
2023-02-24T12:00:00 | current balance = 0.00
2023-02-24T12:00:00 | balance:0.00+units:0.052589540000000004*price:23185.2891=net_wealth:1219.3050
--------------------------------------------------
2023-02-25T12:00:00 | *** GOING SHORT ***
2023-02-25T12:00:00's price 23157.0703, sell 0.052589540000000004 units.
2023-02-25T12:00:00 | current balance = 1216.60
2023-02-25T12:00:00 | balance:1216.60+units:0.0*price:23157.0703=net_wealth:1216.6031
--------------------------------------------------
2023-02-26T00:00:00 | *** GOING LONG ***
2023-02-26T00:00:00's price 23253.4395, buy 0.05226695 units.
2023-02-26T00:00:00 | current balance = 0.00
2023-02-26T00:00:00 | balance:0.00+units:0.05226695*price:23253.4395=net_wealth:1215.3877
--------------------------------------------------
2023-02-27T12:00:00 | *** GOING SHORT ***
2023-02-27T12:00:00's price 23492.0898, sell 0.05226695 units.
2023-02-27T12:00:00 | current balance = 1226.63
2023-02-27T12:00:00 | balance:1226.63+units:0.0*price:23492.0898=net_wealth:1226.6334
--------------------------------------------------
2023-02-28T00:00:00 | *** GOING LONG ***
2023-02-28T00:00:00's price 23392.6895, buy 0.05238417 units.
2023-02-28T00:00:00 | current balance = 0.00
2023-02-28T00:00:00 | balance:0.00+units:0.05238417*price:23392.6895=net_wealth:1225.4080
--------------------------------------------------
2023-03-06T00:00:00 | *** GOING SHORT ***
2023-03-06T00:00:00's price 22379.5703, sell 0.05238417 units.
2023-03-06T00:00:00 | current balance = 1171.16
2023-03-06T00:00:00 | balance:1171.16+units:0.0*price:22379.5703=net_wealth:1171.1643
--------------------------------------------------
2023-03-08T00:00:00 | *** GOING LONG ***
2023-03-08T00:00:00's price 22072.4492, buy 0.05300694 units.
2023-03-08T00:00:00 | current balance = 0.00
2023-03-08T00:00:00 | balance:0.00+units:0.05300694*price:22072.4492=net_wealth:1169.9943
--------------------------------------------------
2023-03-08T12:00:00 | *** GOING SHORT ***
2023-03-08T12:00:00's price 21705.4395, sell 0.05300694 units.
2023-03-08T12:00:00 | current balance = 1149.39
2023-03-08T12:00:00 | balance:1149.39+units:0.0*price:21705.4395=net_wealth:1149.3897
--------------------------------------------------
2023-03-12T12:00:00 | *** GOING LONG ***
2023-03-12T12:00:00's price 21997.1094, buy 0.052199590000000004 units.
2023-03-12T12:00:00 | current balance = 0.00
2023-03-12T12:00:00 | balance:0.00+units:0.052199590000000004*price:21997.1094=net_wealth:1148.2414
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING SHORT ***
2023-03-13T12:00:00's price 24113.4805, sell 0.052199590000000004 units.
2023-03-13T12:00:00 | current balance = 1257.46
2023-03-13T12:00:00 | balance:1257.46+units:0.0*price:24113.4805=net_wealth:1257.4564
--------------------------------------------------
2023-03-15T00:00:00 | *** GOING LONG ***
2023-03-15T00:00:00's price 24754.5000, buy 0.05074628 units.
2023-03-15T00:00:00 | current balance = 0.00
2023-03-15T00:00:00 | balance:0.00+units:0.05074628*price:24754.5000=net_wealth:1256.2002
--------------------------------------------------
2023-03-17T00:00:00 | *** GOING SHORT ***
2023-03-17T00:00:00's price 26918.7305, sell 0.05074628 units.
2023-03-17T00:00:00 | current balance = 1364.66
2023-03-17T00:00:00 | balance:1364.66+units:0.0*price:26918.7305=net_wealth:1364.6608
--------------------------------------------------
2023-03-20T00:00:00 | *** GOING LONG ***
2023-03-20T00:00:00's price 28188.9297, buy 0.04836282 units.
2023-03-20T00:00:00 | current balance = 0.00
2023-03-20T00:00:00 | balance:0.00+units:0.04836282*price:28188.9297=net_wealth:1363.2975
--------------------------------------------------
2023-03-20T12:00:00 | *** GOING SHORT ***
2023-03-20T12:00:00's price 27717.0098, sell 0.04836282 units.
2023-03-20T12:00:00 | current balance = 1339.13
2023-03-20T12:00:00 | balance:1339.13+units:0.0*price:27717.0098=net_wealth:1339.1337
--------------------------------------------------
2023-03-23T00:00:00 | *** GOING LONG ***
2023-03-23T00:00:00's price 27584.5293, buy 0.048498 units.
2023-03-23T00:00:00 | current balance = 0.00
2023-03-23T00:00:00 | balance:0.00+units:0.048498*price:27584.5293=net_wealth:1337.7959
--------------------------------------------------
2023-03-24T00:00:00 | *** GOING SHORT ***
2023-03-24T00:00:00's price 28080.0000, sell 0.048498 units.
2023-03-24T00:00:00 | current balance = 1360.46
2023-03-24T00:00:00 | balance:1360.46+units:0.0*price:28080.0000=net_wealth:1360.4634
--------------------------------------------------
2023-03-25T12:00:00 | *** GOING LONG ***
2023-03-25T12:00:00's price 27462.9492, buy 0.0494886 units.
2023-03-25T12:00:00 | current balance = 0.00
2023-03-25T12:00:00 | balance:0.00+units:0.0494886*price:27462.9492=net_wealth:1359.1043
--------------------------------------------------
2023-03-28T12:00:00 | *** GOING SHORT ***
2023-03-28T12:00:00's price 27261.0703, sell 0.0494886 units.
2023-03-28T12:00:00 | current balance = 1347.76
2023-03-28T12:00:00 | balance:1347.76+units:0.0*price:27261.0703=net_wealth:1347.7645
--------------------------------------------------
2023-03-29T12:00:00 | *** GOING LONG ***
2023-03-29T12:00:00's price 28348.5996, buy 0.04749499 units.
2023-03-29T12:00:00 | current balance = 0.00
2023-03-29T12:00:00 | balance:0.00+units:0.04749499*price:28348.5996=net_wealth:1346.4181
--------------------------------------------------
2023-04-02T12:00:00 | *** GOING SHORT ***
2023-04-02T12:00:00's price 28171.8691, sell 0.04749499 units.
2023-04-02T12:00:00 | current balance = 1336.69
2023-04-02T12:00:00 | balance:1336.69+units:0.0*price:28171.8691=net_wealth:1336.6862
--------------------------------------------------
2023-04-03T00:00:00 | *** GOING LONG ***
2023-04-03T00:00:00's price 28253.7305, buy 0.04726276 units.
2023-04-03T00:00:00 | current balance = 0.00
2023-04-03T00:00:00 | balance:0.00+units:0.04726276*price:28253.7305=net_wealth:1335.3509
--------------------------------------------------
2023-04-04T00:00:00 | *** GOING SHORT ***
2023-04-04T00:00:00's price 28289.5195, sell 0.04726276 units.
2023-04-04T00:00:00 | current balance = 1335.71
2023-04-04T00:00:00 | balance:1335.71+units:0.0*price:28289.5195=net_wealth:1335.7053
--------------------------------------------------
2023-04-05T12:00:00 | *** GOING LONG ***
2023-04-05T12:00:00's price 28170.0098, buy 0.04736844 units.
2023-04-05T12:00:00 | current balance = 0.00
2023-04-05T12:00:00 | balance:0.00+units:0.04736844*price:28170.0098=net_wealth:1334.3710
--------------------------------------------------
2023-04-08T00:00:00 | *** GOING SHORT ***
2023-04-08T00:00:00's price 28016.0898, sell 0.04736844 units.
2023-04-08T00:00:00 | current balance = 1325.75
2023-04-08T00:00:00 | balance:1325.75+units:0.0*price:28016.0898=net_wealth:1325.7529
--------------------------------------------------
2023-04-08T12:00:00 | *** GOING LONG ***
2023-04-08T12:00:00's price 27938.3809, buy 0.04740529 units.
2023-04-08T12:00:00 | current balance = 0.00
2023-04-08T12:00:00 | balance:0.00+units:0.04740529*price:27938.3809=net_wealth:1324.4285
--------------------------------------------------
2023-04-09T12:00:00 | *** GOING SHORT ***
2023-04-09T12:00:00's price 28323.7598, sell 0.04740529 units.
2023-04-09T12:00:00 | current balance = 1341.35
2023-04-09T12:00:00 | balance:1341.35+units:0.0*price:28323.7598=net_wealth:1341.3548
--------------------------------------------------
2023-04-10T00:00:00 | *** GOING LONG ***
2023-04-10T00:00:00's price 28305.5996, buy 0.04734093 units.
2023-04-10T00:00:00 | current balance = 0.00
2023-04-10T00:00:00 | balance:0.00+units:0.04734093*price:28305.5996=net_wealth:1340.0148
--------------------------------------------------
2023-04-15T12:00:00 | *** GOING SHORT ***
2023-04-15T12:00:00's price 30295.0898, sell 0.04734093 units.
2023-04-15T12:00:00 | current balance = 1432.76
2023-04-15T12:00:00 | balance:1432.76+units:0.0*price:30295.0898=net_wealth:1432.7649
--------------------------------------------------
2023-04-17T00:00:00 | *** GOING LONG ***
2023-04-17T00:00:00's price 29570.8105, buy 0.04840354 units.
2023-04-17T00:00:00 | current balance = 0.00
2023-04-17T00:00:00 | balance:0.00+units:0.04840354*price:29570.8105=net_wealth:1431.3336
--------------------------------------------------
2023-04-17T12:00:00 | *** GOING SHORT ***
2023-04-17T12:00:00's price 29430.2695, sell 0.04840354 units.
2023-04-17T12:00:00 | current balance = 1423.11
2023-04-17T12:00:00 | balance:1423.11+units:0.0*price:29430.2695=net_wealth:1423.1064
--------------------------------------------------
2023-04-19T00:00:00 | *** GOING LONG ***
2023-04-19T00:00:00's price 29310.6504, buy 0.04850398 units.
2023-04-19T00:00:00 | current balance = 0.00
2023-04-19T00:00:00 | balance:0.00+units:0.04850398*price:29310.6504=net_wealth:1421.6847
--------------------------------------------------
2023-04-20T00:00:00 | *** GOING SHORT ***
2023-04-20T00:00:00's price 28607.1309, sell 0.04850398 units.
2023-04-20T00:00:00 | current balance = 1386.17
2023-04-20T00:00:00 | balance:1386.17+units:0.0*price:28607.1309=net_wealth:1386.1736
--------------------------------------------------
2023-04-20T12:00:00 | *** GOING LONG ***
2023-04-20T12:00:00's price 28243.6504, buy 0.049030040000000004 units.
2023-04-20T12:00:00 | current balance = 0.00
2023-04-20T12:00:00 | balance:0.00+units:0.049030040000000004*price:28243.6504=net_wealth:1384.7889
--------------------------------------------------
2023-04-21T12:00:00 | *** GOING SHORT ***
2023-04-21T12:00:00's price 27262.8398, sell 0.049030040000000004 units.
2023-04-21T12:00:00 | current balance = 1335.36
2023-04-21T12:00:00 | balance:1335.36+units:0.0*price:27262.8398=net_wealth:1335.3630
--------------------------------------------------
2023-04-22T00:00:00 | *** GOING LONG ***
2023-04-22T00:00:00's price 27286.6504, buy 0.04888938 units.
2023-04-22T00:00:00 | current balance = 0.00
2023-04-22T00:00:00 | balance:0.00+units:0.04888938*price:27286.6504=net_wealth:1334.0289
--------------------------------------------------
2023-04-22T12:00:00 | *** GOING SHORT ***
2023-04-22T12:00:00's price 27816.8496, sell 0.04888938 units.
2023-04-22T12:00:00 | current balance = 1358.59
2023-04-22T12:00:00 | balance:1358.59+units:0.0*price:27816.8496=net_wealth:1358.5901
--------------------------------------------------
2023-04-24T12:00:00 | *** GOING LONG ***
2023-04-24T12:00:00's price 27510.9297, buy 0.04933426 units.
2023-04-24T12:00:00 | current balance = 0.00
2023-04-24T12:00:00 | balance:0.00+units:0.04933426*price:27510.9297=net_wealth:1357.2329
--------------------------------------------------
2023-04-27T00:00:00 | *** GOING SHORT ***
2023-04-27T00:00:00's price 28934.2109, sell 0.04933426 units.
2023-04-27T00:00:00 | current balance = 1426.02
2023-04-27T00:00:00 | balance:1426.02+units:0.0*price:28934.2109=net_wealth:1426.0220
--------------------------------------------------
2023-05-01T00:00:00 | *** GOING LONG ***
2023-05-01T00:00:00's price 28523.8594, buy 0.049944010000000004 units.
2023-05-01T00:00:00 | current balance = 0.00
2023-05-01T00:00:00 | balance:0.00+units:0.049944010000000004*price:28523.8594=net_wealth:1424.5974
--------------------------------------------------
2023-05-02T00:00:00 | *** GOING SHORT ***
2023-05-02T00:00:00's price 28084.8301, sell 0.049944010000000004 units.
2023-05-02T00:00:00 | current balance = 1401.27
2023-05-02T00:00:00 | balance:1401.27+units:0.0*price:28084.8301=net_wealth:1401.2678
--------------------------------------------------
2023-05-03T12:00:00 | *** GOING LONG ***
2023-05-03T12:00:00's price 29026.1602, buy 0.04822775 units.
2023-05-03T12:00:00 | current balance = 0.00
2023-05-03T12:00:00 | balance:0.00+units:0.04822775*price:29026.1602=net_wealth:1399.8679
--------------------------------------------------
2023-05-07T00:00:00 | *** GOING SHORT ***
2023-05-07T00:00:00's price 28840.0605, sell 0.04822775 units.
2023-05-07T00:00:00 | current balance = 1389.50
2023-05-07T00:00:00 | balance:1389.50+units:0.0*price:28840.0605=net_wealth:1389.5019
--------------------------------------------------
2023-05-08T00:00:00 | *** GOING LONG ***
2023-05-08T00:00:00's price 27934.0898, buy 0.04969241 units.
2023-05-08T00:00:00 | current balance = 0.00
2023-05-08T00:00:00 | balance:0.00+units:0.04969241*price:27934.0898=net_wealth:1388.1138
--------------------------------------------------
2023-05-11T00:00:00 | *** GOING SHORT ***
2023-05-11T00:00:00's price 27405.6094, sell 0.04969241 units.
2023-05-11T00:00:00 | current balance = 1360.49
2023-05-11T00:00:00 | balance:1360.49+units:0.0*price:27405.6094=net_wealth:1360.4905
--------------------------------------------------
2023-05-11T12:00:00 | *** GOING LONG ***
2023-05-11T12:00:00's price 26968.6191, buy 0.05039672 units.
2023-05-11T12:00:00 | current balance = 0.00
2023-05-11T12:00:00 | balance:0.00+units:0.05039672*price:26968.6191=net_wealth:1359.1313
--------------------------------------------------
2023-05-12T12:00:00 | *** GOING SHORT ***
2023-05-12T12:00:00's price 26795.0098, sell 0.05039672 units.
2023-05-12T12:00:00 | current balance = 1349.03
2023-05-12T12:00:00 | balance:1349.03+units:0.0*price:26795.0098=net_wealth:1349.0316
--------------------------------------------------
2023-05-15T00:00:00 | *** GOING LONG ***
2023-05-15T00:00:00's price 27336.1191, buy 0.04930043 units.
2023-05-15T00:00:00 | current balance = 0.00
2023-05-15T00:00:00 | balance:0.00+units:0.04930043*price:27336.1191=net_wealth:1347.6839
--------------------------------------------------
2023-05-18T12:00:00 | *** GOING SHORT ***
2023-05-18T12:00:00's price 26821.2793, sell 0.04930043 units.
2023-05-18T12:00:00 | current balance = 1320.98
2023-05-18T12:00:00 | balance:1320.98+units:0.0*price:26821.2793=net_wealth:1320.9798
--------------------------------------------------
2023-05-22T00:00:00 | *** GOING LONG ***
2023-05-22T00:00:00's price 26826.7793, buy 0.04919184 units.
2023-05-22T00:00:00 | current balance = 0.00
2023-05-22T00:00:00 | balance:0.00+units:0.04919184*price:26826.7793=net_wealth:1319.6601
--------------------------------------------------
2023-05-24T00:00:00 | *** GOING SHORT ***
2023-05-24T00:00:00's price 26742.2402, sell 0.04919184 units.
2023-05-24T00:00:00 | current balance = 1314.19
2023-05-24T00:00:00 | balance:1314.19+units:0.0*price:26742.2402=net_wealth:1314.1860
--------------------------------------------------
2023-05-27T12:00:00 | *** GOING LONG ***
2023-05-27T12:00:00's price 26854.2695, buy 0.04888875 units.
2023-05-27T12:00:00 | current balance = 0.00
2023-05-27T12:00:00 | balance:0.00+units:0.04888875*price:26854.2695=net_wealth:1312.8731
--------------------------------------------------
2023-05-29T00:00:00 | *** GOING SHORT ***
2023-05-29T00:00:00's price 27913.8691, sell 0.04888875 units.
2023-05-29T00:00:00 | current balance = 1363.31
2023-05-29T00:00:00 | balance:1363.31+units:0.0*price:27913.8691=net_wealth:1363.3110
--------------------------------------------------
2023-05-30T12:00:00 | *** GOING LONG ***
2023-05-30T12:00:00's price 27694.4004, buy 0.04917772 units.
2023-05-30T12:00:00 | current balance = 0.00
2023-05-30T12:00:00 | balance:0.00+units:0.04917772*price:27694.4004=net_wealth:1361.9490
--------------------------------------------------
2023-05-31T12:00:00 | *** GOING SHORT ***
2023-05-31T12:00:00's price 27210.3496, sell 0.04917772 units.
2023-05-31T12:00:00 | current balance = 1336.81
2023-05-31T12:00:00 | balance:1336.81+units:0.0*price:27210.3496=net_wealth:1336.8064
--------------------------------------------------
2023-06-03T00:00:00 | *** GOING LONG ***
2023-06-03T00:00:00's price 27129.7891, buy 0.049225200000000004 units.
2023-06-03T00:00:00 | current balance = 0.00
2023-06-03T00:00:00 | balance:0.00+units:0.049225200000000004*price:27129.7891=net_wealth:1335.4709
--------------------------------------------------
2023-06-06T00:00:00 | *** GOING SHORT ***
2023-06-06T00:00:00's price 25686.6406, sell 0.049225200000000004 units.
2023-06-06T00:00:00 | current balance = 1263.17
2023-06-06T00:00:00 | balance:1263.17+units:0.0*price:25686.6406=net_wealth:1263.1672
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1263.17
2023-06-08T12:00:00 | net performance [%] = 26.3167
2023-06-08T12:00:00 | number of trades [#] = 90
==================================================
Trial 17 Complete [00h 25m 09s]
net_wealth: 1263.1671814392112

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 02h 14m 08s

Search: Running Trial #18

Value             |Best Value So Far |Hyperparameter
4                 |8                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
20                |14                |lags
0.9               |0.98              |gamma
32                |32                |memory_size
16                |16                |batch_size
32                |32                |n_steps
0.98              |0.98              |gae_lambda
10                |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4219.000000   4223.000000
mean      0.000429    19869.492402  ...   19934.900107  19920.121151
std       0.028054    16157.511856  ...   16192.506388  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7576.504883   7559.520020
50%       0.000696    11383.668066  ...   11464.480469  11460.440430
75%       0.011799    29453.128320  ...   29311.174805  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.5653 | profit rate:    0.8 | accuracy: 0.32
step_num: 400 | loss: 0.4794 | profit rate:    1.1 | accuracy: 0.34
step_num: 600 | loss: 1.0519 | profit rate:    1.5 | accuracy: 0.35
step_num: 800 | loss: 0.4411 | profit rate:    0.7 | accuracy: 0.34
step_num: 1000 | loss: 0.5097 | profit rate:    0.3 | accuracy: 0.33
step_num: 1200 | loss: 0.4349 | profit rate:    0.4 | accuracy: 0.34
step_num: 1400 | loss: 0.5862 | profit rate:    0.5 | accuracy: 0.35
step_num: 1600 | loss: 0.0901 | profit rate:    0.6 | accuracy: 0.33
step_num: 1800 | loss: 0.6659 | profit rate:    0.2 | accuracy: 0.31
step_num: 2000 | loss: 0.6698 | profit rate:    0.0 | accuracy: 0.32
step_num: 2200 | loss: 0.8832 | profit rate:    0.0 | accuracy: 0.33
step_num: 2400 | loss: 0.2857 | profit rate:    0.0 | accuracy: 0.34
step_num: 2600 | loss: 0.4782 | profit rate:    0.0 | accuracy: 0.33
step_num: 2800 | loss: 0.4825 | profit rate:    0.0 | accuracy: 0.33
step_num: 3000 | loss: 0.4942 | profit rate:    0.0 | accuracy: 0.34
episode:   1/8,耗时:0.36分/0.36分,训练集: | step: 3157 | average_treward:  -25.4 | max_treward: 0.0000 | average profit rate:  0.084
step_num: 3200 | loss: 0.3502 | profit rate:    0.9 | accuracy: 0.30
step_num: 3400 | loss: 0.5256 | profit rate:    6.1 | accuracy: 0.50
step_num: 3600 | loss: 0.3071 | profit rate:    4.7 | accuracy: 0.46
step_num: 3800 | loss: 1.3404 | profit rate:   28.4 | accuracy: 0.48
step_num: 4000 | loss: 0.5829 | profit rate:   32.1 | accuracy: 0.47
step_num: 4200 | loss: 0.2886 | profit rate:   27.2 | accuracy: 0.45
step_num: 4400 | loss: 0.6411 | profit rate:  113.7 | accuracy: 0.44
step_num: 4600 | loss: 0.6324 | profit rate:   75.0 | accuracy: 0.44
step_num: 4800 | loss: 0.0184 | profit rate:  129.7 | accuracy: 0.41
step_num: 5000 | loss: 0.3142 | profit rate:   93.2 | accuracy: 0.36
step_num: 5200 | loss: 0.4167 | profit rate:   44.0 | accuracy: 0.34
step_num: 5400 | loss: 0.0140 | profit rate:   84.6 | accuracy: 0.32
step_num: 5600 | loss: 0.0620 | profit rate:  144.0 | accuracy: 0.31
step_num: 5800 | loss: 0.1960 | profit rate:  133.3 | accuracy: 0.31
step_num: 6000 | loss: 0.7665 | profit rate: 1311.4 | accuracy: 0.32
step_num: 6200 | loss: 0.8616 | profit rate: 2372.6 | accuracy: 0.33
model saved @ step:6314,performance:6759.529,accuracy:0.34
step_num: 6400 | loss: 0.6143 | profit rate:    1.0 | accuracy: 0.47
step_num: 6600 | loss: 0.4237 | profit rate:   16.1 | accuracy: 0.54
step_num: 6800 | loss: 0.5514 | profit rate:    6.2 | accuracy: 0.49
step_num: 7000 | loss: 0.1963 | profit rate:   15.2 | accuracy: 0.43
step_num: 7200 | loss: 0.1196 | profit rate:   10.5 | accuracy: 0.34
step_num: 7400 | loss: 0.0297 | profit rate:   13.5 | accuracy: 0.32
step_num: 7600 | loss: 0.0094 | profit rate:   43.4 | accuracy: 0.33
step_num: 7800 | loss: 0.0133 | profit rate:   42.9 | accuracy: 0.29
step_num: 8000 | loss: 0.0121 | profit rate:   43.7 | accuracy: 0.26
step_num: 8200 | loss: 0.0189 | profit rate:   48.5 | accuracy: 0.23
step_num: 8400 | loss: 0.1891 | profit rate:   51.7 | accuracy: 0.22
step_num: 8600 | loss: 0.6743 | profit rate:   97.4 | accuracy: 0.21
step_num: 8800 | loss: 0.3732 | profit rate:  181.7 | accuracy: 0.21
step_num: 9000 | loss: 0.8263 | profit rate:  207.5 | accuracy: 0.22
step_num: 9200 | loss: 0.6386 | profit rate:  235.1 | accuracy: 0.24
step_num: 9400 | loss: 0.3668 | profit rate:  669.6 | accuracy: 0.26
episode:   3/8,耗时:0.40分/1.17分,训练集: | step: 9471 | average_treward:  102.7 | max_treward: 171.0935 | average profit rate: 2472.943
step_num: 9600 | loss: 0.4843 | profit rate:    1.1 | accuracy: 0.48
step_num: 9800 | loss: 0.6336 | profit rate:   13.1 | accuracy: 0.50
step_num: 10000 | loss: 0.7107 | profit rate:   28.9 | accuracy: 0.49
step_num: 10200 | loss: 0.0605 | profit rate:   14.1 | accuracy: 0.41
step_num: 10400 | loss: 0.4981 | profit rate:   13.1 | accuracy: 0.36
step_num: 10600 | loss: 1.1091 | profit rate:   36.4 | accuracy: 0.34
step_num: 10800 | loss: 0.0015 | profit rate:  262.0 | accuracy: 0.34
step_num: 11000 | loss: 0.0716 | profit rate:  251.3 | accuracy: 0.30
step_num: 11200 | loss: 0.0073 | profit rate:  251.3 | accuracy: 0.27
step_num: 11400 | loss: 0.0170 | profit rate:  239.9 | accuracy: 0.24
step_num: 11600 | loss: 0.5773 | profit rate:  242.9 | accuracy: 0.23
step_num: 11800 | loss: 0.0023 | profit rate:  443.2 | accuracy: 0.23
step_num: 12000 | loss: 0.8292 | profit rate:  300.4 | accuracy: 0.23
step_num: 12200 | loss: 0.5609 | profit rate:   95.9 | accuracy: 0.24
step_num: 12400 | loss: 0.7042 | profit rate:   79.1 | accuracy: 0.26
step_num: 12600 | loss: 0.5543 | profit rate:  136.2 | accuracy: 0.27
step_num: 12800 | loss: 0.7991 | profit rate:    6.7 | accuracy: 0.51
step_num: 13000 | loss: 0.5451 | profit rate:   10.6 | accuracy: 0.49
step_num: 13200 | loss: 0.2998 | profit rate:   14.2 | accuracy: 0.46
step_num: 13400 | loss: 0.0895 | profit rate:   24.2 | accuracy: 0.42
step_num: 13600 | loss: 0.5076 | profit rate:   21.2 | accuracy: 0.38
step_num: 13800 | loss: 0.6558 | profit rate:  112.7 | accuracy: 0.37
step_num: 14000 | loss: 0.0715 | profit rate:  367.5 | accuracy: 0.35
step_num: 14200 | loss: 0.0014 | profit rate:  361.2 | accuracy: 0.31
step_num: 14400 | loss: 0.4611 | profit rate:  182.4 | accuracy: 0.28
step_num: 14600 | loss: 0.0141 | profit rate:  182.4 | accuracy: 0.25
step_num: 14800 | loss: 0.0024 | profit rate:  263.0 | accuracy: 0.24
step_num: 15000 | loss: 0.0031 | profit rate:  299.7 | accuracy: 0.22
step_num: 15200 | loss: 0.8470 | profit rate:  171.8 | accuracy: 0.23
step_num: 15400 | loss: 0.8877 | profit rate:  336.8 | accuracy: 0.25
step_num: 15600 | loss: 0.5176 | profit rate: 2914.5 | accuracy: 0.27
episode:   5/8,耗时:0.40分/1.96分,训练集: | step: 15785 | average_treward:  116.5 | max_treward: 178.7284 | average profit rate: 2201.875
model saved @ step:15785,performance:3448.472,accuracy:0.28
step_num: 15800 | loss: 0.5400 | profit rate:    0.9 | accuracy: 0.38
step_num: 16000 | loss: 0.6977 | profit rate:    5.1 | accuracy: 0.52
step_num: 16200 | loss: 0.5437 | profit rate:    4.0 | accuracy: 0.48
step_num: 16400 | loss: 0.0819 | profit rate:   12.2 | accuracy: 0.41
step_num: 16600 | loss: 0.3868 | profit rate:   13.6 | accuracy: 0.34
step_num: 16800 | loss: 0.5128 | profit rate:   14.4 | accuracy: 0.32
step_num: 17000 | loss: 0.6200 | profit rate:  225.6 | accuracy: 0.33
step_num: 17200 | loss: 0.0506 | profit rate:  256.2 | accuracy: 0.30
step_num: 17400 | loss: 0.0045 | profit rate:  262.7 | accuracy: 0.26
step_num: 17600 | loss: 0.0041 | profit rate:  262.7 | accuracy: 0.23
step_num: 17800 | loss: 0.5785 | profit rate:  316.7 | accuracy: 0.22
step_num: 18000 | loss: 0.2133 | profit rate:  386.0 | accuracy: 0.22
step_num: 18200 | loss: 0.0600 | profit rate:  375.1 | accuracy: 0.20
step_num: 18400 | loss: 0.6041 | profit rate:  629.3 | accuracy: 0.22
step_num: 18600 | loss: 0.5632 | profit rate: 1177.3 | accuracy: 0.24
step_num: 18800 | loss: 0.5751 | profit rate: 5635.4 | accuracy: 0.26
model saved @ step:18942,performance:2613.494,accuracy:0.27
step_num: 19000 | loss: 0.4953 | profit rate:    0.8 | accuracy: 0.32
step_num: 19200 | loss: 0.5672 | profit rate:   10.8 | accuracy: 0.51
step_num: 19400 | loss: 0.4435 | profit rate:    4.4 | accuracy: 0.48
step_num: 19600 | loss: 0.2337 | profit rate:    9.2 | accuracy: 0.43
step_num: 19800 | loss: 0.3460 | profit rate:    6.5 | accuracy: 0.35
step_num: 20000 | loss: 0.0370 | profit rate:    6.6 | accuracy: 0.32
step_num: 20200 | loss: 0.1198 | profit rate:   90.9 | accuracy: 0.34
step_num: 20400 | loss: 0.0009 | profit rate:   94.2 | accuracy: 0.30
step_num: 20600 | loss: 0.0037 | profit rate:   91.0 | accuracy: 0.26
step_num: 20800 | loss: 0.0042 | profit rate:   62.7 | accuracy: 0.24
step_num: 21000 | loss: 0.0067 | profit rate:  100.9 | accuracy: 0.22
step_num: 21200 | loss: 0.0874 | profit rate:   91.7 | accuracy: 0.21
step_num: 21400 | loss: 0.2256 | profit rate:  142.3 | accuracy: 0.21
step_num: 21600 | loss: 0.4394 | profit rate:  154.8 | accuracy: 0.22
step_num: 21800 | loss: 0.5728 | profit rate:  946.8 | accuracy: 0.25
step_num: 22000 | loss: 0.6743 | profit rate:  451.7 | accuracy: 0.26
episode:   7/8,耗时:0.40分/2.76分,训练集: | step: 22099 | average_treward:  131.9 | max_treward: 187.3422 | average profit rate: 2020.783
step_num: 22200 | loss: 0.4592 | profit rate:    1.0 | accuracy: 0.44
step_num: 22400 | loss: 0.5771 | profit rate:   14.3 | accuracy: 0.49
step_num: 22600 | loss: 0.2313 | profit rate:   10.3 | accuracy: 0.47
step_num: 22800 | loss: 0.1971 | profit rate:   15.0 | accuracy: 0.40
step_num: 23000 | loss: 0.0921 | profit rate:   16.2 | accuracy: 0.34
step_num: 23200 | loss: 0.0605 | profit rate:   20.9 | accuracy: 0.31
step_num: 23400 | loss: 0.0539 | profit rate:  297.2 | accuracy: 0.33
step_num: 23600 | loss: 0.1262 | profit rate:  312.6 | accuracy: 0.29
step_num: 23800 | loss: 0.0111 | profit rate:  320.7 | accuracy: 0.26
step_num: 24000 | loss: 0.2118 | profit rate:  202.2 | accuracy: 0.24
step_num: 24200 | loss: 0.1357 | profit rate:  408.5 | accuracy: 0.23
step_num: 24400 | loss: 0.0480 | profit rate:  647.2 | accuracy: 0.23
step_num: 24600 | loss: 0.6438 | profit rate: 1069.0 | accuracy: 0.22
step_num: 24800 | loss: 0.7967 | profit rate: 3005.4 | accuracy: 0.24
step_num: 25000 | loss: 0.5368 | profit rate: 20662.3 | accuracy: 0.27
step_num: 25200 | loss: 0.6466 | profit rate: 12070.8 | accuracy: 0.28
model saved @ step:25256,performance:14087.218,accuracy:0.28
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 31%|      | 94/299 [00:00<00:00, 934.42it/s] 66%|   | 196/299 [00:00<00:00, 978.89it/s]100%|| 299/299 [00:00<00:00, 991.39it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-18T00:00:00 | *** GOING LONG ***
2023-01-18T00:00:00's price 21204.6699, buy 0.04711226 units.
2023-01-18T00:00:00 | current balance = 0.00
2023-01-18T00:00:00 | balance:0.00+units:0.04711226*price:21204.6699=net_wealth:999.0010
--------------------------------------------------
2023-02-09T00:00:00 | *** GOING SHORT ***
2023-02-09T00:00:00's price 22685.7891, sell 0.04711226 units.
2023-02-09T00:00:00 | current balance = 1067.71
2023-02-09T00:00:00 | balance:1067.71+units:0.0*price:22685.7891=net_wealth:1067.7111
--------------------------------------------------
2023-02-24T00:00:00 | *** GOING LONG ***
2023-02-24T00:00:00's price 23883.7207, buy 0.04465984 units.
2023-02-24T00:00:00 | current balance = 0.00
2023-02-24T00:00:00 | balance:0.00+units:0.04465984*price:23883.7207=net_wealth:1066.6444
--------------------------------------------------
2023-03-08T12:00:00 | *** GOING SHORT ***
2023-03-08T12:00:00's price 21705.4395, sell 0.04465984 units.
2023-03-08T12:00:00 | current balance = 968.39
2023-03-08T12:00:00 | balance:968.39+units:0.0*price:21705.4395=net_wealth:968.3934
--------------------------------------------------
2023-03-21T00:00:00 | *** GOING LONG ***
2023-03-21T00:00:00's price 28040.1309, buy 0.03450144 units.
2023-03-21T00:00:00 | current balance = 0.00
2023-03-21T00:00:00 | balance:0.00+units:0.03450144*price:28040.1309=net_wealth:967.4260
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03450144 units.
2023-06-08T12:00:00 | current balance = 916.81
2023-06-08T12:00:00 | net performance [%] = -8.3186
2023-06-08T12:00:00 | number of trades [#] = 6
==================================================
Trial 18 Complete [00h 03m 13s]
net_wealth: 917.7321036537863

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 02h 17m 21s

Search: Running Trial #19

Value             |Best Value So Far |Hyperparameter
14                |8                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
14                |14                |lags
0.97              |0.98              |gamma
2000              |32                |memory_size
16                |16                |batch_size
64                |32                |n_steps
0.96              |0.98              |gae_lambda
10                |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4209.000000   4223.000000
mean      0.000429    19869.492402  ...   19971.309209  19920.121151
std       0.028054    16157.511856  ...   16194.471215  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7625.000000   7559.520020
50%       0.000696    11383.668066  ...   11477.000000  11460.440430
75%       0.011799    29453.128320  ...   29331.689453  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9889 | profit rate:    0.1 | accuracy: 0.31
step_num: 1200 | loss: 0.6420 | profit rate:    0.3 | accuracy: 0.32
step_num: 1400 | loss: 0.6264 | profit rate:    0.1 | accuracy: 0.32
step_num: 1600 | loss: 0.6269 | profit rate:    0.1 | accuracy: 0.33
step_num: 1800 | loss: 0.6290 | profit rate:    0.0 | accuracy: 0.33
step_num: 2000 | loss: 0.6290 | profit rate:    0.0 | accuracy: 0.33
step_num: 2200 | loss: 0.6778 | profit rate:    0.0 | accuracy: 0.33
step_num: 2400 | loss: 0.6987 | profit rate:    0.0 | accuracy: 0.34
step_num: 2600 | loss: 0.6821 | profit rate:    0.0 | accuracy: 0.34
step_num: 2800 | loss: 0.6437 | profit rate:    0.1 | accuracy: 0.35
step_num: 3000 | loss: 0.6770 | profit rate:    0.6 | accuracy: 0.36
episode:   1/8,耗时:2.30分/2.30分,训练集: | step: 3163 | average_treward:   43.1 | max_treward: 43.1493 | average profit rate:  6.233
model saved @ step:3163,performance:6.233,accuracy:0.36
step_num: 3200 | loss: 0.6393 | profit rate:    1.5 | accuracy: 0.32
step_num: 3400 | loss: 0.6529 | profit rate:  203.6 | accuracy: 0.42
step_num: 3600 | loss: 0.6512 | profit rate:    5.8 | accuracy: 0.40
step_num: 3800 | loss: 0.6330 | profit rate:    0.1 | accuracy: 0.37
step_num: 4000 | loss: 0.6598 | profit rate:    0.6 | accuracy: 0.37
step_num: 4200 | loss: 0.6208 | profit rate:    0.7 | accuracy: 0.34
step_num: 4400 | loss: 0.6765 | profit rate:  126.4 | accuracy: 0.34
step_num: 4600 | loss: 0.6184 | profit rate:   60.4 | accuracy: 0.33
step_num: 4800 | loss: 0.6026 | profit rate:  231.5 | accuracy: 0.32
step_num: 5000 | loss: 0.5825 | profit rate: 104962.1 | accuracy: 0.33
step_num: 5200 | loss: 0.6004 | profit rate: 226351.7 | accuracy: 0.33
step_num: 5400 | loss: 0.5547 | profit rate: 675835.6 | accuracy: 0.32
step_num: 5600 | loss: 0.5202 | profit rate: 3275781.0 | accuracy: 0.32
step_num: 5800 | loss: 0.5263 | profit rate: 15141490.6 | accuracy: 0.33
step_num: 6000 | loss: 0.5022 | profit rate: 25371474.0 | accuracy: 0.33
step_num: 6200 | loss: 0.5210 | profit rate: 21491562.4 | accuracy: 0.32
model saved @ step:6326,performance:21522910.887,accuracy:0.31
step_num: 6400 | loss: 0.4789 | profit rate:    0.8 | accuracy: 0.11
step_num: 6600 | loss: 0.5260 | profit rate:    4.3 | accuracy: 0.18
step_num: 6800 | loss: 0.4947 | profit rate:    3.0 | accuracy: 0.18
step_num: 7000 | loss: 0.5004 | profit rate:  195.6 | accuracy: 0.24
step_num: 7200 | loss: 0.5073 | profit rate:   43.4 | accuracy: 0.28
step_num: 7400 | loss: 0.4874 | profit rate:   36.5 | accuracy: 0.27
step_num: 7600 | loss: 0.5712 | profit rate: 7595.7 | accuracy: 0.29
step_num: 7800 | loss: 0.5613 | profit rate: 24015.8 | accuracy: 0.31
step_num: 8000 | loss: 0.5719 | profit rate: 136217.3 | accuracy: 0.31
step_num: 8200 | loss: 0.5965 | profit rate: 131196231.3 | accuracy: 0.32
step_num: 8400 | loss: 0.6465 | profit rate: 7782476574.0 | accuracy: 0.34
step_num: 8600 | loss: 0.5978 | profit rate: 2917890414.4 | accuracy: 0.33
step_num: 8800 | loss: 0.6126 | profit rate: 121021015150.1 | accuracy: 0.34
step_num: 9000 | loss: 0.6095 | profit rate: 5738140800808.9 | accuracy: 0.34
step_num: 9200 | loss: 0.6415 | profit rate: 499375448862708.0 | accuracy: 0.35
step_num: 9400 | loss: 0.6516 | profit rate: 368617644645120.5 | accuracy: 0.34
episode:   3/8,耗时:3.33分/8.87分,训练集: | step: 9489 | average_treward:  267.4 | max_treward: 516.6750 | average profit rate: 149213225855421.469
model saved @ step:9489,performance:447639656043347.312,accuracy:0.34
step_num: 9600 | loss: 0.6603 | profit rate:    0.8 | accuracy: 0.18
step_num: 9800 | loss: 0.7697 | profit rate:    5.4 | accuracy: 0.24
step_num: 10000 | loss: 0.6393 | profit rate:    0.7 | accuracy: 0.22
step_num: 10200 | loss: 0.7017 | profit rate:    2.9 | accuracy: 0.26
step_num: 10400 | loss: 0.6770 | profit rate:   61.6 | accuracy: 0.31
step_num: 10600 | loss: 0.6827 | profit rate: 25892.2 | accuracy: 0.33
step_num: 10800 | loss: 0.6340 | profit rate: 17337.1 | accuracy: 0.33
step_num: 11000 | loss: 0.6714 | profit rate: 36808.3 | accuracy: 0.35
step_num: 11200 | loss: 0.6780 | profit rate: 8413255.5 | accuracy: 0.35
step_num: 11400 | loss: 0.6391 | profit rate: 2067264630.8 | accuracy: 0.37
step_num: 11600 | loss: 0.7414 | profit rate: 25217769895.8 | accuracy: 0.37
step_num: 11800 | loss: 0.7386 | profit rate: 65334155823.8 | accuracy: 0.37
step_num: 12000 | loss: 0.7068 | profit rate: 4389082819443.9 | accuracy: 0.37
step_num: 12200 | loss: 0.7541 | profit rate: 476254845135990.6 | accuracy: 0.37
step_num: 12400 | loss: 0.6719 | profit rate: 6804523337890652.0 | accuracy: 0.36
step_num: 12600 | loss: 0.6281 | profit rate: 1583014212969885.2 | accuracy: 0.36
model saved @ step:12652,performance:1556657152477513.500,accuracy:0.35
step_num: 12800 | loss: 0.6448 | profit rate:    1.7 | accuracy: 0.22
step_num: 13000 | loss: 0.6807 | profit rate:    3.3 | accuracy: 0.24
step_num: 13200 | loss: 0.6626 | profit rate:    2.6 | accuracy: 0.25
step_num: 13400 | loss: 0.6449 | profit rate:    1.9 | accuracy: 0.28
step_num: 13600 | loss: 0.6370 | profit rate:    2.9 | accuracy: 0.28
step_num: 13800 | loss: 0.7626 | profit rate: 2602.0 | accuracy: 0.30
step_num: 14000 | loss: 0.6504 | profit rate: 19277.8 | accuracy: 0.30
step_num: 14200 | loss: 0.6496 | profit rate: 155378.6 | accuracy: 0.31
step_num: 14400 | loss: 0.6386 | profit rate: 360886393.3 | accuracy: 0.32
step_num: 14600 | loss: 0.7219 | profit rate: 44606235190.9 | accuracy: 0.33
step_num: 14800 | loss: 0.7633 | profit rate: 398663330147.1 | accuracy: 0.33
step_num: 15000 | loss: 0.7326 | profit rate: 5360881496888.5 | accuracy: 0.34
step_num: 15200 | loss: 0.7581 | profit rate: 513541185085570.4 | accuracy: 0.34
step_num: 15400 | loss: 0.7765 | profit rate: 28968201078728104.0 | accuracy: 0.34
step_num: 15600 | loss: 0.7852 | profit rate: 51088856128673752.0 | accuracy: 0.34
step_num: 15800 | loss: 0.7205 | profit rate: 27169015271585844.0 | accuracy: 0.34
episode:   5/8,耗时:3.45分/15.57分,训练集: | step: 15815 | average_treward:  403.3 | max_treward: 648.1122 | average profit rate: 5735550839586120.000
model saved @ step:15815,performance:26673457367886820.000,accuracy:0.33
step_num: 16000 | loss: 0.7001 | profit rate:    3.5 | accuracy: 0.24
step_num: 16200 | loss: 0.6733 | profit rate:    0.3 | accuracy: 0.23
step_num: 16400 | loss: 0.6766 | profit rate:    2.3 | accuracy: 0.25
step_num: 16600 | loss: 0.6161 | profit rate:   10.5 | accuracy: 0.30
step_num: 16800 | loss: 0.6382 | profit rate:   28.5 | accuracy: 0.31
step_num: 17000 | loss: 0.7573 | profit rate: 407111.5 | accuracy: 0.33
step_num: 17200 | loss: 0.7415 | profit rate: 1660566.9 | accuracy: 0.33
step_num: 17400 | loss: 0.6961 | profit rate: 24177031.9 | accuracy: 0.33
step_num: 17600 | loss: 0.6385 | profit rate: 516122795685.9 | accuracy: 0.35
step_num: 17800 | loss: 0.7011 | profit rate: 3474281920326753.0 | accuracy: 0.37
step_num: 18000 | loss: 0.6697 | profit rate: 46850426344056304.0 | accuracy: 0.38
step_num: 18200 | loss: 0.7808 | profit rate: 14694115269315549184.0 | accuracy: 0.39
step_num: 18400 | loss: 0.7877 | profit rate: 398865645494516121600.0 | accuracy: 0.39
step_num: 18600 | loss: 0.7465 | profit rate: 40773401655740131704832.0 | accuracy: 0.38
step_num: 18800 | loss: 0.7352 | profit rate: 1117531514724175323332608.0 | accuracy: 0.38
model saved @ step:18978,performance:1052994623039685047353344.000,accuracy:0.37
step_num: 19000 | loss: 0.7167 | profit rate:    0.5 | accuracy: 0.13
step_num: 19200 | loss: 0.8033 | profit rate:    3.1 | accuracy: 0.24
step_num: 19400 | loss: 0.6892 | profit rate:    1.8 | accuracy: 0.26
step_num: 19600 | loss: 0.6061 | profit rate:    4.1 | accuracy: 0.28
step_num: 19800 | loss: 0.6374 | profit rate:   65.8 | accuracy: 0.34
step_num: 20000 | loss: 0.6710 | profit rate:   98.4 | accuracy: 0.33
step_num: 20200 | loss: 0.6859 | profit rate: 2599477.3 | accuracy: 0.35
step_num: 20400 | loss: 0.6814 | profit rate: 11946108.5 | accuracy: 0.34
step_num: 20600 | loss: 0.6755 | profit rate: 22216065.3 | accuracy: 0.34
step_num: 20800 | loss: 0.6930 | profit rate: 538414769147.8 | accuracy: 0.36
step_num: 21000 | loss: 0.7871 | profit rate: 557946663075930.0 | accuracy: 0.37
step_num: 21200 | loss: 0.7713 | profit rate: 14623508262522780.0 | accuracy: 0.38
step_num: 21400 | loss: 0.7443 | profit rate: 320495217596246144.0 | accuracy: 0.39
step_num: 21600 | loss: 0.7521 | profit rate: 99157067474460639232.0 | accuracy: 0.39
step_num: 21800 | loss: 0.7754 | profit rate: 4074724621341960962048.0 | accuracy: 0.39
step_num: 22000 | loss: 0.8153 | profit rate: 3140480964088303714304.0 | accuracy: 0.39
episode:   7/8,耗时:3.29分/22.17分,训练集: | step: 22141 | average_treward:  523.1 | max_treward: 863.5684 | average profit rate: 151052456251165052502016.000
step_num: 22200 | loss: 0.7611 | profit rate:    0.8 | accuracy: 0.12
step_num: 22400 | loss: 0.7447 | profit rate:    0.8 | accuracy: 0.26
step_num: 22600 | loss: 0.7203 | profit rate:    0.8 | accuracy: 0.24
step_num: 22800 | loss: 0.7274 | profit rate:    8.7 | accuracy: 0.26
step_num: 23000 | loss: 0.6802 | profit rate:   80.0 | accuracy: 0.30
step_num: 23200 | loss: 0.6481 | profit rate:  260.0 | accuracy: 0.29
step_num: 23400 | loss: 0.7324 | profit rate: 3807978.9 | accuracy: 0.32
step_num: 23600 | loss: 0.7331 | profit rate: 30216384.7 | accuracy: 0.32
step_num: 23800 | loss: 0.7379 | profit rate: 65852581.6 | accuracy: 0.32
step_num: 24000 | loss: 0.6978 | profit rate: 17039393996277.5 | accuracy: 0.34
step_num: 24200 | loss: 0.7051 | profit rate: 51537576075753312.0 | accuracy: 0.35
step_num: 24400 | loss: 0.7484 | profit rate: 380188342560237568.0 | accuracy: 0.37
step_num: 24600 | loss: 0.7153 | profit rate: 122087126755024322560.0 | accuracy: 0.38
step_num: 24800 | loss: 0.7739 | profit rate: 51331356336436268761088.0 | accuracy: 0.38
step_num: 25000 | loss: 0.8039 | profit rate: 40498565943670609178263552.0 | accuracy: 0.38
step_num: 25200 | loss: 0.7782 | profit rate: 52708813757175740430811136.0 | accuracy: 0.38
model saved @ step:25304,performance:93138275094354202453868544.000,accuracy:0.38
----------------------------------------finished----------------------------------------
  0%|          | 0/305 [00:00<?, ?it/s] 33%|      | 100/305 [00:00<00:00, 992.39it/s] 70%|   | 213/305 [00:00<00:00, 1066.83it/s]100%|| 305/305 [00:00<00:00, 1106.04it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-12T12:00:00 | *** GOING LONG ***
2023-01-12T12:00:00's price 18846.6191, buy 0.05300685 units.
2023-01-12T12:00:00 | current balance = 0.00
2023-01-12T12:00:00 | balance:0.00+units:0.05300685*price:18846.6191=net_wealth:999.0010
--------------------------------------------------
2023-02-06T00:00:00 | *** GOING SHORT ***
2023-02-06T00:00:00's price 22878.2305, sell 0.05300685 units.
2023-02-06T00:00:00 | current balance = 1211.49
2023-02-06T00:00:00 | balance:1211.49+units:0.0*price:22878.2305=net_wealth:1211.4913
--------------------------------------------------
2023-02-20T00:00:00 | *** GOING LONG ***
2023-02-20T00:00:00's price 24890.0000, buy 0.048625140000000004 units.
2023-02-20T00:00:00 | current balance = 0.00
2023-02-20T00:00:00 | balance:0.00+units:0.048625140000000004*price:24890.0000=net_wealth:1210.2810
--------------------------------------------------
2023-03-04T00:00:00 | *** GOING SHORT ***
2023-03-04T00:00:00's price 22349.4609, sell 0.048625140000000004 units.
2023-03-04T00:00:00 | current balance = 1085.66
2023-03-04T00:00:00 | balance:1085.66+units:0.0*price:22349.4609=net_wealth:1085.6602
--------------------------------------------------
2023-03-15T12:00:00 | *** GOING LONG ***
2023-03-15T12:00:00's price 24285.6602, buy 0.04465905 units.
2023-03-15T12:00:00 | current balance = 0.00
2023-03-15T12:00:00 | balance:0.00+units:0.04465905*price:24285.6602=net_wealth:1084.5756
--------------------------------------------------
2023-03-16T12:00:00 | *** GOING SHORT ***
2023-03-16T12:00:00's price 24998.7793, sell 0.04465905 units.
2023-03-16T12:00:00 | current balance = 1115.31
2023-03-16T12:00:00 | balance:1115.31+units:0.0*price:24998.7793=net_wealth:1115.3064
--------------------------------------------------
2023-03-18T00:00:00 | *** GOING LONG ***
2023-03-18T00:00:00's price 27443.0898, buy 0.04060006 units.
2023-03-18T00:00:00 | current balance = 0.00
2023-03-18T00:00:00 | balance:0.00+units:0.04060006*price:27443.0898=net_wealth:1114.1923
--------------------------------------------------
2023-03-18T12:00:00 | *** GOING SHORT ***
2023-03-18T12:00:00's price 26907.4902, sell 0.04060006 units.
2023-03-18T12:00:00 | current balance = 1091.35
2023-03-18T12:00:00 | balance:1091.35+units:0.0*price:26907.4902=net_wealth:1091.3544
--------------------------------------------------
2023-03-19T00:00:00 | *** GOING LONG ***
2023-03-19T00:00:00's price 27160.9805, buy 0.04014078 units.
2023-03-19T00:00:00 | current balance = 0.00
2023-03-19T00:00:00 | balance:0.00+units:0.04014078*price:27160.9805=net_wealth:1090.2642
--------------------------------------------------
2023-04-02T00:00:00 | *** GOING SHORT ***
2023-04-02T00:00:00's price 28357.9297, sell 0.04014078 units.
2023-04-02T00:00:00 | current balance = 1137.17
2023-04-02T00:00:00 | balance:1137.17+units:0.0*price:28357.9297=net_wealth:1137.1723
--------------------------------------------------
2023-05-01T00:00:00 | *** GOING LONG ***
2023-05-01T00:00:00's price 28523.8594, buy 0.03982754 units.
2023-05-01T00:00:00 | current balance = 0.00
2023-05-01T00:00:00 | balance:0.00+units:0.03982754*price:28523.8594=net_wealth:1136.0363
--------------------------------------------------
2023-05-03T12:00:00 | *** GOING SHORT ***
2023-05-03T12:00:00's price 29026.1602, sell 0.03982754 units.
2023-05-03T12:00:00 | current balance = 1154.89
2023-05-03T12:00:00 | balance:1154.89+units:0.0*price:29026.1602=net_wealth:1154.8857
--------------------------------------------------
2023-05-04T00:00:00 | *** GOING LONG ***
2023-05-04T00:00:00's price 29154.6602, buy 0.03957277 units.
2023-05-04T00:00:00 | current balance = 0.00
2023-05-04T00:00:00 | balance:0.00+units:0.03957277*price:29154.6602=net_wealth:1153.7319
--------------------------------------------------
2023-05-15T12:00:00 | *** GOING SHORT ***
2023-05-15T12:00:00's price 27162.1406, sell 0.03957277 units.
2023-05-15T12:00:00 | current balance = 1073.81
2023-05-15T12:00:00 | balance:1073.81+units:0.0*price:27162.1406=net_wealth:1073.8075
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1073.81
2023-06-08T12:00:00 | net performance [%] = 7.3808
2023-06-08T12:00:00 | number of trades [#] = 14
==================================================
Trial 19 Complete [00h 25m 30s]
net_wealth: 1073.8075378349881

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 02h 42m 51s

Search: Running Trial #20

Value             |Best Value So Far |Hyperparameter
2                 |8                 |horizon
365               |225               |lookback
False             |True              |MarketFactor
14                |14                |lags
0.98              |0.98              |gamma
32                |32                |memory_size
32                |16                |batch_size
64                |32                |n_steps
0.97              |0.98              |gae_lambda
0.2               |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4221.000000   4223.000000
mean      0.000429    19869.492402  ...   19927.514390  19920.121151
std       0.028054    16157.511856  ...   16192.223372  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7566.169922   7559.520020
50%       0.000696    11383.668066  ...   11461.429688  11460.440430
75%       0.011799    29453.128320  ...   29310.650391  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.8290 | profit rate:    2.4 | accuracy: 0.33
step_num: 400 | loss: 0.4444 | profit rate:    2.7 | accuracy: 0.32
step_num: 600 | loss: 1.0069 | profit rate:    3.6 | accuracy: 0.31
step_num: 800 | loss: 0.3755 | profit rate:    2.9 | accuracy: 0.30
step_num: 1000 | loss: 0.9957 | profit rate:    3.0 | accuracy: 0.32
step_num: 1200 | loss: 0.5788 | profit rate:    1.5 | accuracy: 0.33
step_num: 1400 | loss: 0.4409 | profit rate:    1.8 | accuracy: 0.35
step_num: 1600 | loss: 0.3592 | profit rate:    0.4 | accuracy: 0.34
step_num: 1800 | loss: 0.1280 | profit rate:    0.6 | accuracy: 0.33
step_num: 2000 | loss: 0.4637 | profit rate:    0.5 | accuracy: 0.31
step_num: 2200 | loss: 0.9003 | profit rate:    1.5 | accuracy: 0.33
step_num: 2400 | loss: 0.5496 | profit rate:    0.6 | accuracy: 0.33
step_num: 2600 | loss: 0.5208 | profit rate:    0.5 | accuracy: 0.34
step_num: 2800 | loss: 0.2878 | profit rate:    0.5 | accuracy: 0.34
step_num: 3000 | loss: 0.4501 | profit rate:    0.2 | accuracy: 0.34
step_num: 3200 | loss: 0.3796 | profit rate:    0.2 | accuracy: 0.33
step_num: 3400 | loss: 0.6598 | profit rate:    0.3 | accuracy: 0.34
episode:   1/8,耗时:0.41分/0.41分,训练集: | step: 3528 | average_treward:   87.5 | max_treward: 87.5291 | average profit rate:  0.610
model saved @ step:3528,performance:0.610,accuracy:0.34
step_num: 3600 | loss: 0.1524 | profit rate:    1.0 | accuracy: 0.14
step_num: 3800 | loss: 0.6172 | profit rate:    1.0 | accuracy: 0.35
step_num: 4000 | loss: 0.5829 | profit rate:    0.9 | accuracy: 0.37
step_num: 4200 | loss: 0.5568 | profit rate:    1.9 | accuracy: 0.38
step_num: 4400 | loss: 0.7582 | profit rate:    2.5 | accuracy: 0.39
step_num: 4600 | loss: 0.5194 | profit rate:    2.8 | accuracy: 0.41
step_num: 4800 | loss: 0.1377 | profit rate:    3.0 | accuracy: 0.39
step_num: 5000 | loss: 0.2999 | profit rate:    2.2 | accuracy: 0.39
step_num: 5200 | loss: 0.2207 | profit rate:    0.6 | accuracy: 0.38
step_num: 5400 | loss: 0.0561 | profit rate:    0.7 | accuracy: 0.35
step_num: 5600 | loss: 0.5734 | profit rate:    1.7 | accuracy: 0.35
step_num: 5800 | loss: 0.2636 | profit rate:    1.7 | accuracy: 0.34
step_num: 6000 | loss: 0.6312 | profit rate:    1.4 | accuracy: 0.33
step_num: 6200 | loss: 0.4220 | profit rate:    1.2 | accuracy: 0.34
step_num: 6400 | loss: 0.6717 | profit rate:    0.9 | accuracy: 0.32
step_num: 6600 | loss: 0.3732 | profit rate:    0.7 | accuracy: 0.33
step_num: 6800 | loss: 0.4647 | profit rate:    1.6 | accuracy: 0.34
step_num: 7000 | loss: 0.6242 | profit rate:    2.9 | accuracy: 0.35
model saved @ step:7056,performance:3.273,accuracy:0.35
step_num: 7200 | loss: 0.6202 | profit rate:    0.9 | accuracy: 0.33
step_num: 7400 | loss: 0.3637 | profit rate:    1.1 | accuracy: 0.39
step_num: 7600 | loss: 0.1084 | profit rate:    1.8 | accuracy: 0.40
step_num: 7800 | loss: 0.4071 | profit rate:    2.6 | accuracy: 0.42
step_num: 8000 | loss: 0.1101 | profit rate:    4.1 | accuracy: 0.41
step_num: 8200 | loss: 0.3817 | profit rate:    3.5 | accuracy: 0.38
step_num: 8400 | loss: 0.4603 | profit rate:    6.1 | accuracy: 0.39
step_num: 8600 | loss: 0.5810 | profit rate:    1.4 | accuracy: 0.39
step_num: 8800 | loss: 0.1574 | profit rate:    0.8 | accuracy: 0.37
step_num: 9000 | loss: 0.4345 | profit rate:    1.3 | accuracy: 0.35
step_num: 9200 | loss: 0.0475 | profit rate:    2.8 | accuracy: 0.33
step_num: 9400 | loss: 0.5294 | profit rate:    1.8 | accuracy: 0.34
step_num: 9600 | loss: 0.5619 | profit rate:    1.4 | accuracy: 0.35
step_num: 9800 | loss: 0.2724 | profit rate:    1.2 | accuracy: 0.35
step_num: 10000 | loss: 0.8679 | profit rate:    1.3 | accuracy: 0.35
step_num: 10200 | loss: 0.5965 | profit rate:    3.7 | accuracy: 0.36
step_num: 10400 | loss: 0.6109 | profit rate:    5.0 | accuracy: 0.37
episode:   3/8,耗时:0.44分/1.30分,训练集: | step: 10584 | average_treward:  105.4 | max_treward: 126.8758 | average profit rate:  4.229
model saved @ step:10584,performance:8.804,accuracy:0.38
step_num: 10600 | loss: 0.1943 | profit rate:    0.9 | accuracy: 0.00
step_num: 10800 | loss: 0.5485 | profit rate:    1.5 | accuracy: 0.37
step_num: 11000 | loss: 0.4851 | profit rate:    1.4 | accuracy: 0.40
step_num: 11200 | loss: 0.7266 | profit rate:    3.2 | accuracy: 0.41
step_num: 11400 | loss: 0.5866 | profit rate:    2.6 | accuracy: 0.42
step_num: 11600 | loss: 0.3793 | profit rate:    9.2 | accuracy: 0.42
step_num: 11800 | loss: 0.3869 | profit rate:   10.5 | accuracy: 0.42
step_num: 12000 | loss: 0.4629 | profit rate:   10.9 | accuracy: 0.42
step_num: 12200 | loss: 0.7342 | profit rate:    1.4 | accuracy: 0.42
step_num: 12400 | loss: 0.5489 | profit rate:    1.7 | accuracy: 0.43
step_num: 12600 | loss: 0.4466 | profit rate:    3.5 | accuracy: 0.45
step_num: 12800 | loss: 0.6576 | profit rate:   27.0 | accuracy: 0.46
step_num: 13000 | loss: 0.6223 | profit rate:   12.7 | accuracy: 0.46
step_num: 13200 | loss: 0.6715 | profit rate:    8.0 | accuracy: 0.46
step_num: 13400 | loss: 0.5090 | profit rate:    4.5 | accuracy: 0.46
step_num: 13600 | loss: 0.2501 | profit rate:    4.6 | accuracy: 0.45
step_num: 13800 | loss: 0.4515 | profit rate:    9.2 | accuracy: 0.45
step_num: 14000 | loss: 0.6000 | profit rate:   15.4 | accuracy: 0.46
model saved @ step:14112,performance:22.987,accuracy:0.46
step_num: 14200 | loss: 0.3989 | profit rate:    0.4 | accuracy: 0.16
step_num: 14400 | loss: 0.6392 | profit rate:    0.3 | accuracy: 0.30
step_num: 14600 | loss: 0.2737 | profit rate:    0.4 | accuracy: 0.33
step_num: 14800 | loss: 0.7103 | profit rate:    0.9 | accuracy: 0.36
step_num: 15000 | loss: 0.7538 | profit rate:    1.0 | accuracy: 0.38
step_num: 15200 | loss: 0.5405 | profit rate:    1.3 | accuracy: 0.41
step_num: 15400 | loss: 0.3637 | profit rate:    0.9 | accuracy: 0.39
step_num: 15600 | loss: 0.4525 | profit rate:    0.3 | accuracy: 0.39
step_num: 15800 | loss: 0.7628 | profit rate:    0.1 | accuracy: 0.40
step_num: 16000 | loss: 0.6680 | profit rate:    0.1 | accuracy: 0.42
step_num: 16200 | loss: 1.3595 | profit rate:    1.2 | accuracy: 0.44
step_num: 16400 | loss: 0.6572 | profit rate:    2.1 | accuracy: 0.44
step_num: 16600 | loss: 0.5706 | profit rate:    1.0 | accuracy: 0.43
step_num: 16800 | loss: 0.8242 | profit rate:    1.5 | accuracy: 0.43
step_num: 17000 | loss: 0.4550 | profit rate:    0.5 | accuracy: 0.43
step_num: 17200 | loss: 0.2831 | profit rate:    0.8 | accuracy: 0.42
step_num: 17400 | loss: 0.2762 | profit rate:    1.7 | accuracy: 0.42
step_num: 17600 | loss: 0.4986 | profit rate:    2.3 | accuracy: 0.42
episode:   5/8,耗时:0.44分/2.20分,训练集: | step: 17640 | average_treward:  135.8 | max_treward: 197.6746 | average profit rate:  7.654
step_num: 17800 | loss: 0.1659 | profit rate:    0.5 | accuracy: 0.20
step_num: 18000 | loss: 0.4286 | profit rate:    0.3 | accuracy: 0.27
step_num: 18200 | loss: 0.4564 | profit rate:    0.8 | accuracy: 0.29
step_num: 18400 | loss: 0.5977 | profit rate:    0.8 | accuracy: 0.33
step_num: 18600 | loss: 1.1155 | profit rate:    2.9 | accuracy: 0.38
step_num: 18800 | loss: 0.3214 | profit rate:    1.1 | accuracy: 0.38
step_num: 19000 | loss: 0.5390 | profit rate:    0.9 | accuracy: 0.37
step_num: 19200 | loss: 0.2342 | profit rate:    0.5 | accuracy: 0.36
step_num: 19400 | loss: 0.4721 | profit rate:    0.5 | accuracy: 0.38
step_num: 19600 | loss: 0.5892 | profit rate:    0.8 | accuracy: 0.39
step_num: 19800 | loss: 1.3830 | profit rate:    6.3 | accuracy: 0.41
step_num: 20000 | loss: 0.4109 | profit rate:    3.3 | accuracy: 0.42
step_num: 20200 | loss: 0.6095 | profit rate:    3.6 | accuracy: 0.40
step_num: 20400 | loss: 0.3450 | profit rate:    2.6 | accuracy: 0.40
step_num: 20600 | loss: 0.2833 | profit rate:    2.0 | accuracy: 0.39
step_num: 20800 | loss: 0.1949 | profit rate:    2.3 | accuracy: 0.37
step_num: 21000 | loss: 0.5351 | profit rate:    3.5 | accuracy: 0.37
step_num: 21200 | loss: 0.3540 | profit rate:    0.7 | accuracy: 0.09
step_num: 21400 | loss: 0.2087 | profit rate:    1.0 | accuracy: 0.16
step_num: 21600 | loss: 0.2418 | profit rate:    0.5 | accuracy: 0.21
step_num: 21800 | loss: 0.4120 | profit rate:    0.8 | accuracy: 0.23
step_num: 22000 | loss: 0.6302 | profit rate:    0.9 | accuracy: 0.25
step_num: 22200 | loss: 0.4126 | profit rate:    2.7 | accuracy: 0.31
step_num: 22400 | loss: 0.3792 | profit rate:    1.3 | accuracy: 0.30
step_num: 22600 | loss: 0.5311 | profit rate:    1.4 | accuracy: 0.29
step_num: 22800 | loss: 0.5963 | profit rate:    1.1 | accuracy: 0.30
step_num: 23000 | loss: 0.6091 | profit rate:    1.1 | accuracy: 0.32
step_num: 23200 | loss: 0.4948 | profit rate:    3.0 | accuracy: 0.35
step_num: 23400 | loss: 0.7202 | profit rate:   18.2 | accuracy: 0.37
step_num: 23600 | loss: 0.0179 | profit rate:   11.9 | accuracy: 0.36
step_num: 23800 | loss: 0.6145 | profit rate:   12.3 | accuracy: 0.35
step_num: 24000 | loss: 0.0887 | profit rate:    7.7 | accuracy: 0.35
step_num: 24200 | loss: 0.0104 | profit rate:    8.2 | accuracy: 0.34
step_num: 24400 | loss: 0.3889 | profit rate:   15.1 | accuracy: 0.34
step_num: 24600 | loss: 0.2832 | profit rate:   24.5 | accuracy: 0.34
episode:   7/8,耗时:0.44分/3.08分,训练集: | step: 24696 | average_treward:  158.4 | max_treward: 241.4730 | average profit rate:  9.951
model saved @ step:24696,performance:26.966,accuracy:0.34
step_num: 24800 | loss: 0.5056 | profit rate:    0.4 | accuracy: 0.10
step_num: 25000 | loss: 0.5011 | profit rate:    0.4 | accuracy: 0.19
step_num: 25200 | loss: 0.0253 | profit rate:    0.5 | accuracy: 0.22
step_num: 25400 | loss: 0.9309 | profit rate:    0.6 | accuracy: 0.26
step_num: 25600 | loss: 1.4763 | profit rate:    1.4 | accuracy: 0.30
step_num: 25800 | loss: 0.4982 | profit rate:    1.7 | accuracy: 0.35
step_num: 26000 | loss: 0.2318 | profit rate:    1.0 | accuracy: 0.31
step_num: 26200 | loss: 0.2527 | profit rate:    0.6 | accuracy: 0.31
step_num: 26400 | loss: 0.6238 | profit rate:    0.4 | accuracy: 0.32
step_num: 26600 | loss: 0.6180 | profit rate:    0.5 | accuracy: 0.35
step_num: 26800 | loss: 1.1591 | profit rate:    3.8 | accuracy: 0.38
step_num: 27000 | loss: 0.7132 | profit rate:    7.4 | accuracy: 0.39
step_num: 27200 | loss: 0.1125 | profit rate:    6.2 | accuracy: 0.37
step_num: 27400 | loss: 0.5969 | profit rate:    7.5 | accuracy: 0.37
step_num: 27600 | loss: 0.3169 | profit rate:    3.7 | accuracy: 0.36
step_num: 27800 | loss: 0.4589 | profit rate:    5.1 | accuracy: 0.36
step_num: 28000 | loss: 0.1082 | profit rate:    8.3 | accuracy: 0.35
step_num: 28200 | loss: 0.4286 | profit rate:   13.7 | accuracy: 0.35
model saved @ step:28224,performance:14.204,accuracy:0.35
----------------------------------------finished----------------------------------------
  0%|          | 0/305 [00:00<?, ?it/s] 33%|      | 100/305 [00:00<00:00, 997.90it/s] 70%|   | 212/305 [00:00<00:00, 1066.39it/s]100%|| 305/305 [00:00<00:00, 1086.24it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-17T00:00:00 | *** GOING LONG ***
2023-01-17T00:00:00's price 21219.7500, buy 0.04707878 units.
2023-01-17T00:00:00 | current balance = 0.00
2023-01-17T00:00:00 | balance:0.00+units:0.04707878*price:21219.7500=net_wealth:999.0010
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.04707878 units.
2023-06-08T12:00:00 | current balance = 1251.03
2023-06-08T12:00:00 | net performance [%] = 25.1034
2023-06-08T12:00:00 | number of trades [#] = 2
==================================================
Trial 20 Complete [00h 03m 34s]
net_wealth: 1252.286675472939

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 02h 46m 26s

Search: Running Trial #21

Value             |Best Value So Far |Hyperparameter
6                 |8                 |horizon
730               |225               |lookback
True              |True              |MarketFactor
30                |14                |lags
0.6               |0.98              |gamma
64                |32                |memory_size
16                |16                |batch_size
10                |32                |n_steps
0.96              |0.98              |gae_lambda
0.5               |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4203.000000   4209.000000
mean      0.000424    19921.326125  ...   19993.666186  19971.309209
std       0.028069    16159.303521  ...   16195.203792  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7637.519775   7625.000000
50%       0.000696    11410.370947  ...   11491.000000  11477.000000
75%       0.011720    29502.909082  ...   29370.559570  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 200 | loss: 0.7662 | profit rate:    0.4 | accuracy: 0.24
step_num: 400 | loss: 0.3544 | profit rate:    0.2 | accuracy: 0.28
step_num: 600 | loss: 0.6688 | profit rate:    0.1 | accuracy: 0.30
step_num: 800 | loss: 0.5356 | profit rate:    0.1 | accuracy: 0.29
step_num: 1000 | loss: 0.4796 | profit rate:    0.2 | accuracy: 0.31
step_num: 1200 | loss: 0.6579 | profit rate:    1.2 | accuracy: 0.34
step_num: 1400 | loss: 0.6005 | profit rate:    2.3 | accuracy: 0.34
step_num: 1600 | loss: 0.5135 | profit rate:   31.2 | accuracy: 0.35
step_num: 1800 | loss: 0.2824 | profit rate:  797.9 | accuracy: 0.36
step_num: 2000 | loss: 0.4399 | profit rate:  700.0 | accuracy: 0.35
step_num: 2200 | loss: 0.4187 | profit rate:  836.9 | accuracy: 0.34
step_num: 2400 | loss: 0.4654 | profit rate:  888.9 | accuracy: 0.34
step_num: 2600 | loss: 0.3431 | profit rate:  540.0 | accuracy: 0.34
step_num: 2800 | loss: 0.4206 | profit rate:   26.1 | accuracy: 0.34
step_num: 3000 | loss: 0.2618 | profit rate:   46.3 | accuracy: 0.34
episode:   1/8,耗时:0.45分/0.45分,训练集: | step: 3133 | average_treward:   97.8 | max_treward: 97.7895 | average profit rate: 52.348
model saved @ step:3133,performance:52.348,accuracy:0.33
step_num: 3200 | loss: 0.0198 | profit rate:    1.0 | accuracy: 0.01
step_num: 3400 | loss: 0.0834 | profit rate:    2.3 | accuracy: 0.16
step_num: 3600 | loss: 0.2042 | profit rate:    2.1 | accuracy: 0.12
step_num: 3800 | loss: 0.6663 | profit rate:    1.6 | accuracy: 0.20
step_num: 4000 | loss: 0.2414 | profit rate:    1.6 | accuracy: 0.16
step_num: 4200 | loss: 0.0500 | profit rate:    2.2 | accuracy: 0.15
step_num: 4400 | loss: 0.2342 | profit rate:    5.3 | accuracy: 0.16
step_num: 4600 | loss: 0.4190 | profit rate:    6.5 | accuracy: 0.16
step_num: 4800 | loss: 0.0344 | profit rate:    1.8 | accuracy: 0.16
step_num: 5000 | loss: 0.0749 | profit rate:    1.2 | accuracy: 0.14
step_num: 5200 | loss: 0.0440 | profit rate:    0.7 | accuracy: 0.14
step_num: 5400 | loss: 0.0049 | profit rate:    0.7 | accuracy: 0.12
step_num: 5600 | loss: 0.0078 | profit rate:    0.7 | accuracy: 0.12
step_num: 5800 | loss: 0.0867 | profit rate:    0.7 | accuracy: 0.11
step_num: 6000 | loss: 0.0262 | profit rate:    1.1 | accuracy: 0.11
step_num: 6200 | loss: 0.0331 | profit rate:    0.9 | accuracy: 0.11
step_num: 6400 | loss: 0.0966 | profit rate:    0.7 | accuracy: 0.01
step_num: 6600 | loss: 0.0678 | profit rate:    0.7 | accuracy: 0.08
step_num: 6800 | loss: 0.2638 | profit rate:    1.8 | accuracy: 0.13
step_num: 7000 | loss: 0.1560 | profit rate:    4.6 | accuracy: 0.16
step_num: 7200 | loss: 0.0519 | profit rate:    3.9 | accuracy: 0.14
step_num: 7400 | loss: 0.1485 | profit rate:   30.6 | accuracy: 0.14
step_num: 7600 | loss: 0.0053 | profit rate:   24.1 | accuracy: 0.13
step_num: 7800 | loss: 0.0874 | profit rate:   25.1 | accuracy: 0.12
step_num: 8000 | loss: 1.2543 | profit rate:  429.9 | accuracy: 0.16
step_num: 8200 | loss: 0.5740 | profit rate:  914.8 | accuracy: 0.17
step_num: 8400 | loss: 0.0476 | profit rate: 1157.4 | accuracy: 0.16
step_num: 8600 | loss: 0.4928 | profit rate: 3777.3 | accuracy: 0.17
step_num: 8800 | loss: 0.2263 | profit rate: 2015.9 | accuracy: 0.17
step_num: 9000 | loss: 0.3867 | profit rate: 1228.4 | accuracy: 0.18
step_num: 9200 | loss: 0.1846 | profit rate: 2510.5 | accuracy: 0.18
episode:   3/8,耗时:0.51分/1.44分,训练集: | step: 9399 | average_treward:  123.1 | max_treward: 227.1139 | average profit rate: 1034.309
model saved @ step:9399,performance:3049.672,accuracy:0.18
step_num: 9400 | loss: 0.0141 | profit rate:    1.0 | accuracy: 0.00
step_num: 9600 | loss: 0.2590 | profit rate:    1.0 | accuracy: 0.10
step_num: 9800 | loss: 0.1445 | profit rate:    1.0 | accuracy: 0.09
step_num: 10000 | loss: 0.3951 | profit rate:    4.9 | accuracy: 0.11
step_num: 10200 | loss: 0.1870 | profit rate:    7.4 | accuracy: 0.13
step_num: 10400 | loss: 0.0932 | profit rate:    5.4 | accuracy: 0.12
step_num: 10600 | loss: 0.0616 | profit rate:   16.7 | accuracy: 0.12
step_num: 10800 | loss: 0.0314 | profit rate:   13.2 | accuracy: 0.11
step_num: 11000 | loss: 0.0590 | profit rate:   13.0 | accuracy: 0.10
step_num: 11200 | loss: 0.0511 | profit rate:   14.5 | accuracy: 0.10
step_num: 11400 | loss: 0.1788 | profit rate:   56.6 | accuracy: 0.10
step_num: 11600 | loss: 0.0346 | profit rate:   98.9 | accuracy: 0.10
step_num: 11800 | loss: 0.3009 | profit rate:  202.6 | accuracy: 0.11
step_num: 12000 | loss: 0.0290 | profit rate:   67.2 | accuracy: 0.11
step_num: 12200 | loss: 0.6023 | profit rate:  103.5 | accuracy: 0.11
step_num: 12400 | loss: 0.0865 | profit rate:  127.0 | accuracy: 0.11
step_num: 12600 | loss: 0.0099 | profit rate:    1.0 | accuracy: 0.00
step_num: 12800 | loss: 0.0428 | profit rate:    1.1 | accuracy: 0.05
step_num: 13000 | loss: 0.2099 | profit rate:    1.5 | accuracy: 0.10
step_num: 13200 | loss: 0.2162 | profit rate:    3.1 | accuracy: 0.16
step_num: 13400 | loss: 0.0616 | profit rate:    2.7 | accuracy: 0.13
step_num: 13600 | loss: 0.0129 | profit rate:    2.8 | accuracy: 0.11
step_num: 13800 | loss: 0.0145 | profit rate:   40.0 | accuracy: 0.14
step_num: 14000 | loss: 0.4532 | profit rate:   41.1 | accuracy: 0.13
step_num: 14200 | loss: 0.0224 | profit rate:   43.2 | accuracy: 0.12
step_num: 14400 | loss: 0.0126 | profit rate:   57.9 | accuracy: 0.11
step_num: 14600 | loss: 0.0354 | profit rate:  184.9 | accuracy: 0.11
step_num: 14800 | loss: 0.2335 | profit rate: 1023.7 | accuracy: 0.12
step_num: 15000 | loss: 0.0227 | profit rate: 1300.3 | accuracy: 0.12
step_num: 15200 | loss: 0.0064 | profit rate: 1247.6 | accuracy: 0.13
step_num: 15400 | loss: 0.0808 | profit rate: 2765.5 | accuracy: 0.14
step_num: 15600 | loss: 0.2019 | profit rate: 3983.1 | accuracy: 0.14
episode:   5/8,耗时:0.49分/2.41分,训练集: | step: 15665 | average_treward:  151.5 | max_treward: 254.4491 | average profit rate: 1445.305
model saved @ step:15665,performance:3983.147,accuracy:0.13
step_num: 15800 | loss: 0.0131 | profit rate:    0.9 | accuracy: 0.01
step_num: 16000 | loss: 0.0220 | profit rate:    0.8 | accuracy: 0.06
step_num: 16200 | loss: 0.5123 | profit rate:    3.2 | accuracy: 0.18
step_num: 16400 | loss: 0.1341 | profit rate:   10.0 | accuracy: 0.21
step_num: 16600 | loss: 0.0325 | profit rate:   11.4 | accuracy: 0.19
step_num: 16800 | loss: 0.3589 | profit rate:   78.6 | accuracy: 0.21
step_num: 17000 | loss: 0.0847 | profit rate:  259.7 | accuracy: 0.21
step_num: 17200 | loss: 0.3263 | profit rate:  286.8 | accuracy: 0.22
step_num: 17400 | loss: 0.5290 | profit rate:   17.9 | accuracy: 0.21
step_num: 17600 | loss: 0.2077 | profit rate:    9.9 | accuracy: 0.19
step_num: 17800 | loss: 0.2447 | profit rate:  102.6 | accuracy: 0.19
step_num: 18000 | loss: 0.0055 | profit rate:  193.1 | accuracy: 0.18
step_num: 18200 | loss: 0.7105 | profit rate:  350.4 | accuracy: 0.19
step_num: 18400 | loss: 0.4433 | profit rate:  128.4 | accuracy: 0.19
step_num: 18600 | loss: 0.1876 | profit rate:  453.6 | accuracy: 0.19
step_num: 18800 | loss: 0.1608 | profit rate:    1.0 | accuracy: 0.00
step_num: 19000 | loss: 0.4136 | profit rate:    1.6 | accuracy: 0.18
step_num: 19200 | loss: 0.1432 | profit rate:    2.1 | accuracy: 0.14
step_num: 19400 | loss: 0.3815 | profit rate:   25.6 | accuracy: 0.24
step_num: 19600 | loss: 0.2349 | profit rate:   68.0 | accuracy: 0.23
step_num: 19800 | loss: 0.0606 | profit rate:   60.7 | accuracy: 0.21
step_num: 20000 | loss: 0.1697 | profit rate:  368.9 | accuracy: 0.20
step_num: 20200 | loss: 0.2975 | profit rate:  607.5 | accuracy: 0.19
step_num: 20400 | loss: 0.2790 | profit rate:  402.1 | accuracy: 0.19
step_num: 20600 | loss: 0.0204 | profit rate:  227.9 | accuracy: 0.18
step_num: 20800 | loss: 0.3309 | profit rate:  397.7 | accuracy: 0.17
step_num: 21000 | loss: 0.1915 | profit rate: 4005.8 | accuracy: 0.17
step_num: 21200 | loss: 0.1879 | profit rate: 15817.2 | accuracy: 0.18
step_num: 21400 | loss: 0.1064 | profit rate: 4114.7 | accuracy: 0.18
step_num: 21600 | loss: 0.4009 | profit rate: 9264.5 | accuracy: 0.18
step_num: 21800 | loss: 0.0967 | profit rate: 25052.4 | accuracy: 0.18
episode:   7/8,耗时:0.48分/3.38分,训练集: | step: 21931 | average_treward:  182.6 | max_treward: 281.9680 | average profit rate: 6843.585
model saved @ step:21931,performance:39878.567,accuracy:0.18
step_num: 22000 | loss: 0.2320 | profit rate:    1.4 | accuracy: 0.27
step_num: 22200 | loss: 0.0646 | profit rate:    2.1 | accuracy: 0.21
step_num: 22400 | loss: 0.1759 | profit rate:    3.5 | accuracy: 0.22
step_num: 22600 | loss: 0.3199 | profit rate:    3.4 | accuracy: 0.26
step_num: 22800 | loss: 0.3446 | profit rate:   17.0 | accuracy: 0.27
step_num: 23000 | loss: 0.1862 | profit rate:    9.1 | accuracy: 0.24
step_num: 23200 | loss: 0.0836 | profit rate:  177.6 | accuracy: 0.24
step_num: 23400 | loss: 0.3668 | profit rate:  418.6 | accuracy: 0.24
step_num: 23600 | loss: 0.1740 | profit rate:  166.6 | accuracy: 0.23
step_num: 23800 | loss: 0.0357 | profit rate:   29.4 | accuracy: 0.21
step_num: 24000 | loss: 0.0970 | profit rate:  407.8 | accuracy: 0.21
step_num: 24200 | loss: 0.0844 | profit rate: 3940.5 | accuracy: 0.21
step_num: 24400 | loss: 0.0778 | profit rate: 3064.3 | accuracy: 0.20
step_num: 24600 | loss: 0.0355 | profit rate: 2324.1 | accuracy: 0.20
step_num: 24800 | loss: 0.1750 | profit rate: 13770.3 | accuracy: 0.21
step_num: 25000 | loss: 0.0169 | profit rate: 25317.2 | accuracy: 0.21
model saved @ step:25064,performance:31715.970,accuracy:0.21
----------------------------------------finished----------------------------------------
  0%|          | 0/289 [00:00<?, ?it/s] 37%|      | 106/289 [00:00<00:00, 1056.12it/s] 78%|  | 224/289 [00:00<00:00, 1128.87it/s]100%|| 289/289 [00:00<00:00, 1121.50it/s]
==================================================
2023-01-15T12:00:00 | *** START BACKTEST ***
2023-01-15T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-27T00:00:00 | *** GOING LONG ***
2023-01-27T00:00:00's price 22967.4707, buy 0.0434963 units.
2023-01-27T00:00:00 | current balance = 0.00
2023-01-27T00:00:00 | balance:0.00+units:0.0434963*price:22967.4707=net_wealth:999.0010
--------------------------------------------------
2023-02-03T00:00:00 | *** GOING SHORT ***
2023-02-03T00:00:00's price 23534.1309, sell 0.0434963 units.
2023-02-03T00:00:00 | current balance = 1022.62
2023-02-03T00:00:00 | balance:1022.62+units:0.0*price:23534.1309=net_wealth:1022.6250
--------------------------------------------------
2023-02-26T00:00:00 | *** GOING LONG ***
2023-02-26T00:00:00's price 23253.4395, buy 0.04393338 units.
2023-02-26T00:00:00 | current balance = 0.00
2023-02-26T00:00:00 | balance:0.00+units:0.04393338*price:23253.4395=net_wealth:1021.6034
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING SHORT ***
2023-03-13T12:00:00's price 24113.4805, sell 0.04393338 units.
2023-03-13T12:00:00 | current balance = 1058.33
2023-03-13T12:00:00 | balance:1058.33+units:0.0*price:24113.4805=net_wealth:1058.3285
--------------------------------------------------
2023-03-23T00:00:00 | *** GOING LONG ***
2023-03-23T00:00:00's price 27584.5293, buy 0.03832837 units.
2023-03-23T00:00:00 | current balance = 0.00
2023-03-23T00:00:00 | balance:0.00+units:0.03832837*price:27584.5293=net_wealth:1057.2712
--------------------------------------------------
2023-04-01T12:00:00 | *** GOING SHORT ***
2023-04-01T12:00:00's price 28452.7305, sell 0.03832837 units.
2023-04-01T12:00:00 | current balance = 1089.46
2023-04-01T12:00:00 | balance:1089.46+units:0.0*price:28452.7305=net_wealth:1089.4574
--------------------------------------------------
2023-04-04T12:00:00 | *** GOING LONG ***
2023-04-04T12:00:00's price 28165.4707, buy 0.03864192 units.
2023-04-04T12:00:00 | current balance = 0.00
2023-04-04T12:00:00 | balance:0.00+units:0.03864192*price:28165.4707=net_wealth:1088.3690
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03864192 units.
2023-06-08T12:00:00 | current balance = 1026.84
2023-06-08T12:00:00 | net performance [%] = 2.6840
2023-06-08T12:00:00 | number of trades [#] = 8
==================================================
Trial 21 Complete [00h 03m 55s]
net_wealth: 1027.8680987607395

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 02h 50m 21s

Search: Running Trial #22

Value             |Best Value So Far |Hyperparameter
4                 |8                 |horizon
225               |225               |lookback
False             |True              |MarketFactor
20                |14                |lags
0.7               |0.98              |gamma
2000              |32                |memory_size
32                |16                |batch_size
5                 |32                |n_steps
0.98              |0.98              |gae_lambda
10                |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4219.000000   4223.000000
mean      0.000429    19869.492402  ...   19934.900107  19920.121151
std       0.028054    16157.511856  ...   16192.506388  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7576.504883   7559.520020
50%       0.000696    11383.668066  ...   11464.480469  11460.440430
75%       0.011799    29453.128320  ...   29311.174805  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9069 | profit rate:    0.5 | accuracy: 0.32
step_num: 1200 | loss: 0.4182 | profit rate:    0.7 | accuracy: 0.33
step_num: 1400 | loss: 0.4186 | profit rate:    1.1 | accuracy: 0.33
step_num: 1600 | loss: 0.3969 | profit rate:    0.7 | accuracy: 0.33
step_num: 1800 | loss: 0.4192 | profit rate:    2.3 | accuracy: 0.34
step_num: 2000 | loss: 0.3968 | profit rate:    3.3 | accuracy: 0.34
step_num: 2200 | loss: 0.3787 | profit rate:   10.7 | accuracy: 0.35
step_num: 2400 | loss: 0.3645 | profit rate:   67.2 | accuracy: 0.35
step_num: 2600 | loss: 0.3679 | profit rate:  124.7 | accuracy: 0.35
step_num: 2800 | loss: 0.3674 | profit rate:  128.7 | accuracy: 0.35
step_num: 3000 | loss: 0.3328 | profit rate:  157.4 | accuracy: 0.34
step_num: 3200 | loss: 0.3493 | profit rate:  191.4 | accuracy: 0.34
step_num: 3400 | loss: 0.3530 | profit rate:  889.9 | accuracy: 0.34
step_num: 3600 | loss: 0.3171 | profit rate:  393.0 | accuracy: 0.33
episode:   1/8,耗时:1.54分/1.54分,训练集: | step: 3662 | average_treward:  102.1 | max_treward: 102.1364 | average profit rate: 414.583
model saved @ step:3662,performance:414.583,accuracy:0.33
step_num: 3800 | loss: 0.3527 | profit rate:    0.1 | accuracy: 0.24
step_num: 4000 | loss: 0.3330 | profit rate:    0.4 | accuracy: 0.27
step_num: 4200 | loss: 0.3041 | profit rate:    1.7 | accuracy: 0.29
step_num: 4400 | loss: 0.3041 | profit rate:   16.0 | accuracy: 0.32
step_num: 4600 | loss: 0.2959 | profit rate:   17.6 | accuracy: 0.32
step_num: 4800 | loss: 0.2788 | profit rate:  171.4 | accuracy: 0.32
step_num: 5000 | loss: 0.2459 | profit rate:   88.7 | accuracy: 0.31
step_num: 5200 | loss: 0.2444 | profit rate:  299.6 | accuracy: 0.32
step_num: 5400 | loss: 0.2352 | profit rate:  131.7 | accuracy: 0.31
step_num: 5600 | loss: 0.2725 | profit rate:  197.6 | accuracy: 0.31
step_num: 5800 | loss: 0.2326 | profit rate:  408.6 | accuracy: 0.31
step_num: 6000 | loss: 0.2382 | profit rate: 4038.7 | accuracy: 0.31
step_num: 6200 | loss: 0.2282 | profit rate: 6318.7 | accuracy: 0.30
step_num: 6400 | loss: 0.2198 | profit rate: 7276.0 | accuracy: 0.30
step_num: 6600 | loss: 0.2039 | profit rate: 22040.1 | accuracy: 0.30
step_num: 6800 | loss: 0.2022 | profit rate: 83581.6 | accuracy: 0.29
step_num: 7000 | loss: 0.2086 | profit rate: 1088482.9 | accuracy: 0.30
step_num: 7200 | loss: 0.1938 | profit rate: 3226045.4 | accuracy: 0.30
model saved @ step:7324,performance:5940495.804,accuracy:0.30
step_num: 7400 | loss: 0.1926 | profit rate:    0.3 | accuracy: 0.19
step_num: 7600 | loss: 0.2000 | profit rate:    0.7 | accuracy: 0.22
step_num: 7800 | loss: 0.1870 | profit rate:    2.6 | accuracy: 0.26
step_num: 8000 | loss: 0.2157 | profit rate:   10.3 | accuracy: 0.29
step_num: 8200 | loss: 0.1696 | profit rate:   32.3 | accuracy: 0.29
step_num: 8400 | loss: 0.1801 | profit rate:  336.4 | accuracy: 0.31
step_num: 8600 | loss: 0.1699 | profit rate:  531.3 | accuracy: 0.29
step_num: 8800 | loss: 0.1823 | profit rate: 1424.2 | accuracy: 0.30
step_num: 9000 | loss: 0.1827 | profit rate: 3437.9 | accuracy: 0.30
step_num: 9200 | loss: 0.1733 | profit rate: 6181.3 | accuracy: 0.29
step_num: 9400 | loss: 0.1721 | profit rate: 21094.7 | accuracy: 0.30
step_num: 9600 | loss: 0.1752 | profit rate: 560961.0 | accuracy: 0.30
step_num: 9800 | loss: 0.1667 | profit rate: 963406.2 | accuracy: 0.29
step_num: 10000 | loss: 0.1744 | profit rate: 4487853.0 | accuracy: 0.30
step_num: 10200 | loss: 0.1751 | profit rate: 16346327.9 | accuracy: 0.30
step_num: 10400 | loss: 0.1786 | profit rate: 39626696.1 | accuracy: 0.29
step_num: 10600 | loss: 0.1792 | profit rate: 377446501.7 | accuracy: 0.30
step_num: 10800 | loss: 0.1713 | profit rate: 3532041900.4 | accuracy: 0.30
episode:   3/8,耗时:2.17分/5.89分,训练集: | step: 10986 | average_treward:  423.9 | max_treward: 680.4275 | average profit rate: 2373711953.901
model saved @ step:10986,performance:7115194951.317,accuracy:0.30
step_num: 11000 | loss: 0.1492 | profit rate:    1.0 | accuracy: 0.40
step_num: 11200 | loss: 0.1364 | profit rate:    5.8 | accuracy: 0.25
step_num: 11400 | loss: 0.1604 | profit rate:   19.2 | accuracy: 0.30
step_num: 11600 | loss: 0.1621 | profit rate:   85.9 | accuracy: 0.32
step_num: 11800 | loss: 0.1503 | profit rate:  374.2 | accuracy: 0.32
step_num: 12000 | loss: 0.1688 | profit rate: 2750.1 | accuracy: 0.33
step_num: 12200 | loss: 0.1835 | profit rate: 14012.5 | accuracy: 0.32
step_num: 12400 | loss: 0.1643 | profit rate: 67499.5 | accuracy: 0.32
step_num: 12600 | loss: 0.1570 | profit rate: 142360.3 | accuracy: 0.32
step_num: 12800 | loss: 0.1701 | profit rate: 1105395.4 | accuracy: 0.32
step_num: 13000 | loss: 0.1553 | profit rate: 1559439.9 | accuracy: 0.31
step_num: 13200 | loss: 0.1596 | profit rate: 52851897.5 | accuracy: 0.32
step_num: 13400 | loss: 0.1629 | profit rate: 715307672.9 | accuracy: 0.32
step_num: 13600 | loss: 0.1472 | profit rate: 3076988380.5 | accuracy: 0.32
step_num: 13800 | loss: 0.1427 | profit rate: 18177170117.2 | accuracy: 0.32
step_num: 14000 | loss: 0.1419 | profit rate: 37341083128.2 | accuracy: 0.31
step_num: 14200 | loss: 0.1531 | profit rate: 398793973436.7 | accuracy: 0.32
step_num: 14400 | loss: 0.1483 | profit rate: 5177999305360.0 | accuracy: 0.32
step_num: 14600 | loss: 0.1335 | profit rate: 10210045074554.3 | accuracy: 0.32
model saved @ step:14648,performance:12219114795527.787,accuracy:0.32
step_num: 14800 | loss: 0.1270 | profit rate:    3.4 | accuracy: 0.22
step_num: 15000 | loss: 0.1346 | profit rate:   17.2 | accuracy: 0.30
step_num: 15200 | loss: 0.1269 | profit rate:   71.5 | accuracy: 0.30
step_num: 15400 | loss: 0.1456 | profit rate:  602.6 | accuracy: 0.31
step_num: 15600 | loss: 0.1334 | profit rate: 2084.0 | accuracy: 0.31
step_num: 15800 | loss: 0.1343 | profit rate: 35946.8 | accuracy: 0.32
step_num: 16000 | loss: 0.1409 | profit rate: 116659.2 | accuracy: 0.31
step_num: 16200 | loss: 0.1519 | profit rate: 663795.8 | accuracy: 0.32
step_num: 16400 | loss: 0.1352 | profit rate: 2331507.9 | accuracy: 0.31
step_num: 16600 | loss: 0.1405 | profit rate: 4497720.4 | accuracy: 0.31
step_num: 16800 | loss: 0.1332 | profit rate: 38400524.8 | accuracy: 0.31
step_num: 17000 | loss: 0.1197 | profit rate: 4910373743.3 | accuracy: 0.31
step_num: 17200 | loss: 0.1292 | profit rate: 75846179520.9 | accuracy: 0.31
step_num: 17400 | loss: 0.1445 | profit rate: 614637629513.5 | accuracy: 0.32
step_num: 17600 | loss: 0.1253 | profit rate: 2938537859737.5 | accuracy: 0.31
step_num: 17800 | loss: 0.1484 | profit rate: 16450279243442.1 | accuracy: 0.31
step_num: 18000 | loss: 0.1438 | profit rate: 823846977774906.8 | accuracy: 0.33
step_num: 18200 | loss: 0.1260 | profit rate: 2540021195750446.0 | accuracy: 0.33
episode:   5/8,耗时:2.17分/10.23分,训练集: | step: 18310 | average_treward:  614.0 | max_treward: 956.8305 | average profit rate: 684861837235545.750
model saved @ step:18310,performance:3412082950246339.500,accuracy:0.33
step_num: 18400 | loss: 0.1483 | profit rate:    2.9 | accuracy: 0.32
step_num: 18600 | loss: 0.1478 | profit rate:   10.5 | accuracy: 0.31
step_num: 18800 | loss: 0.1506 | profit rate:   39.8 | accuracy: 0.32
step_num: 19000 | loss: 0.1759 | profit rate:  718.7 | accuracy: 0.35
step_num: 19200 | loss: 0.1461 | profit rate: 1088.7 | accuracy: 0.33
step_num: 19400 | loss: 0.1604 | profit rate: 37742.0 | accuracy: 0.36
step_num: 19600 | loss: 0.1585 | profit rate: 135274.3 | accuracy: 0.35
step_num: 19800 | loss: 0.1585 | profit rate: 857944.0 | accuracy: 0.36
step_num: 20000 | loss: 0.1654 | profit rate: 5295966.4 | accuracy: 0.36
step_num: 20200 | loss: 0.1528 | profit rate: 15850990.3 | accuracy: 0.34
step_num: 20400 | loss: 0.1395 | profit rate: 101245599.6 | accuracy: 0.35
step_num: 20600 | loss: 0.1365 | profit rate: 10997677608.8 | accuracy: 0.35
step_num: 20800 | loss: 0.1337 | profit rate: 55411881604.3 | accuracy: 0.34
step_num: 21000 | loss: 0.1568 | profit rate: 1112691919240.3 | accuracy: 0.35
step_num: 21200 | loss: 0.1391 | profit rate: 4292015856073.7 | accuracy: 0.35
step_num: 21400 | loss: 0.1473 | profit rate: 20759467847133.4 | accuracy: 0.34
step_num: 21600 | loss: 0.1559 | profit rate: 648525819251523.8 | accuracy: 0.35
step_num: 21800 | loss: 0.1492 | profit rate: 11708719595253938.0 | accuracy: 0.36
model saved @ step:21972,performance:21473425078476500.000,accuracy:0.36
step_num: 22000 | loss: 0.1599 | profit rate:    1.7 | accuracy: 0.45
step_num: 22200 | loss: 0.1579 | profit rate:   12.9 | accuracy: 0.31
step_num: 22400 | loss: 0.1776 | profit rate:   29.9 | accuracy: 0.36
step_num: 22600 | loss: 0.1700 | profit rate:  189.1 | accuracy: 0.38
step_num: 22800 | loss: 0.1735 | profit rate: 1000.9 | accuracy: 0.36
step_num: 23000 | loss: 0.1757 | profit rate: 26746.3 | accuracy: 0.39
step_num: 23200 | loss: 0.1698 | profit rate: 116355.0 | accuracy: 0.38
step_num: 23400 | loss: 0.1570 | profit rate: 951118.9 | accuracy: 0.38
step_num: 23600 | loss: 0.1551 | profit rate: 3075012.0 | accuracy: 0.38
step_num: 23800 | loss: 0.1492 | profit rate: 25773101.4 | accuracy: 0.38
step_num: 24000 | loss: 0.1318 | profit rate: 39976455.3 | accuracy: 0.36
step_num: 24200 | loss: 0.1504 | profit rate: 9148195164.0 | accuracy: 0.37
step_num: 24400 | loss: 0.1554 | profit rate: 71291138380.4 | accuracy: 0.36
step_num: 24600 | loss: 0.1426 | profit rate: 1573629254456.1 | accuracy: 0.36
step_num: 24800 | loss: 0.1315 | profit rate: 23366979602488.7 | accuracy: 0.37
step_num: 25000 | loss: 0.1427 | profit rate: 160507574877950.4 | accuracy: 0.36
step_num: 25200 | loss: 0.1351 | profit rate: 3138007418732040.0 | accuracy: 0.37
step_num: 25400 | loss: 0.1428 | profit rate: 177213795531206112.0 | accuracy: 0.38
step_num: 25600 | loss: 0.1507 | profit rate: 402389173603659392.0 | accuracy: 0.38
episode:   7/8,耗时:2.16分/14.55分,训练集: | step: 25634 | average_treward:  739.3 | max_treward: 1085.7976 | average profit rate: 62396950987099736.000
model saved @ step:25634,performance:411880922645043968.000,accuracy:0.38
step_num: 25800 | loss: 0.1472 | profit rate:   21.9 | accuracy: 0.38
step_num: 26000 | loss: 0.1554 | profit rate:   83.7 | accuracy: 0.40
step_num: 26200 | loss: 0.1764 | profit rate:  467.7 | accuracy: 0.39
step_num: 26400 | loss: 0.1555 | profit rate: 6998.3 | accuracy: 0.39
step_num: 26600 | loss: 0.1676 | profit rate: 32428.6 | accuracy: 0.39
step_num: 26800 | loss: 0.1794 | profit rate: 951846.6 | accuracy: 0.40
step_num: 27000 | loss: 0.1428 | profit rate: 4551492.5 | accuracy: 0.39
step_num: 27200 | loss: 0.1548 | profit rate: 22039149.9 | accuracy: 0.40
step_num: 27400 | loss: 0.1438 | profit rate: 500159048.3 | accuracy: 0.40
step_num: 27600 | loss: 0.1419 | profit rate: 907826612.6 | accuracy: 0.39
step_num: 27800 | loss: 0.1500 | profit rate: 13217885690.5 | accuracy: 0.39
step_num: 28000 | loss: 0.1355 | profit rate: 1090551219741.6 | accuracy: 0.39
step_num: 28200 | loss: 0.1434 | profit rate: 28237425691888.6 | accuracy: 0.39
step_num: 28400 | loss: 0.1369 | profit rate: 546701602539121.8 | accuracy: 0.39
step_num: 28600 | loss: 0.1582 | profit rate: 3558167862449945.5 | accuracy: 0.39
step_num: 28800 | loss: 0.1551 | profit rate: 124640768583577888.0 | accuracy: 0.39
step_num: 29000 | loss: 0.1557 | profit rate: 18177967742787102720.0 | accuracy: 0.40
step_num: 29200 | loss: 0.1484 | profit rate: 65416254573930184704.0 | accuracy: 0.40
model saved @ step:29296,performance:78631964106341580800.000,accuracy:0.40
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 34%|      | 101/299 [00:00<00:00, 1002.73it/s] 75%|  | 225/299 [00:00<00:00, 1141.88it/s]==================================================
100%|| 299/299 [00:00<00:00, 1108.50it/s]
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-24T12:00:00 | *** GOING LONG ***
2023-01-24T12:00:00's price 22632.8906, buy 0.0441393 units.
2023-01-24T12:00:00 | current balance = 0.00
2023-01-24T12:00:00 | balance:0.00+units:0.0441393*price:22632.8906=net_wealth:999.0010
--------------------------------------------------
2023-02-02T12:00:00 | *** GOING SHORT ***
2023-02-02T12:00:00's price 23488.9395, sell 0.0441393 units.
2023-02-02T12:00:00 | current balance = 1035.75
2023-02-02T12:00:00 | balance:1035.75+units:0.0*price:23488.9395=net_wealth:1035.7496
--------------------------------------------------
2023-02-03T12:00:00 | *** GOING LONG ***
2023-02-03T12:00:00's price 23431.9004, buy 0.044158340000000004 units.
2023-02-03T12:00:00 | current balance = 0.00
2023-02-03T12:00:00 | balance:0.00+units:0.044158340000000004*price:23431.9004=net_wealth:1034.7149
--------------------------------------------------
2023-02-11T12:00:00 | *** GOING SHORT ***
2023-02-11T12:00:00's price 21862.5508, sell 0.044158340000000004 units.
2023-02-11T12:00:00 | current balance = 964.45
2023-02-11T12:00:00 | balance:964.45+units:0.0*price:21862.5508=net_wealth:964.4496
--------------------------------------------------
2023-02-12T00:00:00 | *** GOING LONG ***
2023-02-12T00:00:00's price 21888.3105, buy 0.04401825 units.
2023-02-12T00:00:00 | current balance = 0.00
2023-02-12T00:00:00 | balance:0.00+units:0.04401825*price:21888.3105=net_wealth:963.4861
--------------------------------------------------
2023-03-04T12:00:00 | *** GOING SHORT ***
2023-03-04T12:00:00's price 22346.5703, sell 0.04401825 units.
2023-03-04T12:00:00 | current balance = 982.67
2023-03-04T12:00:00 | balance:982.67+units:0.0*price:22346.5703=net_wealth:982.6743
--------------------------------------------------
2023-03-10T00:00:00 | *** GOING LONG ***
2023-03-10T00:00:00's price 19760.7793, buy 0.04967878 units.
2023-03-10T00:00:00 | current balance = 0.00
2023-03-10T00:00:00 | balance:0.00+units:0.04967878*price:19760.7793=net_wealth:981.6926
--------------------------------------------------
2023-03-12T00:00:00 | *** GOING SHORT ***
2023-03-12T00:00:00's price 20445.4297, sell 0.04967878 units.
2023-03-12T00:00:00 | current balance = 1014.69
2023-03-12T00:00:00 | balance:1014.69+units:0.0*price:20445.4297=net_wealth:1014.6895
--------------------------------------------------
2023-03-18T12:00:00 | *** GOING LONG ***
2023-03-18T12:00:00's price 26907.4902, buy 0.037672580000000004 units.
2023-03-18T12:00:00 | current balance = 0.00
2023-03-18T12:00:00 | balance:0.00+units:0.037672580000000004*price:26907.4902=net_wealth:1013.6758
--------------------------------------------------
2023-04-08T00:00:00 | *** GOING SHORT ***
2023-04-08T00:00:00's price 28016.0898, sell 0.037672580000000004 units.
2023-04-08T00:00:00 | current balance = 1054.38
2023-04-08T00:00:00 | balance:1054.38+units:0.0*price:28016.0898=net_wealth:1054.3842
--------------------------------------------------
2023-04-09T12:00:00 | *** GOING LONG ***
2023-04-09T12:00:00's price 28323.7598, buy 0.03718891 units.
2023-04-09T12:00:00 | current balance = 0.00
2023-04-09T12:00:00 | balance:0.00+units:0.03718891*price:28323.7598=net_wealth:1053.3308
--------------------------------------------------
2023-04-11T12:00:00 | *** GOING SHORT ***
2023-04-11T12:00:00's price 30200.4199, sell 0.03718891 units.
2023-04-11T12:00:00 | current balance = 1122.00
2023-04-11T12:00:00 | balance:1122.00+units:0.0*price:30200.4199=net_wealth:1121.9987
--------------------------------------------------
2023-04-19T00:00:00 | *** GOING LONG ***
2023-04-19T00:00:00's price 29310.6504, buy 0.03824127 units.
2023-04-19T00:00:00 | current balance = 0.00
2023-04-19T00:00:00 | balance:0.00+units:0.03824127*price:29310.6504=net_wealth:1120.8778
--------------------------------------------------
2023-04-23T12:00:00 | *** GOING SHORT ***
2023-04-23T12:00:00's price 27590.5996, sell 0.03824127 units.
2023-04-23T12:00:00 | current balance = 1054.05
2023-04-23T12:00:00 | balance:1054.05+units:0.0*price:27590.5996=net_wealth:1054.0457
--------------------------------------------------
2023-04-25T00:00:00 | *** GOING LONG ***
2023-04-25T00:00:00's price 27390.9609, buy 0.03844303 units.
2023-04-25T00:00:00 | current balance = 0.00
2023-04-25T00:00:00 | balance:0.00+units:0.03844303*price:27390.9609=net_wealth:1052.9928
--------------------------------------------------
2023-05-12T12:00:00 | *** GOING SHORT ***
2023-05-12T12:00:00's price 26795.0098, sell 0.03844303 units.
2023-05-12T12:00:00 | current balance = 1029.05
2023-05-12T12:00:00 | balance:1029.05+units:0.0*price:26795.0098=net_wealth:1029.0525
--------------------------------------------------
2023-05-13T12:00:00 | *** GOING LONG ***
2023-05-13T12:00:00's price 26775.2793, buy 0.03839449 units.
2023-05-13T12:00:00 | current balance = 0.00
2023-05-13T12:00:00 | balance:0.00+units:0.03839449*price:26775.2793=net_wealth:1028.0245
--------------------------------------------------
2023-05-16T00:00:00 | *** GOING SHORT ***
2023-05-16T00:00:00's price 27059.0293, sell 0.03839449 units.
2023-05-16T00:00:00 | current balance = 1037.88
2023-05-16T00:00:00 | balance:1037.88+units:0.0*price:27059.0293=net_wealth:1037.8800
--------------------------------------------------
2023-05-17T12:00:00 | *** GOING LONG ***
2023-05-17T12:00:00's price 27405.6094, buy 0.0378332 units.
2023-05-17T12:00:00 | current balance = 0.00
2023-05-17T12:00:00 | balance:0.00+units:0.0378332*price:27405.6094=net_wealth:1036.8432
--------------------------------------------------
2023-05-21T00:00:00 | *** GOING SHORT ***
2023-05-21T00:00:00's price 26829.9395, sell 0.0378332 units.
2023-05-21T00:00:00 | current balance = 1014.05
2023-05-21T00:00:00 | balance:1014.05+units:0.0*price:26829.9395=net_wealth:1014.0487
--------------------------------------------------
2023-05-23T12:00:00 | *** GOING LONG ***
2023-05-23T12:00:00's price 27219.6094, buy 0.03721708 units.
2023-05-23T12:00:00 | current balance = 0.00
2023-05-23T12:00:00 | balance:0.00+units:0.03721708*price:27219.6094=net_wealth:1013.0356
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.03721708 units.
2023-06-08T12:00:00 | current balance = 988.98
2023-06-08T12:00:00 | net performance [%] = -1.1022
2023-06-08T12:00:00 | number of trades [#] = 22
==================================================
Trial 22 Complete [00h 16m 48s]
net_wealth: 989.9677260984295

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 03h 07m 09s

Search: Running Trial #23

Value             |Best Value So Far |Hyperparameter
4                 |8                 |horizon
730               |225               |lookback
False             |True              |MarketFactor
7                 |14                |lags
0.9               |0.98              |gamma
32                |32                |memory_size
32                |16                |batch_size
10                |32                |n_steps
0.97              |0.98              |gae_lambda
2                 |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4219.000000   4223.000000
mean      0.000429    19869.492402  ...   19934.900107  19920.121151
std       0.028054    16157.511856  ...   16192.506388  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7576.504883   7559.520020
50%       0.000696    11383.668066  ...   11464.480469  11460.440430
75%       0.011799    29453.128320  ...   29311.174805  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.8560 | profit rate:    0.9 | accuracy: 0.27
step_num: 400 | loss: 0.7421 | profit rate:    1.2 | accuracy: 0.34
step_num: 600 | loss: 0.3808 | profit rate:    1.6 | accuracy: 0.34
step_num: 800 | loss: 0.5249 | profit rate:    2.4 | accuracy: 0.33
step_num: 1000 | loss: 0.6548 | profit rate:    1.5 | accuracy: 0.33
step_num: 1200 | loss: 0.6097 | profit rate:    2.8 | accuracy: 0.34
step_num: 1400 | loss: 0.3101 | profit rate:    5.0 | accuracy: 0.34
step_num: 1600 | loss: 0.2412 | profit rate:    4.8 | accuracy: 0.32
step_num: 1800 | loss: 0.5994 | profit rate:    9.6 | accuracy: 0.30
step_num: 2000 | loss: 0.9710 | profit rate:    6.8 | accuracy: 0.31
step_num: 2200 | loss: 0.2307 | profit rate:    1.5 | accuracy: 0.31
step_num: 2400 | loss: 0.6549 | profit rate:    2.8 | accuracy: 0.30
step_num: 2600 | loss: 0.7199 | profit rate:    5.5 | accuracy: 0.30
step_num: 2800 | loss: 0.7856 | profit rate:    3.1 | accuracy: 0.31
step_num: 3000 | loss: 0.7147 | profit rate:    3.0 | accuracy: 0.32
episode:   1/8,耗时:0.36分/0.36分,训练集: | step: 3170 | average_treward:   32.4 | max_treward: 32.4189 | average profit rate:  4.410
model saved @ step:3170,performance:4.410,accuracy:0.32
step_num: 3200 | loss: 0.6496 | profit rate:    1.3 | accuracy: 0.26
step_num: 3400 | loss: 0.7159 | profit rate:    7.5 | accuracy: 0.44
step_num: 3600 | loss: 0.5901 | profit rate:    4.3 | accuracy: 0.44
step_num: 3800 | loss: 0.5908 | profit rate:   19.3 | accuracy: 0.42
step_num: 4000 | loss: 0.1236 | profit rate:    3.8 | accuracy: 0.38
step_num: 4200 | loss: 0.4307 | profit rate:    3.2 | accuracy: 0.35
step_num: 4400 | loss: 0.2456 | profit rate:    8.5 | accuracy: 0.34
step_num: 4600 | loss: 0.0480 | profit rate:    9.8 | accuracy: 0.32
step_num: 4800 | loss: 0.0540 | profit rate:    9.8 | accuracy: 0.28
step_num: 5000 | loss: 0.1546 | profit rate:    9.3 | accuracy: 0.25
step_num: 5200 | loss: 0.7324 | profit rate:   15.2 | accuracy: 0.25
step_num: 5400 | loss: 0.2430 | profit rate:   10.2 | accuracy: 0.25
step_num: 5600 | loss: 0.3050 | profit rate:   12.1 | accuracy: 0.24
step_num: 5800 | loss: 0.0799 | profit rate:   24.5 | accuracy: 0.24
step_num: 6000 | loss: 0.6804 | profit rate:    4.1 | accuracy: 0.25
step_num: 6200 | loss: 0.0943 | profit rate:    5.4 | accuracy: 0.25
model saved @ step:6340,performance:5.059,accuracy:0.25
step_num: 6400 | loss: 0.0334 | profit rate:    1.0 | accuracy: 0.03
step_num: 6600 | loss: 0.3263 | profit rate:    2.0 | accuracy: 0.20
step_num: 6800 | loss: 0.5080 | profit rate:    2.2 | accuracy: 0.18
step_num: 7000 | loss: 0.9436 | profit rate:    1.6 | accuracy: 0.20
step_num: 7200 | loss: 0.2918 | profit rate:    1.2 | accuracy: 0.20
step_num: 7400 | loss: 0.0034 | profit rate:    1.0 | accuracy: 0.19
step_num: 7600 | loss: 0.2759 | profit rate:    2.2 | accuracy: 0.21
step_num: 7800 | loss: 0.0018 | profit rate:    2.3 | accuracy: 0.19
step_num: 8000 | loss: 0.0075 | profit rate:    2.2 | accuracy: 0.17
step_num: 8200 | loss: 0.2578 | profit rate:    5.0 | accuracy: 0.17
step_num: 8400 | loss: 0.8765 | profit rate:    1.3 | accuracy: 0.18
step_num: 8600 | loss: 0.4133 | profit rate:    2.7 | accuracy: 0.19
step_num: 8800 | loss: 0.1593 | profit rate:    3.1 | accuracy: 0.18
step_num: 9000 | loss: 0.0559 | profit rate:    4.0 | accuracy: 0.18
step_num: 9200 | loss: 0.4280 | profit rate:    0.5 | accuracy: 0.19
step_num: 9400 | loss: 0.0015 | profit rate:    0.5 | accuracy: 0.19
episode:   3/8,耗时:0.40分/1.16分,训练集: | step: 9510 | average_treward:   47.7 | max_treward: 70.5152 | average profit rate:  3.292
model saved @ step:9510,performance:0.408,accuracy:0.19
step_num: 9600 | loss: 0.0328 | profit rate:    1.0 | accuracy: 0.03
step_num: 9800 | loss: 0.0308 | profit rate:    1.1 | accuracy: 0.10
step_num: 10000 | loss: 0.0655 | profit rate:    1.2 | accuracy: 0.10
step_num: 10200 | loss: 0.4412 | profit rate:    3.3 | accuracy: 0.19
step_num: 10400 | loss: 0.1348 | profit rate:    1.0 | accuracy: 0.21
step_num: 10600 | loss: 0.4551 | profit rate:    0.7 | accuracy: 0.20
step_num: 10800 | loss: 0.1009 | profit rate:    1.5 | accuracy: 0.21
step_num: 11000 | loss: 0.2665 | profit rate:    1.8 | accuracy: 0.20
step_num: 11200 | loss: 0.5056 | profit rate:    7.3 | accuracy: 0.20
step_num: 11400 | loss: 0.7449 | profit rate:  180.1 | accuracy: 0.24
step_num: 11600 | loss: 0.4289 | profit rate:   37.3 | accuracy: 0.26
step_num: 11800 | loss: 0.3949 | profit rate:  208.4 | accuracy: 0.26
step_num: 12000 | loss: 0.0558 | profit rate:  112.6 | accuracy: 0.25
step_num: 12200 | loss: 0.0774 | profit rate:   64.3 | accuracy: 0.24
step_num: 12400 | loss: 0.0650 | profit rate:  139.2 | accuracy: 0.24
step_num: 12600 | loss: 0.4049 | profit rate:  154.5 | accuracy: 0.23
model saved @ step:12680,performance:154.472,accuracy:0.23
step_num: 12800 | loss: 0.0025 | profit rate:    1.0 | accuracy: 0.05
step_num: 13000 | loss: 0.0283 | profit rate:    1.4 | accuracy: 0.08
step_num: 13200 | loss: 0.1610 | profit rate:    1.5 | accuracy: 0.09
step_num: 13400 | loss: 0.5594 | profit rate:    2.9 | accuracy: 0.20
step_num: 13600 | loss: 0.2741 | profit rate:    1.5 | accuracy: 0.21
step_num: 13800 | loss: 0.4356 | profit rate:    0.8 | accuracy: 0.20
step_num: 14000 | loss: 0.2224 | profit rate:    2.4 | accuracy: 0.21
step_num: 14200 | loss: 0.1115 | profit rate:    2.4 | accuracy: 0.20
step_num: 14400 | loss: 0.3374 | profit rate:   70.4 | accuracy: 0.23
step_num: 14600 | loss: 0.5599 | profit rate:  301.5 | accuracy: 0.26
step_num: 14800 | loss: 0.0587 | profit rate:   89.6 | accuracy: 0.27
step_num: 15000 | loss: 0.4710 | profit rate:  584.3 | accuracy: 0.28
step_num: 15200 | loss: 0.0698 | profit rate:  258.9 | accuracy: 0.27
step_num: 15400 | loss: 0.2204 | profit rate:  281.3 | accuracy: 0.26
step_num: 15600 | loss: 0.1185 | profit rate:  814.3 | accuracy: 0.25
step_num: 15800 | loss: 0.1994 | profit rate:  931.1 | accuracy: 0.24
episode:   5/8,耗时:0.39分/1.96分,训练集: | step: 15850 | average_treward:  116.3 | max_treward: 233.1820 | average profit rate: 219.095
model saved @ step:15850,performance:931.125,accuracy:0.24
step_num: 16000 | loss: 0.0003 | profit rate:    1.0 | accuracy: 0.05
step_num: 16200 | loss: 0.0281 | profit rate:    1.8 | accuracy: 0.10
step_num: 16400 | loss: 0.3617 | profit rate:    3.0 | accuracy: 0.12
step_num: 16600 | loss: 0.4280 | profit rate:    2.6 | accuracy: 0.21
step_num: 16800 | loss: 0.0740 | profit rate:    1.3 | accuracy: 0.21
step_num: 17000 | loss: 1.1663 | profit rate:    3.2 | accuracy: 0.22
step_num: 17200 | loss: 0.0006 | profit rate:    3.1 | accuracy: 0.21
step_num: 17400 | loss: 0.2079 | profit rate:    3.6 | accuracy: 0.22
step_num: 17600 | loss: 0.6626 | profit rate:   98.8 | accuracy: 0.25
step_num: 17800 | loss: 0.7536 | profit rate:  870.4 | accuracy: 0.29
step_num: 18000 | loss: 0.2323 | profit rate:  443.8 | accuracy: 0.29
step_num: 18200 | loss: 0.4453 | profit rate: 1552.7 | accuracy: 0.29
step_num: 18400 | loss: 0.0398 | profit rate:  572.0 | accuracy: 0.28
step_num: 18600 | loss: 0.0933 | profit rate:  673.6 | accuracy: 0.27
step_num: 18800 | loss: 0.0798 | profit rate: 1267.1 | accuracy: 0.26
step_num: 19000 | loss: 0.0045 | profit rate: 1369.4 | accuracy: 0.25
step_num: 19200 | loss: 0.1552 | profit rate:    1.0 | accuracy: 0.05
step_num: 19400 | loss: 0.2600 | profit rate:    1.4 | accuracy: 0.09
step_num: 19600 | loss: 0.4639 | profit rate:    2.9 | accuracy: 0.14
step_num: 19800 | loss: 0.6222 | profit rate:    1.1 | accuracy: 0.20
step_num: 20000 | loss: 0.1898 | profit rate:    1.3 | accuracy: 0.21
step_num: 20200 | loss: 0.4319 | profit rate:    3.4 | accuracy: 0.21
step_num: 20400 | loss: 0.0281 | profit rate:    4.2 | accuracy: 0.20
step_num: 20600 | loss: 0.0538 | profit rate:    5.1 | accuracy: 0.22
step_num: 20800 | loss: 0.4503 | profit rate:  282.0 | accuracy: 0.26
step_num: 21000 | loss: 0.8084 | profit rate:  399.4 | accuracy: 0.29
step_num: 21200 | loss: 0.3183 | profit rate:  477.7 | accuracy: 0.29
step_num: 21400 | loss: 0.1813 | profit rate: 1552.4 | accuracy: 0.29
step_num: 21600 | loss: 0.3591 | profit rate:  914.0 | accuracy: 0.28
step_num: 21800 | loss: 0.3227 | profit rate: 1130.4 | accuracy: 0.27
step_num: 22000 | loss: 0.1330 | profit rate: 1293.1 | accuracy: 0.26
episode:   7/8,耗时:0.39分/2.76分,训练集: | step: 22190 | average_treward:  148.5 | max_treward: 233.1820 | average profit rate: 549.324
step_num: 22200 | loss: 0.1092 | profit rate:    1.0 | accuracy: 0.00
step_num: 22400 | loss: 0.1554 | profit rate:    1.2 | accuracy: 0.06
step_num: 22600 | loss: 0.0877 | profit rate:    1.4 | accuracy: 0.08
step_num: 22800 | loss: 0.3063 | profit rate:    4.6 | accuracy: 0.14
step_num: 23000 | loss: 0.4709 | profit rate:    1.2 | accuracy: 0.21
step_num: 23200 | loss: 0.1508 | profit rate:    1.5 | accuracy: 0.20
step_num: 23400 | loss: 0.0530 | profit rate:    5.1 | accuracy: 0.20
step_num: 23600 | loss: 0.0781 | profit rate:    5.8 | accuracy: 0.20
step_num: 23800 | loss: 0.2690 | profit rate:   16.3 | accuracy: 0.22
step_num: 24000 | loss: 0.5208 | profit rate: 1737.5 | accuracy: 0.27
step_num: 24200 | loss: 0.4920 | profit rate:  371.7 | accuracy: 0.29
step_num: 24400 | loss: 0.1941 | profit rate: 1058.2 | accuracy: 0.29
step_num: 24600 | loss: 0.3937 | profit rate: 1822.1 | accuracy: 0.29
step_num: 24800 | loss: 0.1834 | profit rate: 1928.8 | accuracy: 0.27
step_num: 25000 | loss: 0.2392 | profit rate: 2386.4 | accuracy: 0.26
step_num: 25200 | loss: 0.2324 | profit rate: 3434.4 | accuracy: 0.26
model saved @ step:25360,performance:4324.484,accuracy:0.25
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 35%|      | 108/312 [00:00<00:00, 1079.73it/s] 76%|  | 238/312 [00:00<00:00, 1209.28it/s]==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
100%|| 312/312 [00:00<00:00, 1209.18it/s]
--------------------------------------------------
2023-01-24T12:00:00 | *** GOING LONG ***
2023-01-24T12:00:00's price 22632.8906, buy 0.0441393 units.
2023-01-24T12:00:00 | current balance = 0.00
2023-01-24T12:00:00 | balance:0.00+units:0.0441393*price:22632.8906=net_wealth:999.0010
--------------------------------------------------
2023-01-25T12:00:00 | *** GOING SHORT ***
2023-01-25T12:00:00's price 23060.9395, sell 0.0441393 units.
2023-01-25T12:00:00 | current balance = 1016.88
2023-01-25T12:00:00 | balance:1016.88+units:0.0*price:23060.9395=net_wealth:1016.8769
--------------------------------------------------
2023-01-31T12:00:00 | *** GOING LONG ***
2023-01-31T12:00:00's price 23125.1309, buy 0.04392883 units.
2023-01-31T12:00:00 | current balance = 0.00
2023-01-31T12:00:00 | balance:0.00+units:0.04392883*price:23125.1309=net_wealth:1015.8610
--------------------------------------------------
2023-02-17T12:00:00 | *** GOING SHORT ***
2023-02-17T12:00:00's price 24569.9707, sell 0.04392883 units.
2023-02-17T12:00:00 | current balance = 1078.25
2023-02-17T12:00:00 | balance:1078.25+units:0.0*price:24569.9707=net_wealth:1078.2518
--------------------------------------------------
2023-02-23T00:00:00 | *** GOING LONG ***
2023-02-23T00:00:00's price 23780.1992, buy 0.04529707 units.
2023-02-23T00:00:00 | current balance = 0.00
2023-02-23T00:00:00 | balance:0.00+units:0.04529707*price:23780.1992=net_wealth:1077.1746
--------------------------------------------------
2023-03-15T00:00:00 | *** GOING SHORT ***
2023-03-15T00:00:00's price 24754.5000, sell 0.04529707 units.
2023-03-15T00:00:00 | current balance = 1120.19
2023-03-15T00:00:00 | balance:1120.19+units:0.0*price:24754.5000=net_wealth:1120.1863
--------------------------------------------------
2023-03-22T12:00:00 | *** GOING LONG ***
2023-03-22T12:00:00's price 27250.9707, buy 0.04106518 units.
2023-03-22T12:00:00 | current balance = 0.00
2023-03-22T12:00:00 | balance:0.00+units:0.04106518*price:27250.9707=net_wealth:1119.0672
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, sell 0.04106518 units.
2023-06-08T12:00:00 | current balance = 1091.23
2023-06-08T12:00:00 | net performance [%] = 9.1234
2023-06-08T12:00:00 | number of trades [#] = 8
==================================================
Trial 23 Complete [00h 03m 12s]
net_wealth: 1092.3263495495755

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 03h 10m 21s

Search: Running Trial #24

Value             |Best Value So Far |Hyperparameter
14                |8                 |horizon
365               |225               |lookback
False             |True              |MarketFactor
20                |14                |lags
0.98              |0.98              |gamma
32                |32                |memory_size
32                |16                |batch_size
20                |32                |n_steps
0.97              |0.98              |gae_lambda
10                |2                 |gradient_clip_
3                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4223.000000     4223.000000  ...    4209.000000   4223.000000
mean      0.000429    19869.492402  ...   19971.309209  19920.121151
std       0.028054    16157.511856  ...   16194.471215  16191.951213
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009843     7524.016455  ...    7625.000000   7559.520020
50%       0.000696    11383.668066  ...   11477.000000  11460.440430
75%       0.011799    29453.128320  ...   29331.689453  29303.195312
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 8 columns]
step_num: 200 | loss: 0.4260 | profit rate:    0.3 | accuracy: 0.32
step_num: 400 | loss: 0.4602 | profit rate:    0.6 | accuracy: 0.31
step_num: 600 | loss: 1.2978 | profit rate:    1.2 | accuracy: 0.30
step_num: 800 | loss: 1.1900 | profit rate:    0.1 | accuracy: 0.30
step_num: 1000 | loss: 1.1924 | profit rate:    0.1 | accuracy: 0.30
step_num: 1200 | loss: 0.9771 | profit rate:    0.0 | accuracy: 0.31
step_num: 1400 | loss: 0.5703 | profit rate:    0.0 | accuracy: 0.31
step_num: 1600 | loss: 0.4293 | profit rate:    0.1 | accuracy: 0.33
step_num: 1800 | loss: 0.5442 | profit rate:    0.0 | accuracy: 0.34
step_num: 2000 | loss: 0.8475 | profit rate:    0.0 | accuracy: 0.34
step_num: 2200 | loss: 0.6081 | profit rate:    0.1 | accuracy: 0.35
step_num: 2400 | loss: 0.8955 | profit rate:    0.0 | accuracy: 0.35
step_num: 2600 | loss: 0.5477 | profit rate:    0.0 | accuracy: 0.35
step_num: 2800 | loss: 0.4672 | profit rate:    0.0 | accuracy: 0.36
step_num: 3000 | loss: 0.5999 | profit rate:    0.0 | accuracy: 0.36
step_num: 3200 | loss: 1.0169 | profit rate:    0.0 | accuracy: 0.37
step_num: 3400 | loss: 0.6798 | profit rate:    0.0 | accuracy: 0.38
episode:   1/8,耗时:0.40分/0.40分,训练集: | step: 3522 | average_treward:    9.3 | max_treward: 9.2779 | average profit rate:  0.475
model saved @ step:3522,performance:0.475,accuracy:0.39
step_num: 3600 | loss: 1.1441 | profit rate:    2.0 | accuracy: 0.44
step_num: 3800 | loss: 0.9584 | profit rate:    4.1 | accuracy: 0.47
step_num: 4000 | loss: 0.4915 | profit rate:    3.8 | accuracy: 0.42
step_num: 4200 | loss: 0.6328 | profit rate:   78.9 | accuracy: 0.43
step_num: 4400 | loss: 1.3032 | profit rate:  627.3 | accuracy: 0.44
step_num: 4600 | loss: 0.5813 | profit rate: 11691.9 | accuracy: 0.45
step_num: 4800 | loss: 0.5741 | profit rate: 1366.1 | accuracy: 0.44
step_num: 5000 | loss: 0.8186 | profit rate:  214.8 | accuracy: 0.43
step_num: 5200 | loss: 0.4883 | profit rate:   43.2 | accuracy: 0.41
step_num: 5400 | loss: 0.5950 | profit rate:   21.8 | accuracy: 0.42
step_num: 5600 | loss: 0.6331 | profit rate: 21978078.0 | accuracy: 0.45
step_num: 5800 | loss: 0.9500 | profit rate: 2382023760.4 | accuracy: 0.46
step_num: 6000 | loss: 0.9380 | profit rate: 8894976.9 | accuracy: 0.46
step_num: 6200 | loss: 0.6057 | profit rate: 352598470.7 | accuracy: 0.46
step_num: 6400 | loss: 0.5076 | profit rate: 287114669.2 | accuracy: 0.46
step_num: 6600 | loss: 0.1904 | profit rate: 23593662385.9 | accuracy: 0.45
step_num: 6800 | loss: 0.7614 | profit rate: 876669559799.9 | accuracy: 0.45
step_num: 7000 | loss: 0.6186 | profit rate: 4527417196204.1 | accuracy: 0.45
model saved @ step:7044,performance:7272727910744.286,accuracy:0.45
step_num: 7200 | loss: 1.0405 | profit rate:   15.2 | accuracy: 0.51
step_num: 7400 | loss: 0.8772 | profit rate:    0.9 | accuracy: 0.43
step_num: 7600 | loss: 0.0188 | profit rate:   85.0 | accuracy: 0.40
step_num: 7800 | loss: 0.3753 | profit rate:   41.6 | accuracy: 0.38
step_num: 8000 | loss: 1.2248 | profit rate: 109313.2 | accuracy: 0.43
step_num: 8200 | loss: 0.8883 | profit rate: 511482.2 | accuracy: 0.43
step_num: 8400 | loss: 0.6505 | profit rate: 88787.5 | accuracy: 0.43
step_num: 8600 | loss: 0.1078 | profit rate: 6857067.4 | accuracy: 0.41
step_num: 8800 | loss: 0.9904 | profit rate: 1287646.3 | accuracy: 0.42
step_num: 9000 | loss: 0.5369 | profit rate: 71311204.6 | accuracy: 0.43
step_num: 9200 | loss: 1.3246 | profit rate: 1334322443591834.8 | accuracy: 0.46
step_num: 9400 | loss: 0.7958 | profit rate: 11114468614015.4 | accuracy: 0.46
step_num: 9600 | loss: 0.4949 | profit rate: 11994664122827.0 | accuracy: 0.46
step_num: 9800 | loss: 0.7260 | profit rate: 136998273941982.6 | accuracy: 0.46
step_num: 10000 | loss: 0.4957 | profit rate: 21935164466523244.0 | accuracy: 0.46
step_num: 10200 | loss: 0.3911 | profit rate: 420345892890661760.0 | accuracy: 0.45
step_num: 10400 | loss: 0.4557 | profit rate: 3086633511433592832.0 | accuracy: 0.44
episode:   3/8,耗时:0.47分/1.32分,训练集: | step: 10566 | average_treward:  290.9 | max_treward: 540.4815 | average profit rate: 7036886500696346624.000
model saved @ step:10566,performance:21110652229361127424.000,accuracy:0.44
step_num: 10600 | loss: 0.7319 | profit rate:    7.4 | accuracy: 0.57
step_num: 10800 | loss: 0.9244 | profit rate:   87.1 | accuracy: 0.51
step_num: 11000 | loss: 0.8378 | profit rate:    1.7 | accuracy: 0.40
step_num: 11200 | loss: 0.0193 | profit rate:   65.1 | accuracy: 0.34
step_num: 11400 | loss: 0.4596 | profit rate:   14.4 | accuracy: 0.31
step_num: 11600 | loss: 0.7435 | profit rate: 280328.2 | accuracy: 0.38
step_num: 11800 | loss: 0.7150 | profit rate: 271517.0 | accuracy: 0.39
step_num: 12000 | loss: 0.4885 | profit rate: 521719.3 | accuracy: 0.37
step_num: 12200 | loss: 0.5664 | profit rate: 137383433.0 | accuracy: 0.36
step_num: 12400 | loss: 0.7688 | profit rate: 43788478.7 | accuracy: 0.37
step_num: 12600 | loss: 0.8981 | profit rate: 161669186004.0 | accuracy: 0.40
step_num: 12800 | loss: 0.8129 | profit rate: 36074324158541896.0 | accuracy: 0.43
step_num: 13000 | loss: 0.3290 | profit rate: 323238511082289.4 | accuracy: 0.42
step_num: 13200 | loss: 1.6819 | profit rate: 4327129541911297.0 | accuracy: 0.43
step_num: 13400 | loss: 0.8464 | profit rate: 12408835668515482.0 | accuracy: 0.43
step_num: 13600 | loss: 0.4075 | profit rate: 15379514289894988.0 | accuracy: 0.42
step_num: 13800 | loss: 0.0110 | profit rate: 37755980962425216.0 | accuracy: 0.40
step_num: 14000 | loss: 0.4773 | profit rate: 20167844952807488.0 | accuracy: 0.39
step_num: 14200 | loss: 0.0137 | profit rate:    0.9 | accuracy: 0.33
step_num: 14400 | loss: 0.9167 | profit rate:   35.3 | accuracy: 0.37
step_num: 14600 | loss: 0.8678 | profit rate:  116.1 | accuracy: 0.31
step_num: 14800 | loss: 0.0123 | profit rate:  316.3 | accuracy: 0.24
step_num: 15000 | loss: 1.1395 | profit rate: 62340.6 | accuracy: 0.29
step_num: 15200 | loss: 0.5767 | profit rate: 3831006.1 | accuracy: 0.34
step_num: 15400 | loss: 0.5200 | profit rate: 77456689.3 | accuracy: 0.35
step_num: 15600 | loss: 0.5596 | profit rate: 49910183051.0 | accuracy: 0.35
step_num: 15800 | loss: 0.4868 | profit rate: 113429932164.5 | accuracy: 0.36
step_num: 16000 | loss: 1.1914 | profit rate: 28192948524.3 | accuracy: 0.37
step_num: 16200 | loss: 2.1449 | profit rate: 931930864039110.1 | accuracy: 0.40
step_num: 16400 | loss: 0.8561 | profit rate: 83650100616146960.0 | accuracy: 0.41
step_num: 16600 | loss: 0.4740 | profit rate: 487298319753823.4 | accuracy: 0.41
step_num: 16800 | loss: 1.0883 | profit rate: 5376611414154408.0 | accuracy: 0.42
step_num: 17000 | loss: 0.5830 | profit rate: 25399701291287556.0 | accuracy: 0.42
step_num: 17200 | loss: 0.0672 | profit rate: 294007336687203712.0 | accuracy: 0.41
step_num: 17400 | loss: 0.7765 | profit rate: 75864548327736304.0 | accuracy: 0.40
step_num: 17600 | loss: 0.7079 | profit rate: 1450020137461916672.0 | accuracy: 0.40
episode:   5/8,耗时:0.45分/2.23分,训练集: | step: 17610 | average_treward:  367.5 | max_treward: 540.4815 | average profit rate: 4488125986370420736.000
step_num: 17800 | loss: 1.1285 | profit rate:  242.0 | accuracy: 0.58
step_num: 18000 | loss: 0.4740 | profit rate:   70.6 | accuracy: 0.48
step_num: 18200 | loss: 0.4267 | profit rate: 5484.8 | accuracy: 0.44
step_num: 18400 | loss: 0.8961 | profit rate:   89.9 | accuracy: 0.37
step_num: 18600 | loss: 1.5353 | profit rate: 97746.0 | accuracy: 0.41
step_num: 18800 | loss: 1.0060 | profit rate: 1254688.8 | accuracy: 0.44
step_num: 19000 | loss: 0.8660 | profit rate: 2856421.6 | accuracy: 0.42
step_num: 19200 | loss: 0.7143 | profit rate: 15223549837.8 | accuracy: 0.42
step_num: 19400 | loss: 0.5598 | profit rate: 3604074926.9 | accuracy: 0.44
step_num: 19600 | loss: 0.6067 | profit rate: 140990013052.9 | accuracy: 0.45
step_num: 19800 | loss: 0.8231 | profit rate: 249193660138213280.0 | accuracy: 0.48
step_num: 20000 | loss: 0.6392 | profit rate: 6147674267017594.0 | accuracy: 0.47
step_num: 20200 | loss: 0.6849 | profit rate: 2338135152376699.0 | accuracy: 0.47
step_num: 20400 | loss: 0.8326 | profit rate: 2707027465249872.5 | accuracy: 0.48
step_num: 20600 | loss: 0.6848 | profit rate: 94850656378789728.0 | accuracy: 0.47
step_num: 20800 | loss: 0.0161 | profit rate: 133382588634469984.0 | accuracy: 0.45
step_num: 21000 | loss: 0.7516 | profit rate: 80107969675244768.0 | accuracy: 0.43
step_num: 21200 | loss: 1.1476 | profit rate:    4.7 | accuracy: 0.61
step_num: 21400 | loss: 0.3833 | profit rate:  276.2 | accuracy: 0.47
step_num: 21600 | loss: 0.3371 | profit rate: 1031.5 | accuracy: 0.43
step_num: 21800 | loss: 0.0112 | profit rate: 235791.1 | accuracy: 0.36
step_num: 22000 | loss: 0.9503 | profit rate: 1005494.1 | accuracy: 0.37
step_num: 22200 | loss: 0.8730 | profit rate: 15924450.4 | accuracy: 0.40
step_num: 22400 | loss: 0.8383 | profit rate: 164383654.8 | accuracy: 0.42
step_num: 22600 | loss: 1.2931 | profit rate: 319057994069.3 | accuracy: 0.41
step_num: 22800 | loss: 0.8270 | profit rate: 1418338465596.4 | accuracy: 0.41
step_num: 23000 | loss: 0.6420 | profit rate: 572099642579.7 | accuracy: 0.41
step_num: 23200 | loss: 0.7728 | profit rate: 12568497072867394.0 | accuracy: 0.44
step_num: 23400 | loss: 0.5254 | profit rate: 1251301113929565440.0 | accuracy: 0.45
step_num: 23600 | loss: 0.7657 | profit rate: 8820138460432695.0 | accuracy: 0.44
step_num: 23800 | loss: 0.5653 | profit rate: 211002257988241888.0 | accuracy: 0.45
step_num: 24000 | loss: 0.3411 | profit rate: 6282840155369171968.0 | accuracy: 0.45
step_num: 24200 | loss: 0.0603 | profit rate: 19008022016552263680.0 | accuracy: 0.44
step_num: 24400 | loss: 0.6049 | profit rate: 40175881925292752896.0 | accuracy: 0.42
step_num: 24600 | loss: 0.0684 | profit rate: 104713393768553054208.0 | accuracy: 0.41
episode:   7/8,耗时:0.45分/3.12分,训练集: | step: 24654 | average_treward:  412.6 | max_treward: 559.9178 | average profit rate: 19636648629616824320.000
model saved @ step:24654,performance:114094489625386860544.000,accuracy:0.41
step_num: 24800 | loss: 0.7398 | profit rate:    9.7 | accuracy: 0.54
step_num: 25000 | loss: 0.9294 | profit rate:  164.2 | accuracy: 0.48
step_num: 25200 | loss: 0.0559 | profit rate: 30659.9 | accuracy: 0.44
step_num: 25400 | loss: 0.1857 | profit rate: 5014.6 | accuracy: 0.34
step_num: 25600 | loss: 1.1491 | profit rate: 732420.4 | accuracy: 0.39
step_num: 25800 | loss: 0.7681 | profit rate: 2906426.7 | accuracy: 0.41
step_num: 26000 | loss: 0.1629 | profit rate: 2171607.2 | accuracy: 0.40
step_num: 26200 | loss: 0.1850 | profit rate: 24854913347.7 | accuracy: 0.41
step_num: 26400 | loss: 0.7485 | profit rate: 11881421685.7 | accuracy: 0.42
step_num: 26600 | loss: 0.2483 | profit rate: 21445635631.4 | accuracy: 0.43
step_num: 26800 | loss: 0.8032 | profit rate: 54598385658128680.0 | accuracy: 0.46
step_num: 27000 | loss: 1.2494 | profit rate: 22215931865140100.0 | accuracy: 0.46
step_num: 27200 | loss: 0.6084 | profit rate: 937540429646264.2 | accuracy: 0.45
step_num: 27400 | loss: 0.6984 | profit rate: 16502947013860298.0 | accuracy: 0.46
step_num: 27600 | loss: 0.2108 | profit rate: 222673770232181760.0 | accuracy: 0.45
step_num: 27800 | loss: 0.0563 | profit rate: 1452394103555720704.0 | accuracy: 0.44
step_num: 28000 | loss: 0.2183 | profit rate: 698959901039790976.0 | accuracy: 0.42
----------------------------------------finished----------------------------------------
  0%|          | 0/299 [00:00<?, ?it/s] 35%|      | 104/299 [00:00<00:00, 1034.17it/s] 81%|  | 242/299 [00:00<00:00, 1237.13it/s]100%|| 299/299 [00:00<00:00, 1222.59it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-13T00:00:00 | *** GOING LONG ***
2023-01-13T00:00:00's price 18920.9492, buy 0.05279861 units.
2023-01-13T00:00:00 | current balance = 0.00
2023-01-13T00:00:00 | balance:0.00+units:0.05279861*price:18920.9492=net_wealth:999.0010
--------------------------------------------------
2023-02-05T00:00:00 | *** GOING SHORT ***
2023-02-05T00:00:00's price 23356.3301, sell 0.05279861 units.
2023-02-05T00:00:00 | current balance = 1231.95
2023-02-05T00:00:00 | balance:1231.95+units:0.0*price:23356.3301=net_wealth:1231.9498
--------------------------------------------------
2023-02-06T00:00:00 | *** GOING LONG ***
2023-02-06T00:00:00's price 22878.2305, buy 0.05379427 units.
2023-02-06T00:00:00 | current balance = 0.00
2023-02-06T00:00:00 | balance:0.00+units:0.05379427*price:22878.2305=net_wealth:1230.7190
--------------------------------------------------
2023-02-06T12:00:00 | *** GOING SHORT ***
2023-02-06T12:00:00's price 22762.5195, sell 0.05379427 units.
2023-02-06T12:00:00 | current balance = 1223.27
2023-02-06T12:00:00 | balance:1223.27+units:0.0*price:22762.5195=net_wealth:1223.2700
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING LONG ***
2023-02-07T00:00:00's price 22977.2402, buy 0.053185090000000004 units.
2023-02-07T00:00:00 | current balance = 0.00
2023-02-07T00:00:00 | balance:0.00+units:0.053185090000000004*price:22977.2402=net_wealth:1222.0479
--------------------------------------------------
2023-02-08T00:00:00 | *** GOING SHORT ***
2023-02-08T00:00:00's price 23159.0703, sell 0.053185090000000004 units.
2023-02-08T00:00:00 | current balance = 1230.49
2023-02-08T00:00:00 | balance:1230.49+units:0.0*price:23159.0703=net_wealth:1230.4869
--------------------------------------------------
2023-02-15T12:00:00 | *** GOING LONG ***
2023-02-15T12:00:00's price 24324.0508, buy 0.050536660000000004 units.
2023-02-15T12:00:00 | current balance = 0.00
2023-02-15T12:00:00 | balance:0.00+units:0.050536660000000004*price:24324.0508=net_wealth:1229.2576
--------------------------------------------------
2023-02-28T00:00:00 | *** GOING SHORT ***
2023-02-28T00:00:00's price 23392.6895, sell 0.050536660000000004 units.
2023-02-28T00:00:00 | current balance = 1181.01
2023-02-28T00:00:00 | balance:1181.01+units:0.0*price:23392.6895=net_wealth:1181.0075
--------------------------------------------------
2023-03-01T12:00:00 | *** GOING LONG ***
2023-03-01T12:00:00's price 23628.9707, buy 0.04993135 units.
2023-03-01T12:00:00 | current balance = 0.00
2023-03-01T12:00:00 | balance:0.00+units:0.04993135*price:23628.9707=net_wealth:1179.8277
--------------------------------------------------
2023-03-02T00:00:00 | *** GOING SHORT ***
2023-03-02T00:00:00's price 23414.7305, sell 0.04993135 units.
2023-03-02T00:00:00 | current balance = 1167.96
2023-03-02T00:00:00 | balance:1167.96+units:0.0*price:23414.7305=net_wealth:1167.9613
--------------------------------------------------
2023-03-03T12:00:00 | *** GOING LONG ***
2023-03-03T12:00:00's price 22354.3398, buy 0.05219538 units.
2023-03-03T12:00:00 | current balance = 0.00
2023-03-03T12:00:00 | balance:0.00+units:0.05219538*price:22354.3398=net_wealth:1166.7945
--------------------------------------------------
2023-03-04T12:00:00 | *** GOING SHORT ***
2023-03-04T12:00:00's price 22346.5703, sell 0.05219538 units.
2023-03-04T12:00:00 | current balance = 1165.22
2023-03-04T12:00:00 | balance:1165.22+units:0.0*price:22346.5703=net_wealth:1165.2225
--------------------------------------------------
2023-03-13T12:00:00 | *** GOING LONG ***
2023-03-13T12:00:00's price 24113.4805, buy 0.04827413 units.
2023-03-13T12:00:00 | current balance = 0.00
2023-03-13T12:00:00 | balance:0.00+units:0.04827413*price:24113.4805=net_wealth:1164.0585
--------------------------------------------------
2023-04-21T12:00:00 | *** GOING SHORT ***
2023-04-21T12:00:00's price 27262.8398, sell 0.04827413 units.
2023-04-21T12:00:00 | current balance = 1314.77
2023-04-21T12:00:00 | balance:1314.77+units:0.0*price:27262.8398=net_wealth:1314.7750
--------------------------------------------------
2023-04-27T00:00:00 | *** GOING LONG ***
2023-04-27T00:00:00's price 28934.2109, buy 0.04539471 units.
2023-04-27T00:00:00 | current balance = 0.00
2023-04-27T00:00:00 | balance:0.00+units:0.04539471*price:28934.2109=net_wealth:1313.4615
--------------------------------------------------
2023-05-08T00:00:00 | *** GOING SHORT ***
2023-05-08T00:00:00's price 27934.0898, sell 0.04539471 units.
2023-05-08T00:00:00 | current balance = 1266.79
2023-05-08T00:00:00 | balance:1266.79+units:0.0*price:27934.0898=net_wealth:1266.7933
--------------------------------------------------
2023-05-30T00:00:00 | *** GOING LONG ***
2023-05-30T00:00:00's price 28021.4004, buy 0.045162850000000004 units.
2023-05-30T00:00:00 | current balance = 0.00
2023-05-30T00:00:00 | balance:0.00+units:0.045162850000000004*price:28021.4004=net_wealth:1265.5277
--------------------------------------------------
2023-05-30T12:00:00 | *** GOING SHORT ***
2023-05-30T12:00:00's price 27694.4004, sell 0.045162850000000004 units.
2023-05-30T12:00:00 | current balance = 1249.51
2023-05-30T12:00:00 | balance:1249.51+units:0.0*price:27694.4004=net_wealth:1249.5087
--------------------------------------------------
2023-05-31T00:00:00 | *** GOING LONG ***
2023-05-31T00:00:00's price 27097.1797, buy 0.04606601 units.
2023-05-31T00:00:00 | current balance = 0.00
2023-05-31T00:00:00 | balance:0.00+units:0.04606601*price:27097.1797=net_wealth:1248.2605
--------------------------------------------------
2023-06-01T12:00:00 | *** GOING SHORT ***
2023-06-01T12:00:00's price 26817.9297, sell 0.04606601 units.
2023-06-01T12:00:00 | current balance = 1234.16
2023-06-01T12:00:00 | balance:1234.16+units:0.0*price:26817.9297=net_wealth:1234.1611
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1234.16
2023-06-08T12:00:00 | net performance [%] = 23.4161
2023-06-08T12:00:00 | number of trades [#] = 20
==================================================
Trial 24 Complete [00h 03m 37s]
net_wealth: 1234.1611280141574

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 03h 13m 58s

Search: Running Trial #25

Value             |Best Value So Far |Hyperparameter
4                 |8                 |horizon
730               |225               |lookback
True              |True              |MarketFactor
7                 |14                |lags
0.8               |0.98              |gamma
512               |32                |memory_size
16                |16                |batch_size
128               |32                |n_steps
0.97              |0.98              |gae_lambda
2                 |2                 |gradient_clip_
5                 |5                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4243 entries, 2017-08-17 00:00:00+00:00 to 2023-06-08 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4243 non-null   float64
 1   high        4243 non-null   float64
 2   low         4243 non-null   float64
 3   close       4243 non-null   float64
 4   volume      4243 non-null   float64
 5   amount      4243 non-null   float64
 6   num_trades  4243 non-null   int64  
 7   bid_volume  4243 non-null   float64
 8   bid_amount  4243 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 331.5 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4209.000000     4209.000000  ...    4205.000000   4209.000000
mean      0.000424    19921.326125  ...   19986.205058  19971.309209
std       0.028069    16159.303521  ...   16194.964155  16194.471215
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009845     7562.328955  ...    7628.430176   7625.000000
50%       0.000696    11410.370947  ...   11486.360352  11477.000000
75%       0.011720    29502.909082  ...   29332.109375  29331.689453
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-06-08 08:00:00+08:00    0.003512  ...  26432.000000
2023-06-08 20:00:00+08:00    0.006328  ...  26599.789062

[2 rows x 18 columns]
step_num: 400 | loss: 0.3822 | profit rate:    0.5 | accuracy: 0.34
step_num: 600 | loss: 0.3915 | profit rate:    0.2 | accuracy: 0.31
step_num: 800 | loss: 0.3092 | profit rate:    0.1 | accuracy: 0.31
step_num: 1000 | loss: 0.3174 | profit rate:    0.1 | accuracy: 0.32
step_num: 1200 | loss: 0.3353 | profit rate:    0.1 | accuracy: 0.32
step_num: 1400 | loss: 0.3016 | profit rate:    0.1 | accuracy: 0.31
step_num: 1600 | loss: 0.3419 | profit rate:    0.1 | accuracy: 0.31
step_num: 1800 | loss: 0.2952 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.3068 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.2594 | profit rate:    0.0 | accuracy: 0.30
step_num: 2400 | loss: 0.2764 | profit rate:    0.0 | accuracy: 0.30
step_num: 2600 | loss: 0.2012 | profit rate:    0.0 | accuracy: 0.29
step_num: 2800 | loss: 0.1677 | profit rate:    0.0 | accuracy: 0.27
step_num: 3000 | loss: 0.1198 | profit rate:    0.0 | accuracy: 0.26
episode:   1/8,耗时:0.98分/0.98分,训练集: | step: 3156 | average_treward:  -50.5 | max_treward: 0.0000 | average profit rate:  0.006
step_num: 3200 | loss: 0.0863 | profit rate:    1.1 | accuracy: 0.16
step_num: 3400 | loss: 0.0840 | profit rate:    0.9 | accuracy: 0.12
step_num: 3600 | loss: 0.0978 | profit rate:    0.9 | accuracy: 0.13
step_num: 3800 | loss: 0.1269 | profit rate:    0.2 | accuracy: 0.14
step_num: 4000 | loss: 0.1602 | profit rate:    0.2 | accuracy: 0.14
step_num: 4200 | loss: 0.1006 | profit rate:    0.1 | accuracy: 0.13
step_num: 4400 | loss: 0.0873 | profit rate:    0.3 | accuracy: 0.13
step_num: 4600 | loss: 0.0547 | profit rate:    0.3 | accuracy: 0.13
step_num: 4800 | loss: 0.0650 | profit rate:    0.6 | accuracy: 0.13
step_num: 5000 | loss: 0.0934 | profit rate:    6.7 | accuracy: 0.15
step_num: 5200 | loss: 0.1165 | profit rate:    6.6 | accuracy: 0.15
step_num: 5400 | loss: 0.0698 | profit rate:    9.0 | accuracy: 0.14
step_num: 5600 | loss: 0.0657 | profit rate:    8.0 | accuracy: 0.13
step_num: 5800 | loss: 0.0367 | profit rate:    6.7 | accuracy: 0.13
step_num: 6000 | loss: 0.0787 | profit rate:    6.4 | accuracy: 0.13
step_num: 6200 | loss: 0.0543 | profit rate:    9.4 | accuracy: 0.13
model saved @ step:6312,performance:11.621,accuracy:0.13
step_num: 6400 | loss: 0.0902 | profit rate:    1.2 | accuracy: 0.11
step_num: 6600 | loss: 0.1568 | profit rate:    2.4 | accuracy: 0.21
step_num: 6800 | loss: 0.1569 | profit rate:    1.5 | accuracy: 0.22
step_num: 7000 | loss: 0.1578 | profit rate:    0.4 | accuracy: 0.21
step_num: 7200 | loss: 0.1192 | profit rate:    0.4 | accuracy: 0.19
step_num: 7400 | loss: 0.0587 | profit rate:    0.5 | accuracy: 0.18
step_num: 7600 | loss: 0.0959 | profit rate:    1.4 | accuracy: 0.18
step_num: 7800 | loss: 0.0577 | profit rate:    1.5 | accuracy: 0.17
step_num: 8000 | loss: 0.0963 | profit rate:    1.6 | accuracy: 0.16
step_num: 8200 | loss: 0.0862 | profit rate:    4.0 | accuracy: 0.16
step_num: 8400 | loss: 0.0745 | profit rate:    3.1 | accuracy: 0.16
step_num: 8600 | loss: 0.0832 | profit rate:    3.3 | accuracy: 0.15
step_num: 8800 | loss: 0.0650 | profit rate:    2.9 | accuracy: 0.15
step_num: 9000 | loss: 0.0433 | profit rate:    2.6 | accuracy: 0.14
step_num: 9200 | loss: 0.0420 | profit rate:    3.3 | accuracy: 0.14
step_num: 9400 | loss: 0.0401 | profit rate:    3.2 | accuracy: 0.14
episode:   3/8,耗时:1.11分/3.24分,训练集: | step: 9468 | average_treward:   75.5 | max_treward: 141.2640 | average profit rate:  4.947
step_num: 9600 | loss: 0.0286 | profit rate:    1.0 | accuracy: 0.06
step_num: 9800 | loss: 0.0406 | profit rate:    1.3 | accuracy: 0.08
step_num: 10000 | loss: 0.0795 | profit rate:    2.4 | accuracy: 0.12
step_num: 10200 | loss: 0.0877 | profit rate:    2.1 | accuracy: 0.15
step_num: 10400 | loss: 0.0627 | profit rate:    2.4 | accuracy: 0.14
step_num: 10600 | loss: 0.1145 | profit rate:    8.5 | accuracy: 0.14
step_num: 10800 | loss: 0.0598 | profit rate:   18.4 | accuracy: 0.14
step_num: 11000 | loss: 0.0734 | profit rate:   22.8 | accuracy: 0.14
step_num: 11200 | loss: 0.0775 | profit rate:  121.8 | accuracy: 0.15
step_num: 11400 | loss: 0.0991 | profit rate:  241.2 | accuracy: 0.16
step_num: 11600 | loss: 0.0930 | profit rate:  330.8 | accuracy: 0.16
step_num: 11800 | loss: 0.0880 | profit rate:  843.2 | accuracy: 0.16
step_num: 12000 | loss: 0.0717 | profit rate:  727.0 | accuracy: 0.16
step_num: 12200 | loss: 0.0589 | profit rate:  868.5 | accuracy: 0.16
step_num: 12400 | loss: 0.0547 | profit rate:  853.8 | accuracy: 0.15
step_num: 12600 | loss: 0.0265 | profit rate:  763.6 | accuracy: 0.14
model saved @ step:12624,performance:763.570,accuracy:0.14
step_num: 12800 | loss: 0.0360 | profit rate:    1.1 | accuracy: 0.05
step_num: 13000 | loss: 0.0286 | profit rate:    1.2 | accuracy: 0.08
step_num: 13200 | loss: 0.0855 | profit rate:    2.1 | accuracy: 0.14
step_num: 13400 | loss: 0.1165 | profit rate:    2.0 | accuracy: 0.17
step_num: 13600 | loss: 0.0851 | profit rate:    1.8 | accuracy: 0.16
step_num: 13800 | loss: 0.0782 | profit rate:   15.5 | accuracy: 0.16
step_num: 14000 | loss: 0.0730 | profit rate:   12.6 | accuracy: 0.16
step_num: 14200 | loss: 0.1246 | profit rate:   29.9 | accuracy: 0.18
step_num: 14400 | loss: 0.0928 | profit rate:   59.0 | accuracy: 0.19
step_num: 14600 | loss: 0.0913 | profit rate:  127.0 | accuracy: 0.19
step_num: 14800 | loss: 0.1022 | profit rate:  170.1 | accuracy: 0.18
step_num: 15000 | loss: 0.0844 | profit rate:  360.4 | accuracy: 0.18
step_num: 15200 | loss: 0.0680 | profit rate:  513.7 | accuracy: 0.18
step_num: 15400 | loss: 0.0608 | profit rate:  723.7 | accuracy: 0.17
step_num: 15600 | loss: 0.0612 | profit rate:  974.1 | accuracy: 0.17
episode:   5/8,耗时:1.13分/5.53分,训练集: | step: 15780 | average_treward:  155.8 | max_treward: 291.2144 | average profit rate: 435.306
model saved @ step:15780,performance:1398.121,accuracy:0.17
step_num: 15800 | loss: 0.0685 | profit rate:    1.0 | accuracy: 0.05
step_num: 16000 | loss: 0.0658 | profit rate:    1.3 | accuracy: 0.10
step_num: 16200 | loss: 0.0731 | profit rate:    1.4 | accuracy: 0.12
step_num: 16400 | loss: 0.0647 | profit rate:    1.0 | accuracy: 0.14
step_num: 16600 | loss: 0.0727 | profit rate:    1.9 | accuracy: 0.14
step_num: 16800 | loss: 0.0659 | profit rate:    2.3 | accuracy: 0.14
step_num: 17000 | loss: 0.0987 | profit rate:    8.6 | accuracy: 0.15
step_num: 17200 | loss: 0.1029 | profit rate:    9.6 | accuracy: 0.15
step_num: 17400 | loss: 0.1333 | profit rate:   19.2 | accuracy: 0.17
step_num: 17600 | loss: 0.1570 | profit rate:   33.1 | accuracy: 0.19
step_num: 17800 | loss: 0.1121 | profit rate:  112.5 | accuracy: 0.19
step_num: 18000 | loss: 0.0880 | profit rate:  127.9 | accuracy: 0.19
step_num: 18200 | loss: 0.0879 | profit rate:  253.9 | accuracy: 0.19
step_num: 18400 | loss: 0.0912 | profit rate:  266.7 | accuracy: 0.19
step_num: 18600 | loss: 0.1052 | profit rate:  367.6 | accuracy: 0.18
step_num: 18800 | loss: 0.1339 | profit rate:  518.2 | accuracy: 0.19
model saved @ step:18936,performance:489.510,accuracy:0.19
step_num: 19000 | loss: 0.0963 | profit rate:    1.2 | accuracy: 0.14
step_num: 19200 | loss: 0.0926 | profit rate:    1.5 | accuracy: 0.15
step_num: 19400 | loss: 0.0662 | profit rate:    1.5 | accuracy: 0.15
step_num: 19600 | loss: 0.0947 | profit rate:    1.0 | accuracy: 0.14
step_num: 19800 | loss: 0.0623 | profit rate:    1.2 | accuracy: 0.14
step_num: 20000 | loss: 0.0772 | profit rate:    1.9 | accuracy: 0.14
step_num: 20200 | loss: 0.1248 | profit rate:    4.2 | accuracy: 0.14
step_num: 20400 | loss: 0.1121 | profit rate:    6.7 | accuracy: 0.14
step_num: 20600 | loss: 0.0769 | profit rate:   13.5 | accuracy: 0.15
step_num: 20800 | loss: 0.1167 | profit rate:   70.3 | accuracy: 0.16
step_num: 21000 | loss: 0.1069 | profit rate:  100.0 | accuracy: 0.16
step_num: 21200 | loss: 0.0797 | profit rate:  149.8 | accuracy: 0.16
step_num: 21400 | loss: 0.0493 | profit rate:  299.9 | accuracy: 0.16
step_num: 21600 | loss: 0.0517 | profit rate:  342.8 | accuracy: 0.15
step_num: 21800 | loss: 0.0632 | profit rate:  420.0 | accuracy: 0.15
step_num: 22000 | loss: 0.0693 | profit rate:  639.0 | accuracy: 0.15
episode:   7/8,耗时:1.12分/7.76分,训练集: | step: 22092 | average_treward:  189.0 | max_treward: 294.9670 | average profit rate: 489.266
step_num: 22200 | loss: 0.0704 | profit rate:    1.4 | accuracy: 0.17
step_num: 22400 | loss: 0.0545 | profit rate:    1.9 | accuracy: 0.14
step_num: 22600 | loss: 0.0852 | profit rate:    2.7 | accuracy: 0.17
step_num: 22800 | loss: 0.0977 | profit rate:    4.1 | accuracy: 0.21
step_num: 23000 | loss: 0.0783 | profit rate:    3.6 | accuracy: 0.20
step_num: 23200 | loss: 0.0801 | profit rate:   16.1 | accuracy: 0.20
step_num: 23400 | loss: 0.0938 | profit rate:   15.1 | accuracy: 0.19
step_num: 23600 | loss: 0.0688 | profit rate:   25.2 | accuracy: 0.19
step_num: 23800 | loss: 0.1273 | profit rate:  311.6 | accuracy: 0.21
step_num: 24000 | loss: 0.1218 | profit rate: 1517.0 | accuracy: 0.22
step_num: 24200 | loss: 0.1163 | profit rate: 2181.7 | accuracy: 0.21
step_num: 24400 | loss: 0.0785 | profit rate: 9340.3 | accuracy: 0.21
step_num: 24600 | loss: 0.0678 | profit rate: 19283.5 | accuracy: 0.21
step_num: 24800 | loss: 0.0594 | profit rate: 35886.2 | accuracy: 0.21
step_num: 25000 | loss: 0.1164 | profit rate: 46023.9 | accuracy: 0.20
step_num: 25200 | loss: 0.0957 | profit rate: 101502.5 | accuracy: 0.20
model saved @ step:25248,performance:107628.532,accuracy:0.20
----------------------------------------finished----------------------------------------
  0%|          | 0/312 [00:00<?, ?it/s] 30%|       | 95/312 [00:00<00:00, 948.77it/s] 65%|   | 203/312 [00:00<00:00, 1013.95it/s]100%|| 312/312 [00:00<00:00, 1032.67it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-12T12:00:00 | *** GOING LONG ***
2023-01-12T12:00:00's price 18846.6191, buy 0.05300685 units.
2023-01-12T12:00:00 | current balance = 0.00
2023-01-12T12:00:00 | balance:0.00+units:0.05300685*price:18846.6191=net_wealth:999.0010
--------------------------------------------------
2023-01-13T00:00:00 | *** GOING SHORT ***
2023-01-13T00:00:00's price 18920.9492, sell 0.05300685 units.
2023-01-13T00:00:00 | current balance = 1001.94
2023-01-13T00:00:00 | balance:1001.94+units:0.0*price:18920.9492=net_wealth:1001.9381
--------------------------------------------------
2023-01-21T12:00:00 | *** GOING LONG ***
2023-01-21T12:00:00's price 22783.5508, buy 0.0439324 units.
2023-01-21T12:00:00 | current balance = 0.00
2023-01-21T12:00:00 | balance:0.00+units:0.0439324*price:22783.5508=net_wealth:1000.9371
--------------------------------------------------
2023-01-23T12:00:00 | *** GOING SHORT ***
2023-01-23T12:00:00's price 22916.4492, sell 0.0439324 units.
2023-01-23T12:00:00 | current balance = 1005.77
2023-01-23T12:00:00 | balance:1005.77+units:0.0*price:22916.4492=net_wealth:1005.7689
--------------------------------------------------
2023-01-30T12:00:00 | *** GOING LONG ***
2023-01-30T12:00:00's price 22826.1504, buy 0.04401807 units.
2023-01-30T12:00:00 | current balance = 0.00
2023-01-30T12:00:00 | balance:0.00+units:0.04401807*price:22826.1504=net_wealth:1004.7641
--------------------------------------------------
2023-01-31T00:00:00 | *** GOING SHORT ***
2023-01-31T00:00:00's price 22865.4297, sell 0.04401807 units.
2023-01-31T00:00:00 | current balance = 1005.49
2023-01-31T00:00:00 | balance:1005.49+units:0.0*price:22865.4297=net_wealth:1005.4866
--------------------------------------------------
2023-02-03T00:00:00 | *** GOING LONG ***
2023-02-03T00:00:00's price 23534.1309, buy 0.04268188 units.
2023-02-03T00:00:00 | current balance = 0.00
2023-02-03T00:00:00 | balance:0.00+units:0.04268188*price:23534.1309=net_wealth:1004.4822
--------------------------------------------------
2023-02-07T00:00:00 | *** GOING SHORT ***
2023-02-07T00:00:00's price 22977.2402, sell 0.04268188 units.
2023-02-07T00:00:00 | current balance = 979.73
2023-02-07T00:00:00 | balance:979.73+units:0.0*price:22977.2402=net_wealth:979.7323
--------------------------------------------------
2023-02-07T12:00:00 | *** GOING LONG ***
2023-02-07T12:00:00's price 23240.4609, buy 0.04211416 units.
2023-02-07T12:00:00 | current balance = 0.00
2023-02-07T12:00:00 | balance:0.00+units:0.04211416*price:23240.4609=net_wealth:978.7536
--------------------------------------------------
2023-02-18T00:00:00 | *** GOING SHORT ***
2023-02-18T00:00:00's price 24519.4199, sell 0.04211416 units.
2023-02-18T00:00:00 | current balance = 1031.58
2023-02-18T00:00:00 | balance:1031.58+units:0.0*price:24519.4199=net_wealth:1031.5832
--------------------------------------------------
2023-02-20T00:00:00 | *** GOING LONG ***
2023-02-20T00:00:00's price 24890.0000, buy 0.04140424 units.
2023-02-20T00:00:00 | current balance = 0.00
2023-02-20T00:00:00 | balance:0.00+units:0.04140424*price:24890.0000=net_wealth:1030.5527
--------------------------------------------------
2023-02-21T00:00:00 | *** GOING SHORT ***
2023-02-21T00:00:00's price 24572.8301, sell 0.04140424 units.
2023-02-21T00:00:00 | current balance = 1016.40
2023-02-21T00:00:00 | balance:1016.40+units:0.0*price:24572.8301=net_wealth:1016.4031
--------------------------------------------------
2023-02-23T12:00:00 | *** GOING LONG ***
2023-02-23T12:00:00's price 23940.1992, buy 0.04241345 units.
2023-02-23T12:00:00 | current balance = 0.00
2023-02-23T12:00:00 | balance:0.00+units:0.04241345*price:23940.1992=net_wealth:1015.3877
--------------------------------------------------
2023-02-25T12:00:00 | *** GOING SHORT ***
2023-02-25T12:00:00's price 23157.0703, sell 0.04241345 units.
2023-02-25T12:00:00 | current balance = 981.19
2023-02-25T12:00:00 | balance:981.19+units:0.0*price:23157.0703=net_wealth:981.1903
--------------------------------------------------
2023-02-27T12:00:00 | *** GOING LONG ***
2023-02-27T12:00:00's price 23492.0898, buy 0.04172507 units.
2023-02-27T12:00:00 | current balance = 0.00
2023-02-27T12:00:00 | balance:0.00+units:0.04172507*price:23492.0898=net_wealth:980.2101
--------------------------------------------------
2023-02-28T00:00:00 | *** GOING SHORT ***
2023-02-28T00:00:00's price 23392.6895, sell 0.04172507 units.
2023-02-28T00:00:00 | current balance = 975.09
2023-02-28T00:00:00 | balance:975.09+units:0.0*price:23392.6895=net_wealth:975.0866
--------------------------------------------------
2023-03-13T00:00:00 | *** GOING LONG ***
2023-03-13T00:00:00's price 22106.6406, buy 0.0440642 units.
2023-03-13T00:00:00 | current balance = 0.00
2023-03-13T00:00:00 | balance:0.00+units:0.0440642*price:22106.6406=net_wealth:974.1125
--------------------------------------------------
2023-03-15T12:00:00 | *** GOING SHORT ***
2023-03-15T12:00:00's price 24285.6602, sell 0.0440642 units.
2023-03-15T12:00:00 | current balance = 1069.06
2023-03-15T12:00:00 | balance:1069.06+units:0.0*price:24285.6602=net_wealth:1069.0591
--------------------------------------------------
2023-03-17T12:00:00 | *** GOING LONG ***
2023-03-17T12:00:00's price 27395.1309, buy 0.03898466 units.
2023-03-17T12:00:00 | current balance = 0.00
2023-03-17T12:00:00 | balance:0.00+units:0.03898466*price:27395.1309=net_wealth:1067.9911
--------------------------------------------------
2023-03-21T00:00:00 | *** GOING SHORT ***
2023-03-21T00:00:00's price 28040.1309, sell 0.03898466 units.
2023-03-21T00:00:00 | current balance = 1092.04
2023-03-21T00:00:00 | balance:1092.04+units:0.0*price:28040.1309=net_wealth:1092.0431
--------------------------------------------------
2023-03-22T12:00:00 | *** GOING LONG ***
2023-03-22T12:00:00's price 27250.9707, buy 0.04003347 units.
2023-03-22T12:00:00 | current balance = 0.00
2023-03-22T12:00:00 | balance:0.00+units:0.04003347*price:27250.9707=net_wealth:1090.9521
--------------------------------------------------
2023-03-24T00:00:00 | *** GOING SHORT ***
2023-03-24T00:00:00's price 28080.0000, sell 0.04003347 units.
2023-03-24T00:00:00 | current balance = 1123.02
2023-03-24T00:00:00 | balance:1123.02+units:0.0*price:28080.0000=net_wealth:1123.0169
--------------------------------------------------
2023-03-24T12:00:00 | *** GOING LONG ***
2023-03-24T12:00:00's price 27454.4707, buy 0.040863790000000004 units.
2023-03-24T12:00:00 | current balance = 0.00
2023-03-24T12:00:00 | balance:0.00+units:0.040863790000000004*price:27454.4707=net_wealth:1121.8950
--------------------------------------------------
2023-03-27T12:00:00 | *** GOING SHORT ***
2023-03-27T12:00:00's price 27124.9102, sell 0.040863790000000004 units.
2023-03-27T12:00:00 | current balance = 1107.32
2023-03-27T12:00:00 | balance:1107.32+units:0.0*price:27124.9102=net_wealth:1107.3195
--------------------------------------------------
2023-03-28T00:00:00 | *** GOING LONG ***
2023-03-28T00:00:00's price 27057.3594, buy 0.040883960000000004 units.
2023-03-28T00:00:00 | current balance = 0.00
2023-03-28T00:00:00 | balance:0.00+units:0.040883960000000004*price:27057.3594=net_wealth:1106.2133
--------------------------------------------------
2023-04-02T12:00:00 | *** GOING SHORT ***
2023-04-02T12:00:00's price 28171.8691, sell 0.040883960000000004 units.
2023-04-02T12:00:00 | current balance = 1150.63
2023-04-02T12:00:00 | balance:1150.63+units:0.0*price:28171.8691=net_wealth:1150.6271
--------------------------------------------------
2023-04-09T00:00:00 | *** GOING LONG ***
2023-04-09T00:00:00's price 27930.1992, buy 0.04115532 units.
2023-04-09T00:00:00 | current balance = 0.00
2023-04-09T00:00:00 | balance:0.00+units:0.04115532*price:27930.1992=net_wealth:1149.4776
--------------------------------------------------
2023-04-10T12:00:00 | *** GOING SHORT ***
2023-04-10T12:00:00's price 29637.3398, sell 0.04115532 units.
2023-04-10T12:00:00 | current balance = 1218.52
2023-04-10T12:00:00 | balance:1218.52+units:0.0*price:29637.3398=net_wealth:1218.5158
--------------------------------------------------
2023-04-11T12:00:00 | *** GOING LONG ***
2023-04-11T12:00:00's price 30200.4199, buy 0.04030729 units.
2023-04-11T12:00:00 | current balance = 0.00
2023-04-11T12:00:00 | balance:0.00+units:0.04030729*price:30200.4199=net_wealth:1217.2985
--------------------------------------------------
2023-04-13T00:00:00 | *** GOING SHORT ***
2023-04-13T00:00:00's price 30159.8203, sell 0.04030729 units.
2023-04-13T00:00:00 | current balance = 1214.45
2023-04-13T00:00:00 | balance:1214.45+units:0.0*price:30159.8203=net_wealth:1214.4463
--------------------------------------------------
2023-04-21T00:00:00 | *** GOING LONG ***
2023-04-21T00:00:00's price 28066.2109, buy 0.04322749 units.
2023-04-21T00:00:00 | current balance = 0.00
2023-04-21T00:00:00 | balance:0.00+units:0.04322749*price:28066.2109=net_wealth:1213.2331
--------------------------------------------------
2023-04-27T12:00:00 | *** GOING SHORT ***
2023-04-27T12:00:00's price 29472.7695, sell 0.04322749 units.
2023-04-27T12:00:00 | current balance = 1272.76
2023-04-27T12:00:00 | balance:1272.76+units:0.0*price:29472.7695=net_wealth:1272.7611
--------------------------------------------------
2023-04-30T12:00:00 | *** GOING LONG ***
2023-04-30T12:00:00's price 29233.2109, buy 0.04349465 units.
2023-04-30T12:00:00 | current balance = 0.00
2023-04-30T12:00:00 | balance:0.00+units:0.04349465*price:29233.2109=net_wealth:1271.4896
--------------------------------------------------
2023-05-04T12:00:00 | *** GOING SHORT ***
2023-05-04T12:00:00's price 28838.1602, sell 0.04349465 units.
2023-05-04T12:00:00 | current balance = 1253.05
2023-05-04T12:00:00 | balance:1253.05+units:0.0*price:28838.1602=net_wealth:1253.0527
--------------------------------------------------
2023-05-08T00:00:00 | *** GOING LONG ***
2023-05-08T00:00:00's price 27934.0898, buy 0.04481261 units.
2023-05-08T00:00:00 | current balance = 0.00
2023-05-08T00:00:00 | balance:0.00+units:0.04481261*price:27934.0898=net_wealth:1251.8009
--------------------------------------------------
2023-05-09T12:00:00 | *** GOING SHORT ***
2023-05-09T12:00:00's price 27628.2695, sell 0.04481261 units.
2023-05-09T12:00:00 | current balance = 1236.86
2023-05-09T12:00:00 | balance:1236.86+units:0.0*price:27628.2695=net_wealth:1236.8582
--------------------------------------------------
2023-05-16T00:00:00 | *** GOING LONG ***
2023-05-16T00:00:00's price 27059.0293, buy 0.04566391 units.
2023-05-16T00:00:00 | current balance = 0.00
2023-05-16T00:00:00 | balance:0.00+units:0.04566391*price:27059.0293=net_wealth:1235.6226
--------------------------------------------------
2023-05-22T00:00:00 | *** GOING SHORT ***
2023-05-22T00:00:00's price 26826.7793, sell 0.04566391 units.
2023-05-22T00:00:00 | current balance = 1223.79
2023-05-22T00:00:00 | balance:1223.79+units:0.0*price:26826.7793=net_wealth:1223.7921
==================================================
2023-06-08T12:00:00 | *** CLOSING OUT ***
2023-06-08T12:00:00's price 26599.7891, 0.0 unit trades .
2023-06-08T12:00:00 | current balance = 1223.79
2023-06-08T12:00:00 | net performance [%] = 22.3792
2023-06-08T12:00:00 | number of trades [#] = 38
==================================================
Trial 25 Complete [00h 08m 55s]
net_wealth: 1223.7921067500463

Best net_wealth So Far: 1523.8896368924688
Total elapsed time: 03h 22m 54s
Results summary
Results in saved_model\keras_tuner
Showing 10 best trials
Objective(name="net_wealth", direction="max")

Trial 08 summary
Hyperparameters:
horizon: 8
lookback: 225
MarketFactor: True
lags: 14
gamma: 0.98
memory_size: 32
batch_size: 16
n_steps: 32
gae_lambda: 0.98
gradient_clip_: 2.0
epochs: 5
Score: 1523.8896368924688

Trial 04 summary
Hyperparameters:
horizon: 6
lookback: 225
MarketFactor: True
lags: 7
gamma: 0.98
memory_size: 64
batch_size: 32
n_steps: 10
gae_lambda: 0.98
gradient_clip_: 2.0
epochs: 3
Score: 1460.00206518385

Trial 02 summary
Hyperparameters:
horizon: 2
lookback: 225
MarketFactor: False
lags: 30
gamma: 0.6
memory_size: 256
batch_size: 16
n_steps: 20
gae_lambda: 0.97
gradient_clip_: 2.0
epochs: 3
Score: 1366.5272203871461

Trial 16 summary
Hyperparameters:
horizon: 2
lookback: 730
MarketFactor: True
lags: 14
gamma: 0.7
memory_size: 2000
batch_size: 16
n_steps: 64
gae_lambda: 0.96
gradient_clip_: 0.5
epochs: 5
Score: 1263.1671814392112

Trial 19 summary
Hyperparameters:
horizon: 2
lookback: 365
MarketFactor: False
lags: 14
gamma: 0.98
memory_size: 32
batch_size: 32
n_steps: 64
gae_lambda: 0.97
gradient_clip_: 0.2
epochs: 3
Score: 1252.286675472939

Trial 23 summary
Hyperparameters:
horizon: 14
lookback: 365
MarketFactor: False
lags: 20
gamma: 0.98
memory_size: 32
batch_size: 32
n_steps: 20
gae_lambda: 0.97
gradient_clip_: 10.0
epochs: 3
Score: 1234.1611280141574

Trial 24 summary
Hyperparameters:
horizon: 4
lookback: 730
MarketFactor: True
lags: 7
gamma: 0.8
memory_size: 512
batch_size: 16
n_steps: 128
gae_lambda: 0.97
gradient_clip_: 2.0
epochs: 5
Score: 1223.7921067500463

Trial 01 summary
Hyperparameters:
horizon: 8
lookback: 365
MarketFactor: True
lags: 20
gamma: 0.92
memory_size: 64
batch_size: 16
n_steps: 256
gae_lambda: 0.96
gradient_clip_: 5.0
epochs: 3
Score: 1186.8667195638236

Trial 06 summary
Hyperparameters:
horizon: 2
lookback: 365
MarketFactor: False
lags: 5
gamma: 0.95
memory_size: 32
batch_size: 32
n_steps: 32
gae_lambda: 0.98
gradient_clip_: 1.0
epochs: 5
Score: 1167.8847088245016

Trial 10 summary
Hyperparameters:
horizon: 8
lookback: 225
MarketFactor: False
lags: 20
gamma: 0.92
memory_size: 256
batch_size: 32
n_steps: 256
gae_lambda: 0.98
gradient_clip_: 1.0
epochs: 5
Score: 1122.480495379946
None
   horizon  lookback  MarketFactor  ...  gradient_clip_  epochs        score
0        8       225          True  ...             2.0       5  1523.889637
1        6       225          True  ...             2.0       3  1460.002065
2        2       225         False  ...             2.0       3  1366.527220
3        2       730          True  ...             0.5       5  1263.167181
4        2       365         False  ...             0.2       3  1252.286675
5       14       365         False  ...            10.0       3  1234.161128
6        4       730          True  ...             2.0       5  1223.792107
7        8       365          True  ...             5.0       3  1186.866720
8        2       365         False  ...             1.0       5  1167.884709
9        8       225         False  ...             1.0       5  1122.480495

[10 rows x 12 columns]
