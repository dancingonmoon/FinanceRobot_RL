
Search: Running Trial #1

default configuration

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4000.000000     4000.000000  ...    3998.000000   4000.000000
mean      0.000426    19495.007760  ...   19546.633939  19539.018967
std       0.028529    16512.401386  ...   16545.479841  16544.846301
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009987     7350.115240  ...    7388.430176   7381.677368
50%       0.000789    10706.818994  ...   10872.345215  10860.569824
75%       0.012261    30336.414380  ...   30354.480469  30331.140625
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 8 columns]
2023-06-22 21:04:50.221916: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-22 21:04:50.223363: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
step_num: 200 | loss: 0.5622 | profit rate:    1.1 | accuracy: 0.38
step_num: 400 | loss: 0.6871 | profit rate:    0.5 | accuracy: 0.32
step_num: 600 | loss: 0.5220 | profit rate:    0.2 | accuracy: 0.32
step_num: 800 | loss: 0.5122 | profit rate:    0.2 | accuracy: 0.31
step_num: 1000 | loss: 0.5325 | profit rate:    0.3 | accuracy: 0.33
step_num: 1200 | loss: 0.4581 | profit rate:    1.2 | accuracy: 0.36
step_num: 1400 | loss: 0.4905 | profit rate:    0.9 | accuracy: 0.36
step_num: 1600 | loss: 0.7427 | profit rate:    0.4 | accuracy: 0.36
step_num: 1800 | loss: 0.5361 | profit rate:    1.3 | accuracy: 0.37
step_num: 2000 | loss: 0.5170 | profit rate:    1.1 | accuracy: 0.38
step_num: 2200 | loss: 0.6633 | profit rate:    3.1 | accuracy: 0.39
step_num: 2400 | loss: 0.4636 | profit rate:    3.6 | accuracy: 0.40
step_num: 2600 | loss: 0.5923 | profit rate:    1.9 | accuracy: 0.40
step_num: 2800 | loss: 0.4712 | profit rate:    3.6 | accuracy: 0.41
step_num: 3000 | loss: 0.4604 | profit rate:    1.9 | accuracy: 0.41
step_num: 3200 | loss: 0.5080 | profit rate:    1.1 | accuracy: 0.41
step_num: 3400 | loss: 0.5464 | profit rate:    1.8 | accuracy: 0.41
step_num: 3600 | loss: 0.3188 | profit rate:    1.7 | accuracy: 0.41
episode:   1/8,耗时:2.49分/2.49分,训练集: | step: 3677 | average_treward:   66.1 | max_treward: 66.1028 | average profit rate:  1.860
model saved @ step:3677,performance:1.860,accuracy:0.41
step_num: 3800 | loss: 0.7599 | profit rate:    0.1 | accuracy: 0.39
step_num: 4000 | loss: 0.6007 | profit rate:    0.1 | accuracy: 0.44
step_num: 4200 | loss: 0.5401 | profit rate:    0.1 | accuracy: 0.43
step_num: 4400 | loss: 0.6823 | profit rate:    0.1 | accuracy: 0.43
step_num: 4600 | loss: 0.4744 | profit rate:    0.1 | accuracy: 0.42
step_num: 4800 | loss: 0.7858 | profit rate:    0.3 | accuracy: 0.45
step_num: 5000 | loss: 0.4044 | profit rate:    0.2 | accuracy: 0.45
step_num: 5200 | loss: 0.4868 | profit rate:    0.2 | accuracy: 0.45
step_num: 5400 | loss: 0.5057 | profit rate:    0.2 | accuracy: 0.45
step_num: 5600 | loss: 0.4658 | profit rate:    0.2 | accuracy: 0.46
step_num: 5800 | loss: 0.5085 | profit rate:    0.3 | accuracy: 0.46
step_num: 6000 | loss: 0.7287 | profit rate:    2.5 | accuracy: 0.47
step_num: 6200 | loss: 0.8147 | profit rate:    1.2 | accuracy: 0.47
step_num: 6400 | loss: 0.5762 | profit rate:    0.9 | accuracy: 0.47
step_num: 6600 | loss: 0.5523 | profit rate:    1.8 | accuracy: 0.47
step_num: 6800 | loss: 0.3982 | profit rate:    1.3 | accuracy: 0.46
step_num: 7000 | loss: 0.3936 | profit rate:    2.9 | accuracy: 0.46
step_num: 7200 | loss: 0.2456 | profit rate:    3.3 | accuracy: 0.45
model saved @ step:7354,performance:6.332,accuracy:0.45
step_num: 7400 | loss: 0.8664 | profit rate:    0.8 | accuracy: 0.51
step_num: 7600 | loss: 0.4987 | profit rate:    0.3 | accuracy: 0.38
step_num: 7800 | loss: 0.4360 | profit rate:    0.4 | accuracy: 0.36
step_num: 8000 | loss: 0.1574 | profit rate:    0.3 | accuracy: 0.34
step_num: 8200 | loss: 0.2524 | profit rate:    0.3 | accuracy: 0.34
step_num: 8400 | loss: 0.5772 | profit rate:    1.0 | accuracy: 0.36
step_num: 8600 | loss: 0.4721 | profit rate:    0.8 | accuracy: 0.38
step_num: 8800 | loss: 0.1674 | profit rate:    1.3 | accuracy: 0.36
step_num: 9000 | loss: 0.6484 | profit rate:    2.3 | accuracy: 0.36
step_num: 9200 | loss: 0.5480 | profit rate:    1.4 | accuracy: 0.36
step_num: 9400 | loss: 0.2854 | profit rate:    1.3 | accuracy: 0.37
step_num: 9600 | loss: 0.5653 | profit rate:    9.8 | accuracy: 0.39
step_num: 9800 | loss: 0.6035 | profit rate:   17.1 | accuracy: 0.40
step_num: 10000 | loss: 0.2280 | profit rate:    9.4 | accuracy: 0.39
step_num: 10200 | loss: 0.6223 | profit rate:    8.5 | accuracy: 0.39
step_num: 10400 | loss: 0.3637 | profit rate:    8.1 | accuracy: 0.39
step_num: 10600 | loss: 0.6088 | profit rate:    8.5 | accuracy: 0.39
step_num: 10800 | loss: 0.0791 | profit rate:   20.5 | accuracy: 0.38
step_num: 11000 | loss: 0.1928 | profit rate:   24.6 | accuracy: 0.37
episode:   3/8,耗时:2.63分/8.01分,训练集: | step: 11031 | average_treward:  140.1 | max_treward: 199.9347 | average profit rate: 10.802
model saved @ step:11031,performance:24.214,accuracy:0.37
step_num: 11200 | loss: 0.0015 | profit rate:    0.1 | accuracy: 0.31
step_num: 11400 | loss: 0.1970 | profit rate:    0.2 | accuracy: 0.22
step_num: 11600 | loss: 0.2091 | profit rate:    0.1 | accuracy: 0.24
step_num: 11800 | loss: 0.4653 | profit rate:    0.1 | accuracy: 0.26
step_num: 12000 | loss: 0.3126 | profit rate:    0.2 | accuracy: 0.26
step_num: 12200 | loss: 0.7046 | profit rate:    0.6 | accuracy: 0.31
step_num: 12400 | loss: 0.4416 | profit rate:    0.7 | accuracy: 0.32
step_num: 12600 | loss: 0.4566 | profit rate:    0.9 | accuracy: 0.32
step_num: 12800 | loss: 0.4477 | profit rate:    0.8 | accuracy: 0.32
step_num: 13000 | loss: 0.5301 | profit rate:    0.8 | accuracy: 0.34
step_num: 13200 | loss: 0.4152 | profit rate:    1.4 | accuracy: 0.35
step_num: 13400 | loss: 0.4999 | profit rate:   10.6 | accuracy: 0.37
step_num: 13600 | loss: 0.5250 | profit rate:    5.2 | accuracy: 0.37
step_num: 13800 | loss: 0.6103 | profit rate:    3.9 | accuracy: 0.37
step_num: 14000 | loss: 0.2347 | profit rate:    4.9 | accuracy: 0.37
step_num: 14200 | loss: 0.3503 | profit rate:    3.7 | accuracy: 0.37
step_num: 14400 | loss: 0.2994 | profit rate:    9.6 | accuracy: 0.37
step_num: 14600 | loss: 0.1064 | profit rate:    9.5 | accuracy: 0.35
model saved @ step:14708,performance:9.510,accuracy:0.35
step_num: 14800 | loss: 0.7035 | profit rate:    0.2 | accuracy: 0.45
step_num: 15000 | loss: 0.1021 | profit rate:    0.1 | accuracy: 0.19
step_num: 15200 | loss: 0.3301 | profit rate:    0.1 | accuracy: 0.20
step_num: 15400 | loss: 0.3456 | profit rate:    0.1 | accuracy: 0.20
step_num: 15600 | loss: 0.1558 | profit rate:    0.1 | accuracy: 0.22
step_num: 15800 | loss: 0.5215 | profit rate:    0.4 | accuracy: 0.26
step_num: 16000 | loss: 0.0386 | profit rate:    0.4 | accuracy: 0.28
step_num: 16200 | loss: 0.3028 | profit rate:    0.5 | accuracy: 0.27
step_num: 16400 | loss: 0.3048 | profit rate:    0.7 | accuracy: 0.28
step_num: 16600 | loss: 0.3464 | profit rate:    0.8 | accuracy: 0.29
step_num: 16800 | loss: 0.2058 | profit rate:    1.0 | accuracy: 0.30
step_num: 17000 | loss: 0.5394 | profit rate:    7.2 | accuracy: 0.33
step_num: 17200 | loss: 0.7206 | profit rate:    4.4 | accuracy: 0.34
step_num: 17400 | loss: 0.3003 | profit rate:    5.6 | accuracy: 0.33
step_num: 17600 | loss: 0.3990 | profit rate:    4.7 | accuracy: 0.34
step_num: 17800 | loss: 0.3734 | profit rate:    7.1 | accuracy: 0.34
step_num: 18000 | loss: 0.3156 | profit rate:    8.0 | accuracy: 0.34
step_num: 18200 | loss: 0.3182 | profit rate:    9.8 | accuracy: 0.34
episode:   5/8,耗时:2.62分/13.25分,训练集: | step: 18385 | average_treward:  189.1 | max_treward: 268.9950 | average profit rate: 10.187
model saved @ step:18385,performance:9.016,accuracy:0.33
step_num: 18400 | loss: 0.6347 | profit rate:    0.8 | accuracy: 0.44
step_num: 18600 | loss: 0.0537 | profit rate:    0.1 | accuracy: 0.24
step_num: 18800 | loss: 0.1607 | profit rate:    0.2 | accuracy: 0.21
step_num: 19000 | loss: 0.2807 | profit rate:    0.1 | accuracy: 0.21
step_num: 19200 | loss: 0.0651 | profit rate:    0.1 | accuracy: 0.23
step_num: 19400 | loss: 0.4954 | profit rate:    0.2 | accuracy: 0.24
step_num: 19600 | loss: 0.6389 | profit rate:    0.5 | accuracy: 0.29
step_num: 19800 | loss: 0.0016 | profit rate:    0.4 | accuracy: 0.27
step_num: 20000 | loss: 0.5355 | profit rate:    0.4 | accuracy: 0.28
step_num: 20200 | loss: 0.4066 | profit rate:    0.5 | accuracy: 0.28
step_num: 20400 | loss: 0.3585 | profit rate:    0.5 | accuracy: 0.30
step_num: 20600 | loss: 0.3975 | profit rate:    2.6 | accuracy: 0.31
step_num: 20800 | loss: 0.3737 | profit rate:    9.6 | accuracy: 0.33
step_num: 21000 | loss: 0.0328 | profit rate:    7.5 | accuracy: 0.33
step_num: 21200 | loss: 0.5268 | profit rate:    6.4 | accuracy: 0.33
step_num: 21400 | loss: 0.3245 | profit rate:    4.5 | accuracy: 0.33
step_num: 21600 | loss: 0.2030 | profit rate:    6.7 | accuracy: 0.33
step_num: 21800 | loss: 0.0624 | profit rate:    9.7 | accuracy: 0.32
step_num: 22000 | loss: 0.1476 | profit rate:    7.7 | accuracy: 0.31
step_num: 22200 | loss: 0.2182 | profit rate:    0.1 | accuracy: 0.31
step_num: 22400 | loss: 0.0675 | profit rate:    0.2 | accuracy: 0.17
step_num: 22600 | loss: 0.3037 | profit rate:    0.2 | accuracy: 0.19
step_num: 22800 | loss: 0.4071 | profit rate:    0.1 | accuracy: 0.20
step_num: 23000 | loss: 0.0279 | profit rate:    0.1 | accuracy: 0.19
step_num: 23200 | loss: 0.6367 | profit rate:    0.3 | accuracy: 0.25
step_num: 23400 | loss: 0.1529 | profit rate:    0.2 | accuracy: 0.26
step_num: 23600 | loss: 0.1593 | profit rate:    0.2 | accuracy: 0.25
step_num: 23800 | loss: 0.0744 | profit rate:    0.2 | accuracy: 0.26
step_num: 24000 | loss: 0.3283 | profit rate:    0.3 | accuracy: 0.26
step_num: 24200 | loss: 0.3471 | profit rate:    0.5 | accuracy: 0.27
step_num: 24400 | loss: 0.4144 | profit rate:    3.6 | accuracy: 0.29
step_num: 24600 | loss: 0.5592 | profit rate:    3.1 | accuracy: 0.31
step_num: 24800 | loss: 0.5505 | profit rate:    3.4 | accuracy: 0.31
step_num: 25000 | loss: 0.3512 | profit rate:    3.0 | accuracy: 0.32
step_num: 25200 | loss: 0.1305 | profit rate:    2.8 | accuracy: 0.31
step_num: 25400 | loss: 0.0618 | profit rate:    3.2 | accuracy: 0.31
step_num: 25600 | loss: 0.1474 | profit rate:    3.8 | accuracy: 0.30
episode:   7/8,耗时:2.66分/18.51分,训练集: | step: 25739 | average_treward:  210.6 | max_treward: 268.9950 | average profit rate:  8.892
step_num: 25800 | loss: 0.5586 | profit rate:    0.3 | accuracy: 0.44
step_num: 26000 | loss: 0.0711 | profit rate:    0.1 | accuracy: 0.16
step_num: 26200 | loss: 0.3114 | profit rate:    0.1 | accuracy: 0.18
step_num: 26400 | loss: 0.1000 | profit rate:    0.1 | accuracy: 0.19
step_num: 26600 | loss: 0.1346 | profit rate:    0.1 | accuracy: 0.22
step_num: 26800 | loss: 0.3994 | profit rate:    0.3 | accuracy: 0.25
step_num: 27000 | loss: 0.2572 | profit rate:    0.4 | accuracy: 0.29
step_num: 27200 | loss: 0.2095 | profit rate:    0.5 | accuracy: 0.28
step_num: 27400 | loss: 0.5828 | profit rate:    0.4 | accuracy: 0.29
step_num: 27600 | loss: 0.1941 | profit rate:    0.4 | accuracy: 0.28
step_num: 27800 | loss: 0.1869 | profit rate:    0.5 | accuracy: 0.29
step_num: 28000 | loss: 0.7594 | profit rate:    2.9 | accuracy: 0.31
step_num: 28200 | loss: 0.5287 | profit rate:    8.4 | accuracy: 0.33
step_num: 28400 | loss: 0.2424 | profit rate:    8.6 | accuracy: 0.33
step_num: 28600 | loss: 0.6493 | profit rate:    8.2 | accuracy: 0.33
step_num: 28800 | loss: 0.2823 | profit rate:    5.5 | accuracy: 0.33
step_num: 29000 | loss: 0.0019 | profit rate:    8.3 | accuracy: 0.32
step_num: 29200 | loss: 0.1390 | profit rate:    6.0 | accuracy: 0.31
step_num: 29400 | loss: 0.0904 | profit rate:    5.9 | accuracy: 0.30
model saved @ step:29416,performance:5.947,accuracy:0.30
----------------------------------------finished----------------------------------------
  0%|          | 0/91 [00:00<?, ?it/s] 14%|        | 13/91 [00:00<00:00, 126.19it/s] 54%|    | 49/91 [00:00<00:00, 258.68it/s] 93%|| 85/91 [00:00<00:00, 302.92it/s]100%|| 91/91 [00:00<00:00, 283.58it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-15T00:00:00 | *** GOING LONG ***
2023-01-15T00:00:00's price 20722.2305, buy 0.04820909 units.
2023-01-15T00:00:00 | current balance = 0.00
2023-01-15T00:00:00 | balance:0.00+units:0.04820909*price:20722.2305=net_wealth:999.0010
--------------------------------------------------
2023-01-29T12:00:00 | *** GOING SHORT ***
2023-01-29T12:00:00's price 23742.3008, sell 0.04820909 units.
2023-01-29T12:00:00 | current balance = 1143.45
2023-01-29T12:00:00 | balance:1143.45+units:0.0*price:23742.3008=net_wealth:1143.4512
--------------------------------------------------
2023-01-30T00:00:00 | *** GOING LONG ***
2023-01-30T00:00:00's price 23077.4707, buy 0.04949882 units.
2023-01-30T00:00:00 | current balance = 0.00
2023-01-30T00:00:00 | balance:0.00+units:0.04949882*price:23077.4707=net_wealth:1142.3089
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, sell 0.04949882 units.
2023-02-17T00:00:00 | current balance = 1179.00
2023-02-17T00:00:00 | net performance [%] = 17.8999
2023-02-17T00:00:00 | number of trades [#] = 4
==================================================
Trial 1 Complete [00h 21m 07s]
net_wealth: 1180.1795004171079

Best net_wealth So Far: 1180.1795004171079
Total elapsed time: 00h 21m 07s

Search: Running Trial #2

Value             |Best Value So Far |Hyperparameter
4                 |2                 |horizon
730               |225               |lookback
False             |False             |MarketFactor
14                |5                 |lags
0.7               |0.5               |gamma
64                |32                |memory_size
32                |16                |batch_size
128               |5                 |n_steps
0.98              |0.96              |gae_lambda
0.5               |0.2               |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4000.000000     4000.000000  ...    3996.000000   4000.000000
mean      0.000426    19495.007760  ...   19554.241191  19539.018967
std       0.028529    16512.401386  ...   16546.124577  16544.846301
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009987     7350.115240  ...    7390.417603   7381.677368
50%       0.000789    10706.818994  ...   10877.780273  10860.569824
75%       0.012261    30336.414380  ...   30373.890137  30331.140625
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 8 columns]
step_num: 200 | loss: 1.3368 | profit rate:    0.2 | accuracy: 0.23
step_num: 400 | loss: 0.4528 | profit rate:    0.2 | accuracy: 0.28
step_num: 600 | loss: 0.8538 | profit rate:    0.1 | accuracy: 0.27
step_num: 800 | loss: 0.6293 | profit rate:    0.1 | accuracy: 0.30
step_num: 1000 | loss: 0.5647 | profit rate:    0.0 | accuracy: 0.32
step_num: 1200 | loss: 0.7064 | profit rate:    0.1 | accuracy: 0.35
step_num: 1400 | loss: 0.5581 | profit rate:    0.1 | accuracy: 0.35
step_num: 1600 | loss: 0.1939 | profit rate:    0.1 | accuracy: 0.33
step_num: 1800 | loss: 0.5575 | profit rate:    1.1 | accuracy: 0.34
step_num: 2000 | loss: 0.6353 | profit rate:    0.8 | accuracy: 0.35
step_num: 2200 | loss: 0.3231 | profit rate:    0.6 | accuracy: 0.34
step_num: 2400 | loss: 0.3170 | profit rate:    0.4 | accuracy: 0.33
step_num: 2600 | loss: 0.6005 | profit rate:    0.8 | accuracy: 0.34
step_num: 2800 | loss: 0.4638 | profit rate:    0.7 | accuracy: 0.34
step_num: 3000 | loss: 0.3548 | profit rate:    1.0 | accuracy: 0.35
episode:   1/8,耗时:2.07分/2.07分,训练集: | step: 3163 | average_treward:   12.3 | max_treward: 12.2871 | average profit rate:  1.930
model saved @ step:3163,performance:1.930,accuracy:0.35
step_num: 3200 | loss: 0.5463 | profit rate:    1.4 | accuracy: 0.42
step_num: 3400 | loss: 0.2283 | profit rate:    3.8 | accuracy: 0.39
step_num: 3600 | loss: 0.5882 | profit rate:    1.5 | accuracy: 0.39
step_num: 3800 | loss: 0.9711 | profit rate:    3.1 | accuracy: 0.42
step_num: 4000 | loss: 0.6925 | profit rate:    1.0 | accuracy: 0.42
step_num: 4200 | loss: 0.2054 | profit rate:    1.1 | accuracy: 0.38
step_num: 4400 | loss: 0.2024 | profit rate:    3.2 | accuracy: 0.37
step_num: 4600 | loss: 0.5336 | profit rate:    2.6 | accuracy: 0.37
step_num: 4800 | loss: 0.1890 | profit rate:    0.8 | accuracy: 0.36
step_num: 5000 | loss: 0.6797 | profit rate:    1.8 | accuracy: 0.36
step_num: 5200 | loss: 0.8369 | profit rate:    0.4 | accuracy: 0.37
step_num: 5400 | loss: 0.6156 | profit rate:    0.3 | accuracy: 0.37
step_num: 5600 | loss: 0.3566 | profit rate:    0.3 | accuracy: 0.37
step_num: 5800 | loss: 0.1431 | profit rate:    0.2 | accuracy: 0.35
step_num: 6000 | loss: 0.6779 | profit rate:    0.2 | accuracy: 0.35
step_num: 6200 | loss: 0.6273 | profit rate:    0.3 | accuracy: 0.35
step_num: 6400 | loss: 0.4566 | profit rate:    1.7 | accuracy: 0.36
step_num: 6600 | loss: 0.7334 | profit rate:    5.1 | accuracy: 0.41
step_num: 6800 | loss: 0.4357 | profit rate:    1.7 | accuracy: 0.40
step_num: 7000 | loss: 0.7296 | profit rate:    5.5 | accuracy: 0.43
step_num: 7200 | loss: 0.4930 | profit rate:    1.2 | accuracy: 0.41
step_num: 7400 | loss: 0.0911 | profit rate:    0.9 | accuracy: 0.36
step_num: 7600 | loss: 0.1070 | profit rate:    1.2 | accuracy: 0.35
step_num: 7800 | loss: 0.3008 | profit rate:    2.3 | accuracy: 0.32
step_num: 8000 | loss: 0.3307 | profit rate:    0.6 | accuracy: 0.30
step_num: 8200 | loss: 0.0127 | profit rate:    0.3 | accuracy: 0.27
step_num: 8400 | loss: 0.3952 | profit rate:    0.2 | accuracy: 0.26
step_num: 8600 | loss: 0.1257 | profit rate:    0.3 | accuracy: 0.25
step_num: 8800 | loss: 0.0501 | profit rate:    0.2 | accuracy: 0.23
step_num: 9000 | loss: 0.0904 | profit rate:    0.9 | accuracy: 0.23
step_num: 9200 | loss: 0.6562 | profit rate:    0.2 | accuracy: 0.25
step_num: 9400 | loss: 0.5479 | profit rate:    0.6 | accuracy: 0.27
episode:   3/8,耗时:2.25分/6.46分,训练集: | step: 9489 | average_treward:   22.5 | max_treward: 62.7989 | average profit rate:  1.099
model saved @ step:9489,performance:0.644,accuracy:0.27
step_num: 9600 | loss: 0.2669 | profit rate:    2.0 | accuracy: 0.37
step_num: 9800 | loss: 0.5155 | profit rate:    7.7 | accuracy: 0.40
step_num: 10000 | loss: 0.2269 | profit rate:    1.4 | accuracy: 0.36
step_num: 10200 | loss: 0.4237 | profit rate:    1.3 | accuracy: 0.35
step_num: 10400 | loss: 0.1921 | profit rate:    1.2 | accuracy: 0.32
step_num: 10600 | loss: 0.2144 | profit rate:    0.8 | accuracy: 0.28
step_num: 10800 | loss: 0.0138 | profit rate:    2.3 | accuracy: 0.27
step_num: 11000 | loss: 0.0700 | profit rate:    2.6 | accuracy: 0.24
step_num: 11200 | loss: 0.1984 | profit rate:    1.0 | accuracy: 0.22
step_num: 11400 | loss: 0.0262 | profit rate:    0.6 | accuracy: 0.21
step_num: 11600 | loss: 0.1094 | profit rate:    0.3 | accuracy: 0.20
step_num: 11800 | loss: 0.0027 | profit rate:    0.7 | accuracy: 0.19
step_num: 12000 | loss: 0.1892 | profit rate:    0.9 | accuracy: 0.18
step_num: 12200 | loss: 0.4784 | profit rate:    0.5 | accuracy: 0.19
step_num: 12400 | loss: 0.3779 | profit rate:    0.5 | accuracy: 0.21
step_num: 12600 | loss: 0.4980 | profit rate:    0.7 | accuracy: 0.22
model saved @ step:12652,performance:0.895,accuracy:0.22
step_num: 12800 | loss: 0.1054 | profit rate:    1.0 | accuracy: 0.09
step_num: 13000 | loss: 0.6458 | profit rate:    2.2 | accuracy: 0.29
step_num: 13200 | loss: 0.1417 | profit rate:    2.0 | accuracy: 0.25
step_num: 13400 | loss: 0.1993 | profit rate:    1.3 | accuracy: 0.23
step_num: 13600 | loss: 0.0301 | profit rate:    1.1 | accuracy: 0.20
step_num: 13800 | loss: 0.3889 | profit rate:    1.7 | accuracy: 0.18
step_num: 14000 | loss: 0.0008 | profit rate:    2.4 | accuracy: 0.16
step_num: 14200 | loss: 0.0458 | profit rate:    2.4 | accuracy: 0.15
step_num: 14400 | loss: 0.1118 | profit rate:    1.7 | accuracy: 0.13
step_num: 14600 | loss: 0.0706 | profit rate:    1.6 | accuracy: 0.12
step_num: 14800 | loss: 0.0911 | profit rate:    2.6 | accuracy: 0.13
step_num: 15000 | loss: 0.0014 | profit rate:    3.5 | accuracy: 0.12
step_num: 15200 | loss: 0.4996 | profit rate:    4.0 | accuracy: 0.12
step_num: 15400 | loss: 0.7443 | profit rate:    2.7 | accuracy: 0.13
step_num: 15600 | loss: 0.0223 | profit rate:    1.3 | accuracy: 0.14
step_num: 15800 | loss: 0.0584 | profit rate:    1.3 | accuracy: 0.14
episode:   5/8,耗时:2.53分/11.31分,训练集: | step: 15815 | average_treward:   45.7 | max_treward: 89.4480 | average profit rate:  1.103
step_num: 16000 | loss: 0.0394 | profit rate:    0.9 | accuracy: 0.05
step_num: 16200 | loss: 0.1535 | profit rate:    1.4 | accuracy: 0.12
step_num: 16400 | loss: 0.1942 | profit rate:    2.4 | accuracy: 0.14
step_num: 16600 | loss: 0.1020 | profit rate:    1.7 | accuracy: 0.16
step_num: 16800 | loss: 0.0619 | profit rate:    1.8 | accuracy: 0.15
step_num: 17000 | loss: 0.5047 | profit rate:    6.5 | accuracy: 0.16
step_num: 17200 | loss: 0.0003 | profit rate:   11.8 | accuracy: 0.16
step_num: 17400 | loss: 0.0399 | profit rate:   12.5 | accuracy: 0.14
step_num: 17600 | loss: 0.8607 | profit rate:  213.6 | accuracy: 0.18
step_num: 17800 | loss: 0.7210 | profit rate:   77.2 | accuracy: 0.21
step_num: 18000 | loss: 0.2053 | profit rate:  123.6 | accuracy: 0.21
step_num: 18200 | loss: 0.0201 | profit rate:  148.5 | accuracy: 0.20
step_num: 18400 | loss: 0.3418 | profit rate:  118.0 | accuracy: 0.20
step_num: 18600 | loss: 0.2247 | profit rate:   31.9 | accuracy: 0.19
step_num: 18800 | loss: 0.2214 | profit rate:   53.8 | accuracy: 0.19
model saved @ step:18978,performance:54.476,accuracy:0.18
step_num: 19000 | loss: 0.0539 | profit rate:    0.9 | accuracy: 0.00
step_num: 19200 | loss: 0.0233 | profit rate:    0.9 | accuracy: 0.04
step_num: 19400 | loss: 0.1008 | profit rate:    1.1 | accuracy: 0.09
step_num: 19600 | loss: 0.3890 | profit rate:    1.3 | accuracy: 0.15
step_num: 19800 | loss: 0.0537 | profit rate:    0.7 | accuracy: 0.16
step_num: 20000 | loss: 0.1017 | profit rate:    0.6 | accuracy: 0.14
step_num: 20200 | loss: 0.1538 | profit rate:    1.9 | accuracy: 0.15
step_num: 20400 | loss: 0.0263 | profit rate:    3.2 | accuracy: 0.15
step_num: 20600 | loss: 0.0229 | profit rate:    4.6 | accuracy: 0.13
step_num: 20800 | loss: 0.5579 | profit rate:   60.2 | accuracy: 0.17
step_num: 21000 | loss: 0.9790 | profit rate:   13.4 | accuracy: 0.19
step_num: 21200 | loss: 0.0642 | profit rate:   18.1 | accuracy: 0.20
step_num: 21400 | loss: 0.2490 | profit rate:   19.7 | accuracy: 0.19
step_num: 21600 | loss: 0.3494 | profit rate:   33.8 | accuracy: 0.19
step_num: 21800 | loss: 0.5855 | profit rate:   16.8 | accuracy: 0.19
step_num: 22000 | loss: 0.6161 | profit rate:   32.4 | accuracy: 0.21
episode:   7/8,耗时:2.50分/16.18分,训练集: | step: 22141 | average_treward:   85.3 | max_treward: 189.9888 | average profit rate: 17.879
step_num: 22200 | loss: 0.2367 | profit rate:    1.0 | accuracy: 0.15
step_num: 22400 | loss: 0.6717 | profit rate:    2.7 | accuracy: 0.29
step_num: 22600 | loss: 0.4079 | profit rate:    1.4 | accuracy: 0.32
step_num: 22800 | loss: 0.5286 | profit rate:    9.4 | accuracy: 0.34
step_num: 23000 | loss: 0.2922 | profit rate:   10.7 | accuracy: 0.35
step_num: 23200 | loss: 0.2879 | profit rate:   12.2 | accuracy: 0.31
step_num: 23400 | loss: 0.1042 | profit rate:   30.7 | accuracy: 0.31
step_num: 23600 | loss: 0.2853 | profit rate:   55.3 | accuracy: 0.29
step_num: 23800 | loss: 0.5702 | profit rate:   44.0 | accuracy: 0.30
step_num: 24000 | loss: 0.7260 | profit rate: 3095.8 | accuracy: 0.34
step_num: 24200 | loss: 0.6076 | profit rate:  602.0 | accuracy: 0.35
step_num: 24400 | loss: 0.0405 | profit rate: 1342.9 | accuracy: 0.33
step_num: 24600 | loss: 0.0357 | profit rate: 1950.9 | accuracy: 0.31
step_num: 24800 | loss: 0.2154 | profit rate: 1736.9 | accuracy: 0.30
step_num: 25000 | loss: 0.5278 | profit rate:  861.7 | accuracy: 0.30
step_num: 25200 | loss: 0.2395 | profit rate:  216.5 | accuracy: 0.30
----------------------------------------finished----------------------------------------
  0%|          | 0/82 [00:00<?, ?it/s] 21%|        | 17/82 [00:00<00:00, 165.50it/s] 54%|    | 44/82 [00:00<00:00, 222.81it/s] 85%| | 70/82 [00:00<00:00, 235.43it/s]100%|| 82/82 [00:00<00:00, 226.02it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-18T12:00:00 | *** GOING LONG ***
2023-01-18T12:00:00's price 20677.4707, buy 0.04831345 units.
2023-01-18T12:00:00 | current balance = 0.00
2023-01-18T12:00:00 | balance:0.00+units:0.04831345*price:20677.4707=net_wealth:999.0010
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, sell 0.04831345 units.
2023-02-17T00:00:00 | current balance = 1150.77
2023-02-17T00:00:00 | net performance [%] = 15.0765
2023-02-17T00:00:00 | number of trades [#] = 2
==================================================
Trial 2 Complete [00h 18m 35s]
net_wealth: 1151.9169381535464

Best net_wealth So Far: 1180.1795004171079
Total elapsed time: 00h 39m 42s

Search: Running Trial #3

Value             |Best Value So Far |Hyperparameter
8                 |2                 |horizon
365               |225               |lookback
False             |False             |MarketFactor
14                |5                 |lags
0.7               |0.5               |gamma
2000              |32                |memory_size
32                |16                |batch_size
5                 |5                 |n_steps
0.97              |0.96              |gae_lambda
5                 |0.2               |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4000.000000     4000.000000  ...    3992.000000   4000.000000
mean      0.000426    19495.007760  ...   19569.323229  19539.018967
std       0.028529    16512.401386  ...   16547.547425  16544.846301
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009987     7350.115240  ...    7397.927368   7381.677368
50%       0.000789    10706.818994  ...   10891.359863  10860.569824
75%       0.012261    30336.414380  ...   30400.544434  30331.140625
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9187 | profit rate:    1.2 | accuracy: 0.34
step_num: 1200 | loss: 0.4726 | profit rate:    0.5 | accuracy: 0.34
step_num: 1400 | loss: 0.4586 | profit rate:    0.3 | accuracy: 0.34
step_num: 1600 | loss: 0.4344 | profit rate:    0.0 | accuracy: 0.33
step_num: 1800 | loss: 0.4326 | profit rate:    0.0 | accuracy: 0.33
step_num: 2000 | loss: 0.4050 | profit rate:    0.2 | accuracy: 0.34
step_num: 2200 | loss: 0.4297 | profit rate:    0.3 | accuracy: 0.35
step_num: 2400 | loss: 0.4244 | profit rate:    0.2 | accuracy: 0.35
step_num: 2600 | loss: 0.4212 | profit rate:    0.3 | accuracy: 0.35
step_num: 2800 | loss: 0.4456 | profit rate:    0.2 | accuracy: 0.35
step_num: 3000 | loss: 0.4256 | profit rate:    0.1 | accuracy: 0.34
step_num: 3200 | loss: 0.3872 | profit rate:    0.2 | accuracy: 0.33
step_num: 3400 | loss: 0.3575 | profit rate:    0.4 | accuracy: 0.33
episode:   1/8,耗时:26.14分/26.14分,训练集: | step: 3528 | average_treward:   77.6 | max_treward: 77.6207 | average profit rate:  0.417
model saved @ step:3528,performance:0.417,accuracy:0.32
step_num: 3600 | loss: 0.3481 | profit rate:    0.6 | accuracy: 0.19
step_num: 3800 | loss: 0.3258 | profit rate:    1.2 | accuracy: 0.15
step_num: 4000 | loss: 0.3394 | profit rate:    0.9 | accuracy: 0.18
step_num: 4200 | loss: 0.2942 | profit rate:   25.2 | accuracy: 0.23
step_num: 4400 | loss: 0.2761 | profit rate:   16.2 | accuracy: 0.23
step_num: 4600 | loss: 0.2417 | profit rate:    9.4 | accuracy: 0.22
step_num: 4800 | loss: 0.2230 | profit rate:   24.4 | accuracy: 0.22
step_num: 5000 | loss: 0.2096 | profit rate:   43.0 | accuracy: 0.22
step_num: 5200 | loss: 0.2184 | profit rate: 1191.9 | accuracy: 0.23
step_num: 5400 | loss: 0.2182 | profit rate: 5665.9 | accuracy: 0.23
step_num: 5600 | loss: 0.2137 | profit rate: 169800.6 | accuracy: 0.24
step_num: 5800 | loss: 0.2027 | profit rate: 3925920.2 | accuracy: 0.24
step_num: 6000 | loss: 0.1996 | profit rate: 17623065.6 | accuracy: 0.24
step_num: 6200 | loss: 0.2183 | profit rate: 42292570.6 | accuracy: 0.24
step_num: 6400 | loss: 0.2153 | profit rate: 63720644.6 | accuracy: 0.24
step_num: 6600 | loss: 0.2446 | profit rate: 137532190.9 | accuracy: 0.24
step_num: 6800 | loss: 0.2177 | profit rate: 594507696.5 | accuracy: 0.25
step_num: 7000 | loss: 0.2264 | profit rate: 1600081621.3 | accuracy: 0.25
model saved @ step:7056,performance:2511104251.355,accuracy:0.25
step_num: 7200 | loss: 0.2263 | profit rate:    1.4 | accuracy: 0.21
step_num: 7400 | loss: 0.2204 | profit rate:    4.2 | accuracy: 0.27
step_num: 7600 | loss: 0.2542 | profit rate:   73.8 | accuracy: 0.30
step_num: 7800 | loss: 0.2707 | profit rate:  277.2 | accuracy: 0.32
step_num: 8000 | loss: 0.2445 | profit rate: 3328.9 | accuracy: 0.33
step_num: 8200 | loss: 0.2599 | profit rate: 1623.3 | accuracy: 0.30
step_num: 8400 | loss: 0.2415 | profit rate: 7161.0 | accuracy: 0.31
step_num: 8600 | loss: 0.2433 | profit rate: 1386310.1 | accuracy: 0.32
step_num: 8800 | loss: 0.2583 | profit rate: 1530465.0 | accuracy: 0.32
step_num: 9000 | loss: 0.2825 | profit rate: 25819682.1 | accuracy: 0.33
step_num: 9200 | loss: 0.3045 | profit rate: 6996488024.6 | accuracy: 0.34
step_num: 9400 | loss: 0.2408 | profit rate: 15248900247.4 | accuracy: 0.32
step_num: 9600 | loss: 0.2548 | profit rate: 212983729035.4 | accuracy: 0.33
step_num: 9800 | loss: 0.2454 | profit rate: 700697721788.0 | accuracy: 0.32
step_num: 10000 | loss: 0.2652 | profit rate: 11643391868460.5 | accuracy: 0.32
step_num: 10200 | loss: 0.2449 | profit rate: 125304604672593.6 | accuracy: 0.32
step_num: 10400 | loss: 0.2491 | profit rate: 5813100718919708.0 | accuracy: 0.32
episode:   3/8,耗时:58.81分/121.06分,训练集: | step: 10584 | average_treward:  416.4 | max_treward: 735.4115 | average profit rate: 6327575404846235.000
model saved @ step:10584,performance:18982723703434452.000,accuracy:0.32
step_num: 10600 | loss: 0.2122 | profit rate:    2.3 | accuracy: 0.29
step_num: 10800 | loss: 0.2484 | profit rate:   26.2 | accuracy: 0.35
step_num: 11000 | loss: 0.2367 | profit rate:    9.0 | accuracy: 0.30
step_num: 11200 | loss: 0.2289 | profit rate:  486.8 | accuracy: 0.34
step_num: 11400 | loss: 0.2300 | profit rate: 6384.1 | accuracy: 0.36
step_num: 11600 | loss: 0.2385 | profit rate: 616161.9 | accuracy: 0.36
step_num: 11800 | loss: 0.2385 | profit rate: 225181.0 | accuracy: 0.34
step_num: 12000 | loss: 0.2231 | profit rate: 9124002.3 | accuracy: 0.35
step_num: 12200 | loss: 0.2646 | profit rate: 3569946231.0 | accuracy: 0.36
step_num: 12400 | loss: 0.2557 | profit rate: 9751306119.4 | accuracy: 0.35
step_num: 12600 | loss: 0.2419 | profit rate: 336945989469.9 | accuracy: 0.36
step_num: 12800 | loss: 0.2693 | profit rate: 19043283623136.0 | accuracy: 0.36
step_num: 13000 | loss: 0.2279 | profit rate: 66896845699541.6 | accuracy: 0.35
step_num: 13200 | loss: 0.2518 | profit rate: 78434506752137.5 | accuracy: 0.34
step_num: 13400 | loss: 0.2429 | profit rate: 447115829097533.9 | accuracy: 0.34
step_num: 13600 | loss: 0.2251 | profit rate: 9927416730476290.0 | accuracy: 0.34
step_num: 13800 | loss: 0.2448 | profit rate: 481399819057017792.0 | accuracy: 0.34
step_num: 14000 | loss: 0.2515 | profit rate: 3948278994536819712.0 | accuracy: 0.35
model saved @ step:14112,performance:5584282435739502592.000,accuracy:0.35
step_num: 14200 | loss: 0.2060 | profit rate:    2.0 | accuracy: 0.24
step_num: 14400 | loss: 0.2371 | profit rate:    7.7 | accuracy: 0.33
step_num: 14600 | loss: 0.2219 | profit rate:   12.6 | accuracy: 0.34
step_num: 14800 | loss: 0.2515 | profit rate:  341.1 | accuracy: 0.35
step_num: 15000 | loss: 0.2529 | profit rate: 20358.2 | accuracy: 0.37
step_num: 15200 | loss: 0.2369 | profit rate: 146614.7 | accuracy: 0.35
step_num: 15400 | loss: 0.2444 | profit rate: 686774.5 | accuracy: 0.35
step_num: 15600 | loss: 0.2356 | profit rate: 260689136.0 | accuracy: 0.36
step_num: 15800 | loss: 0.2498 | profit rate: 12715206337.8 | accuracy: 0.37
step_num: 16000 | loss: 0.2274 | profit rate: 79708198559.8 | accuracy: 0.37
step_num: 16200 | loss: 0.2551 | profit rate: 14352616166393.3 | accuracy: 0.38
step_num: 16400 | loss: 0.2364 | profit rate: 168992160964974.0 | accuracy: 0.37
step_num: 16600 | loss: 0.2101 | profit rate: 795295454617241.2 | accuracy: 0.36
step_num: 16800 | loss: 0.2366 | profit rate: 8525756090129748.0 | accuracy: 0.36
step_num: 17000 | loss: 0.2021 | profit rate: 244792461489414944.0 | accuracy: 0.36
step_num: 17200 | loss: 0.2036 | profit rate: 9059699441776208896.0 | accuracy: 0.36
step_num: 17400 | loss: 0.2189 | profit rate: 1209950930506040999936.0 | accuracy: 0.37
step_num: 17600 | loss: 0.2248 | profit rate: 6213668750254871150592.0 | accuracy: 0.38
episode:   5/8,耗时:36.68分/194.50分,训练集: | step: 17640 | average_treward:  621.1 | max_treward: 1019.5064 | average profit rate: 1712927479162161594368.000
model saved @ step:17640,performance:8559034130648854953984.000,accuracy:0.38
step_num: 17800 | loss: 0.2393 | profit rate:    2.6 | accuracy: 0.36
step_num: 18000 | loss: 0.2526 | profit rate:    5.5 | accuracy: 0.35
step_num: 18200 | loss: 0.2423 | profit rate:  579.4 | accuracy: 0.40
step_num: 18400 | loss: 0.2459 | profit rate: 4698.2 | accuracy: 0.40
step_num: 18600 | loss: 0.2727 | profit rate: 2338466.7 | accuracy: 0.41
step_num: 18800 | loss: 0.2527 | profit rate: 1359004.9 | accuracy: 0.37
step_num: 19000 | loss: 0.2432 | profit rate: 21658380.6 | accuracy: 0.38
step_num: 19200 | loss: 0.2404 | profit rate: 19271480679.0 | accuracy: 0.38
step_num: 19400 | loss: 0.2331 | profit rate: 679920458406.0 | accuracy: 0.39
step_num: 19600 | loss: 0.2394 | profit rate: 10854140247529.6 | accuracy: 0.39
step_num: 19800 | loss: 0.2272 | profit rate: 12942449888751262.0 | accuracy: 0.40
step_num: 20000 | loss: 0.2332 | profit rate: 109484576667533280.0 | accuracy: 0.39
step_num: 20200 | loss: 0.2219 | profit rate: 979954613222520960.0 | accuracy: 0.38
step_num: 20400 | loss: 0.2297 | profit rate: 8232299881059943424.0 | accuracy: 0.39
step_num: 20600 | loss: 0.2235 | profit rate: 2634337018663067975680.0 | accuracy: 0.39
step_num: 20800 | loss: 0.2305 | profit rate: 207102036202388201668608.0 | accuracy: 0.39
step_num: 21000 | loss: 0.2210 | profit rate: 23475729988343901726965760.0 | accuracy: 0.40
model saved @ step:21168,performance:32131675832270974089166848.000,accuracy:0.41
step_num: 21200 | loss: 0.2210 | profit rate:    0.8 | accuracy: 0.27
step_num: 21400 | loss: 0.2516 | profit rate:    2.5 | accuracy: 0.36
step_num: 21600 | loss: 0.2535 | profit rate:   45.0 | accuracy: 0.38
step_num: 21800 | loss: 0.2516 | profit rate: 13752.4 | accuracy: 0.42
step_num: 22000 | loss: 0.2631 | profit rate: 106605.6 | accuracy: 0.42
step_num: 22200 | loss: 0.2529 | profit rate: 7365980.5 | accuracy: 0.42
step_num: 22400 | loss: 0.2693 | profit rate: 5059620.3 | accuracy: 0.39
step_num: 22600 | loss: 0.2588 | profit rate: 227945894.5 | accuracy: 0.40
step_num: 22800 | loss: 0.2648 | profit rate: 808492319904.3 | accuracy: 0.40
step_num: 23000 | loss: 0.2739 | profit rate: 7784491114323.5 | accuracy: 0.41
step_num: 23200 | loss: 0.2535 | profit rate: 183714386531787.8 | accuracy: 0.42
step_num: 23400 | loss: 0.2393 | profit rate: 2326978441689440768.0 | accuracy: 0.43
step_num: 23600 | loss: 0.2547 | profit rate: 12866007074721224704.0 | accuracy: 0.42
step_num: 23800 | loss: 0.2409 | profit rate: 168069863763998605312.0 | accuracy: 0.42
step_num: 24000 | loss: 0.2485 | profit rate: 2206474792386453569536.0 | accuracy: 0.42
step_num: 24200 | loss: 0.2643 | profit rate: 193382746430378468179968.0 | accuracy: 0.42
step_num: 24400 | loss: 0.2488 | profit rate: 624451935905148792635129856.0 | accuracy: 0.43
step_num: 24600 | loss: 0.2596 | profit rate: 5276827807595614326612819968.0 | accuracy: 0.43
episode:   7/8,耗时:36.32分/267.09分,训练集: | step: 24696 | average_treward:  782.4 | max_treward: 1239.3314 | average profit rate: 1167079622060955338335584256.000
model saved @ step:24696,performance:8137417113957020766555865088.000,accuracy:0.43
step_num: 24800 | loss: 0.2648 | profit rate:    2.5 | accuracy: 0.33
step_num: 25000 | loss: 0.2880 | profit rate:    6.9 | accuracy: 0.38
step_num: 25200 | loss: 0.2692 | profit rate:  162.8 | accuracy: 0.43
step_num: 25400 | loss: 0.2735 | profit rate: 74920.0 | accuracy: 0.45
step_num: 25600 | loss: 0.2606 | profit rate: 6130374.8 | accuracy: 0.47
step_num: 25800 | loss: 0.2586 | profit rate: 57330059.0 | accuracy: 0.43
step_num: 26000 | loss: 0.2656 | profit rate: 446530469.9 | accuracy: 0.44
step_num: 26200 | loss: 0.2621 | profit rate: 166665507888.7 | accuracy: 0.43
step_num: 26400 | loss: 0.2451 | profit rate: 8050895618263.8 | accuracy: 0.44
step_num: 26600 | loss: 0.2364 | profit rate: 75664919114612.0 | accuracy: 0.44
step_num: 26800 | loss: 0.2765 | profit rate: 167465207116340160.0 | accuracy: 0.45
step_num: 27000 | loss: 0.2432 | profit rate: 98065075215154462720.0 | accuracy: 0.45
step_num: 27200 | loss: 0.2526 | profit rate: 734316648575856803840.0 | accuracy: 0.44
step_num: 27400 | loss: 0.2417 | profit rate: 22319140408950849011712.0 | accuracy: 0.45
step_num: 27600 | loss: 0.2286 | profit rate: 1443374666323839051366400.0 | accuracy: 0.45
step_num: 27800 | loss: 0.2268 | profit rate: 99386433432635813547474944.0 | accuracy: 0.45
step_num: 28000 | loss: 0.2424 | profit rate: 252612869796834226605649821696.0 | accuracy: 0.46
step_num: 28200 | loss: 0.2329 | profit rate: 3049175695148824774576948903936.0 | accuracy: 0.46
model saved @ step:28224,performance:3474786657100012451855943598080.000,accuracy:0.46
----------------------------------------finished----------------------------------------
  0%|          | 0/82 [00:00<?, ?it/s] 16%|        | 13/82 [00:00<00:00, 129.33it/s] 45%|     | 37/82 [00:00<00:00, 193.55it/s] 87%| | 71/82 [00:00<00:00, 257.32it/s]100%|| 82/82 [00:00<00:00, 240.15it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-07T12:00:00 | *** GOING LONG ***
2023-01-07T12:00:00's price 16943.5703, buy 0.05896041 units.
2023-01-07T12:00:00 | current balance = 0.00
2023-01-07T12:00:00 | balance:0.00+units:0.05896041*price:16943.5703=net_wealth:999.0010
--------------------------------------------------
2023-01-21T00:00:00 | *** GOING SHORT ***
2023-01-21T00:00:00's price 22905.6504, sell 0.05896041 units.
2023-01-21T00:00:00 | current balance = 1349.18
2023-01-21T00:00:00 | balance:1349.18+units:0.0*price:22905.6504=net_wealth:1349.1772
--------------------------------------------------
2023-01-23T00:00:00 | *** GOING LONG ***
2023-01-23T00:00:00's price 22904.5801, buy 0.05884534 units.
2023-01-23T00:00:00 | current balance = 0.00
2023-01-23T00:00:00 | balance:0.00+units:0.05884534*price:22904.5801=net_wealth:1347.8293
--------------------------------------------------
2023-01-26T00:00:00 | *** GOING SHORT ***
2023-01-26T00:00:00's price 22992.9395, sell 0.05884534 units.
2023-01-26T00:00:00 | current balance = 1351.68
2023-01-26T00:00:00 | balance:1351.68+units:0.0*price:22992.9395=net_wealth:1351.6758
--------------------------------------------------
2023-01-29T12:00:00 | *** GOING LONG ***
2023-01-29T12:00:00's price 23742.3008, buy 0.05687419 units.
2023-01-29T12:00:00 | current balance = 0.00
2023-01-29T12:00:00 | balance:0.00+units:0.05687419*price:23742.3008=net_wealth:1350.3255
--------------------------------------------------
2023-01-30T00:00:00 | *** GOING SHORT ***
2023-01-30T00:00:00's price 23077.4707, sell 0.05687419 units.
2023-01-30T00:00:00 | current balance = 1311.20
2023-01-30T00:00:00 | balance:1311.20+units:0.0*price:23077.4707=net_wealth:1311.2013
--------------------------------------------------
2023-01-30T12:00:00 | *** GOING LONG ***
2023-01-30T12:00:00's price 22826.1504, buy 0.0573855 units.
2023-01-30T12:00:00 | current balance = 0.00
2023-01-30T12:00:00 | balance:0.00+units:0.0573855*price:22826.1504=net_wealth:1309.8914
--------------------------------------------------
2023-02-02T00:00:00 | *** GOING SHORT ***
2023-02-02T00:00:00's price 23820.4902, sell 0.0573855 units.
2023-02-02T00:00:00 | current balance = 1365.59
2023-02-02T00:00:00 | balance:1365.59+units:0.0*price:23820.4902=net_wealth:1365.5852
--------------------------------------------------
2023-02-02T12:00:00 | *** GOING LONG ***
2023-02-02T12:00:00's price 23488.9395, buy 0.05807923 units.
2023-02-02T12:00:00 | current balance = 0.00
2023-02-02T12:00:00 | balance:0.00+units:0.05807923*price:23488.9395=net_wealth:1364.2210
--------------------------------------------------
2023-02-06T12:00:00 | *** GOING SHORT ***
2023-02-06T12:00:00's price 22762.5195, sell 0.05807923 units.
2023-02-06T12:00:00 | current balance = 1320.71
2023-02-06T12:00:00 | balance:1320.71+units:0.0*price:22762.5195=net_wealth:1320.7090
--------------------------------------------------
2023-02-11T00:00:00 | *** GOING LONG ***
2023-02-11T00:00:00's price 21697.4395, buy 0.06080848 units.
2023-02-11T00:00:00 | current balance = 0.00
2023-02-11T00:00:00 | balance:0.00+units:0.06080848*price:21697.4395=net_wealth:1319.3896
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, sell 0.06080848 units.
2023-02-17T00:00:00 | current balance = 1448.38
2023-02-17T00:00:00 | net performance [%] = 44.8381
2023-02-17T00:00:00 | number of trades [#] = 12
==================================================
Trial 3 Complete [05h 26m 41s]
net_wealth: 1449.830593475787

Best net_wealth So Far: 1449.830593475787
Total elapsed time: 06h 06m 23s

Search: Running Trial #4

Value             |Best Value So Far |Hyperparameter
12                |8                 |horizon
225               |365               |lookback
False             |False             |MarketFactor
14                |14                |lags
0.8               |0.7               |gamma
32                |2000              |memory_size
16                |32                |batch_size
256               |5                 |n_steps
0.96              |0.97              |gae_lambda
2                 |5                 |gradient_clip_
5                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4000.000000     4000.000000  ...    3988.000000   4000.000000
mean      0.000426    19495.007760  ...   19584.189283  19539.018967
std       0.028529    16512.401386  ...   16549.181936  16544.846301
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009987     7350.115240  ...    7405.509888   7381.677368
50%       0.000789    10706.818994  ...   10898.970215  10860.569824
75%       0.012261    30336.414380  ...   30411.654785  30331.140625
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 8 columns]
step_num: 200 | loss: 1.2479 | profit rate:    4.3 | accuracy: 0.35
step_num: 400 | loss: 0.8024 | profit rate:    3.7 | accuracy: 0.31
step_num: 600 | loss: 0.6075 | profit rate:    2.5 | accuracy: 0.30
step_num: 800 | loss: 0.5599 | profit rate:    0.2 | accuracy: 0.30
step_num: 1000 | loss: 0.6235 | profit rate:    1.6 | accuracy: 0.33
step_num: 1200 | loss: 0.7323 | profit rate:    0.6 | accuracy: 0.34
step_num: 1400 | loss: 0.6654 | profit rate:    0.2 | accuracy: 0.35
step_num: 1600 | loss: 1.0126 | profit rate:    0.1 | accuracy: 0.35
step_num: 1800 | loss: 0.3919 | profit rate:    0.4 | accuracy: 0.35
step_num: 2000 | loss: 1.0105 | profit rate:    0.3 | accuracy: 0.36
step_num: 2200 | loss: 0.9481 | profit rate:   72.4 | accuracy: 0.37
step_num: 2400 | loss: 0.7270 | profit rate: 2462.3 | accuracy: 0.39
step_num: 2600 | loss: 0.7546 | profit rate:  126.0 | accuracy: 0.39
step_num: 2800 | loss: 0.7499 | profit rate:   97.2 | accuracy: 0.40
step_num: 3000 | loss: 0.8366 | profit rate:   51.1 | accuracy: 0.40
step_num: 3200 | loss: 0.4301 | profit rate:    3.1 | accuracy: 0.39
step_num: 3400 | loss: 0.4689 | profit rate:   35.9 | accuracy: 0.39
step_num: 3600 | loss: 0.5067 | profit rate:   28.5 | accuracy: 0.38
episode:   1/8,耗时:2.23分/2.23分,训练集: | step: 3668 | average_treward:   70.2 | max_treward: 70.2465 | average profit rate: 31.478
model saved @ step:3668,performance:31.478,accuracy:0.38
step_num: 3800 | loss: 0.7168 | profit rate:    0.1 | accuracy: 0.32
step_num: 4000 | loss: 0.2913 | profit rate:    1.0 | accuracy: 0.29
step_num: 4200 | loss: 0.5306 | profit rate:    0.3 | accuracy: 0.27
step_num: 4400 | loss: 0.6679 | profit rate:    0.3 | accuracy: 0.26
step_num: 4600 | loss: 0.2100 | profit rate:    2.6 | accuracy: 0.29
step_num: 4800 | loss: 0.9499 | profit rate: 2113.7 | accuracy: 0.35
step_num: 5000 | loss: 0.6871 | profit rate:  213.5 | accuracy: 0.34
step_num: 5200 | loss: 0.9025 | profit rate:  133.7 | accuracy: 0.34
step_num: 5400 | loss: 0.6910 | profit rate:    7.7 | accuracy: 0.34
step_num: 5600 | loss: 0.5892 | profit rate:    1.6 | accuracy: 0.35
step_num: 5800 | loss: 0.5094 | profit rate:  167.5 | accuracy: 0.37
step_num: 6000 | loss: 1.2324 | profit rate: 1584776.9 | accuracy: 0.39
step_num: 6200 | loss: 0.3867 | profit rate: 10862.0 | accuracy: 0.39
step_num: 6400 | loss: 0.9105 | profit rate: 35576.2 | accuracy: 0.40
step_num: 6600 | loss: 0.5767 | profit rate: 108449.4 | accuracy: 0.40
step_num: 6800 | loss: 1.2239 | profit rate: 22269.0 | accuracy: 0.39
step_num: 7000 | loss: 1.2111 | profit rate: 1653165.2 | accuracy: 0.39
step_num: 7200 | loss: 0.5624 | profit rate: 2758363.0 | accuracy: 0.39
model saved @ step:7336,performance:11198496.654,accuracy:0.39
step_num: 7400 | loss: 1.0611 | profit rate:    0.1 | accuracy: 0.25
step_num: 7600 | loss: 0.4254 | profit rate:    0.1 | accuracy: 0.20
step_num: 7800 | loss: 0.4979 | profit rate:    0.0 | accuracy: 0.17
step_num: 8000 | loss: 0.0799 | profit rate:    0.0 | accuracy: 0.18
step_num: 8200 | loss: 0.7403 | profit rate:    0.2 | accuracy: 0.23
step_num: 8400 | loss: 0.8469 | profit rate:  495.2 | accuracy: 0.31
step_num: 8600 | loss: 0.3265 | profit rate:  610.3 | accuracy: 0.31
step_num: 8800 | loss: 0.2915 | profit rate:  611.5 | accuracy: 0.31
step_num: 9000 | loss: 0.3733 | profit rate:  397.2 | accuracy: 0.32
step_num: 9200 | loss: 0.4794 | profit rate:  149.4 | accuracy: 0.32
step_num: 9400 | loss: 0.5503 | profit rate:  209.8 | accuracy: 0.33
step_num: 9600 | loss: 1.2579 | profit rate: 9093349.1 | accuracy: 0.36
step_num: 9800 | loss: 0.6128 | profit rate: 17185815.9 | accuracy: 0.37
step_num: 10000 | loss: 0.5597 | profit rate: 7560875.1 | accuracy: 0.37
step_num: 10200 | loss: 0.5071 | profit rate: 22422317.6 | accuracy: 0.38
step_num: 10400 | loss: 0.3503 | profit rate: 30278505.2 | accuracy: 0.37
step_num: 10600 | loss: 0.8968 | profit rate: 89478622.3 | accuracy: 0.37
step_num: 10800 | loss: 0.9633 | profit rate: 175660026.9 | accuracy: 0.37
step_num: 11000 | loss: 0.4311 | profit rate: 845578483.5 | accuracy: 0.37
episode:   3/8,耗时:2.38分/6.97分,训练集: | step: 11004 | average_treward:  197.4 | max_treward: 293.6691 | average profit rate: 279537705.979
model saved @ step:11004,performance:827414589.807,accuracy:0.37
step_num: 11200 | loss: 0.4189 | profit rate:    0.7 | accuracy: 0.22
step_num: 11400 | loss: 0.3437 | profit rate:    0.1 | accuracy: 0.19
step_num: 11600 | loss: 0.0883 | profit rate:    0.0 | accuracy: 0.18
step_num: 11800 | loss: 0.1476 | profit rate:    0.1 | accuracy: 0.20
step_num: 12000 | loss: 0.7154 | profit rate:    8.8 | accuracy: 0.27
step_num: 12200 | loss: 0.7160 | profit rate:  123.9 | accuracy: 0.30
step_num: 12400 | loss: 0.0172 | profit rate:   75.7 | accuracy: 0.29
step_num: 12600 | loss: 1.2699 | profit rate:  100.2 | accuracy: 0.30
step_num: 12800 | loss: 0.6549 | profit rate:    9.8 | accuracy: 0.31
step_num: 13000 | loss: 0.1592 | profit rate:   10.1 | accuracy: 0.31
step_num: 13200 | loss: 0.6811 | profit rate: 378880.7 | accuracy: 0.34
step_num: 13400 | loss: 0.7730 | profit rate: 149124219.7 | accuracy: 0.36
step_num: 13600 | loss: 0.4375 | profit rate: 5806685.0 | accuracy: 0.36
step_num: 13800 | loss: 0.6044 | profit rate: 113227985.3 | accuracy: 0.37
step_num: 14000 | loss: 0.6157 | profit rate: 99617359.3 | accuracy: 0.37
step_num: 14200 | loss: 0.1485 | profit rate: 8406904.0 | accuracy: 0.36
step_num: 14400 | loss: 0.3936 | profit rate: 746324789.5 | accuracy: 0.36
step_num: 14600 | loss: 0.2610 | profit rate: 2058621747.9 | accuracy: 0.36
model saved @ step:14672,performance:2235390995.682,accuracy:0.36
step_num: 14800 | loss: 0.7248 | profit rate:    0.1 | accuracy: 0.23
step_num: 15000 | loss: 0.0498 | profit rate:    0.2 | accuracy: 0.21
step_num: 15200 | loss: 0.2559 | profit rate:    0.0 | accuracy: 0.21
step_num: 15400 | loss: 0.3347 | profit rate:    0.9 | accuracy: 0.24
step_num: 15600 | loss: 0.9864 | profit rate:   13.7 | accuracy: 0.29
step_num: 15800 | loss: 1.2460 | profit rate: 85091.4 | accuracy: 0.36
step_num: 16000 | loss: 0.4549 | profit rate: 8075.6 | accuracy: 0.34
step_num: 16200 | loss: 0.7100 | profit rate: 2997.0 | accuracy: 0.34
step_num: 16400 | loss: 1.1618 | profit rate:   90.8 | accuracy: 0.34
step_num: 16600 | loss: 0.4171 | profit rate:  194.1 | accuracy: 0.34
step_num: 16800 | loss: 0.2399 | profit rate: 10198.6 | accuracy: 0.36
step_num: 17000 | loss: 1.1766 | profit rate: 722898259.0 | accuracy: 0.39
step_num: 17200 | loss: 0.4266 | profit rate: 12922298.7 | accuracy: 0.39
step_num: 17400 | loss: 0.8683 | profit rate: 70352490.6 | accuracy: 0.39
step_num: 17600 | loss: 0.3707 | profit rate: 221361614.0 | accuracy: 0.40
step_num: 17800 | loss: 1.2032 | profit rate: 38872441.7 | accuracy: 0.39
step_num: 18000 | loss: 0.7405 | profit rate: 1906137256.4 | accuracy: 0.39
step_num: 18200 | loss: 0.5711 | profit rate: 3261108024.1 | accuracy: 0.39
episode:   5/8,耗时:2.37分/11.72分,训练集: | step: 18340 | average_treward:  251.0 | max_treward: 342.2074 | average profit rate: 4316408205.973
model saved @ step:18340,performance:18508036916.246,accuracy:0.39
step_num: 18400 | loss: 1.2727 | profit rate:    0.1 | accuracy: 0.30
step_num: 18600 | loss: 0.4100 | profit rate:    0.0 | accuracy: 0.20
step_num: 18800 | loss: 0.8365 | profit rate:    0.0 | accuracy: 0.18
step_num: 19000 | loss: 0.5216 | profit rate:    0.1 | accuracy: 0.23
step_num: 19200 | loss: 0.7483 | profit rate:    0.4 | accuracy: 0.26
step_num: 19400 | loss: 0.8401 | profit rate:  689.8 | accuracy: 0.34
step_num: 19600 | loss: 0.5158 | profit rate: 1569.8 | accuracy: 0.35
step_num: 19800 | loss: 0.5155 | profit rate: 6671.5 | accuracy: 0.34
step_num: 20000 | loss: 0.5300 | profit rate: 4136.1 | accuracy: 0.34
step_num: 20200 | loss: 0.3578 | profit rate: 1090.4 | accuracy: 0.34
step_num: 20400 | loss: 0.5277 | profit rate: 3746.8 | accuracy: 0.35
step_num: 20600 | loss: 1.5767 | profit rate: 241400849.6 | accuracy: 0.39
step_num: 20800 | loss: 0.5576 | profit rate: 8073411308.7 | accuracy: 0.40
step_num: 21000 | loss: 0.7011 | profit rate: 1474527386.7 | accuracy: 0.40
step_num: 21200 | loss: 0.7645 | profit rate: 17207882623.8 | accuracy: 0.41
step_num: 21400 | loss: 0.3760 | profit rate: 8031560952.7 | accuracy: 0.40
step_num: 21600 | loss: 0.1529 | profit rate: 5883079501.9 | accuracy: 0.39
step_num: 21800 | loss: 0.9345 | profit rate: 19847433797.7 | accuracy: 0.40
step_num: 22000 | loss: 0.4544 | profit rate: 91817973760.0 | accuracy: 0.40
model saved @ step:22008,performance:85369460273.391,accuracy:0.40
step_num: 22200 | loss: 0.7892 | profit rate:    4.7 | accuracy: 0.34
step_num: 22400 | loss: 0.2989 | profit rate:    8.4 | accuracy: 0.32
step_num: 22600 | loss: 0.4887 | profit rate:    0.7 | accuracy: 0.28
step_num: 22800 | loss: 0.2261 | profit rate:   28.0 | accuracy: 0.29
step_num: 23000 | loss: 0.6670 | profit rate: 3044.5 | accuracy: 0.35
step_num: 23200 | loss: 1.1989 | profit rate: 151679.3 | accuracy: 0.38
step_num: 23400 | loss: 0.2237 | profit rate: 355495.8 | accuracy: 0.38
step_num: 23600 | loss: 0.6494 | profit rate: 182789.2 | accuracy: 0.38
step_num: 23800 | loss: 0.5539 | profit rate: 35634.9 | accuracy: 0.38
step_num: 24000 | loss: 0.2885 | profit rate:  963.6 | accuracy: 0.37
step_num: 24200 | loss: 0.5140 | profit rate: 9856603.7 | accuracy: 0.40
step_num: 24400 | loss: 0.8609 | profit rate: 9642460034.0 | accuracy: 0.42
step_num: 24600 | loss: 0.3114 | profit rate: 3150499485.8 | accuracy: 0.42
step_num: 24800 | loss: 0.4521 | profit rate: 14509671031.8 | accuracy: 0.43
step_num: 25000 | loss: 0.4078 | profit rate: 14725760037.3 | accuracy: 0.42
step_num: 25200 | loss: 0.1717 | profit rate: 1113539128.3 | accuracy: 0.41
step_num: 25400 | loss: 0.5755 | profit rate: 57758467346.5 | accuracy: 0.41
step_num: 25600 | loss: 0.5625 | profit rate: 419777612227.5 | accuracy: 0.41
episode:   7/8,耗时:2.38分/16.47分,训练集: | step: 25676 | average_treward:  287.5 | max_treward: 383.8513 | average profit rate: 70515738497.752
step_num: 25800 | loss: 0.8662 | profit rate:    0.1 | accuracy: 0.26
step_num: 26000 | loss: 0.4872 | profit rate:    0.6 | accuracy: 0.25
step_num: 26200 | loss: 0.4385 | profit rate:    0.2 | accuracy: 0.22
step_num: 26400 | loss: 0.1792 | profit rate:    4.6 | accuracy: 0.25
step_num: 26600 | loss: 0.7989 | profit rate:   42.5 | accuracy: 0.29
step_num: 26800 | loss: 1.5408 | profit rate: 1513524.0 | accuracy: 0.36
step_num: 27000 | loss: 0.6462 | profit rate: 211983.9 | accuracy: 0.36
step_num: 27200 | loss: 0.6563 | profit rate: 145354.6 | accuracy: 0.36
step_num: 27400 | loss: 0.7775 | profit rate: 13506.6 | accuracy: 0.36
step_num: 27600 | loss: 0.5448 | profit rate: 11923.6 | accuracy: 0.37
step_num: 27800 | loss: 0.8170 | profit rate: 522597.4 | accuracy: 0.38
step_num: 28000 | loss: 0.8959 | profit rate: 23233688130.7 | accuracy: 0.40
step_num: 28200 | loss: 0.6088 | profit rate: 2653158302.8 | accuracy: 0.41
step_num: 28400 | loss: 0.7851 | profit rate: 5266784973.8 | accuracy: 0.41
step_num: 28600 | loss: 0.5823 | profit rate: 21705768113.7 | accuracy: 0.42
step_num: 28800 | loss: 0.8215 | profit rate: 5896821943.7 | accuracy: 0.41
step_num: 29000 | loss: 0.6221 | profit rate: 430120665869.6 | accuracy: 0.41
step_num: 29200 | loss: 0.6270 | profit rate: 834049510473.0 | accuracy: 0.41
  0%|          | 0/82 [00:00<?, ?it/s]model saved @ step:29344,performance:4260654536940.168,accuracy:0.41
----------------------------------------finished----------------------------------------
 20%|        | 16/82 [00:00<00:00, 158.46it/s] 83%| | 68/82 [00:00<00:00, 367.52it/s]100%|| 82/82 [00:00<00:00, 355.91it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-13T12:00:00 | *** GOING LONG ***
2023-01-13T12:00:00's price 19930.0098, buy 0.05012541 units.
2023-01-13T12:00:00 | current balance = 0.00
2023-01-13T12:00:00 | balance:0.00+units:0.05012541*price:19930.0098=net_wealth:999.0010
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, sell 0.05012541 units.
2023-02-17T00:00:00 | current balance = 1193.92
2023-02-17T00:00:00 | net performance [%] = 19.3924
2023-02-17T00:00:00 | number of trades [#] = 2
==================================================
Trial 4 Complete [00h 18m 55s]
net_wealth: 1195.1187226392135

Best net_wealth So Far: 1449.830593475787
Total elapsed time: 06h 25m 18s

Search: Running Trial #5

Value             |Best Value So Far |Hyperparameter
8                 |8                 |horizon
365               |365               |lookback
False             |False             |MarketFactor
14                |14                |lags
0.92              |0.7               |gamma
1024              |2000              |memory_size
32                |32                |batch_size
20                |5                 |n_steps
0.97              |0.97              |gae_lambda
0.5               |5                 |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4000.000000     4000.000000  ...    3992.000000   4000.000000
mean      0.000426    19495.007760  ...   19569.323229  19539.018967
std       0.028529    16512.401386  ...   16547.547425  16544.846301
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009987     7350.115240  ...    7397.927368   7381.677368
50%       0.000789    10706.818994  ...   10891.359863  10860.569824
75%       0.012261    30336.414380  ...   30400.544434  30331.140625
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 8 columns]
step_num: 600 | loss: 0.5436 | profit rate:    2.4 | accuracy: 0.33
step_num: 800 | loss: 0.4662 | profit rate:    1.4 | accuracy: 0.33
step_num: 1000 | loss: 0.4662 | profit rate:    0.3 | accuracy: 0.32
step_num: 1200 | loss: 0.4209 | profit rate:    0.2 | accuracy: 0.32
step_num: 1400 | loss: 0.4591 | profit rate:    0.1 | accuracy: 0.32
step_num: 1600 | loss: 0.4971 | profit rate:    0.3 | accuracy: 0.32
step_num: 1800 | loss: 0.4555 | profit rate:    0.3 | accuracy: 0.31
step_num: 2000 | loss: 0.3951 | profit rate:    1.0 | accuracy: 0.30
step_num: 2200 | loss: 0.4087 | profit rate:    5.9 | accuracy: 0.31
step_num: 2400 | loss: 0.4312 | profit rate:    2.0 | accuracy: 0.31
step_num: 2600 | loss: 0.4296 | profit rate:    3.6 | accuracy: 0.32
step_num: 2800 | loss: 0.4357 | profit rate:    5.5 | accuracy: 0.32
step_num: 3000 | loss: 0.4879 | profit rate:    5.5 | accuracy: 0.32
step_num: 3200 | loss: 0.4910 | profit rate:    1.8 | accuracy: 0.33
step_num: 3400 | loss: 0.4560 | profit rate:    1.2 | accuracy: 0.32
episode:   1/8,耗时:15.91分/15.91分,训练集: | step: 3528 | average_treward:   61.4 | max_treward: 61.4030 | average profit rate:  0.727
model saved @ step:3528,performance:0.727,accuracy:0.32
step_num: 3600 | loss: 0.4145 | profit rate:    6.2 | accuracy: 0.41
step_num: 3800 | loss: 0.4080 | profit rate:   30.5 | accuracy: 0.37
step_num: 4000 | loss: 0.4341 | profit rate:  305.6 | accuracy: 0.38
step_num: 4200 | loss: 0.3980 | profit rate:  869.0 | accuracy: 0.40
step_num: 4400 | loss: 0.4920 | profit rate:    3.5 | accuracy: 0.36
step_num: 4600 | loss: 0.5081 | profit rate:    0.1 | accuracy: 0.34
step_num: 4800 | loss: 0.4532 | profit rate:    0.0 | accuracy: 0.32
step_num: 5000 | loss: 0.3873 | profit rate:    0.0 | accuracy: 0.31
step_num: 5200 | loss: 0.3696 | profit rate:    0.0 | accuracy: 0.29
step_num: 5400 | loss: 0.2851 | profit rate:    0.0 | accuracy: 0.27
step_num: 5600 | loss: 0.2480 | profit rate:    0.0 | accuracy: 0.27
step_num: 5800 | loss: 0.2364 | profit rate:    0.1 | accuracy: 0.26
step_num: 6000 | loss: 0.2326 | profit rate:    0.1 | accuracy: 0.25
step_num: 6200 | loss: 0.2289 | profit rate:    0.3 | accuracy: 0.26
step_num: 6400 | loss: 0.2615 | profit rate:    1.1 | accuracy: 0.26
step_num: 6600 | loss: 0.3598 | profit rate:    1.2 | accuracy: 0.26
step_num: 6800 | loss: 0.3820 | profit rate:    2.9 | accuracy: 0.27
step_num: 7000 | loss: 0.4097 | profit rate:    6.1 | accuracy: 0.27
model saved @ step:7056,performance:7.927,accuracy:0.27
step_num: 7200 | loss: 0.4080 | profit rate:    5.9 | accuracy: 0.38
step_num: 7400 | loss: 0.4028 | profit rate:   42.1 | accuracy: 0.40
step_num: 7600 | loss: 0.4570 | profit rate:   77.7 | accuracy: 0.36
step_num: 7800 | loss: 0.4433 | profit rate:  119.9 | accuracy: 0.35
step_num: 8000 | loss: 0.4643 | profit rate:    0.3 | accuracy: 0.33
step_num: 8200 | loss: 0.4566 | profit rate:    0.0 | accuracy: 0.29
step_num: 8400 | loss: 0.3790 | profit rate:    0.0 | accuracy: 0.28
step_num: 8600 | loss: 0.2803 | profit rate:    0.0 | accuracy: 0.25
step_num: 8800 | loss: 0.2433 | profit rate:    0.0 | accuracy: 0.23
step_num: 9000 | loss: 0.1768 | profit rate:    0.0 | accuracy: 0.21
step_num: 9200 | loss: 0.1728 | profit rate:    0.0 | accuracy: 0.20
step_num: 9400 | loss: 0.1221 | profit rate:    0.0 | accuracy: 0.19
step_num: 9600 | loss: 0.1571 | profit rate:    0.0 | accuracy: 0.19
step_num: 9800 | loss: 0.1794 | profit rate:    0.0 | accuracy: 0.19
step_num: 10000 | loss: 0.2125 | profit rate:    0.0 | accuracy: 0.19
step_num: 10200 | loss: 0.2223 | profit rate:    0.0 | accuracy: 0.19
step_num: 10400 | loss: 0.2687 | profit rate:    0.0 | accuracy: 0.19
episode:   3/8,耗时:18.91分/373.48分,训练集: | step: 10584 | average_treward:   40.7 | max_treward: 95.3511 | average profit rate:  2.885
step_num: 10600 | loss: 0.2971 | profit rate:    3.6 | accuracy: 0.41
step_num: 10800 | loss: 0.2721 | profit rate:    3.5 | accuracy: 0.20
step_num: 11000 | loss: 0.3809 | profit rate:   17.1 | accuracy: 0.26
step_num: 11200 | loss: 0.3306 | profit rate:   80.5 | accuracy: 0.29
step_num: 11400 | loss: 0.3434 | profit rate:   16.7 | accuracy: 0.27
step_num: 11600 | loss: 0.3581 | profit rate:    0.3 | accuracy: 0.26
step_num: 11800 | loss: 0.2904 | profit rate:    0.2 | accuracy: 0.23
step_num: 12000 | loss: 0.2352 | profit rate:    0.4 | accuracy: 0.23
step_num: 12200 | loss: 0.2511 | profit rate:    2.8 | accuracy: 0.22
step_num: 12400 | loss: 0.2044 | profit rate:    2.4 | accuracy: 0.21
step_num: 12600 | loss: 0.1997 | profit rate:    1.5 | accuracy: 0.20
step_num: 12800 | loss: 0.1915 | profit rate:    0.3 | accuracy: 0.19
step_num: 13000 | loss: 0.2155 | profit rate:    0.2 | accuracy: 0.19
step_num: 13200 | loss: 0.2227 | profit rate:    0.2 | accuracy: 0.20
step_num: 13400 | loss: 0.2602 | profit rate:    0.2 | accuracy: 0.20
step_num: 13600 | loss: 0.2925 | profit rate:    0.4 | accuracy: 0.20
step_num: 13800 | loss: 0.3232 | profit rate:    0.5 | accuracy: 0.21
step_num: 14000 | loss: 0.2807 | profit rate:    0.2 | accuracy: 0.21
step_num: 14200 | loss: 0.2901 | profit rate:    3.3 | accuracy: 0.22
step_num: 14400 | loss: 0.3253 | profit rate:   53.2 | accuracy: 0.32
step_num: 14600 | loss: 0.3239 | profit rate:  211.6 | accuracy: 0.30
step_num: 14800 | loss: 0.3459 | profit rate:  728.3 | accuracy: 0.31
step_num: 15000 | loss: 0.4006 | profit rate:   35.9 | accuracy: 0.29
step_num: 15200 | loss: 0.3407 | profit rate:    1.8 | accuracy: 0.27
step_num: 15400 | loss: 0.2940 | profit rate:    1.4 | accuracy: 0.26
step_num: 15600 | loss: 0.3392 | profit rate:    6.1 | accuracy: 0.25
step_num: 15800 | loss: 0.4447 | profit rate:    9.7 | accuracy: 0.24
step_num: 16000 | loss: 0.3783 | profit rate:    7.3 | accuracy: 0.22
step_num: 16200 | loss: 0.3675 | profit rate:    4.5 | accuracy: 0.21
step_num: 16400 | loss: 0.2986 | profit rate:    2.6 | accuracy: 0.20
step_num: 16600 | loss: 0.2707 | profit rate:   40.0 | accuracy: 0.21
step_num: 16800 | loss: 0.2859 | profit rate:   38.7 | accuracy: 0.21
step_num: 17000 | loss: 0.3263 | profit rate:   19.1 | accuracy: 0.21
step_num: 17200 | loss: 0.3368 | profit rate:    8.7 | accuracy: 0.21
step_num: 17400 | loss: 0.3769 | profit rate:   68.8 | accuracy: 0.22
step_num: 17600 | loss: 0.4140 | profit rate:  606.4 | accuracy: 0.24
episode:   5/8,耗时:19.37分/412.02分,训练集: | step: 17640 | average_treward:   78.8 | max_treward: 196.0648 | average profit rate: 183.701
model saved @ step:17640,performance:909.566,accuracy:0.24
step_num: 17800 | loss: 0.3539 | profit rate:    2.0 | accuracy: 0.27
step_num: 18000 | loss: 0.4143 | profit rate:   20.7 | accuracy: 0.34
step_num: 18200 | loss: 0.4438 | profit rate:  111.5 | accuracy: 0.36
step_num: 18400 | loss: 0.4503 | profit rate:  406.4 | accuracy: 0.37
step_num: 18600 | loss: 0.4067 | profit rate:    4.5 | accuracy: 0.34
step_num: 18800 | loss: 0.3158 | profit rate:    3.4 | accuracy: 0.31
step_num: 19000 | loss: 0.3345 | profit rate:    5.9 | accuracy: 0.31
step_num: 19200 | loss: 0.2760 | profit rate:    7.3 | accuracy: 0.28
step_num: 19400 | loss: 0.2183 | profit rate:    1.3 | accuracy: 0.25
step_num: 19600 | loss: 0.1800 | profit rate:    0.8 | accuracy: 0.23
step_num: 19800 | loss: 0.1826 | profit rate:    0.4 | accuracy: 0.21
step_num: 20000 | loss: 0.1804 | profit rate:    0.2 | accuracy: 0.20
step_num: 20200 | loss: 0.3022 | profit rate:    0.7 | accuracy: 0.21
step_num: 20400 | loss: 0.2187 | profit rate:    0.6 | accuracy: 0.20
step_num: 20600 | loss: 0.2964 | profit rate:    0.5 | accuracy: 0.21
step_num: 20800 | loss: 0.4173 | profit rate:   10.8 | accuracy: 0.22
step_num: 21000 | loss: 0.4543 | profit rate:  347.3 | accuracy: 0.24
model saved @ step:21168,performance:2267.380,accuracy:0.25
step_num: 21200 | loss: 0.4877 | profit rate:    1.6 | accuracy: 0.21
step_num: 21400 | loss: 0.3943 | profit rate:    0.9 | accuracy: 0.32
step_num: 21600 | loss: 0.4469 | profit rate:    5.9 | accuracy: 0.36
step_num: 21800 | loss: 0.4217 | profit rate:   56.1 | accuracy: 0.40
step_num: 22000 | loss: 0.4552 | profit rate:   51.0 | accuracy: 0.40
step_num: 22200 | loss: 0.4414 | profit rate:   19.4 | accuracy: 0.37
step_num: 22400 | loss: 0.4056 | profit rate:   20.2 | accuracy: 0.34
step_num: 22600 | loss: 0.3307 | profit rate:  215.0 | accuracy: 0.36
step_num: 22800 | loss: 0.3602 | profit rate: 2917.1 | accuracy: 0.35
step_num: 23000 | loss: 0.2788 | profit rate: 13334.8 | accuracy: 0.33
step_num: 23200 | loss: 0.2910 | profit rate: 23276.0 | accuracy: 0.33
step_num: 23400 | loss: 0.3446 | profit rate: 137492.6 | accuracy: 0.31
step_num: 23600 | loss: 0.2570 | profit rate: 50704.7 | accuracy: 0.30
step_num: 23800 | loss: 0.2600 | profit rate: 254480.7 | accuracy: 0.30
step_num: 24000 | loss: 0.3457 | profit rate: 588755.8 | accuracy: 0.29
step_num: 24200 | loss: 0.3993 | profit rate: 841442.2 | accuracy: 0.30
step_num: 24400 | loss: 0.3815 | profit rate: 13753419.6 | accuracy: 0.31
step_num: 24600 | loss: 0.4001 | profit rate: 130256899.0 | accuracy: 0.32
episode:   7/8,耗时:19.93分/451.74分,训练集: | step: 24696 | average_treward:  162.0 | max_treward: 495.7069 | average profit rate: 53514789.794
model saved @ step:24696,performance:374600342.677,accuracy:0.32
step_num: 24800 | loss: 0.3860 | profit rate:    1.9 | accuracy: 0.28
step_num: 25000 | loss: 0.4172 | profit rate:    0.2 | accuracy: 0.31
step_num: 25200 | loss: 0.4401 | profit rate:    3.5 | accuracy: 0.40
step_num: 25400 | loss: 0.4409 | profit rate:    4.5 | accuracy: 0.42
step_num: 25600 | loss: 0.4593 | profit rate:    0.1 | accuracy: 0.39
step_num: 25800 | loss: 0.3861 | profit rate:    0.1 | accuracy: 0.34
step_num: 26000 | loss: 0.4021 | profit rate:    0.5 | accuracy: 0.33
step_num: 26200 | loss: 0.3857 | profit rate:    9.5 | accuracy: 0.33
step_num: 26400 | loss: 0.3324 | profit rate:   81.0 | accuracy: 0.32
step_num: 26600 | loss: 0.2771 | profit rate:  218.5 | accuracy: 0.31
step_num: 26800 | loss: 0.3171 | profit rate: 75447.6 | accuracy: 0.33
step_num: 27000 | loss: 0.3024 | profit rate: 13694.9 | accuracy: 0.31
step_num: 27200 | loss: 0.3421 | profit rate: 23069.4 | accuracy: 0.31
step_num: 27400 | loss: 0.3418 | profit rate: 31741.5 | accuracy: 0.31
step_num: 27600 | loss: 0.4431 | profit rate: 580575.1 | accuracy: 0.32
step_num: 27800 | loss: 0.4736 | profit rate: 2083525.1 | accuracy: 0.32
step_num: 28000 | loss: 0.4501 | profit rate: 843320026.2 | accuracy: 0.33
step_num: 28200 | loss: 0.4398 | profit rate: 18453143758.5 | accuracy: 0.34
model saved @ step:28224,performance:20111993622.832,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/82 [00:00<?, ?it/s]  7%|         | 6/82 [00:00<00:01, 57.96it/s] 28%|       | 23/82 [00:00<00:00, 120.46it/s] 51%|     | 42/82 [00:00<00:00, 147.95it/s] 73%|  | 60/82 [00:00<00:00, 157.54it/s] 93%|| 76/82 [00:00<00:00, 155.89it/s]==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
100%|| 82/82 [00:00<00:00, 145.47it/s]
--------------------------------------------------
2023-01-07T12:00:00 | *** GOING LONG ***
2023-01-07T12:00:00's price 16943.5703, buy 0.05896041 units.
2023-01-07T12:00:00 | current balance = 0.00
2023-01-07T12:00:00 | balance:0.00+units:0.05896041*price:16943.5703=net_wealth:999.0010
--------------------------------------------------
2023-01-12T12:00:00 | *** GOING SHORT ***
2023-01-12T12:00:00's price 18846.6191, sell 0.05896041 units.
2023-01-12T12:00:00 | current balance = 1110.09
2023-01-12T12:00:00 | balance:1110.09+units:0.0*price:18846.6191=net_wealth:1110.0943
--------------------------------------------------
2023-01-17T12:00:00 | *** GOING LONG ***
2023-01-17T12:00:00's price 21134.8105, buy 0.05247192 units.
2023-01-17T12:00:00 | current balance = 0.00
2023-01-17T12:00:00 | balance:0.00+units:0.05247192*price:21134.8105=net_wealth:1108.9854
--------------------------------------------------
2023-01-21T12:00:00 | *** GOING SHORT ***
2023-01-21T12:00:00's price 22783.5508, sell 0.05247192 units.
2023-01-21T12:00:00 | current balance = 1194.30
2023-01-21T12:00:00 | balance:1194.30+units:0.0*price:22783.5508=net_wealth:1194.3024
--------------------------------------------------
2023-01-25T00:00:00 | *** GOING LONG ***
2023-01-25T00:00:00's price 22598.4707, buy 0.05279596 units.
2023-01-25T00:00:00 | current balance = 0.00
2023-01-25T00:00:00 | balance:0.00+units:0.05279596*price:22598.4707=net_wealth:1193.1093
--------------------------------------------------
2023-02-02T00:00:00 | *** GOING SHORT ***
2023-02-02T00:00:00's price 23820.4902, sell 0.05279596 units.
2023-02-02T00:00:00 | current balance = 1256.37
2023-02-02T00:00:00 | balance:1256.37+units:0.0*price:23820.4902=net_wealth:1256.3694
--------------------------------------------------
2023-02-11T00:00:00 | *** GOING LONG ***
2023-02-11T00:00:00's price 21697.4395, buy 0.05784613 units.
2023-02-11T00:00:00 | current balance = 0.00
2023-02-11T00:00:00 | balance:0.00+units:0.05784613*price:21697.4395=net_wealth:1255.1143
--------------------------------------------------
2023-02-12T00:00:00 | *** GOING SHORT ***
2023-02-12T00:00:00's price 21888.3105, sell 0.05784613 units.
2023-02-12T00:00:00 | current balance = 1264.89
2023-02-12T00:00:00 | balance:1264.89+units:0.0*price:21888.3105=net_wealth:1264.8893
--------------------------------------------------
2023-02-12T12:00:00 | *** GOING LONG ***
2023-02-12T12:00:00's price 21783.5391, buy 0.05800822 units.
2023-02-12T12:00:00 | current balance = 0.00
2023-02-12T12:00:00 | balance:0.00+units:0.05800822*price:21783.5391=net_wealth:1263.6256
--------------------------------------------------
2023-02-13T12:00:00 | *** GOING SHORT ***
2023-02-13T12:00:00's price 21773.9707, sell 0.05800822 units.
2023-02-13T12:00:00 | current balance = 1261.81
2023-02-13T12:00:00 | balance:1261.81+units:0.0*price:21773.9707=net_wealth:1261.8075
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, 0.0 unit trades .
2023-02-17T00:00:00 | current balance = 1261.81
2023-02-17T00:00:00 | net performance [%] = 26.1808
2023-02-17T00:00:00 | number of trades [#] = 10
==================================================
Trial 5 Complete [07h 51m 27s]
net_wealth: 1261.8075305719549

Best net_wealth So Far: 1449.830593475787
Total elapsed time: 14h 16m 45s

Search: Running Trial #6

Value             |Best Value So Far |Hyperparameter
12                |8                 |horizon
365               |365               |lookback
True              |False             |MarketFactor
7                 |14                |lags
0.6               |0.7               |gamma
32                |2000              |memory_size
32                |32                |batch_size
10                |5                 |n_steps
0.97              |0.97              |gae_lambda
0.5               |5                 |gradient_clip_
3                 |3                 |epochs

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4020 entries, 2017-08-17 00:00:00+00:00 to 2023-02-17 00:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4020 non-null   float64
 1   high        4020 non-null   float64
 2   low         4020 non-null   float64
 3   close       4020 non-null   float64
 4   volume      4020 non-null   float64
 5   amount      4020 non-null   float64
 6   num_trades  4020 non-null   int64  
 7   bid_volume  4020 non-null   float64
 8   bid_amount  4020 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 314.1 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  3986.000000     3986.000000  ...    3974.000000   3986.000000
mean      0.000420    19548.426063  ...   19637.488538  19591.732240
std       0.028547    16516.711778  ...   16553.880197  16549.906141
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009992     7385.701892  ...    7458.072510   7412.930176
50%       0.000789    10744.347241  ...   10919.419922  10899.495117
75%       0.012228    30451.578345  ...   30592.442871  30413.265137
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-02-16 20:00:00+08:00   -0.043713  ...  23517.720703
2023-02-17 08:00:00+08:00    0.013718  ...  23842.550781

[2 rows x 18 columns]
step_num: 200 | loss: 0.7036 | profit rate:    0.2 | accuracy: 0.29
step_num: 400 | loss: 0.4308 | profit rate:    0.1 | accuracy: 0.29
step_num: 600 | loss: 0.7559 | profit rate:    0.4 | accuracy: 0.29
step_num: 800 | loss: 0.9421 | profit rate:    0.2 | accuracy: 0.31
step_num: 1000 | loss: 0.6646 | profit rate:    0.1 | accuracy: 0.31
step_num: 1200 | loss: 0.7097 | profit rate:    0.1 | accuracy: 0.32
step_num: 1400 | loss: 0.2401 | profit rate:    0.0 | accuracy: 0.31
step_num: 1600 | loss: 0.7587 | profit rate:    0.4 | accuracy: 0.31
step_num: 1800 | loss: 0.3837 | profit rate:    0.3 | accuracy: 0.30
step_num: 2000 | loss: 0.9281 | profit rate:    0.7 | accuracy: 0.31
step_num: 2200 | loss: 0.7229 | profit rate: 21787.5 | accuracy: 0.34
step_num: 2400 | loss: 0.7338 | profit rate:   34.6 | accuracy: 0.34
step_num: 2600 | loss: 0.4575 | profit rate:   90.3 | accuracy: 0.34
step_num: 2800 | loss: 0.5478 | profit rate:   59.0 | accuracy: 0.34
step_num: 3000 | loss: 0.4523 | profit rate:   55.7 | accuracy: 0.34
step_num: 3200 | loss: 0.7740 | profit rate:    0.8 | accuracy: 0.35
step_num: 3400 | loss: 0.4901 | profit rate:    0.1 | accuracy: 0.34
episode:   1/8,耗时:2.19分/2.19分,训练集: | step: 3521 | average_treward:  -41.0 | max_treward: 0.0000 | average profit rate:  0.027
step_num: 3600 | loss: 0.8728 | profit rate:    0.0 | accuracy: 0.19
step_num: 3800 | loss: 0.6260 | profit rate:    0.1 | accuracy: 0.26
step_num: 4000 | loss: 0.2091 | profit rate:    0.0 | accuracy: 0.21
step_num: 4200 | loss: 0.0301 | profit rate:    0.0 | accuracy: 0.17
step_num: 4400 | loss: 0.5876 | profit rate:    0.5 | accuracy: 0.21
step_num: 4600 | loss: 0.4282 | profit rate:    5.0 | accuracy: 0.26
step_num: 4800 | loss: 0.2094 | profit rate:    0.9 | accuracy: 0.24
step_num: 5000 | loss: 0.3146 | profit rate:    0.6 | accuracy: 0.22
step_num: 5200 | loss: 0.8608 | profit rate:    0.3 | accuracy: 0.22
step_num: 5400 | loss: 0.3748 | profit rate:    0.2 | accuracy: 0.24
step_num: 5600 | loss: 1.1900 | profit rate: 60929.3 | accuracy: 0.28
step_num: 5800 | loss: 0.9706 | profit rate: 3326733.4 | accuracy: 0.31
step_num: 6000 | loss: 0.0732 | profit rate: 89168.7 | accuracy: 0.30
step_num: 6200 | loss: 0.4946 | profit rate: 5320847.3 | accuracy: 0.31
step_num: 6400 | loss: 0.2361 | profit rate: 78978.0 | accuracy: 0.30
step_num: 6600 | loss: 0.4102 | profit rate: 21204.7 | accuracy: 0.29
step_num: 6800 | loss: 0.0973 | profit rate: 14747.0 | accuracy: 0.28
step_num: 7000 | loss: 0.2830 | profit rate: 15792.6 | accuracy: 0.27
model saved @ step:7042,performance:19760.861,accuracy:0.27
step_num: 7200 | loss: 0.0042 | profit rate:    0.2 | accuracy: 0.03
step_num: 7400 | loss: 0.1658 | profit rate:    0.1 | accuracy: 0.04
step_num: 7600 | loss: 0.1410 | profit rate:    0.2 | accuracy: 0.04
step_num: 7800 | loss: 0.0519 | profit rate:    0.5 | accuracy: 0.10
step_num: 8000 | loss: 1.1424 | profit rate:  920.3 | accuracy: 0.20
step_num: 8200 | loss: 0.2925 | profit rate:   35.1 | accuracy: 0.23
step_num: 8400 | loss: 0.5333 | profit rate:   11.2 | accuracy: 0.22
step_num: 8600 | loss: 0.0087 | profit rate:    4.3 | accuracy: 0.21
step_num: 8800 | loss: 0.0249 | profit rate:    3.5 | accuracy: 0.21
step_num: 9000 | loss: 0.7624 | profit rate:   81.0 | accuracy: 0.23
step_num: 9200 | loss: 0.9915 | profit rate: 34919506.4 | accuracy: 0.27
step_num: 9400 | loss: 0.7389 | profit rate: 621507.9 | accuracy: 0.29
step_num: 9600 | loss: 0.2535 | profit rate: 3776458.2 | accuracy: 0.29
step_num: 9800 | loss: 0.8144 | profit rate: 5107268.7 | accuracy: 0.30
step_num: 10000 | loss: 0.1556 | profit rate: 853475.0 | accuracy: 0.29
step_num: 10200 | loss: 0.1266 | profit rate: 732192.3 | accuracy: 0.28
step_num: 10400 | loss: 0.0098 | profit rate: 1337802.5 | accuracy: 0.26
episode:   3/8,耗时:2.28分/6.73分,训练集: | step: 10563 | average_treward:  121.7 | max_treward: 253.7875 | average profit rate: 706626.800
model saved @ step:10563,performance:2100119.511,accuracy:0.26
step_num: 10600 | loss: 0.0091 | profit rate:    0.9 | accuracy: 0.00
step_num: 10800 | loss: 0.4000 | profit rate:    1.3 | accuracy: 0.06
step_num: 11000 | loss: 0.2796 | profit rate:    1.0 | accuracy: 0.11
step_num: 11200 | loss: 0.2986 | profit rate:   10.6 | accuracy: 0.18
step_num: 11400 | loss: 0.5664 | profit rate:    0.8 | accuracy: 0.23
step_num: 11600 | loss: 0.7783 | profit rate: 3819.4 | accuracy: 0.30
step_num: 11800 | loss: 0.2619 | profit rate:  112.1 | accuracy: 0.29
step_num: 12000 | loss: 0.7196 | profit rate:   96.1 | accuracy: 0.28
step_num: 12200 | loss: 0.3977 | profit rate:  113.6 | accuracy: 0.26
step_num: 12400 | loss: 0.8891 | profit rate:   46.1 | accuracy: 0.27
step_num: 12600 | loss: 0.6105 | profit rate: 251360.2 | accuracy: 0.30
step_num: 12800 | loss: 1.0441 | profit rate: 10937741486.9 | accuracy: 0.34
step_num: 13000 | loss: 0.2960 | profit rate: 112719006.3 | accuracy: 0.34
step_num: 13200 | loss: 0.4974 | profit rate: 7457449835.5 | accuracy: 0.35
step_num: 13400 | loss: 0.1010 | profit rate: 110320913.9 | accuracy: 0.34
step_num: 13600 | loss: 0.0633 | profit rate: 11188528.0 | accuracy: 0.33
step_num: 13800 | loss: 0.0052 | profit rate: 6241512.1 | accuracy: 0.31
step_num: 14000 | loss: 0.0862 | profit rate: 14359951.2 | accuracy: 0.30
model saved @ step:14084,performance:14802891.395,accuracy:0.29
step_num: 14200 | loss: 0.1041 | profit rate:    0.8 | accuracy: 0.02
step_num: 14400 | loss: 0.1517 | profit rate:    1.0 | accuracy: 0.03
step_num: 14600 | loss: 0.3187 | profit rate:    1.1 | accuracy: 0.05
step_num: 14800 | loss: 0.7418 | profit rate:    4.5 | accuracy: 0.14
step_num: 15000 | loss: 0.8573 | profit rate:   79.6 | accuracy: 0.21
step_num: 15200 | loss: 0.5414 | profit rate: 1740.7 | accuracy: 0.26
step_num: 15400 | loss: 0.1829 | profit rate:  183.3 | accuracy: 0.25
step_num: 15600 | loss: 0.3709 | profit rate:   69.9 | accuracy: 0.24
step_num: 15800 | loss: 0.6120 | profit rate:   22.5 | accuracy: 0.24
step_num: 16000 | loss: 0.6874 | profit rate:  251.3 | accuracy: 0.26
step_num: 16200 | loss: 1.5283 | profit rate: 7855765.3 | accuracy: 0.29
step_num: 16400 | loss: 0.6283 | profit rate: 280029991.6 | accuracy: 0.32
step_num: 16600 | loss: 0.4834 | profit rate: 176580944.0 | accuracy: 0.31
step_num: 16800 | loss: 1.4749 | profit rate: 2219294458.0 | accuracy: 0.33
step_num: 17000 | loss: 0.3639 | profit rate: 122399894.1 | accuracy: 0.33
step_num: 17200 | loss: 0.1043 | profit rate: 46951902.4 | accuracy: 0.31
step_num: 17400 | loss: 0.0765 | profit rate: 184479825.0 | accuracy: 0.30
step_num: 17600 | loss: 0.0973 | profit rate: 120241429.9 | accuracy: 0.30
episode:   5/8,耗时:2.25分/11.27分,训练集: | step: 17605 | average_treward:  184.7 | max_treward: 295.8202 | average profit rate: 26467324.521
model saved @ step:17605,performance:115413850.809,accuracy:0.30
step_num: 17800 | loss: 0.2260 | profit rate:    3.5 | accuracy: 0.07
step_num: 18000 | loss: 0.3510 | profit rate:    2.5 | accuracy: 0.12
step_num: 18200 | loss: 0.2054 | profit rate:   15.9 | accuracy: 0.17
step_num: 18400 | loss: 0.9244 | profit rate:    2.7 | accuracy: 0.22
step_num: 18600 | loss: 1.0874 | profit rate: 14041.1 | accuracy: 0.31
step_num: 18800 | loss: 0.3989 | profit rate: 8627.5 | accuracy: 0.30
step_num: 19000 | loss: 0.3516 | profit rate: 5406.9 | accuracy: 0.30
step_num: 19200 | loss: 0.4514 | profit rate: 2068.9 | accuracy: 0.29
step_num: 19400 | loss: 0.4737 | profit rate: 4299.0 | accuracy: 0.30
step_num: 19600 | loss: 0.5912 | profit rate: 820700.9 | accuracy: 0.32
step_num: 19800 | loss: 0.8091 | profit rate: 52470976420.0 | accuracy: 0.35
step_num: 20000 | loss: 0.3827 | profit rate: 1109384072.0 | accuracy: 0.35
step_num: 20200 | loss: 0.4088 | profit rate: 4421976040.7 | accuracy: 0.36
step_num: 20400 | loss: 0.8439 | profit rate: 2809338539.0 | accuracy: 0.36
step_num: 20600 | loss: 0.2657 | profit rate: 1058956132.1 | accuracy: 0.35
step_num: 20800 | loss: 0.1771 | profit rate: 2414799761.0 | accuracy: 0.34
step_num: 21000 | loss: 0.1366 | profit rate: 2314148857.6 | accuracy: 0.32
model saved @ step:21126,performance:3248655014.970,accuracy:0.32
step_num: 21200 | loss: 0.0026 | profit rate:    1.0 | accuracy: 0.00
step_num: 21400 | loss: 0.4774 | profit rate:    3.5 | accuracy: 0.09
step_num: 21600 | loss: 0.6456 | profit rate:    1.2 | accuracy: 0.12
step_num: 21800 | loss: 0.5291 | profit rate:    7.1 | accuracy: 0.18
step_num: 22000 | loss: 0.8159 | profit rate:   47.4 | accuracy: 0.25
step_num: 22200 | loss: 0.5730 | profit rate:  994.1 | accuracy: 0.29
step_num: 22400 | loss: 0.2744 | profit rate:  368.1 | accuracy: 0.28
step_num: 22600 | loss: 0.0772 | profit rate:  487.6 | accuracy: 0.28
step_num: 22800 | loss: 0.6929 | profit rate:  243.4 | accuracy: 0.28
step_num: 23000 | loss: 0.5114 | profit rate:  315.9 | accuracy: 0.29
step_num: 23200 | loss: 0.5554 | profit rate: 253689626.9 | accuracy: 0.32
step_num: 23400 | loss: 0.7121 | profit rate: 7646520857.0 | accuracy: 0.35
step_num: 23600 | loss: 0.0355 | profit rate: 349052985.6 | accuracy: 0.34
step_num: 23800 | loss: 0.8551 | profit rate: 258717482838.0 | accuracy: 0.36
step_num: 24000 | loss: 0.4952 | profit rate: 4976743738.8 | accuracy: 0.35
step_num: 24200 | loss: 0.0713 | profit rate: 1858990788.8 | accuracy: 0.34
step_num: 24400 | loss: 0.0076 | profit rate: 3912449951.5 | accuracy: 0.33
step_num: 24600 | loss: 0.4315 | profit rate: 3798557492.0 | accuracy: 0.32
episode:   7/8,耗时:2.20分/15.77分,训练集: | step: 24647 | average_treward:  234.8 | max_treward: 363.5075 | average profit rate: 1204585941.167
step_num: 24800 | loss: 0.0008 | profit rate:    0.7 | accuracy: 0.05
step_num: 25000 | loss: 0.2098 | profit rate:    0.4 | accuracy: 0.12
step_num: 25200 | loss: 0.1993 | profit rate:    1.8 | accuracy: 0.16
step_num: 25400 | loss: 0.5223 | profit rate:    2.4 | accuracy: 0.23
step_num: 25600 | loss: 0.7553 | profit rate:  300.9 | accuracy: 0.29
step_num: 25800 | loss: 0.4443 | profit rate:   45.5 | accuracy: 0.29
step_num: 26000 | loss: 0.5592 | profit rate:   62.3 | accuracy: 0.29
step_num: 26200 | loss: 0.3989 | profit rate:  423.7 | accuracy: 0.29
step_num: 26400 | loss: 0.1464 | profit rate:  266.3 | accuracy: 0.28
step_num: 26600 | loss: 0.6433 | profit rate: 13623.8 | accuracy: 0.30
step_num: 26800 | loss: 0.6011 | profit rate: 3746320968.5 | accuracy: 0.33
step_num: 27000 | loss: 0.4618 | profit rate: 113677243.1 | accuracy: 0.34
step_num: 27200 | loss: 0.6592 | profit rate: 987739764.0 | accuracy: 0.35
step_num: 27400 | loss: 0.8019 | profit rate: 4612859045.1 | accuracy: 0.36
step_num: 27600 | loss: 0.6938 | profit rate: 1384085285.4 | accuracy: 0.35
step_num: 27800 | loss: 0.4080 | profit rate: 298470906.8 | accuracy: 0.34
step_num: 28000 | loss: 0.0586 | profit rate: 635271626.3 | accuracy: 0.32
----------------------------------------finished----------------------------------------
  0%|          | 0/89 [00:00<?, ?it/s] 26%|       | 23/89 [00:00<00:00, 229.75it/s] 88%| | 78/89 [00:00<00:00, 414.66it/s]100%|| 89/89 [00:00<00:00, 397.09it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
--------------------------------------------------
2023-01-17T00:00:00 | *** GOING LONG ***
2023-01-17T00:00:00's price 21219.7500, buy 0.04707878 units.
2023-01-17T00:00:00 | current balance = 0.00
2023-01-17T00:00:00 | balance:0.00+units:0.04707878*price:21219.7500=net_wealth:999.0010
==================================================
2023-02-17T00:00:00 | *** CLOSING OUT ***
2023-02-17T00:00:00's price 23842.5508, sell 0.04707878 units.
2023-02-17T00:00:00 | current balance = 1121.36
2023-02-17T00:00:00 | net performance [%] = 12.1357
2023-02-17T00:00:00 | number of trades [#] = 2
==================================================
Trial 6 Complete [00h 18m 05s]
net_wealth: 1122.479261022392

Best net_wealth So Far: 1449.830593475787
Total elapsed time: 14h 34m 50s
Results summary
Results in saved_model\keras_tunner
Showing 10 best trials
<keras_tuner.engine.objective.Objective object at 0x0000023D34199FA0>
Trial summary
Hyperparameters:
horizon: 8
lookback: 365
MarketFactor: False
lags: 14
gamma: 0.7
memory_size: 2000
batch_size: 32
n_steps: 5
gae_lambda: 0.97
gradient_clip_: 5.0
epochs: 3
Score: 1449.830593475787
Trial summary
Hyperparameters:
horizon: 8
lookback: 365
MarketFactor: False
lags: 14
gamma: 0.92
memory_size: 1024
batch_size: 32
n_steps: 20
gae_lambda: 0.97
gradient_clip_: 0.5
epochs: 3
Score: 1261.8075305719549
Trial summary
Hyperparameters:
horizon: 12
lookback: 225
MarketFactor: False
lags: 14
gamma: 0.8
memory_size: 32
batch_size: 16
n_steps: 256
gae_lambda: 0.96
gradient_clip_: 2.0
epochs: 5
Score: 1195.1187226392135
Trial summary
Hyperparameters:
horizon: 2
lookback: 225
MarketFactor: False
lags: 5
gamma: 0.5
memory_size: 32
batch_size: 16
n_steps: 5
gae_lambda: 0.96
gradient_clip_: 0.2
epochs: 3
Score: 1180.1795004171079
Trial summary
Hyperparameters:
horizon: 4
lookback: 730
MarketFactor: False
lags: 14
gamma: 0.7
memory_size: 64
batch_size: 32
n_steps: 128
gae_lambda: 0.98
gradient_clip_: 0.5
epochs: 5
Score: 1151.9169381535464
Trial summary
Hyperparameters:
horizon: 12
lookback: 365
MarketFactor: True
lags: 7
gamma: 0.6
memory_size: 32
batch_size: 32
n_steps: 10
gae_lambda: 0.97
gradient_clip_: 0.5
epochs: 3
Score: 1122.479261022392
None
