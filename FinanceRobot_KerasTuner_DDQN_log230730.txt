
Search: Running Trial #1

default configuration

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4314.000000   4315.000000
mean      0.000441    20062.255222  ...   20122.295285  20118.633889
std       0.027818    16039.874230  ...   16077.162832  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7691.585083   7690.540039
50%       0.000642    11554.824463  ...   11724.320312  11715.610352
75%       0.011655    29873.081836  ...   29925.802734  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
2023-07-29 20:03:49.651846: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX AVX2
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-07-29 20:03:49.980505: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1510] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 5454 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3070, pci bus id: 0000:01:00.0, compute capability: 8.6
2023-07-29 20:03:50.219115: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2)
2023-07-29 20:03:52.488075: I tensorflow/stream_executor/cuda/cuda_dnn.cc:369] Loaded cuDNN version 8201
2023-07-29 20:03:53.023457: I tensorflow/stream_executor/cuda/cuda_blas.cc:1760] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
step_num: 200 | loss: 0.5026 | profit rate:    3.9 | accuracy: 0.40
step_num: 400 | loss: 0.6011 | profit rate:    6.2 | accuracy: 0.39
step_num: 600 | loss: 0.4518 | profit rate:    7.9 | accuracy: 0.39
step_num: 800 | loss: 0.5461 | profit rate:    8.7 | accuracy: 0.38
step_num: 1000 | loss: 0.5537 | profit rate:   10.1 | accuracy: 0.39
step_num: 1200 | loss: 0.4771 | profit rate:   10.1 | accuracy: 0.38
step_num: 1400 | loss: 0.5153 | profit rate:    5.6 | accuracy: 0.38
step_num: 1600 | loss: 0.4951 | profit rate:    7.3 | accuracy: 0.39
step_num: 1800 | loss: 0.4781 | profit rate:   10.1 | accuracy: 0.40
step_num: 2000 | loss: 0.5366 | profit rate:   10.7 | accuracy: 0.40
step_num: 2200 | loss: 0.2959 | profit rate:   17.5 | accuracy: 0.41
step_num: 2400 | loss: 0.4686 | profit rate:   62.6 | accuracy: 0.42
step_num: 2600 | loss: 0.5287 | profit rate:   66.6 | accuracy: 0.43
step_num: 2800 | loss: 0.5597 | profit rate:   45.7 | accuracy: 0.42
step_num: 3000 | loss: 0.4877 | profit rate:   42.8 | accuracy: 0.42
step_num: 3200 | loss: 0.3893 | profit rate:   43.1 | accuracy: 0.42
step_num: 3400 | loss: 0.2608 | profit rate:   43.7 | accuracy: 0.41
step_num: 3600 | loss: 0.0765 | profit rate:   43.5 | accuracy: 0.40
episode:   1/5,耗时:0.54分/0.54分,训练集: | step: 3724 | average_treward:  240.1 | max_treward: 240.0906 | average profit rate: 37.268
model saved @ step:3724,performance:37.268,accuracy:0.39
step_num: 3800 | loss: 0.5372 | profit rate:    1.6 | accuracy: 0.60
step_num: 4000 | loss: 0.0039 | profit rate:    1.0 | accuracy: 0.25
step_num: 4200 | loss: 0.0658 | profit rate:    0.9 | accuracy: 0.19
step_num: 4400 | loss: 0.0650 | profit rate:    0.9 | accuracy: 0.17
step_num: 4600 | loss: 0.0635 | profit rate:    0.9 | accuracy: 0.14
step_num: 4800 | loss: 0.5494 | profit rate:    1.5 | accuracy: 0.21
step_num: 5000 | loss: 0.3995 | profit rate:    2.5 | accuracy: 0.25
step_num: 5200 | loss: 0.0718 | profit rate:    2.6 | accuracy: 0.23
step_num: 5400 | loss: 0.5104 | profit rate:    2.2 | accuracy: 0.24
step_num: 5600 | loss: 0.4774 | profit rate:    2.6 | accuracy: 0.25
step_num: 5800 | loss: 0.0836 | profit rate:    3.3 | accuracy: 0.25
step_num: 6000 | loss: 0.3054 | profit rate:    6.0 | accuracy: 0.27
step_num: 6200 | loss: 0.4594 | profit rate:    8.1 | accuracy: 0.28
step_num: 6400 | loss: 0.1224 | profit rate:    8.3 | accuracy: 0.28
step_num: 6600 | loss: 0.4391 | profit rate:    9.5 | accuracy: 0.28
step_num: 6800 | loss: 0.1640 | profit rate:    7.6 | accuracy: 0.27
step_num: 7000 | loss: 0.2149 | profit rate:    8.1 | accuracy: 0.27
step_num: 7200 | loss: 0.0422 | profit rate:    6.0 | accuracy: 0.26
step_num: 7400 | loss: 0.0858 | profit rate:    5.8 | accuracy: 0.26
model saved @ step:7448,performance:5.822,accuracy:0.25
step_num: 7600 | loss: 0.1664 | profit rate:    0.7 | accuracy: 0.26
step_num: 7800 | loss: 0.0906 | profit rate:    0.6 | accuracy: 0.15
step_num: 8000 | loss: 0.1447 | profit rate:    0.7 | accuracy: 0.16
step_num: 8200 | loss: 0.2470 | profit rate:    0.5 | accuracy: 0.16
step_num: 8400 | loss: 0.1467 | profit rate:    0.5 | accuracy: 0.16
step_num: 8600 | loss: 0.3727 | profit rate:    0.7 | accuracy: 0.20
step_num: 8800 | loss: 0.2138 | profit rate:    0.4 | accuracy: 0.20
step_num: 9000 | loss: 0.0592 | profit rate:    0.4 | accuracy: 0.20
step_num: 9200 | loss: 0.2184 | profit rate:    0.4 | accuracy: 0.19
step_num: 9400 | loss: 0.0536 | profit rate:    0.5 | accuracy: 0.19
step_num: 9600 | loss: 0.1307 | profit rate:    0.5 | accuracy: 0.19
step_num: 9800 | loss: 0.4204 | profit rate:    1.1 | accuracy: 0.21
step_num: 10000 | loss: 0.1383 | profit rate:    1.2 | accuracy: 0.21
step_num: 10200 | loss: 0.1837 | profit rate:    1.3 | accuracy: 0.21
step_num: 10400 | loss: 0.2071 | profit rate:    1.7 | accuracy: 0.21
step_num: 10600 | loss: 0.2583 | profit rate:    2.1 | accuracy: 0.20
step_num: 10800 | loss: 0.4435 | profit rate:    1.8 | accuracy: 0.21
step_num: 11000 | loss: 0.0612 | profit rate:    1.9 | accuracy: 0.20
episode:   3/5,耗时:0.56分/1.67分,训练集: | step: 11172 | average_treward:  281.6 | max_treward: 314.8083 | average profit rate: 14.948
step_num: 11200 | loss: 0.1389 | profit rate:    1.0 | accuracy: 0.17
step_num: 11400 | loss: 0.0183 | profit rate:    1.1 | accuracy: 0.18
step_num: 11600 | loss: 0.0459 | profit rate:    1.1 | accuracy: 0.12
step_num: 11800 | loss: 0.0948 | profit rate:    1.0 | accuracy: 0.11
step_num: 12000 | loss: 0.0392 | profit rate:    1.3 | accuracy: 0.12
step_num: 12200 | loss: 0.1109 | profit rate:    1.4 | accuracy: 0.13
step_num: 12400 | loss: 0.3647 | profit rate:    1.3 | accuracy: 0.16
step_num: 12600 | loss: 0.2612 | profit rate:    1.0 | accuracy: 0.17
step_num: 12800 | loss: 0.0555 | profit rate:    0.9 | accuracy: 0.17
step_num: 13000 | loss: 0.0673 | profit rate:    1.3 | accuracy: 0.18
step_num: 13200 | loss: 0.1006 | profit rate:    1.3 | accuracy: 0.17
step_num: 13400 | loss: 0.2993 | profit rate:    1.4 | accuracy: 0.18
step_num: 13600 | loss: 0.2439 | profit rate:    3.7 | accuracy: 0.20
step_num: 13800 | loss: 0.2148 | profit rate:    5.2 | accuracy: 0.20
step_num: 14000 | loss: 0.2645 | profit rate:    6.1 | accuracy: 0.20
step_num: 14200 | loss: 0.2593 | profit rate:    5.7 | accuracy: 0.21
step_num: 14400 | loss: 0.2552 | profit rate:    4.7 | accuracy: 0.21
step_num: 14600 | loss: 0.0204 | profit rate:    4.9 | accuracy: 0.21
step_num: 14800 | loss: 0.1311 | profit rate:    4.7 | accuracy: 0.21
step_num: 15000 | loss: 0.5331 | profit rate:    1.0 | accuracy: 0.37
step_num: 15200 | loss: 0.0156 | profit rate:    1.4 | accuracy: 0.20
step_num: 15400 | loss: 0.0805 | profit rate:    1.8 | accuracy: 0.19
step_num: 15600 | loss: 0.1680 | profit rate:    1.9 | accuracy: 0.19
step_num: 15800 | loss: 0.0313 | profit rate:    1.8 | accuracy: 0.19
step_num: 16000 | loss: 0.1875 | profit rate:    2.1 | accuracy: 0.18
step_num: 16200 | loss: 0.0900 | profit rate:    2.0 | accuracy: 0.18
step_num: 16400 | loss: 0.0673 | profit rate:    1.6 | accuracy: 0.17
step_num: 16600 | loss: 0.0861 | profit rate:    2.5 | accuracy: 0.16
step_num: 16800 | loss: 0.0968 | profit rate:    2.5 | accuracy: 0.15
step_num: 17000 | loss: 0.0601 | profit rate:    2.3 | accuracy: 0.15
step_num: 17200 | loss: 0.1955 | profit rate:    2.1 | accuracy: 0.14
step_num: 17400 | loss: 0.0673 | profit rate:    2.2 | accuracy: 0.14
step_num: 17600 | loss: 0.0821 | profit rate:    3.2 | accuracy: 0.14
step_num: 17800 | loss: 0.2553 | profit rate:    3.0 | accuracy: 0.14
step_num: 18000 | loss: 0.1192 | profit rate:    2.6 | accuracy: 0.14
step_num: 18200 | loss: 0.2127 | profit rate:    2.4 | accuracy: 0.15
step_num: 18400 | loss: 0.0578 | profit rate:    2.1 | accuracy: 0.15
step_num: 18600 | loss: 0.0505 | profit rate:    2.0 | accuracy: 0.14
episode:   5/5,耗时:0.56分/2.81分,训练集: | step: 18620 | average_treward:  280.6 | max_treward: 314.8083 | average profit rate: 10.295
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 16%|        | 66/408 [00:00<00:00, 657.19it/s] 44%|     | 181/408 [00:00<00:00, 942.15it/s] 72%|  | 293/408 [00:00<00:00, 1018.44it/s] 98%|| 401/408 [00:00<00:00, 1038.58it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 997.02it/s] 
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1235.04
2023-07-24T12:00:00 | net performance [%] = 23.5039
2023-07-24T12:00:00 | number of trades [#] = 2
==================================================
Trial 1 Complete [00h 02m 53s]
net_wealth: 1236.2749274731684

Best net_wealth So Far: 1236.2749274731684
Total elapsed time: 00h 02m 53s

Search: Running Trial #2

Value             |Best Value So Far |Hyperparameter
9                 |1                 |horizon
180               |180               |lookback
False             |False             |MarketFactor
20                |3                 |lags
0.98              |0.5               |gamma
0.001             |0.001             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.5               |0.1               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4306.000000   4315.000000
mean      0.000441    20062.255222  ...   20151.395964  20118.633889
std       0.027818    16039.874230  ...   16077.894500  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7715.610107   7690.540039
50%       0.000642    11554.824463  ...   11746.555176  11715.610352
75%       0.011655    29873.081836  ...   29983.155273  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9089 | profit rate:    1.0 | accuracy: 0.34
step_num: 1200 | loss: 0.6017 | profit rate:    1.1 | accuracy: 0.34
step_num: 1400 | loss: 0.6403 | profit rate:    3.7 | accuracy: 0.34
step_num: 1600 | loss: 0.5593 | profit rate:    3.6 | accuracy: 0.34
step_num: 1800 | loss: 0.5721 | profit rate:    0.1 | accuracy: 0.33
step_num: 2000 | loss: 0.5884 | profit rate:    0.1 | accuracy: 0.33
step_num: 2200 | loss: 0.5818 | profit rate:    1.2 | accuracy: 0.34
step_num: 2400 | loss: 0.5694 | profit rate:   26.0 | accuracy: 0.34
step_num: 2600 | loss: 0.6000 | profit rate:    4.8 | accuracy: 0.34
step_num: 2800 | loss: 0.5984 | profit rate:    2.9 | accuracy: 0.34
step_num: 3000 | loss: 0.6279 | profit rate:    2.0 | accuracy: 0.34
step_num: 3200 | loss: 0.5507 | profit rate:    0.5 | accuracy: 0.33
step_num: 3400 | loss: 0.5747 | profit rate:   58.9 | accuracy: 0.34
step_num: 3600 | loss: 0.5659 | profit rate:   21.0 | accuracy: 0.34
episode:   1/5,耗时:1.70分/1.70分,训练集: | step: 3707 | average_treward:   52.2 | max_treward: 52.1895 | average profit rate: 20.861
model saved @ step:3707,performance:20.861,accuracy:0.33
step_num: 3800 | loss: 0.6305 | profit rate:    0.1 | accuracy: 0.35
step_num: 4000 | loss: 0.5733 | profit rate:    0.0 | accuracy: 0.29
step_num: 4200 | loss: 0.5900 | profit rate:    0.2 | accuracy: 0.31
step_num: 4400 | loss: 0.5999 | profit rate:    1.6 | accuracy: 0.35
step_num: 4600 | loss: 0.6515 | profit rate:    1.2 | accuracy: 0.33
step_num: 4800 | loss: 0.6405 | profit rate:    3.3 | accuracy: 0.32
step_num: 5000 | loss: 0.6096 | profit rate:    1.1 | accuracy: 0.32
step_num: 5200 | loss: 0.6633 | profit rate:   18.8 | accuracy: 0.33
step_num: 5400 | loss: 0.6975 | profit rate:    1.4 | accuracy: 0.33
step_num: 5600 | loss: 0.6848 | profit rate:    1.2 | accuracy: 0.33
step_num: 5800 | loss: 0.6701 | profit rate:    1.5 | accuracy: 0.33
step_num: 6000 | loss: 0.7144 | profit rate:  418.6 | accuracy: 0.34
step_num: 6200 | loss: 0.6248 | profit rate: 1762.9 | accuracy: 0.34
step_num: 6400 | loss: 0.6610 | profit rate: 56301.5 | accuracy: 0.36
step_num: 6600 | loss: 0.7436 | profit rate: 45449.3 | accuracy: 0.35
step_num: 6800 | loss: 0.7162 | profit rate: 37981.5 | accuracy: 0.34
step_num: 7000 | loss: 0.6851 | profit rate: 277922.2 | accuracy: 0.35
step_num: 7200 | loss: 0.6494 | profit rate: 3782862.7 | accuracy: 0.35
step_num: 7400 | loss: 0.7139 | profit rate: 8957506.2 | accuracy: 0.35
model saved @ step:7414,performance:9393552.860,accuracy:0.35
step_num: 7600 | loss: 0.7429 | profit rate:    0.2 | accuracy: 0.26
step_num: 7800 | loss: 0.6423 | profit rate:    0.7 | accuracy: 0.29
step_num: 8000 | loss: 0.6785 | profit rate:    0.7 | accuracy: 0.30
step_num: 8200 | loss: 0.6654 | profit rate:    3.5 | accuracy: 0.33
step_num: 8400 | loss: 0.6315 | profit rate:    1.0 | accuracy: 0.33
step_num: 8600 | loss: 0.6953 | profit rate:   50.0 | accuracy: 0.35
step_num: 8800 | loss: 0.6867 | profit rate:   43.6 | accuracy: 0.34
step_num: 9000 | loss: 0.6868 | profit rate:  610.2 | accuracy: 0.35
step_num: 9200 | loss: 0.6703 | profit rate: 1348.2 | accuracy: 0.35
step_num: 9400 | loss: 0.6304 | profit rate: 2500.5 | accuracy: 0.35
step_num: 9600 | loss: 0.6186 | profit rate: 29863.6 | accuracy: 0.37
step_num: 9800 | loss: 0.7285 | profit rate: 57658467.9 | accuracy: 0.37
step_num: 10000 | loss: 0.7674 | profit rate: 10765802.7 | accuracy: 0.37
step_num: 10200 | loss: 0.7669 | profit rate: 7110391.0 | accuracy: 0.36
step_num: 10400 | loss: 0.7242 | profit rate: 18648996.8 | accuracy: 0.36
step_num: 10600 | loss: 0.6445 | profit rate: 8703067.7 | accuracy: 0.35
step_num: 10800 | loss: 0.7755 | profit rate: 1532874668.2 | accuracy: 0.36
step_num: 11000 | loss: 0.9325 | profit rate: 8063715138.1 | accuracy: 0.37
episode:   3/5,耗时:2.37分/6.32分,训练集: | step: 11121 | average_treward:  299.7 | max_treward: 442.6105 | average profit rate: 1108546354.517
model saved @ step:11121,performance:3316245489.831,accuracy:0.37
step_num: 11200 | loss: 0.8217 | profit rate:    0.6 | accuracy: 0.33
step_num: 11400 | loss: 0.8708 | profit rate:   10.6 | accuracy: 0.40
step_num: 11600 | loss: 0.8566 | profit rate:  223.3 | accuracy: 0.41
step_num: 11800 | loss: 0.9480 | profit rate:  316.4 | accuracy: 0.40
step_num: 12000 | loss: 0.9355 | profit rate: 3205.8 | accuracy: 0.40
step_num: 12200 | loss: 0.8980 | profit rate:  610.9 | accuracy: 0.37
step_num: 12400 | loss: 0.8617 | profit rate:  841.6 | accuracy: 0.36
step_num: 12600 | loss: 0.8901 | profit rate: 9884.6 | accuracy: 0.37
step_num: 12800 | loss: 0.8026 | profit rate: 27476.8 | accuracy: 0.36
step_num: 13000 | loss: 0.8029 | profit rate: 25319.2 | accuracy: 0.35
step_num: 13200 | loss: 0.8231 | profit rate: 53831.5 | accuracy: 0.34
step_num: 13400 | loss: 0.7340 | profit rate: 6116540.2 | accuracy: 0.35
step_num: 13600 | loss: 0.7813 | profit rate: 17450709.2 | accuracy: 0.35
step_num: 13800 | loss: 0.7333 | profit rate: 14917413.4 | accuracy: 0.35
step_num: 14000 | loss: 0.7165 | profit rate: 47478678.8 | accuracy: 0.34
step_num: 14200 | loss: 0.7897 | profit rate: 118672314.7 | accuracy: 0.34
step_num: 14400 | loss: 0.8870 | profit rate: 439929514.1 | accuracy: 0.34
step_num: 14600 | loss: 0.8489 | profit rate: 34271558990.6 | accuracy: 0.35
step_num: 14800 | loss: 0.7452 | profit rate: 131542850578.5 | accuracy: 0.35
step_num: 15000 | loss: 0.9503 | profit rate:    0.0 | accuracy: 0.31
step_num: 15200 | loss: 0.8863 | profit rate:    0.1 | accuracy: 0.34
step_num: 15400 | loss: 0.7611 | profit rate:    0.0 | accuracy: 0.34
step_num: 15600 | loss: 0.8070 | profit rate:    1.0 | accuracy: 0.35
step_num: 15800 | loss: 0.7135 | profit rate:    0.4 | accuracy: 0.34
step_num: 16000 | loss: 0.7749 | profit rate:    3.0 | accuracy: 0.34
step_num: 16200 | loss: 0.6475 | profit rate:    9.2 | accuracy: 0.33
step_num: 16400 | loss: 0.6279 | profit rate:   24.5 | accuracy: 0.34
step_num: 16600 | loss: 0.7030 | profit rate:    8.1 | accuracy: 0.33
step_num: 16800 | loss: 0.7212 | profit rate:    8.9 | accuracy: 0.32
step_num: 17000 | loss: 0.6575 | profit rate:  167.0 | accuracy: 0.33
step_num: 17200 | loss: 0.6594 | profit rate: 1320402.0 | accuracy: 0.35
step_num: 17400 | loss: 0.6700 | profit rate: 116039.6 | accuracy: 0.35
step_num: 17600 | loss: 0.7707 | profit rate: 212310.2 | accuracy: 0.34
step_num: 17800 | loss: 0.6829 | profit rate: 682311.2 | accuracy: 0.34
step_num: 18000 | loss: 0.9435 | profit rate: 1529342.1 | accuracy: 0.34
step_num: 18200 | loss: 0.7023 | profit rate: 1433892287.1 | accuracy: 0.35
step_num: 18400 | loss: 0.6345 | profit rate: 4431182422.6 | accuracy: 0.35
episode:   5/5,耗时:2.29分/10.92分,训练集: | step: 18535 | average_treward:  357.6 | max_treward: 449.2449 | average profit rate: 32053665973.766
model saved @ step:18535,performance:6860111705.378,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 20%|        | 77/391 [00:00<00:00, 762.37it/s] 45%|     | 176/391 [00:00<00:00, 894.62it/s] 70%|   | 275/391 [00:00<00:00, 935.39it/s] 96%|| 374/391 [00:00<00:00, 955.52it/s]100%|| 391/391 [00:00<00:00, 933.93it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1358.38
2023-07-24T12:00:00 | net performance [%] = 35.8383
2023-07-24T12:00:00 | number of trades [#] = 24
==================================================
Trial 2 Complete [00h 10m 59s]
net_wealth: 1359.743183222804

Best net_wealth So Far: 1359.743183222804
Total elapsed time: 00h 13m 51s

Search: Running Trial #3

Value             |Best Value So Far |Hyperparameter
14                |9                 |horizon
180               |180               |lookback
False             |False             |MarketFactor
7                 |20                |lags
0.8               |0.98              |gamma
5e-05             |0.001             |DQN_lr
2000              |2000              |memory_size
64                |32                |batch_size
5                 |0.5               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.6312 | profit rate:   51.4 | accuracy: 0.34
step_num: 1200 | loss: 1.0607 | profit rate:    7.9 | accuracy: 0.33
step_num: 1400 | loss: 0.7747 | profit rate:    0.6 | accuracy: 0.32
step_num: 1600 | loss: 0.6676 | profit rate:    0.4 | accuracy: 0.33
step_num: 1800 | loss: 0.6508 | profit rate:    0.2 | accuracy: 0.32
step_num: 2000 | loss: 0.6227 | profit rate:    0.1 | accuracy: 0.32
step_num: 2200 | loss: 0.5373 | profit rate:    0.5 | accuracy: 0.32
step_num: 2400 | loss: 0.5688 | profit rate:  127.0 | accuracy: 0.33
step_num: 2600 | loss: 0.5618 | profit rate:   15.0 | accuracy: 0.33
step_num: 2800 | loss: 0.5709 | profit rate:    8.3 | accuracy: 0.34
step_num: 3000 | loss: 0.5937 | profit rate:    4.5 | accuracy: 0.34
step_num: 3200 | loss: 0.6113 | profit rate:   39.3 | accuracy: 0.35
step_num: 3400 | loss: 0.6112 | profit rate:    0.2 | accuracy: 0.35
step_num: 3600 | loss: 0.6359 | profit rate:    0.0 | accuracy: 0.35
episode:   1/5,耗时:1.03分/1.03分,训练集: | step: 3720 | average_treward:  -76.3 | max_treward: 0.0000 | average profit rate:  0.001
step_num: 3800 | loss: 0.6433 | profit rate:   88.1 | accuracy: 0.58
step_num: 4000 | loss: 0.6761 | profit rate:    4.2 | accuracy: 0.45
step_num: 4200 | loss: 0.7104 | profit rate:   50.9 | accuracy: 0.44
step_num: 4400 | loss: 0.6949 | profit rate:    8.1 | accuracy: 0.38
step_num: 4600 | loss: 0.6398 | profit rate:  151.5 | accuracy: 0.39
step_num: 4800 | loss: 0.6643 | profit rate:  289.5 | accuracy: 0.40
step_num: 5000 | loss: 0.6828 | profit rate:    1.1 | accuracy: 0.39
step_num: 5200 | loss: 0.6610 | profit rate:   54.0 | accuracy: 0.42
step_num: 5400 | loss: 0.7003 | profit rate:    4.7 | accuracy: 0.40
step_num: 5600 | loss: 0.6945 | profit rate:    0.1 | accuracy: 0.40
step_num: 5800 | loss: 0.6645 | profit rate:    0.1 | accuracy: 0.41
step_num: 6000 | loss: 0.6441 | profit rate: 1363.8 | accuracy: 0.43
step_num: 6200 | loss: 0.6534 | profit rate: 278759.8 | accuracy: 0.43
step_num: 6400 | loss: 0.6720 | profit rate: 112704.6 | accuracy: 0.43
step_num: 6600 | loss: 0.6909 | profit rate: 93265463.5 | accuracy: 0.45
step_num: 6800 | loss: 0.7135 | profit rate: 17462045.7 | accuracy: 0.44
step_num: 7000 | loss: 0.6674 | profit rate: 7193795.4 | accuracy: 0.43
step_num: 7200 | loss: 0.6896 | profit rate: 41027724.5 | accuracy: 0.44
step_num: 7400 | loss: 0.6648 | profit rate: 74213093.3 | accuracy: 0.43
model saved @ step:7440,performance:110100262.666,accuracy:0.44
step_num: 7600 | loss: 0.6895 | profit rate:    0.0 | accuracy: 0.37
step_num: 7800 | loss: 0.7448 | profit rate:    1.0 | accuracy: 0.42
step_num: 8000 | loss: 0.7321 | profit rate:    1.2 | accuracy: 0.42
step_num: 8200 | loss: 0.6953 | profit rate:   10.8 | accuracy: 0.40
step_num: 8400 | loss: 0.6954 | profit rate:    3.5 | accuracy: 0.41
step_num: 8600 | loss: 0.7280 | profit rate:    0.4 | accuracy: 0.42
step_num: 8800 | loss: 0.7065 | profit rate:    1.9 | accuracy: 0.43
step_num: 9000 | loss: 0.7201 | profit rate:    3.8 | accuracy: 0.43
step_num: 9200 | loss: 0.7507 | profit rate:   10.2 | accuracy: 0.41
step_num: 9400 | loss: 0.7305 | profit rate:    0.8 | accuracy: 0.42
step_num: 9600 | loss: 0.6797 | profit rate:   22.7 | accuracy: 0.44
step_num: 9800 | loss: 0.6897 | profit rate: 3777407.7 | accuracy: 0.45
step_num: 10000 | loss: 0.6390 | profit rate: 315016226.8 | accuracy: 0.45
step_num: 10200 | loss: 0.6533 | profit rate: 515592847.5 | accuracy: 0.45
step_num: 10400 | loss: 0.6837 | profit rate: 89341633757.7 | accuracy: 0.46
step_num: 10600 | loss: 0.6509 | profit rate: 1064905960564.8 | accuracy: 0.46
step_num: 10800 | loss: 0.6139 | profit rate: 1961948071129.0 | accuracy: 0.45
step_num: 11000 | loss: 0.5998 | profit rate: 4208323824461.7 | accuracy: 0.45
episode:   3/5,耗时:1.36分/3.80分,训练集: | step: 11160 | average_treward:  225.7 | max_treward: 457.0011 | average profit rate: 2917152612360.014
model saved @ step:11160,performance:8751347736817.377,accuracy:0.45
step_num: 11200 | loss: 0.5997 | profit rate:  254.7 | accuracy: 0.80
step_num: 11400 | loss: 0.6590 | profit rate: 1084.4 | accuracy: 0.53
step_num: 11600 | loss: 0.6938 | profit rate: 9900.0 | accuracy: 0.50
step_num: 11800 | loss: 0.6815 | profit rate:  604.5 | accuracy: 0.45
step_num: 12000 | loss: 0.6631 | profit rate: 51489.8 | accuracy: 0.42
step_num: 12200 | loss: 0.7052 | profit rate:  135.7 | accuracy: 0.41
step_num: 12400 | loss: 0.7401 | profit rate:    0.0 | accuracy: 0.40
step_num: 12600 | loss: 0.7191 | profit rate:    5.0 | accuracy: 0.42
step_num: 12800 | loss: 0.7394 | profit rate:    1.0 | accuracy: 0.40
step_num: 13000 | loss: 0.7170 | profit rate:    2.0 | accuracy: 0.38
step_num: 13200 | loss: 0.6588 | profit rate:    5.0 | accuracy: 0.40
step_num: 13400 | loss: 0.6267 | profit rate: 3015.1 | accuracy: 0.41
step_num: 13600 | loss: 0.6382 | profit rate: 1109635703.8 | accuracy: 0.43
step_num: 13800 | loss: 0.5660 | profit rate: 3507899755.3 | accuracy: 0.42
step_num: 14000 | loss: 0.6298 | profit rate: 80209113338.3 | accuracy: 0.43
step_num: 14200 | loss: 0.5793 | profit rate: 326178072269.9 | accuracy: 0.44
step_num: 14400 | loss: 0.5798 | profit rate: 1575953892599.4 | accuracy: 0.43
step_num: 14600 | loss: 0.5735 | profit rate: 96165347342.9 | accuracy: 0.43
step_num: 14800 | loss: 0.5827 | profit rate: 196040243713.6 | accuracy: 0.43
step_num: 15000 | loss: 0.6268 | profit rate:    1.4 | accuracy: 0.45
step_num: 15200 | loss: 0.6735 | profit rate:   19.7 | accuracy: 0.43
step_num: 15400 | loss: 0.6831 | profit rate:  424.5 | accuracy: 0.45
step_num: 15600 | loss: 0.6696 | profit rate: 13717.7 | accuracy: 0.42
step_num: 15800 | loss: 0.6583 | profit rate: 16160.1 | accuracy: 0.41
step_num: 16000 | loss: 0.7172 | profit rate:    2.8 | accuracy: 0.39
step_num: 16200 | loss: 0.6837 | profit rate:    0.1 | accuracy: 0.39
step_num: 16400 | loss: 0.6792 | profit rate:    5.1 | accuracy: 0.40
step_num: 16600 | loss: 0.6605 | profit rate:   33.2 | accuracy: 0.37
step_num: 16800 | loss: 0.6115 | profit rate:    3.7 | accuracy: 0.36
step_num: 17000 | loss: 0.5676 | profit rate:    1.5 | accuracy: 0.35
step_num: 17200 | loss: 0.5691 | profit rate: 659294.2 | accuracy: 0.39
step_num: 17400 | loss: 0.5473 | profit rate: 1975740878.9 | accuracy: 0.39
step_num: 17600 | loss: 0.5470 | profit rate: 162503687.6 | accuracy: 0.39
step_num: 17800 | loss: 0.5508 | profit rate: 6904517058.0 | accuracy: 0.40
step_num: 18000 | loss: 0.5788 | profit rate: 23895891907.0 | accuracy: 0.40
step_num: 18200 | loss: 0.5434 | profit rate: 27516180960.0 | accuracy: 0.40
step_num: 18400 | loss: 0.5528 | profit rate: 27360717212.1 | accuracy: 0.41
episode:   5/5,耗时:1.41分/6.57分,训练集: | step: 18600 | average_treward:  279.2 | max_treward: 457.0011 | average profit rate: 1800659098255.387
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 24%|       | 98/404 [00:00<00:00, 980.00it/s] 49%|     | 199/404 [00:00<00:00, 996.90it/s] 74%|  | 299/404 [00:00<00:00, 980.38it/s]==================================================
100%|| 404/404 [00:00<00:00, 1007.21it/s]100%|| 404/404 [00:00<00:00, 996.98it/s] 
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1256.79
2023-07-24T12:00:00 | net performance [%] = 25.6785
2023-07-24T12:00:00 | number of trades [#] = 24
==================================================
Trial 3 Complete [00h 06m 37s]
net_wealth: 1256.7854106863222

Best net_wealth So Far: 1359.743183222804
Total elapsed time: 00h 20m 29s

Search: Running Trial #4

Value             |Best Value So Far |Hyperparameter
5                 |9                 |horizon
225               |180               |lookback
True              |False             |MarketFactor
14                |20                |lags
0.6               |0.98              |gamma
1e-05             |0.001             |DQN_lr
64                |2000              |memory_size
64                |32                |batch_size
0.5               |0.5               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4296.000000   4301.000000
mean      0.000435    20113.607657  ...   20187.844288  20169.373185
std       0.027833    16040.642334  ...   16078.813220  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7752.362549   7730.930176
50%       0.000642    11571.842969  ...   11756.264648  11751.469727
75%       0.011590    29894.706152  ...   30017.365723  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.4280 | profit rate:    2.0 | accuracy: 0.34
step_num: 400 | loss: 0.8876 | profit rate:    0.9 | accuracy: 0.31
step_num: 600 | loss: 0.8503 | profit rate:    0.5 | accuracy: 0.30
step_num: 800 | loss: 0.3499 | profit rate:    0.9 | accuracy: 0.29
step_num: 1000 | loss: 0.7743 | profit rate:    1.5 | accuracy: 0.33
step_num: 1200 | loss: 0.6271 | profit rate:    2.1 | accuracy: 0.34
step_num: 1400 | loss: 0.5266 | profit rate:    3.6 | accuracy: 0.33
step_num: 1600 | loss: 1.1734 | profit rate:   13.1 | accuracy: 0.33
step_num: 1800 | loss: 0.5850 | profit rate:   40.1 | accuracy: 0.33
step_num: 2000 | loss: 0.5490 | profit rate:   15.6 | accuracy: 0.33
step_num: 2200 | loss: 1.0520 | profit rate:   88.1 | accuracy: 0.35
step_num: 2400 | loss: 0.7137 | profit rate:   56.4 | accuracy: 0.36
step_num: 2600 | loss: 0.2571 | profit rate:   58.1 | accuracy: 0.34
step_num: 2800 | loss: 0.7453 | profit rate:   62.8 | accuracy: 0.35
step_num: 3000 | loss: 0.4731 | profit rate:   44.6 | accuracy: 0.35
step_num: 3200 | loss: 0.4922 | profit rate:   46.1 | accuracy: 0.34
step_num: 3400 | loss: 0.6508 | profit rate:   54.5 | accuracy: 0.34
step_num: 3600 | loss: 0.4875 | profit rate:   27.2 | accuracy: 0.33
episode:   1/5,耗时:0.46分/0.46分,训练集: | step: 3654 | average_treward:  116.7 | max_treward: 116.7251 | average profit rate: 28.361
model saved @ step:3654,performance:28.361,accuracy:0.33
step_num: 3800 | loss: 0.8350 | profit rate:    0.7 | accuracy: 0.38
step_num: 4000 | loss: 0.5648 | profit rate:    1.0 | accuracy: 0.31
step_num: 4200 | loss: 0.2606 | profit rate:    0.6 | accuracy: 0.29
step_num: 4400 | loss: 0.5338 | profit rate:    1.0 | accuracy: 0.27
step_num: 4600 | loss: 0.9228 | profit rate:    1.2 | accuracy: 0.30
step_num: 4800 | loss: 0.7953 | profit rate:    3.8 | accuracy: 0.33
step_num: 5000 | loss: 0.4587 | profit rate:    2.1 | accuracy: 0.32
step_num: 5200 | loss: 0.5735 | profit rate:    3.0 | accuracy: 0.32
step_num: 5400 | loss: 0.5702 | profit rate:    4.6 | accuracy: 0.32
step_num: 5600 | loss: 0.7666 | profit rate:    3.7 | accuracy: 0.33
step_num: 5800 | loss: 0.8921 | profit rate:   10.3 | accuracy: 0.34
step_num: 6000 | loss: 0.6706 | profit rate:   23.5 | accuracy: 0.35
step_num: 6200 | loss: 0.3308 | profit rate:   23.3 | accuracy: 0.35
step_num: 6400 | loss: 0.6486 | profit rate:   13.3 | accuracy: 0.34
step_num: 6600 | loss: 0.2596 | profit rate:   34.4 | accuracy: 0.35
step_num: 6800 | loss: 0.5684 | profit rate:   31.6 | accuracy: 0.35
step_num: 7000 | loss: 0.7144 | profit rate:   18.1 | accuracy: 0.34
step_num: 7200 | loss: 0.5326 | profit rate:   17.2 | accuracy: 0.34
model saved @ step:7308,performance:16.495,accuracy:0.33
step_num: 7400 | loss: 0.6243 | profit rate:    0.3 | accuracy: 0.38
step_num: 7600 | loss: 0.3508 | profit rate:    0.3 | accuracy: 0.30
step_num: 7800 | loss: 0.3902 | profit rate:    0.4 | accuracy: 0.30
step_num: 8000 | loss: 0.5809 | profit rate:    0.5 | accuracy: 0.30
step_num: 8200 | loss: 0.4121 | profit rate:    0.5 | accuracy: 0.29
step_num: 8400 | loss: 0.6305 | profit rate:    1.0 | accuracy: 0.33
step_num: 8600 | loss: 0.3420 | profit rate:    0.9 | accuracy: 0.33
step_num: 8800 | loss: 0.4324 | profit rate:    0.7 | accuracy: 0.32
step_num: 9000 | loss: 0.2595 | profit rate:    2.2 | accuracy: 0.33
step_num: 9200 | loss: 0.5695 | profit rate:    1.4 | accuracy: 0.33
step_num: 9400 | loss: 0.5022 | profit rate:    2.8 | accuracy: 0.34
step_num: 9600 | loss: 0.5756 | profit rate:   34.6 | accuracy: 0.35
step_num: 9800 | loss: 0.8818 | profit rate:   21.2 | accuracy: 0.36
step_num: 10000 | loss: 0.6058 | profit rate:   14.8 | accuracy: 0.35
step_num: 10200 | loss: 0.5624 | profit rate:   27.6 | accuracy: 0.36
step_num: 10400 | loss: 0.4814 | profit rate:   21.1 | accuracy: 0.35
step_num: 10600 | loss: 0.3089 | profit rate:   15.3 | accuracy: 0.34
step_num: 10800 | loss: 0.3319 | profit rate:   18.0 | accuracy: 0.34
episode:   3/5,耗时:0.50分/1.47分,训练集: | step: 10962 | average_treward:  126.1 | max_treward: 131.0152 | average profit rate: 17.683
step_num: 11000 | loss: 0.6285 | profit rate:    0.5 | accuracy: 0.36
step_num: 11200 | loss: 0.4440 | profit rate:    0.2 | accuracy: 0.31
step_num: 11400 | loss: 0.5590 | profit rate:    0.3 | accuracy: 0.33
step_num: 11600 | loss: 0.2609 | profit rate:    0.2 | accuracy: 0.31
step_num: 11800 | loss: 0.4731 | profit rate:    0.5 | accuracy: 0.31
step_num: 12000 | loss: 0.5975 | profit rate:    1.7 | accuracy: 0.33
step_num: 12200 | loss: 0.4137 | profit rate:    1.9 | accuracy: 0.34
step_num: 12400 | loss: 0.2629 | profit rate:    2.9 | accuracy: 0.33
step_num: 12600 | loss: 0.8394 | profit rate:    9.4 | accuracy: 0.34
step_num: 12800 | loss: 0.4015 | profit rate:   12.4 | accuracy: 0.34
step_num: 13000 | loss: 0.4642 | profit rate:    4.3 | accuracy: 0.34
step_num: 13200 | loss: 0.8247 | profit rate:  155.9 | accuracy: 0.36
step_num: 13400 | loss: 0.7228 | profit rate:  129.4 | accuracy: 0.37
step_num: 13600 | loss: 0.5650 | profit rate:  116.3 | accuracy: 0.36
step_num: 13800 | loss: 0.4446 | profit rate:  135.6 | accuracy: 0.36
step_num: 14000 | loss: 0.4809 | profit rate:  129.5 | accuracy: 0.35
step_num: 14200 | loss: 0.4046 | profit rate:  219.3 | accuracy: 0.35
step_num: 14400 | loss: 0.4936 | profit rate:  181.2 | accuracy: 0.35
step_num: 14600 | loss: 0.2513 | profit rate:   75.7 | accuracy: 0.34
model saved @ step:14616,performance:82.742,accuracy:0.34
step_num: 14800 | loss: 0.5012 | profit rate:    0.9 | accuracy: 0.39
step_num: 15000 | loss: 0.4501 | profit rate:    1.6 | accuracy: 0.35
step_num: 15200 | loss: 0.3452 | profit rate:    0.4 | accuracy: 0.31
step_num: 15400 | loss: 0.3891 | profit rate:    1.4 | accuracy: 0.31
step_num: 15600 | loss: 0.4726 | profit rate:    1.3 | accuracy: 0.32
step_num: 15800 | loss: 0.6376 | profit rate:    3.7 | accuracy: 0.34
step_num: 16000 | loss: 0.5179 | profit rate:    6.1 | accuracy: 0.34
step_num: 16200 | loss: 0.6710 | profit rate:    6.1 | accuracy: 0.34
step_num: 16400 | loss: 0.5591 | profit rate:   16.3 | accuracy: 0.34
step_num: 16600 | loss: 0.6645 | profit rate:    4.9 | accuracy: 0.34
step_num: 16800 | loss: 0.6999 | profit rate:  121.9 | accuracy: 0.36
step_num: 17000 | loss: 0.4673 | profit rate:  261.7 | accuracy: 0.36
step_num: 17200 | loss: 0.1701 | profit rate:  476.0 | accuracy: 0.36
step_num: 17400 | loss: 0.6937 | profit rate:  293.5 | accuracy: 0.36
step_num: 17600 | loss: 0.3720 | profit rate:  397.1 | accuracy: 0.36
step_num: 17800 | loss: 0.4036 | profit rate:  554.8 | accuracy: 0.35
step_num: 18000 | loss: 0.5791 | profit rate:  369.5 | accuracy: 0.35
step_num: 18200 | loss: 0.4809 | profit rate:  187.6 | accuracy: 0.35
episode:   5/5,耗时:0.50分/2.47分,训练集: | step: 18270 | average_treward:  149.1 | max_treward: 190.0688 | average profit rate: 63.915
model saved @ step:18270,performance:183.783,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 21%|        | 83/397 [00:00<00:00, 828.87it/s] 49%|     | 196/397 [00:00<00:00, 1000.03it/s] 77%|  | 306/397 [00:00<00:00, 1045.07it/s]100%|| 397/397 [00:00<00:00, 1032.44it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 859.73
2023-07-24T12:00:00 | net performance [%] = -14.0268
2023-07-24T12:00:00 | number of trades [#] = 80
==================================================
Trial 4 Complete [00h 02m 32s]
net_wealth: 859.7316318097282

Best net_wealth So Far: 1359.743183222804
Total elapsed time: 00h 23m 01s

Search: Running Trial #5

Value             |Best Value So Far |Hyperparameter
10                |9                 |horizon
180               |180               |lookback
False             |False             |MarketFactor
14                |20                |lags
0.6               |0.98              |gamma
1e-05             |0.001             |DQN_lr
512               |2000              |memory_size
64                |32                |batch_size
0.2               |0.5               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4305.000000   4315.000000
mean      0.000441    20062.255222  ...   20154.979356  20118.633889
std       0.027818    16039.874230  ...   16078.042379  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7717.890137   7690.540039
50%       0.000642    11554.824463  ...   11748.200195  11715.610352
75%       0.011655    29873.081836  ...   29993.890625  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 1.3711 | profit rate:    0.2 | accuracy: 0.31
step_num: 600 | loss: 1.0097 | profit rate:    0.5 | accuracy: 0.32
step_num: 800 | loss: 1.1979 | profit rate:    0.2 | accuracy: 0.33
step_num: 1000 | loss: 1.2147 | profit rate:    0.3 | accuracy: 0.32
step_num: 1200 | loss: 1.2197 | profit rate:    0.3 | accuracy: 0.29
step_num: 1400 | loss: 1.0207 | profit rate:    0.1 | accuracy: 0.29
step_num: 1600 | loss: 0.7264 | profit rate:    0.1 | accuracy: 0.30
step_num: 1800 | loss: 0.8540 | profit rate:    2.4 | accuracy: 0.31
step_num: 2000 | loss: 0.5593 | profit rate:    2.3 | accuracy: 0.29
step_num: 2200 | loss: 0.4875 | profit rate:    5.7 | accuracy: 0.28
step_num: 2400 | loss: 0.4296 | profit rate:    0.5 | accuracy: 0.26
step_num: 2600 | loss: 0.5433 | profit rate:    0.1 | accuracy: 0.26
step_num: 2800 | loss: 0.5982 | profit rate:    1.8 | accuracy: 0.26
step_num: 3000 | loss: 0.6445 | profit rate:    0.3 | accuracy: 0.26
step_num: 3200 | loss: 0.5009 | profit rate:    0.8 | accuracy: 0.27
step_num: 3400 | loss: 0.7813 | profit rate:    0.0 | accuracy: 0.27
step_num: 3600 | loss: 0.7302 | profit rate:    0.0 | accuracy: 0.28
episode:   1/5,耗时:0.61分/0.61分,训练集: | step: 3713 | average_treward:   -0.8 | max_treward: 0.0000 | average profit rate:  0.003
step_num: 3800 | loss: 0.7095 | profit rate:    3.0 | accuracy: 0.20
step_num: 4000 | loss: 0.7055 | profit rate:   79.9 | accuracy: 0.40
step_num: 4200 | loss: 0.7332 | profit rate:  189.4 | accuracy: 0.41
step_num: 4400 | loss: 0.6075 | profit rate: 1128.7 | accuracy: 0.42
step_num: 4600 | loss: 0.7515 | profit rate:   94.4 | accuracy: 0.41
step_num: 4800 | loss: 0.6652 | profit rate:   88.4 | accuracy: 0.34
step_num: 5000 | loss: 0.3844 | profit rate:    9.1 | accuracy: 0.32
step_num: 5200 | loss: 0.5227 | profit rate:   50.8 | accuracy: 0.35
step_num: 5400 | loss: 0.6586 | profit rate:   51.3 | accuracy: 0.34
step_num: 5600 | loss: 0.5180 | profit rate:   83.7 | accuracy: 0.34
step_num: 5800 | loss: 0.3337 | profit rate:   58.2 | accuracy: 0.33
step_num: 6000 | loss: 0.2418 | profit rate:   20.9 | accuracy: 0.30
step_num: 6200 | loss: 0.3158 | profit rate:   15.6 | accuracy: 0.29
step_num: 6400 | loss: 0.5188 | profit rate:    3.2 | accuracy: 0.30
step_num: 6600 | loss: 0.4778 | profit rate:   10.1 | accuracy: 0.29
step_num: 6800 | loss: 0.5496 | profit rate:    8.9 | accuracy: 0.30
step_num: 7000 | loss: 0.6328 | profit rate:    0.3 | accuracy: 0.30
step_num: 7200 | loss: 0.7573 | profit rate:    0.1 | accuracy: 0.30
step_num: 7400 | loss: 0.7472 | profit rate:    0.1 | accuracy: 0.31
model saved @ step:7426,performance:0.071,accuracy:0.31
step_num: 7600 | loss: 0.6759 | profit rate:   13.9 | accuracy: 0.37
step_num: 7800 | loss: 0.6397 | profit rate:  323.5 | accuracy: 0.41
step_num: 8000 | loss: 0.6714 | profit rate: 1119.3 | accuracy: 0.42
step_num: 8200 | loss: 0.7212 | profit rate:  356.5 | accuracy: 0.42
step_num: 8400 | loss: 0.6106 | profit rate:  206.4 | accuracy: 0.39
step_num: 8600 | loss: 0.5355 | profit rate:  346.5 | accuracy: 0.35
step_num: 8800 | loss: 0.3982 | profit rate:  447.2 | accuracy: 0.37
step_num: 9000 | loss: 0.6063 | profit rate:  150.0 | accuracy: 0.38
step_num: 9200 | loss: 0.6836 | profit rate:    3.3 | accuracy: 0.37
step_num: 9400 | loss: 0.4955 | profit rate:    1.4 | accuracy: 0.35
step_num: 9600 | loss: 0.4200 | profit rate:    2.3 | accuracy: 0.35
step_num: 9800 | loss: 0.4644 | profit rate:    4.3 | accuracy: 0.34
step_num: 10000 | loss: 0.4879 | profit rate:    1.5 | accuracy: 0.34
step_num: 10200 | loss: 0.5119 | profit rate:    0.4 | accuracy: 0.33
step_num: 10400 | loss: 0.5327 | profit rate:    0.2 | accuracy: 0.33
step_num: 10600 | loss: 0.5050 | profit rate:    0.4 | accuracy: 0.33
step_num: 10800 | loss: 0.7368 | profit rate:    0.6 | accuracy: 0.34
step_num: 11000 | loss: 0.6989 | profit rate:    0.6 | accuracy: 0.35
episode:   3/5,耗时:0.69分/2.00分,训练集: | step: 11139 | average_treward:   32.3 | max_treward: 51.7294 | average profit rate:  0.283
model saved @ step:11139,performance:0.776,accuracy:0.35
step_num: 11200 | loss: 0.6416 | profit rate:    0.9 | accuracy: 0.19
step_num: 11400 | loss: 0.7629 | profit rate:   69.9 | accuracy: 0.44
step_num: 11600 | loss: 0.7378 | profit rate:  190.2 | accuracy: 0.44
step_num: 11800 | loss: 0.6272 | profit rate:  666.1 | accuracy: 0.44
step_num: 12000 | loss: 0.7125 | profit rate: 1844.5 | accuracy: 0.45
step_num: 12200 | loss: 0.5292 | profit rate: 1116.5 | accuracy: 0.39
step_num: 12400 | loss: 0.4689 | profit rate:  192.0 | accuracy: 0.38
step_num: 12600 | loss: 0.5611 | profit rate:  732.5 | accuracy: 0.41
step_num: 12800 | loss: 0.6886 | profit rate:   21.4 | accuracy: 0.40
step_num: 13000 | loss: 0.6655 | profit rate:    1.8 | accuracy: 0.38
step_num: 13200 | loss: 0.5453 | profit rate:    1.2 | accuracy: 0.38
step_num: 13400 | loss: 0.4180 | profit rate:    4.5 | accuracy: 0.36
step_num: 13600 | loss: 0.4268 | profit rate:   12.0 | accuracy: 0.36
step_num: 13800 | loss: 0.5719 | profit rate:    6.3 | accuracy: 0.37
step_num: 14000 | loss: 0.5063 | profit rate:    9.5 | accuracy: 0.36
step_num: 14200 | loss: 0.5712 | profit rate:    9.9 | accuracy: 0.36
step_num: 14400 | loss: 0.6166 | profit rate:    8.0 | accuracy: 0.36
step_num: 14600 | loss: 0.7090 | profit rate:   43.2 | accuracy: 0.36
step_num: 14800 | loss: 0.6901 | profit rate:   61.8 | accuracy: 0.37
model saved @ step:14852,performance:80.214,accuracy:0.37
step_num: 15000 | loss: 0.6775 | profit rate:    0.2 | accuracy: 0.30
step_num: 15200 | loss: 0.7128 | profit rate:    1.4 | accuracy: 0.37
step_num: 15400 | loss: 0.7565 | profit rate:    3.0 | accuracy: 0.40
step_num: 15600 | loss: 0.6493 | profit rate:   14.9 | accuracy: 0.41
step_num: 15800 | loss: 0.5652 | profit rate:   95.9 | accuracy: 0.41
step_num: 16000 | loss: 0.5089 | profit rate:  281.4 | accuracy: 0.38
step_num: 16200 | loss: 0.4557 | profit rate:  194.2 | accuracy: 0.39
step_num: 16400 | loss: 0.6524 | profit rate:  179.7 | accuracy: 0.40
step_num: 16600 | loss: 0.7306 | profit rate:    6.9 | accuracy: 0.39
step_num: 16800 | loss: 0.6157 | profit rate:    0.8 | accuracy: 0.37
step_num: 17000 | loss: 0.5345 | profit rate:    0.6 | accuracy: 0.37
step_num: 17200 | loss: 0.4385 | profit rate:    9.3 | accuracy: 0.36
step_num: 17400 | loss: 0.4706 | profit rate:   19.6 | accuracy: 0.36
step_num: 17600 | loss: 0.5485 | profit rate:   52.5 | accuracy: 0.36
step_num: 17800 | loss: 0.5660 | profit rate:   26.3 | accuracy: 0.35
step_num: 18000 | loss: 0.5712 | profit rate:   64.2 | accuracy: 0.36
step_num: 18200 | loss: 0.6824 | profit rate: 5270.9 | accuracy: 0.37
step_num: 18400 | loss: 0.6306 | profit rate: 2290.2 | accuracy: 0.37
episode:   5/5,耗时:0.73分/3.43分,训练集: | step: 18565 | average_treward:   68.6 | max_treward: 141.2814 | average profit rate: 438.991
model saved @ step:18565,performance:2113.892,accuracy:0.37
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 20%|        | 80/397 [00:00<00:00, 799.99it/s] 45%|     | 178/397 [00:00<00:00, 905.30it/s] 70%|   | 278/397 [00:00<00:00, 948.53it/s] 95%|| 377/397 [00:00<00:00, 964.89it/s]100%|| 397/397 [00:00<00:00, 942.75it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1178.47
2023-07-24T12:00:00 | net performance [%] = 17.8468
2023-07-24T12:00:00 | number of trades [#] = 60
==================================================
Trial 5 Complete [00h 03m 29s]
net_wealth: 1179.647952128476

Best net_wealth So Far: 1359.743183222804
Total elapsed time: 00h 26m 30s

Search: Running Trial #6

Value             |Best Value So Far |Hyperparameter
5                 |9                 |horizon
225               |180               |lookback
False             |False             |MarketFactor
3                 |20                |lags
0.6               |0.98              |gamma
0.001             |0.001             |DQN_lr
256               |2000              |memory_size
32                |32                |batch_size
1                 |0.5               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4310.000000   4315.000000
mean      0.000441    20062.255222  ...   20136.939364  20118.633889
std       0.027818    16039.874230  ...   16077.430342  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7696.969971   7690.540039
50%       0.000642    11554.824463  ...   11742.710449  11715.610352
75%       0.011655    29873.081836  ...   29945.211914  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.7700 | profit rate:    2.2 | accuracy: 0.32
step_num: 400 | loss: 0.5101 | profit rate:    3.1 | accuracy: 0.35
step_num: 600 | loss: 0.5353 | profit rate:    4.3 | accuracy: 0.36
step_num: 800 | loss: 0.5137 | profit rate:    0.6 | accuracy: 0.35
step_num: 1000 | loss: 0.3533 | profit rate:    0.4 | accuracy: 0.34
step_num: 1200 | loss: 0.3374 | profit rate:    4.4 | accuracy: 0.34
step_num: 1400 | loss: 0.5260 | profit rate:    1.3 | accuracy: 0.35
step_num: 1600 | loss: 0.5470 | profit rate:    1.4 | accuracy: 0.36
step_num: 1800 | loss: 0.5739 | profit rate:    3.6 | accuracy: 0.37
step_num: 2000 | loss: 0.5670 | profit rate:    6.2 | accuracy: 0.38
step_num: 2200 | loss: 0.4441 | profit rate:    4.1 | accuracy: 0.37
step_num: 2400 | loss: 0.3814 | profit rate:   39.4 | accuracy: 0.37
step_num: 2600 | loss: 0.7826 | profit rate:    3.0 | accuracy: 0.37
step_num: 2800 | loss: 0.3621 | profit rate:    1.4 | accuracy: 0.36
step_num: 3000 | loss: 0.1078 | profit rate:    1.6 | accuracy: 0.34
step_num: 3200 | loss: 0.1607 | profit rate:    6.4 | accuracy: 0.33
step_num: 3400 | loss: 0.4030 | profit rate:    9.9 | accuracy: 0.33
step_num: 3600 | loss: 0.4738 | profit rate:   60.2 | accuracy: 0.34
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3679 | average_treward:  118.5 | max_treward: 118.4953 | average profit rate: 73.631
model saved @ step:3679,performance:73.631,accuracy:0.34
step_num: 3800 | loss: 0.5525 | profit rate:   22.4 | accuracy: 0.48
step_num: 4000 | loss: 0.4291 | profit rate:   42.9 | accuracy: 0.37
step_num: 4200 | loss: 0.1605 | profit rate:  182.5 | accuracy: 0.30
step_num: 4400 | loss: 0.3101 | profit rate:  359.1 | accuracy: 0.31
step_num: 4600 | loss: 0.1997 | profit rate:  270.9 | accuracy: 0.28
step_num: 4800 | loss: 0.4076 | profit rate:   27.6 | accuracy: 0.27
step_num: 5000 | loss: 0.0759 | profit rate:   24.0 | accuracy: 0.23
step_num: 5200 | loss: 0.0105 | profit rate:   23.3 | accuracy: 0.21
step_num: 5400 | loss: 0.0774 | profit rate:   15.6 | accuracy: 0.19
step_num: 5600 | loss: 0.0343 | profit rate:   14.4 | accuracy: 0.18
step_num: 5800 | loss: 0.0307 | profit rate:   15.9 | accuracy: 0.16
step_num: 6000 | loss: 0.0938 | profit rate:   29.7 | accuracy: 0.16
step_num: 6200 | loss: 0.1810 | profit rate:   21.1 | accuracy: 0.16
step_num: 6400 | loss: 0.0339 | profit rate:   19.5 | accuracy: 0.15
step_num: 6600 | loss: 0.0338 | profit rate:   20.1 | accuracy: 0.14
step_num: 6800 | loss: 0.0554 | profit rate:   15.3 | accuracy: 0.13
step_num: 7000 | loss: 0.0183 | profit rate:   12.8 | accuracy: 0.13
step_num: 7200 | loss: 0.1030 | profit rate:   17.7 | accuracy: 0.13
step_num: 7400 | loss: 0.1438 | profit rate:    0.5 | accuracy: 0.02
step_num: 7600 | loss: 0.3694 | profit rate:    0.1 | accuracy: 0.12
step_num: 7800 | loss: 0.1004 | profit rate:    0.1 | accuracy: 0.09
step_num: 8000 | loss: 0.0118 | profit rate:    0.1 | accuracy: 0.07
step_num: 8200 | loss: 0.0567 | profit rate:    0.1 | accuracy: 0.07
step_num: 8400 | loss: 0.0223 | profit rate:    0.1 | accuracy: 0.06
step_num: 8600 | loss: 0.0280 | profit rate:    0.1 | accuracy: 0.06
step_num: 8800 | loss: 0.1418 | profit rate:    0.1 | accuracy: 0.07
step_num: 9000 | loss: 0.1652 | profit rate:    0.1 | accuracy: 0.08
step_num: 9200 | loss: 0.1519 | profit rate:    0.1 | accuracy: 0.09
step_num: 9400 | loss: 0.1035 | profit rate:    0.2 | accuracy: 0.09
step_num: 9600 | loss: 0.3399 | profit rate:   15.0 | accuracy: 0.13
step_num: 9800 | loss: 0.5909 | profit rate:   37.8 | accuracy: 0.16
step_num: 10000 | loss: 0.5746 | profit rate:    7.3 | accuracy: 0.18
step_num: 10200 | loss: 0.2684 | profit rate:   15.0 | accuracy: 0.18
step_num: 10400 | loss: 0.2514 | profit rate:   34.1 | accuracy: 0.19
step_num: 10600 | loss: 0.2353 | profit rate:   50.4 | accuracy: 0.19
step_num: 10800 | loss: 0.1952 | profit rate:   94.1 | accuracy: 0.19
step_num: 11000 | loss: 0.3503 | profit rate:  168.6 | accuracy: 0.19
episode:   3/5,耗时:0.68分/2.00分,训练集: | step: 11037 | average_treward:  132.9 | max_treward: 179.9636 | average profit rate: 108.377
model saved @ step:11037,performance:219.802,accuracy:0.20
step_num: 11200 | loss: 0.3519 | profit rate:   32.3 | accuracy: 0.37
step_num: 11400 | loss: 0.2530 | profit rate:   40.1 | accuracy: 0.28
step_num: 11600 | loss: 0.1255 | profit rate:  162.8 | accuracy: 0.25
step_num: 11800 | loss: 0.3363 | profit rate:   51.8 | accuracy: 0.26
step_num: 12000 | loss: 0.5542 | profit rate:   11.2 | accuracy: 0.25
step_num: 12200 | loss: 0.2426 | profit rate:    2.6 | accuracy: 0.23
step_num: 12400 | loss: 0.0612 | profit rate:    2.5 | accuracy: 0.21
step_num: 12600 | loss: 0.0470 | profit rate:    2.7 | accuracy: 0.19
step_num: 12800 | loss: 0.1820 | profit rate:    7.4 | accuracy: 0.19
step_num: 13000 | loss: 0.1553 | profit rate:   14.6 | accuracy: 0.19
step_num: 13200 | loss: 0.3796 | profit rate:    8.0 | accuracy: 0.21
step_num: 13400 | loss: 0.4465 | profit rate: 1356.0 | accuracy: 0.23
step_num: 13600 | loss: 0.7601 | profit rate:   67.0 | accuracy: 0.24
step_num: 13800 | loss: 0.4279 | profit rate:  112.5 | accuracy: 0.25
step_num: 14000 | loss: 0.4112 | profit rate:   48.9 | accuracy: 0.25
step_num: 14200 | loss: 0.1402 | profit rate:   73.8 | accuracy: 0.24
step_num: 14400 | loss: 0.1057 | profit rate:   59.4 | accuracy: 0.23
step_num: 14600 | loss: 0.3842 | profit rate:  189.6 | accuracy: 0.24
step_num: 14800 | loss: 0.4365 | profit rate:   23.2 | accuracy: 0.54
step_num: 15000 | loss: 0.3324 | profit rate:   31.7 | accuracy: 0.33
step_num: 15200 | loss: 0.1587 | profit rate:  103.5 | accuracy: 0.25
step_num: 15400 | loss: 0.3715 | profit rate:   58.2 | accuracy: 0.27
step_num: 15600 | loss: 0.2376 | profit rate:   60.0 | accuracy: 0.24
step_num: 15800 | loss: 0.4771 | profit rate:    6.6 | accuracy: 0.25
step_num: 16000 | loss: 0.3521 | profit rate:    3.5 | accuracy: 0.25
step_num: 16200 | loss: 0.0989 | profit rate:    4.0 | accuracy: 0.22
step_num: 16400 | loss: 0.0392 | profit rate:    4.2 | accuracy: 0.21
step_num: 16600 | loss: 0.1928 | profit rate:    5.9 | accuracy: 0.21
step_num: 16800 | loss: 0.2477 | profit rate:    5.9 | accuracy: 0.21
step_num: 17000 | loss: 0.1302 | profit rate:    6.0 | accuracy: 0.20
step_num: 17200 | loss: 0.2360 | profit rate:    5.7 | accuracy: 0.21
step_num: 17400 | loss: 0.3332 | profit rate:    2.7 | accuracy: 0.21
step_num: 17600 | loss: 0.1086 | profit rate:    4.1 | accuracy: 0.20
step_num: 17800 | loss: 0.1622 | profit rate:    3.0 | accuracy: 0.20
step_num: 18000 | loss: 0.1170 | profit rate:    1.8 | accuracy: 0.20
step_num: 18200 | loss: 0.2092 | profit rate:    7.6 | accuracy: 0.20
episode:   5/5,耗时:0.66分/3.34分,训练集: | step: 18395 | average_treward:  125.1 | max_treward: 179.9636 | average profit rate: 181.625
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 25%|       | 100/408 [00:00<00:00, 996.06it/s] 49%|     | 200/408 [00:00<00:00, 998.37it/s] 75%|  | 308/408 [00:00<00:00, 1034.31it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 1052.70it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1000.00
2023-07-24T12:00:00 | net performance [%] = 0.0000
2023-07-24T12:00:00 | number of trades [#] = 0
==================================================
Trial 6 Complete [00h 03m 23s]
net_wealth: 1000.0

Best net_wealth So Far: 1359.743183222804
Total elapsed time: 00h 29m 54s

Search: Running Trial #7

Value             |Best Value So Far |Hyperparameter
12                |9                 |horizon
730               |180               |lookback
True              |False             |MarketFactor
5                 |20                |lags
0.6               |0.98              |gamma
5e-05             |0.001             |DQN_lr
64                |2000              |memory_size
16                |32                |batch_size
10                |0.5               |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.7436 | profit rate:    0.9 | accuracy: 0.36
step_num: 400 | loss: 0.4014 | profit rate:    0.7 | accuracy: 0.31
step_num: 600 | loss: 1.7365 | profit rate:    0.1 | accuracy: 0.30
step_num: 800 | loss: 1.0465 | profit rate:    0.4 | accuracy: 0.33
step_num: 1000 | loss: 0.4846 | profit rate:    0.6 | accuracy: 0.32
step_num: 1200 | loss: 0.5858 | profit rate:    1.3 | accuracy: 0.33
step_num: 1400 | loss: 0.4294 | profit rate:    0.8 | accuracy: 0.31
step_num: 1600 | loss: 1.1251 | profit rate:    0.0 | accuracy: 0.31
step_num: 1800 | loss: 1.5845 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.9049 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.4361 | profit rate:    0.0 | accuracy: 0.31
step_num: 2400 | loss: 0.4789 | profit rate:    0.0 | accuracy: 0.31
step_num: 2600 | loss: 0.5435 | profit rate:    0.0 | accuracy: 0.31
step_num: 2800 | loss: 0.5953 | profit rate:    0.0 | accuracy: 0.30
step_num: 3000 | loss: 0.3236 | profit rate:    0.0 | accuracy: 0.30
episode:   1/5,耗时:0.43分/0.43分,训练集: | step: 3158 | average_treward: -251.2 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3200 | loss: 0.1592 | profit rate:    1.1 | accuracy: 0.23
step_num: 3400 | loss: 0.4827 | profit rate:    0.5 | accuracy: 0.21
step_num: 3600 | loss: 0.5873 | profit rate:    2.5 | accuracy: 0.25
step_num: 3800 | loss: 1.0498 | profit rate:  113.1 | accuracy: 0.32
step_num: 4000 | loss: 0.4263 | profit rate:   25.9 | accuracy: 0.31
step_num: 4200 | loss: 0.4464 | profit rate:   55.6 | accuracy: 0.31
step_num: 4400 | loss: 0.4794 | profit rate:   13.7 | accuracy: 0.31
step_num: 4600 | loss: 0.4638 | profit rate:   30.8 | accuracy: 0.31
step_num: 4800 | loss: 0.9786 | profit rate:    1.5 | accuracy: 0.30
step_num: 5000 | loss: 0.9609 | profit rate:    0.0 | accuracy: 0.31
step_num: 5200 | loss: 0.8924 | profit rate:    0.0 | accuracy: 0.31
step_num: 5400 | loss: 0.4545 | profit rate:    0.0 | accuracy: 0.31
step_num: 5600 | loss: 0.4575 | profit rate:    0.0 | accuracy: 0.31
step_num: 5800 | loss: 0.4328 | profit rate:    0.0 | accuracy: 0.31
step_num: 6000 | loss: 0.5368 | profit rate:    0.0 | accuracy: 0.30
step_num: 6200 | loss: 0.3364 | profit rate:    0.0 | accuracy: 0.30
step_num: 6400 | loss: 0.1966 | profit rate:    1.0 | accuracy: 0.16
step_num: 6600 | loss: 0.3518 | profit rate:    0.0 | accuracy: 0.14
step_num: 6800 | loss: 0.4675 | profit rate:    0.6 | accuracy: 0.23
step_num: 7000 | loss: 0.6358 | profit rate:    8.9 | accuracy: 0.28
step_num: 7200 | loss: 0.4831 | profit rate:    1.7 | accuracy: 0.26
step_num: 7400 | loss: 0.3538 | profit rate:    4.6 | accuracy: 0.26
step_num: 7600 | loss: 0.3015 | profit rate:   32.7 | accuracy: 0.28
step_num: 7800 | loss: 0.3242 | profit rate:   67.1 | accuracy: 0.27
step_num: 8000 | loss: 0.6628 | profit rate:  959.3 | accuracy: 0.28
step_num: 8200 | loss: 0.7184 | profit rate: 108159.3 | accuracy: 0.31
step_num: 8400 | loss: 0.4896 | profit rate: 5577.0 | accuracy: 0.31
step_num: 8600 | loss: 0.3739 | profit rate: 136046.2 | accuracy: 0.31
step_num: 8800 | loss: 0.5809 | profit rate: 12645.7 | accuracy: 0.30
step_num: 9000 | loss: 0.4146 | profit rate: 1616.8 | accuracy: 0.30
step_num: 9200 | loss: 0.4866 | profit rate:  268.0 | accuracy: 0.30
step_num: 9400 | loss: 0.3571 | profit rate:   49.9 | accuracy: 0.29
episode:   3/5,耗时:0.47分/1.36分,训练集: | step: 9474 | average_treward:  -92.7 | max_treward: 126.4862 | average profit rate: 16.422
model saved @ step:9474,performance:49.266,accuracy:0.29
step_num: 9600 | loss: 0.1018 | profit rate:    1.0 | accuracy: 0.12
step_num: 9800 | loss: 0.1355 | profit rate:    0.0 | accuracy: 0.12
step_num: 10000 | loss: 0.7830 | profit rate:    6.5 | accuracy: 0.23
step_num: 10200 | loss: 0.5478 | profit rate:   20.4 | accuracy: 0.26
step_num: 10400 | loss: 0.4497 | profit rate:    2.3 | accuracy: 0.24
step_num: 10600 | loss: 0.8111 | profit rate:    2.5 | accuracy: 0.26
step_num: 10800 | loss: 0.3303 | profit rate:   30.0 | accuracy: 0.27
step_num: 11000 | loss: 0.2810 | profit rate:  133.5 | accuracy: 0.28
step_num: 11200 | loss: 0.7313 | profit rate: 2906864.1 | accuracy: 0.32
step_num: 11400 | loss: 0.5794 | profit rate: 20903711.6 | accuracy: 0.34
step_num: 11600 | loss: 0.6629 | profit rate: 1871988.8 | accuracy: 0.33
step_num: 11800 | loss: 0.5743 | profit rate: 22824125.4 | accuracy: 0.34
step_num: 12000 | loss: 0.7583 | profit rate: 890061.4 | accuracy: 0.33
step_num: 12200 | loss: 0.4199 | profit rate: 163792.3 | accuracy: 0.32
step_num: 12400 | loss: 0.4079 | profit rate: 18499.9 | accuracy: 0.32
step_num: 12600 | loss: 0.1561 | profit rate: 2706.9 | accuracy: 0.31
model saved @ step:12632,performance:2679.420,accuracy:0.31
step_num: 12800 | loss: 0.3442 | profit rate:    0.2 | accuracy: 0.12
step_num: 13000 | loss: 0.2391 | profit rate:    0.0 | accuracy: 0.13
step_num: 13200 | loss: 0.6140 | profit rate:   49.3 | accuracy: 0.25
step_num: 13400 | loss: 0.5522 | profit rate:    5.1 | accuracy: 0.27
step_num: 13600 | loss: 0.2102 | profit rate:    5.8 | accuracy: 0.25
step_num: 13800 | loss: 0.4794 | profit rate:   13.3 | accuracy: 0.27
step_num: 14000 | loss: 0.2687 | profit rate:  142.7 | accuracy: 0.28
step_num: 14200 | loss: 0.4167 | profit rate: 2354.5 | accuracy: 0.30
step_num: 14400 | loss: 0.7945 | profit rate: 71431635.8 | accuracy: 0.34
step_num: 14600 | loss: 0.9247 | profit rate: 71484413.2 | accuracy: 0.35
step_num: 14800 | loss: 0.4324 | profit rate: 176449021.2 | accuracy: 0.35
step_num: 15000 | loss: 0.6250 | profit rate: 174571100.8 | accuracy: 0.36
step_num: 15200 | loss: 0.6454 | profit rate: 38677572.2 | accuracy: 0.35
step_num: 15400 | loss: 0.6251 | profit rate: 275249.4 | accuracy: 0.34
step_num: 15600 | loss: 0.2508 | profit rate: 323583.7 | accuracy: 0.33
episode:   5/5,耗时:0.49分/2.35分,训练集: | step: 15790 | average_treward:   39.7 | max_treward: 254.0294 | average profit rate: 10407.661
model saved @ step:15790,performance:49309.617,accuracy:0.32
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 22%|       | 91/406 [00:00<00:00, 906.97it/s] 51%|    | 209/406 [00:00<00:00, 1065.40it/s] 80%|  | 325/406 [00:00<00:00, 1107.82it/s]100%|| 406/406 [00:00<00:00, 1092.03it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1676.18
2023-07-24T12:00:00 | net performance [%] = 67.6181
2023-07-24T12:00:00 | number of trades [#] = 6
==================================================
Trial 7 Complete [00h 02m 24s]
net_wealth: 1677.8592230189117

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 00h 32m 18s

Search: Running Trial #8

Value             |Best Value So Far |Hyperparameter
13                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.8               |0.6               |gamma
0.001             |5e-05             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4302.000000   4315.000000
mean      0.000441    20062.255222  ...   20165.724363  20118.633889
std       0.027818    16039.874230  ...   16078.496018  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7729.197632   7690.540039
50%       0.000642    11554.824463  ...   11751.060059  11715.610352
75%       0.011655    29873.081836  ...   30007.945801  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.6416 | profit rate:    2.0 | accuracy: 0.31
step_num: 400 | loss: 0.6508 | profit rate:    5.0 | accuracy: 0.30
step_num: 600 | loss: 0.9113 | profit rate:   25.4 | accuracy: 0.32
step_num: 800 | loss: 0.6233 | profit rate:    6.5 | accuracy: 0.32
step_num: 1000 | loss: 1.1256 | profit rate:    0.3 | accuracy: 0.30
step_num: 1200 | loss: 0.8649 | profit rate:    1.2 | accuracy: 0.31
step_num: 1400 | loss: 0.7615 | profit rate:    3.7 | accuracy: 0.32
step_num: 1600 | loss: 0.5081 | profit rate:    0.8 | accuracy: 0.33
step_num: 1800 | loss: 0.5146 | profit rate:    0.0 | accuracy: 0.33
step_num: 2000 | loss: 0.3964 | profit rate:    0.1 | accuracy: 0.35
step_num: 2200 | loss: 0.9989 | profit rate:    0.3 | accuracy: 0.36
step_num: 2400 | loss: 0.7151 | profit rate: 3042.2 | accuracy: 0.38
step_num: 2600 | loss: 0.7755 | profit rate:   55.0 | accuracy: 0.39
step_num: 2800 | loss: 0.7779 | profit rate:  289.6 | accuracy: 0.40
step_num: 3000 | loss: 0.5820 | profit rate:   55.0 | accuracy: 0.40
step_num: 3200 | loss: 0.6153 | profit rate:   51.5 | accuracy: 0.40
step_num: 3400 | loss: 0.7257 | profit rate: 3278.0 | accuracy: 0.40
step_num: 3600 | loss: 0.6706 | profit rate: 20308.8 | accuracy: 0.40
episode:   1/5,耗时:0.45分/0.45分,训练集: | step: 3679 | average_treward:   58.6 | max_treward: 58.6486 | average profit rate: 16810.010
model saved @ step:3679,performance:16810.010,accuracy:0.40
step_num: 3800 | loss: 0.9705 | profit rate:    0.0 | accuracy: 0.37
step_num: 4000 | loss: 0.5915 | profit rate:    0.4 | accuracy: 0.31
step_num: 4200 | loss: 0.3618 | profit rate:    0.3 | accuracy: 0.29
step_num: 4400 | loss: 0.6618 | profit rate:    0.0 | accuracy: 0.28
step_num: 4600 | loss: 0.5434 | profit rate:    0.0 | accuracy: 0.25
step_num: 4800 | loss: 1.1436 | profit rate:   12.4 | accuracy: 0.31
step_num: 5000 | loss: 0.2932 | profit rate:    4.7 | accuracy: 0.31
step_num: 5200 | loss: 0.4096 | profit rate:    7.1 | accuracy: 0.29
step_num: 5400 | loss: 0.1420 | profit rate:    1.1 | accuracy: 0.30
step_num: 5600 | loss: 0.4075 | profit rate:    2.4 | accuracy: 0.31
step_num: 5800 | loss: 0.7800 | profit rate:   43.0 | accuracy: 0.33
step_num: 6000 | loss: 1.0456 | profit rate: 44799349.0 | accuracy: 0.36
step_num: 6200 | loss: 1.0936 | profit rate: 939592.8 | accuracy: 0.37
step_num: 6400 | loss: 0.7816 | profit rate: 1703854.7 | accuracy: 0.37
step_num: 6600 | loss: 0.7655 | profit rate: 1057252.6 | accuracy: 0.37
step_num: 6800 | loss: 0.5967 | profit rate: 1976407.2 | accuracy: 0.37
step_num: 7000 | loss: 0.2203 | profit rate: 24493742.4 | accuracy: 0.36
step_num: 7200 | loss: 0.3974 | profit rate: 45498624.0 | accuracy: 0.35
model saved @ step:7358,performance:232352981.286,accuracy:0.35
step_num: 7400 | loss: 0.8352 | profit rate:    0.3 | accuracy: 0.40
step_num: 7600 | loss: 0.3161 | profit rate:    0.0 | accuracy: 0.23
step_num: 7800 | loss: 0.6083 | profit rate:    0.2 | accuracy: 0.30
step_num: 8000 | loss: 0.7033 | profit rate:    0.1 | accuracy: 0.30
step_num: 8200 | loss: 0.4803 | profit rate:    1.9 | accuracy: 0.29
step_num: 8400 | loss: 0.7833 | profit rate:   34.3 | accuracy: 0.33
step_num: 8600 | loss: 0.9933 | profit rate:   46.6 | accuracy: 0.36
step_num: 8800 | loss: 0.6557 | profit rate: 9118.7 | accuracy: 0.38
step_num: 9000 | loss: 1.3724 | profit rate:  109.5 | accuracy: 0.38
step_num: 9200 | loss: 0.6151 | profit rate:    9.9 | accuracy: 0.37
step_num: 9400 | loss: 0.4902 | profit rate:    0.3 | accuracy: 0.38
step_num: 9600 | loss: 0.7521 | profit rate: 136678.1 | accuracy: 0.41
step_num: 9800 | loss: 0.9250 | profit rate: 3479279.0 | accuracy: 0.42
step_num: 10000 | loss: 0.4237 | profit rate: 42413.4 | accuracy: 0.40
step_num: 10200 | loss: 0.5729 | profit rate: 6230020.2 | accuracy: 0.42
step_num: 10400 | loss: 0.1215 | profit rate: 1934255.2 | accuracy: 0.41
step_num: 10600 | loss: 0.5206 | profit rate: 5775441.7 | accuracy: 0.40
step_num: 10800 | loss: 0.7385 | profit rate: 47949360.4 | accuracy: 0.40
step_num: 11000 | loss: 0.4486 | profit rate: 54904843.6 | accuracy: 0.39
episode:   3/5,耗时:0.49分/1.44分,训练集: | step: 11037 | average_treward:  158.1 | max_treward: 223.3188 | average profit rate: 96444407.679
step_num: 11200 | loss: 0.7263 | profit rate:    0.1 | accuracy: 0.32
step_num: 11400 | loss: 0.5648 | profit rate:   27.6 | accuracy: 0.35
step_num: 11600 | loss: 0.5101 | profit rate:    9.5 | accuracy: 0.30
step_num: 11800 | loss: 0.0008 | profit rate:   84.5 | accuracy: 0.28
step_num: 12000 | loss: 0.7139 | profit rate:    6.1 | accuracy: 0.28
step_num: 12200 | loss: 1.0942 | profit rate: 16197.6 | accuracy: 0.35
step_num: 12400 | loss: 0.5092 | profit rate: 3318.9 | accuracy: 0.35
step_num: 12600 | loss: 0.5529 | profit rate: 30866.6 | accuracy: 0.36
step_num: 12800 | loss: 0.7935 | profit rate:  110.3 | accuracy: 0.35
step_num: 13000 | loss: 0.5693 | profit rate:    5.0 | accuracy: 0.35
step_num: 13200 | loss: 0.7822 | profit rate:  305.5 | accuracy: 0.37
step_num: 13400 | loss: 0.7655 | profit rate: 528037296.8 | accuracy: 0.40
step_num: 13600 | loss: 0.0932 | profit rate: 14436638.6 | accuracy: 0.39
step_num: 13800 | loss: 0.8533 | profit rate: 14867228.5 | accuracy: 0.39
step_num: 14000 | loss: 0.2595 | profit rate: 18565229.5 | accuracy: 0.39
step_num: 14200 | loss: 0.5891 | profit rate: 70751263.3 | accuracy: 0.38
step_num: 14400 | loss: 0.2736 | profit rate: 1604458638.9 | accuracy: 0.37
step_num: 14600 | loss: 0.6450 | profit rate: 3764149862.5 | accuracy: 0.37
model saved @ step:14716,performance:12303186460.511,accuracy:0.36
step_num: 14800 | loss: 1.2846 | profit rate:    0.0 | accuracy: 0.28
step_num: 15000 | loss: 0.3637 | profit rate:    0.6 | accuracy: 0.26
step_num: 15200 | loss: 0.6423 | profit rate:    4.5 | accuracy: 0.29
step_num: 15400 | loss: 0.4821 | profit rate:  137.0 | accuracy: 0.30
step_num: 15600 | loss: 0.1902 | profit rate:   69.0 | accuracy: 0.24
step_num: 15800 | loss: 0.9630 | profit rate: 4422.2 | accuracy: 0.30
step_num: 16000 | loss: 0.7792 | profit rate: 3387.7 | accuracy: 0.33
step_num: 16200 | loss: 0.2962 | profit rate: 27435.9 | accuracy: 0.34
step_num: 16400 | loss: 0.3604 | profit rate:  674.2 | accuracy: 0.34
step_num: 16600 | loss: 0.5465 | profit rate:   39.0 | accuracy: 0.34
step_num: 16800 | loss: 0.3009 | profit rate:   31.6 | accuracy: 0.34
step_num: 17000 | loss: 1.0015 | profit rate: 28896829.2 | accuracy: 0.38
step_num: 17200 | loss: 0.8610 | profit rate: 45151359324.1 | accuracy: 0.39
step_num: 17400 | loss: 0.2288 | profit rate: 915718714.3 | accuracy: 0.37
step_num: 17600 | loss: 0.8103 | profit rate: 34943672399.0 | accuracy: 0.38
step_num: 17800 | loss: 0.2704 | profit rate: 11446160782.2 | accuracy: 0.37
step_num: 18000 | loss: 0.0167 | profit rate: 475438090286.7 | accuracy: 0.36
step_num: 18200 | loss: 0.4483 | profit rate: 570270715857.4 | accuracy: 0.35
episode:   5/5,耗时:0.49分/2.42分,训练集: | step: 18395 | average_treward:  205.9 | max_treward: 299.2973 | average profit rate: 253845042684.404
model saved @ step:18395,performance:1256632693738.470,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 22%|       | 88/408 [00:00<00:00, 871.29it/s] 49%|     | 198/408 [00:00<00:00, 999.42it/s] 75%|  | 304/408 [00:00<00:00, 1026.06it/s]100%|| 408/408 [00:00<00:00, 1030.00it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1372.44
2023-07-24T12:00:00 | net performance [%] = 37.2444
2023-07-24T12:00:00 | number of trades [#] = 20
==================================================
Trial 8 Complete [00h 02m 29s]
net_wealth: 1372.444102294752

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 00h 34m 47s

Search: Running Trial #9

Value             |Best Value So Far |Hyperparameter
15                |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.95              |0.6               |gamma
5e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4286.000000   4301.000000
mean      0.000435    20113.607657  ...   20224.573864  20169.373185
std       0.027833    16040.642334  ...   16079.545659  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7778.380005   7730.930176
50%       0.000642    11571.842969  ...   11768.989746  11751.469727
75%       0.011590    29894.706152  ...   30071.020508  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 1.3300 | profit rate:    0.1 | accuracy: 0.33
step_num: 800 | loss: 1.1055 | profit rate:    0.1 | accuracy: 0.33
step_num: 1000 | loss: 0.9320 | profit rate:    0.2 | accuracy: 0.35
step_num: 1200 | loss: 0.8705 | profit rate:    4.2 | accuracy: 0.37
step_num: 1400 | loss: 0.8057 | profit rate:    0.1 | accuracy: 0.35
step_num: 1600 | loss: 0.7661 | profit rate:    0.2 | accuracy: 0.35
step_num: 1800 | loss: 0.7876 | profit rate:    0.0 | accuracy: 0.34
step_num: 2000 | loss: 0.7708 | profit rate:    0.0 | accuracy: 0.35
step_num: 2200 | loss: 0.7101 | profit rate:    0.3 | accuracy: 0.37
step_num: 2400 | loss: 0.8394 | profit rate: 904681.8 | accuracy: 0.40
step_num: 2600 | loss: 0.9002 | profit rate: 2885.1 | accuracy: 0.40
step_num: 2800 | loss: 0.9010 | profit rate: 360583.1 | accuracy: 0.40
step_num: 3000 | loss: 0.9037 | profit rate: 27132.4 | accuracy: 0.40
step_num: 3200 | loss: 0.8803 | profit rate: 11287.8 | accuracy: 0.40
step_num: 3400 | loss: 0.7854 | profit rate:  437.8 | accuracy: 0.39
step_num: 3600 | loss: 0.7140 | profit rate: 4612.4 | accuracy: 0.39
episode:   1/5,耗时:0.78分/0.78分,训练集: | step: 3710 | average_treward:  148.3 | max_treward: 148.3251 | average profit rate: 4745.818
model saved @ step:3710,performance:4745.818,accuracy:0.39
step_num: 3800 | loss: 0.6905 | profit rate:    0.6 | accuracy: 0.33
step_num: 4000 | loss: 0.7098 | profit rate:    1.4 | accuracy: 0.36
step_num: 4200 | loss: 0.6467 | profit rate:   29.4 | accuracy: 0.38
step_num: 4400 | loss: 0.6643 | profit rate:  174.8 | accuracy: 0.37
step_num: 4600 | loss: 0.6310 | profit rate: 1839.8 | accuracy: 0.37
step_num: 4800 | loss: 0.6325 | profit rate:    1.4 | accuracy: 0.36
step_num: 5000 | loss: 0.6019 | profit rate:    0.0 | accuracy: 0.34
step_num: 5200 | loss: 0.4998 | profit rate:    0.0 | accuracy: 0.32
step_num: 5400 | loss: 0.4484 | profit rate:    0.0 | accuracy: 0.29
step_num: 5600 | loss: 0.3768 | profit rate:    0.0 | accuracy: 0.27
step_num: 5800 | loss: 0.2877 | profit rate:    0.0 | accuracy: 0.26
step_num: 6000 | loss: 0.3081 | profit rate:   14.3 | accuracy: 0.28
step_num: 6200 | loss: 0.4782 | profit rate: 38058.0 | accuracy: 0.30
step_num: 6400 | loss: 0.5118 | profit rate:  927.8 | accuracy: 0.30
step_num: 6600 | loss: 0.6561 | profit rate: 13567.1 | accuracy: 0.32
step_num: 6800 | loss: 0.7195 | profit rate: 1411.4 | accuracy: 0.32
step_num: 7000 | loss: 0.6571 | profit rate:  318.8 | accuracy: 0.31
step_num: 7200 | loss: 0.5869 | profit rate:   23.4 | accuracy: 0.31
step_num: 7400 | loss: 0.5428 | profit rate:   10.7 | accuracy: 0.30
step_num: 7600 | loss: 0.4487 | profit rate:    2.7 | accuracy: 0.24
step_num: 7800 | loss: 0.4441 | profit rate:   14.7 | accuracy: 0.21
step_num: 8000 | loss: 0.3660 | profit rate:    9.9 | accuracy: 0.21
step_num: 8200 | loss: 0.3488 | profit rate:  107.4 | accuracy: 0.20
step_num: 8400 | loss: 0.3329 | profit rate:  143.9 | accuracy: 0.19
step_num: 8600 | loss: 0.3037 | profit rate:  266.3 | accuracy: 0.20
step_num: 8800 | loss: 0.2733 | profit rate:   80.9 | accuracy: 0.20
step_num: 9000 | loss: 0.2579 | profit rate:   44.2 | accuracy: 0.20
step_num: 9200 | loss: 0.3103 | profit rate:   11.4 | accuracy: 0.19
step_num: 9400 | loss: 0.3303 | profit rate:    2.4 | accuracy: 0.19
step_num: 9600 | loss: 0.3433 | profit rate:  364.5 | accuracy: 0.20
step_num: 9800 | loss: 0.5608 | profit rate: 2528788210.6 | accuracy: 0.25
step_num: 10000 | loss: 0.7344 | profit rate: 56559578.7 | accuracy: 0.25
step_num: 10200 | loss: 0.5594 | profit rate: 50483415.9 | accuracy: 0.26
step_num: 10400 | loss: 0.7138 | profit rate: 217005950.6 | accuracy: 0.27
step_num: 10600 | loss: 0.7549 | profit rate: 483494675.4 | accuracy: 0.28
step_num: 10800 | loss: 0.6624 | profit rate: 13334966.2 | accuracy: 0.28
step_num: 11000 | loss: 0.6163 | profit rate: 27921481.8 | accuracy: 0.28
episode:   3/5,耗时:0.93分/2.64分,训练集: | step: 11130 | average_treward:  113.6 | max_treward: 202.5094 | average profit rate: 10890612.315
model saved @ step:11130,performance:32667080.290,accuracy:0.28
step_num: 11200 | loss: 0.5831 | profit rate:    5.6 | accuracy: 0.48
step_num: 11400 | loss: 0.5524 | profit rate:   12.6 | accuracy: 0.30
step_num: 11600 | loss: 0.5005 | profit rate:   19.8 | accuracy: 0.26
step_num: 11800 | loss: 0.4321 | profit rate:   34.2 | accuracy: 0.24
step_num: 12000 | loss: 0.3992 | profit rate:  230.3 | accuracy: 0.23
step_num: 12200 | loss: 0.3762 | profit rate:  352.7 | accuracy: 0.24
step_num: 12400 | loss: 0.3510 | profit rate:   22.9 | accuracy: 0.22
step_num: 12600 | loss: 0.3157 | profit rate:   65.3 | accuracy: 0.24
step_num: 12800 | loss: 0.3341 | profit rate:  301.9 | accuracy: 0.23
step_num: 13000 | loss: 0.3385 | profit rate:   33.8 | accuracy: 0.22
step_num: 13200 | loss: 0.3547 | profit rate:    5.6 | accuracy: 0.22
step_num: 13400 | loss: 0.4472 | profit rate: 10662964.0 | accuracy: 0.25
step_num: 13600 | loss: 0.7023 | profit rate: 2705584953.7 | accuracy: 0.28
step_num: 13800 | loss: 0.6556 | profit rate: 11485618.3 | accuracy: 0.28
step_num: 14000 | loss: 0.6109 | profit rate: 11552581147.5 | accuracy: 0.30
step_num: 14200 | loss: 0.6471 | profit rate: 617595394.4 | accuracy: 0.30
step_num: 14400 | loss: 0.7195 | profit rate: 562386939.2 | accuracy: 0.30
step_num: 14600 | loss: 0.6185 | profit rate: 139913125.9 | accuracy: 0.30
step_num: 14800 | loss: 0.5860 | profit rate: 78275513.3 | accuracy: 0.29
model saved @ step:14840,performance:101048908.516,accuracy:0.29
step_num: 15000 | loss: 0.5753 | profit rate:    0.5 | accuracy: 0.30
step_num: 15200 | loss: 0.5861 | profit rate:    3.1 | accuracy: 0.27
step_num: 15400 | loss: 0.5232 | profit rate:   32.7 | accuracy: 0.28
step_num: 15600 | loss: 0.4414 | profit rate:  101.8 | accuracy: 0.25
step_num: 15800 | loss: 0.4169 | profit rate:   95.4 | accuracy: 0.26
step_num: 16000 | loss: 0.4478 | profit rate:   16.7 | accuracy: 0.27
step_num: 16200 | loss: 0.3848 | profit rate:   21.2 | accuracy: 0.26
step_num: 16400 | loss: 0.3751 | profit rate:   11.4 | accuracy: 0.26
step_num: 16600 | loss: 0.3778 | profit rate:    2.9 | accuracy: 0.25
step_num: 16800 | loss: 0.3822 | profit rate:    0.4 | accuracy: 0.24
step_num: 17000 | loss: 0.3939 | profit rate:   56.0 | accuracy: 0.25
step_num: 17200 | loss: 0.5709 | profit rate: 18243263.8 | accuracy: 0.28
step_num: 17400 | loss: 0.6711 | profit rate: 13531959.2 | accuracy: 0.29
step_num: 17600 | loss: 0.6230 | profit rate: 33898705.6 | accuracy: 0.29
step_num: 17800 | loss: 0.6868 | profit rate: 182490822.7 | accuracy: 0.30
step_num: 18000 | loss: 0.7175 | profit rate: 1887090094.3 | accuracy: 0.30
step_num: 18200 | loss: 0.6383 | profit rate: 26718148.7 | accuracy: 0.30
step_num: 18400 | loss: 0.5622 | profit rate: 218609573.8 | accuracy: 0.30
episode:   5/5,耗时:0.95分/4.57分,训练集: | step: 18550 | average_treward:  174.3 | max_treward: 286.6838 | average profit rate: 76733706.953
model saved @ step:18550,performance:249947789.302,accuracy:0.30
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 22%|       | 90/408 [00:00<00:00, 900.00it/s] 49%|     | 201/408 [00:00<00:00, 1023.32it/s] 77%|  | 315/408 [00:00<00:00, 1071.70it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 1062.40it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1308.11
2023-07-24T12:00:00 | net performance [%] = 30.8108
2023-07-24T12:00:00 | number of trades [#] = 16
==================================================
Trial 9 Complete [00h 04m 37s]
net_wealth: 1309.4169904340795

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 00h 39m 24s

Search: Running Trial #10

Value             |Best Value So Far |Hyperparameter
9                 |12                |horizon
365               |730               |lookback
True              |True              |MarketFactor
10                |5                 |lags
0.8               |0.6               |gamma
0.0001            |5e-05             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4292.000000   4301.000000
mean      0.000435    20113.607657  ...   20202.430277  20169.373185
std       0.027833    16040.642334  ...   16079.200001  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7761.477417   7730.930176
50%       0.000642    11571.842969  ...   11760.674805  11751.469727
75%       0.011590    29894.706152  ...   30029.208008  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.7295 | profit rate:    0.1 | accuracy: 0.31
step_num: 800 | loss: 0.4772 | profit rate:    0.1 | accuracy: 0.29
step_num: 1000 | loss: 0.5013 | profit rate:    0.4 | accuracy: 0.31
step_num: 1200 | loss: 0.4233 | profit rate:    0.2 | accuracy: 0.29
step_num: 1400 | loss: 0.4261 | profit rate:    0.3 | accuracy: 0.29
step_num: 1600 | loss: 0.4372 | profit rate:    0.4 | accuracy: 0.29
step_num: 1800 | loss: 0.3894 | profit rate:    0.9 | accuracy: 0.30
step_num: 2000 | loss: 0.3946 | profit rate:    3.1 | accuracy: 0.31
step_num: 2200 | loss: 0.4202 | profit rate:   11.0 | accuracy: 0.32
step_num: 2400 | loss: 0.4207 | profit rate:    0.1 | accuracy: 0.32
step_num: 2600 | loss: 0.5129 | profit rate:    1.1 | accuracy: 0.33
step_num: 2800 | loss: 0.5080 | profit rate:    0.3 | accuracy: 0.33
step_num: 3000 | loss: 0.5173 | profit rate:    0.1 | accuracy: 0.33
step_num: 3200 | loss: 0.5163 | profit rate:    0.0 | accuracy: 0.33
step_num: 3400 | loss: 0.4592 | profit rate:    0.0 | accuracy: 0.33
episode:   1/5,耗时:1.09分/1.09分,训练集: | step: 3518 | average_treward:   15.8 | max_treward: 15.7957 | average profit rate:  0.058
model saved @ step:3518,performance:0.058,accuracy:0.33
step_num: 3600 | loss: 0.4128 | profit rate:    1.0 | accuracy: 0.25
step_num: 3800 | loss: 0.3141 | profit rate:    1.9 | accuracy: 0.21
step_num: 4000 | loss: 0.2688 | profit rate:    0.8 | accuracy: 0.20
step_num: 4200 | loss: 0.2893 | profit rate:    3.9 | accuracy: 0.20
step_num: 4400 | loss: 0.2274 | profit rate:    0.7 | accuracy: 0.20
step_num: 4600 | loss: 0.2686 | profit rate:    1.4 | accuracy: 0.21
step_num: 4800 | loss: 0.2414 | profit rate:    0.2 | accuracy: 0.20
step_num: 5000 | loss: 0.2829 | profit rate:    0.7 | accuracy: 0.20
step_num: 5200 | loss: 0.2274 | profit rate:    0.9 | accuracy: 0.19
step_num: 5400 | loss: 0.1897 | profit rate:    1.0 | accuracy: 0.18
step_num: 5600 | loss: 0.1510 | profit rate:    0.1 | accuracy: 0.17
step_num: 5800 | loss: 0.1133 | profit rate:    1.2 | accuracy: 0.16
step_num: 6000 | loss: 0.1257 | profit rate:    1.7 | accuracy: 0.17
step_num: 6200 | loss: 0.1328 | profit rate:   49.9 | accuracy: 0.18
step_num: 6400 | loss: 0.1679 | profit rate:   36.3 | accuracy: 0.18
step_num: 6600 | loss: 0.2215 | profit rate:  115.4 | accuracy: 0.19
step_num: 6800 | loss: 0.2887 | profit rate:  131.0 | accuracy: 0.20
step_num: 7000 | loss: 0.3660 | profit rate:  172.6 | accuracy: 0.20
model saved @ step:7036,performance:174.989,accuracy:0.20
step_num: 7200 | loss: 0.3502 | profit rate:    1.4 | accuracy: 0.27
step_num: 7400 | loss: 0.3348 | profit rate:    3.0 | accuracy: 0.25
step_num: 7600 | loss: 0.3476 | profit rate:   10.3 | accuracy: 0.24
step_num: 7800 | loss: 0.2721 | profit rate:   24.4 | accuracy: 0.25
step_num: 8000 | loss: 0.2918 | profit rate:    0.2 | accuracy: 0.24
step_num: 8200 | loss: 0.2810 | profit rate:    0.3 | accuracy: 0.22
step_num: 8400 | loss: 0.2285 | profit rate:    0.3 | accuracy: 0.21
step_num: 8600 | loss: 0.2749 | profit rate:   23.1 | accuracy: 0.22
step_num: 8800 | loss: 0.2530 | profit rate:   26.8 | accuracy: 0.23
step_num: 9000 | loss: 0.2435 | profit rate:  220.0 | accuracy: 0.24
step_num: 9200 | loss: 0.2489 | profit rate: 5207.7 | accuracy: 0.24
step_num: 9400 | loss: 0.2507 | profit rate: 9088.3 | accuracy: 0.24
step_num: 9600 | loss: 0.2729 | profit rate: 309399.9 | accuracy: 0.26
step_num: 9800 | loss: 0.2468 | profit rate: 1976364.1 | accuracy: 0.27
step_num: 10000 | loss: 0.3023 | profit rate: 1952984.1 | accuracy: 0.27
step_num: 10200 | loss: 0.3435 | profit rate: 3228861.8 | accuracy: 0.28
step_num: 10400 | loss: 0.3667 | profit rate: 10951127.5 | accuracy: 0.28
episode:   3/5,耗时:1.30分/3.73分,训练集: | step: 10554 | average_treward:  167.1 | max_treward: 372.7410 | average profit rate: 17014667.794
model saved @ step:10554,performance:51043828.335,accuracy:0.29
step_num: 10600 | loss: 0.3341 | profit rate:    1.6 | accuracy: 0.19
step_num: 10800 | loss: 0.3527 | profit rate:    2.4 | accuracy: 0.27
step_num: 11000 | loss: 0.3743 | profit rate:    0.7 | accuracy: 0.27
step_num: 11200 | loss: 0.3389 | profit rate:   14.2 | accuracy: 0.29
step_num: 11400 | loss: 0.3507 | profit rate:    2.7 | accuracy: 0.29
step_num: 11600 | loss: 0.3682 | profit rate:    0.5 | accuracy: 0.28
step_num: 11800 | loss: 0.2817 | profit rate:    0.4 | accuracy: 0.26
step_num: 12000 | loss: 0.2867 | profit rate:    0.9 | accuracy: 0.25
step_num: 12200 | loss: 0.2781 | profit rate:   35.8 | accuracy: 0.25
step_num: 12400 | loss: 0.2106 | profit rate:   52.6 | accuracy: 0.24
step_num: 12600 | loss: 0.1914 | profit rate:  206.7 | accuracy: 0.24
step_num: 12800 | loss: 0.2209 | profit rate: 3190.5 | accuracy: 0.24
step_num: 13000 | loss: 0.2229 | profit rate: 10286.7 | accuracy: 0.25
step_num: 13200 | loss: 0.2318 | profit rate: 2342386.9 | accuracy: 0.27
step_num: 13400 | loss: 0.2651 | profit rate: 465284.6 | accuracy: 0.27
step_num: 13600 | loss: 0.2795 | profit rate: 6659930.8 | accuracy: 0.27
step_num: 13800 | loss: 0.3009 | profit rate: 85019588.9 | accuracy: 0.28
step_num: 14000 | loss: 0.3416 | profit rate: 222191340.2 | accuracy: 0.29
model saved @ step:14072,performance:249591975.242,accuracy:0.29
step_num: 14200 | loss: 0.2900 | profit rate:    0.3 | accuracy: 0.22
step_num: 14400 | loss: 0.3407 | profit rate:    0.6 | accuracy: 0.26
step_num: 14600 | loss: 0.2892 | profit rate:   11.3 | accuracy: 0.32
step_num: 14800 | loss: 0.3194 | profit rate:  141.5 | accuracy: 0.37
step_num: 15000 | loss: 0.3769 | profit rate:    1.6 | accuracy: 0.36
step_num: 15200 | loss: 0.3350 | profit rate:    2.1 | accuracy: 0.33
step_num: 15400 | loss: 0.3054 | profit rate:    4.5 | accuracy: 0.33
step_num: 15600 | loss: 0.3154 | profit rate:  161.6 | accuracy: 0.33
step_num: 15800 | loss: 0.2678 | profit rate:  287.6 | accuracy: 0.32
step_num: 16000 | loss: 0.2235 | profit rate:  449.0 | accuracy: 0.30
step_num: 16200 | loss: 0.2219 | profit rate: 1479.7 | accuracy: 0.29
step_num: 16400 | loss: 0.2184 | profit rate: 28004.1 | accuracy: 0.29
step_num: 16600 | loss: 0.2373 | profit rate: 898571.8 | accuracy: 0.30
step_num: 16800 | loss: 0.2480 | profit rate: 15883573.7 | accuracy: 0.31
step_num: 17000 | loss: 0.2807 | profit rate: 26060205.8 | accuracy: 0.32
step_num: 17200 | loss: 0.3107 | profit rate: 183326828.2 | accuracy: 0.32
step_num: 17400 | loss: 0.2968 | profit rate: 5805550918.5 | accuracy: 0.33
episode:   5/5,耗时:1.35分/6.44分,训练集: | step: 17590 | average_treward:  296.5 | max_treward: 571.2325 | average profit rate: 10172800679.816
model saved @ step:17590,performance:50563367420.454,accuracy:0.33
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 26%|       | 104/401 [00:00<00:00, 1039.99it/s] 52%|    | 208/401 [00:00<00:00, 1010.68it/s] 79%|  | 316/401 [00:00<00:00, 1038.21it/s]100%|| 401/401 [00:00<00:00, 1028.09it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1112.29
2023-07-24T12:00:00 | net performance [%] = 11.2293
2023-07-24T12:00:00 | number of trades [#] = 24
==================================================
Trial 10 Complete [00h 06m 30s]
net_wealth: 1113.4062876620112

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 00h 45m 54s

Search: Running Trial #11

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
8                 |5                 |lags
0.98              |0.6               |gamma
0.001             |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.1172 | profit rate:    2.4 | accuracy: 0.32
step_num: 1200 | loss: 0.6044 | profit rate:    4.8 | accuracy: 0.32
step_num: 1400 | loss: 0.6012 | profit rate:   11.1 | accuracy: 0.33
step_num: 1600 | loss: 0.5766 | profit rate:   13.6 | accuracy: 0.34
step_num: 1800 | loss: 0.6276 | profit rate:    5.3 | accuracy: 0.33
step_num: 2000 | loss: 0.5779 | profit rate:    1.1 | accuracy: 0.33
step_num: 2200 | loss: 0.5397 | profit rate:    7.5 | accuracy: 0.34
step_num: 2400 | loss: 0.7006 | profit rate:   31.3 | accuracy: 0.34
step_num: 2600 | loss: 0.5817 | profit rate:  122.6 | accuracy: 0.34
step_num: 2800 | loss: 0.5962 | profit rate:  133.4 | accuracy: 0.34
step_num: 3000 | loss: 0.5639 | profit rate:  295.0 | accuracy: 0.34
episode:   1/5,耗时:1.32分/1.32分,训练集: | step: 3155 | average_treward:   50.2 | max_treward: 50.1965 | average profit rate: 933.838
model saved @ step:3155,performance:933.838,accuracy:0.34
step_num: 3200 | loss: 0.5683 | profit rate:    0.8 | accuracy: 0.17
step_num: 3400 | loss: 0.6067 | profit rate:    1.6 | accuracy: 0.30
step_num: 3600 | loss: 0.5502 | profit rate:    3.6 | accuracy: 0.37
step_num: 3800 | loss: 0.5833 | profit rate: 1283.7 | accuracy: 0.39
step_num: 4000 | loss: 0.5739 | profit rate: 1100.5 | accuracy: 0.37
step_num: 4200 | loss: 0.5679 | profit rate: 2210.9 | accuracy: 0.35
step_num: 4400 | loss: 0.7236 | profit rate: 27783148.9 | accuracy: 0.38
step_num: 4600 | loss: 0.4672 | profit rate: 26090020.0 | accuracy: 0.38
step_num: 4800 | loss: 0.5269 | profit rate: 427385530.1 | accuracy: 0.38
step_num: 5000 | loss: 0.6367 | profit rate: 148609340359.2 | accuracy: 0.39
step_num: 5200 | loss: 0.6052 | profit rate: 13906094422146.0 | accuracy: 0.40
step_num: 5400 | loss: 0.6538 | profit rate: 2971823810747696.0 | accuracy: 0.40
step_num: 5600 | loss: 0.6841 | profit rate: 129805649323506688.0 | accuracy: 0.40
step_num: 5800 | loss: 0.5703 | profit rate: 11097354726808985600.0 | accuracy: 0.41
step_num: 6000 | loss: 0.5982 | profit rate: 46696270861762650112.0 | accuracy: 0.40
step_num: 6200 | loss: 0.5929 | profit rate: 987553127129914146816.0 | accuracy: 0.40
model saved @ step:6310,performance:1527063611063547199488.000,accuracy:0.40
step_num: 6400 | loss: 0.5573 | profit rate:    1.6 | accuracy: 0.36
step_num: 6600 | loss: 0.5818 | profit rate:  266.2 | accuracy: 0.43
step_num: 6800 | loss: 0.5833 | profit rate: 11350.3 | accuracy: 0.46
step_num: 7000 | loss: 0.7247 | profit rate: 3651595.1 | accuracy: 0.47
step_num: 7200 | loss: 0.6209 | profit rate: 29323188.9 | accuracy: 0.46
step_num: 7400 | loss: 0.4914 | profit rate: 1588322219.3 | accuracy: 0.46
step_num: 7600 | loss: 0.6528 | profit rate: 1142095609674.8 | accuracy: 0.46
step_num: 7800 | loss: 0.6626 | profit rate: 7757668513237.3 | accuracy: 0.46
step_num: 8000 | loss: 0.5869 | profit rate: 234587622175948.7 | accuracy: 0.46
step_num: 8200 | loss: 0.6530 | profit rate: 4202586132081302.5 | accuracy: 0.46
step_num: 8400 | loss: 0.7499 | profit rate: 905287864814878848.0 | accuracy: 0.46
step_num: 8600 | loss: 0.8675 | profit rate: 307234002712834670592.0 | accuracy: 0.46
step_num: 8800 | loss: 0.6372 | profit rate: 15081680083919812165632.0 | accuracy: 0.46
step_num: 9000 | loss: 0.5241 | profit rate: 495663168207670499868672.0 | accuracy: 0.46
step_num: 9200 | loss: 0.6282 | profit rate: 16642988523722039757897728.0 | accuracy: 0.46
step_num: 9400 | loss: 0.6545 | profit rate: 520781556297374504276983808.0 | accuracy: 0.46
episode:   3/5,耗时:2.01分/5.22分,训练集: | step: 9465 | average_treward:  639.8 | max_treward: 1092.3071 | average profit rate: 200491572907850937919340544.000
model saved @ step:9465,performance:601473191659941717260369920.000,accuracy:0.46
step_num: 9600 | loss: 0.6363 | profit rate:    3.2 | accuracy: 0.42
step_num: 9800 | loss: 0.9088 | profit rate:   15.6 | accuracy: 0.43
step_num: 10000 | loss: 0.7653 | profit rate: 13488.5 | accuracy: 0.49
step_num: 10200 | loss: 0.7383 | profit rate: 16262846.1 | accuracy: 0.51
step_num: 10400 | loss: 0.6516 | profit rate: 121376235.9 | accuracy: 0.50
step_num: 10600 | loss: 0.6688 | profit rate: 1973417543653.5 | accuracy: 0.51
step_num: 10800 | loss: 0.7657 | profit rate: 189843667944671.7 | accuracy: 0.51
step_num: 11000 | loss: 0.6862 | profit rate: 1139963848994906.0 | accuracy: 0.51
step_num: 11200 | loss: 0.7857 | profit rate: 126585293202915440.0 | accuracy: 0.51
step_num: 11400 | loss: 0.8674 | profit rate: 27951658568601718784.0 | accuracy: 0.52
step_num: 11600 | loss: 0.7629 | profit rate: 10093372471417677807616.0 | accuracy: 0.51
step_num: 11800 | loss: 0.7481 | profit rate: 1607401345074760054210560.0 | accuracy: 0.52
step_num: 12000 | loss: 0.6327 | profit rate: 83579284870419294497800192.0 | accuracy: 0.51
step_num: 12200 | loss: 0.6393 | profit rate: 6512273423964173242164314112.0 | accuracy: 0.51
step_num: 12400 | loss: 0.6483 | profit rate: 7314103515406670308800985038848.0 | accuracy: 0.51
step_num: 12600 | loss: 0.6330 | profit rate: 78963335170039839278982754205696.0 | accuracy: 0.50
model saved @ step:12620,performance:78084022868987819154490743848960.000,accuracy:0.50
step_num: 12800 | loss: 0.7591 | profit rate:    3.2 | accuracy: 0.39
step_num: 13000 | loss: 0.5462 | profit rate:   50.9 | accuracy: 0.47
step_num: 13200 | loss: 0.6581 | profit rate: 3943551.7 | accuracy: 0.55
step_num: 13400 | loss: 0.5920 | profit rate: 509438434.3 | accuracy: 0.55
step_num: 13600 | loss: 0.6076 | profit rate: 3890333427.1 | accuracy: 0.53
step_num: 13800 | loss: 0.6341 | profit rate: 452235007858924.5 | accuracy: 0.54
step_num: 14000 | loss: 0.8816 | profit rate: 12530256333215240.0 | accuracy: 0.54
step_num: 14200 | loss: 0.7710 | profit rate: 2658594375117724672.0 | accuracy: 0.55
step_num: 14400 | loss: 0.7514 | profit rate: 17835934630410513809408.0 | accuracy: 0.55
step_num: 14600 | loss: 0.6571 | profit rate: 74153205455513813388361728.0 | accuracy: 0.55
step_num: 14800 | loss: 0.7384 | profit rate: 11630922510594151948291670016.0 | accuracy: 0.55
step_num: 15000 | loss: 0.6663 | profit rate: 3436401350912592040566787670016.0 | accuracy: 0.55
step_num: 15200 | loss: 0.7565 | profit rate: 233780005163674195925933790068736.0 | accuracy: 0.55
step_num: 15400 | loss: 0.7578 | profit rate: 216160628036644974209084270697250816.0 | accuracy: 0.55
step_num: 15600 | loss: 1.0517 | profit rate: 4837666814537494240780156562357354496.0 | accuracy: 0.54
episode:   5/5,耗时:1.86分/9.04分,训练集: | step: 15775 | average_treward:  921.7 | max_treward: 1460.0619 | average profit rate: 8247289375105820429811470214144983040.000
model saved @ step:15775,performance:41236368790904759734837714226451054592.000,accuracy:0.54
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 22%|       | 89/403 [00:00<00:00, 881.19it/s] 48%|     | 193/403 [00:00<00:00, 974.22it/s] 74%|  | 298/403 [00:00<00:00, 1004.18it/s]100%|| 403/403 [00:00<00:00, 1007.18it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1450.55
2023-07-24T12:00:00 | net performance [%] = 45.0553
2023-07-24T12:00:00 | number of trades [#] = 72
==================================================
Trial 11 Complete [00h 09m 34s]
net_wealth: 1452.0049116992454

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 00h 55m 28s

Search: Running Trial #12

Value             |Best Value So Far |Hyperparameter
5                 |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.92              |0.6               |gamma
5e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4296.000000   4301.000000
mean      0.000435    20113.607657  ...   20187.844288  20169.373185
std       0.027833    16040.642334  ...   16078.813220  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7752.362549   7730.930176
50%       0.000642    11571.842969  ...   11756.264648  11751.469727
75%       0.011590    29894.706152  ...   30017.365723  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.7241 | profit rate:    1.1 | accuracy: 0.32
step_num: 800 | loss: 0.5587 | profit rate:    1.4 | accuracy: 0.31
step_num: 1000 | loss: 0.4800 | profit rate:    3.5 | accuracy: 0.31
step_num: 1200 | loss: 0.4681 | profit rate:   11.4 | accuracy: 0.32
step_num: 1400 | loss: 0.4488 | profit rate:   15.5 | accuracy: 0.32
step_num: 1600 | loss: 0.4170 | profit rate:   39.8 | accuracy: 0.34
step_num: 1800 | loss: 0.4443 | profit rate: 1872.4 | accuracy: 0.36
step_num: 2000 | loss: 0.5403 | profit rate:  318.4 | accuracy: 0.36
step_num: 2200 | loss: 0.5609 | profit rate:  316.9 | accuracy: 0.37
step_num: 2400 | loss: 0.6104 | profit rate:  310.9 | accuracy: 0.38
step_num: 2600 | loss: 0.6222 | profit rate:  186.3 | accuracy: 0.37
step_num: 2800 | loss: 0.6114 | profit rate: 1272.3 | accuracy: 0.37
step_num: 3000 | loss: 0.5509 | profit rate: 1972.0 | accuracy: 0.38
episode:   1/5,耗时:1.68分/1.68分,训练集: | step: 3160 | average_treward:  151.1 | max_treward: 151.1257 | average profit rate: 4560.248
model saved @ step:3160,performance:4560.248,accuracy:0.38
step_num: 3200 | loss: 0.5277 | profit rate:    1.5 | accuracy: 0.51
step_num: 3400 | loss: 0.5174 | profit rate:   10.6 | accuracy: 0.49
step_num: 3600 | loss: 0.5033 | profit rate:    3.9 | accuracy: 0.41
step_num: 3800 | loss: 0.5180 | profit rate:    0.9 | accuracy: 0.38
step_num: 4000 | loss: 0.4721 | profit rate:    0.5 | accuracy: 0.34
step_num: 4200 | loss: 0.4414 | profit rate:    0.5 | accuracy: 0.32
step_num: 4400 | loss: 0.3560 | profit rate:    0.6 | accuracy: 0.30
step_num: 4600 | loss: 0.2839 | profit rate:    0.7 | accuracy: 0.27
step_num: 4800 | loss: 0.2291 | profit rate:    0.3 | accuracy: 0.25
step_num: 5000 | loss: 0.2300 | profit rate:    0.2 | accuracy: 0.24
step_num: 5200 | loss: 0.1702 | profit rate:    0.2 | accuracy: 0.23
step_num: 5400 | loss: 0.1548 | profit rate:    0.3 | accuracy: 0.22
step_num: 5600 | loss: 0.1652 | profit rate:    0.2 | accuracy: 0.22
step_num: 5800 | loss: 0.1817 | profit rate:    0.3 | accuracy: 0.21
step_num: 6000 | loss: 0.2216 | profit rate:    0.1 | accuracy: 0.21
step_num: 6200 | loss: 0.2633 | profit rate:    0.2 | accuracy: 0.22
step_num: 6400 | loss: 0.2864 | profit rate:    1.5 | accuracy: 0.15
step_num: 6600 | loss: 0.2654 | profit rate:    2.8 | accuracy: 0.18
step_num: 6800 | loss: 0.2519 | profit rate:    1.9 | accuracy: 0.18
step_num: 7000 | loss: 0.3302 | profit rate:    0.4 | accuracy: 0.23
step_num: 7200 | loss: 0.2740 | profit rate:    0.4 | accuracy: 0.23
step_num: 7400 | loss: 0.2535 | profit rate:    0.5 | accuracy: 0.22
step_num: 7600 | loss: 0.2613 | profit rate:    0.1 | accuracy: 0.21
step_num: 7800 | loss: 0.2586 | profit rate:    0.1 | accuracy: 0.21
step_num: 8000 | loss: 0.2109 | profit rate:    0.2 | accuracy: 0.22
step_num: 8200 | loss: 0.2864 | profit rate:    1.6 | accuracy: 0.23
step_num: 8400 | loss: 0.3306 | profit rate:    0.4 | accuracy: 0.23
step_num: 8600 | loss: 0.2831 | profit rate:    1.2 | accuracy: 0.24
step_num: 8800 | loss: 0.3299 | profit rate:    0.5 | accuracy: 0.23
step_num: 9000 | loss: 0.3362 | profit rate:    1.0 | accuracy: 0.23
step_num: 9200 | loss: 0.3517 | profit rate:    0.6 | accuracy: 0.24
step_num: 9400 | loss: 0.3222 | profit rate:    1.2 | accuracy: 0.24
episode:   3/5,耗时:1.90分/5.54分,训练集: | step: 9480 | average_treward:  114.5 | max_treward: 151.1257 | average profit rate: 1520.658
step_num: 9600 | loss: 0.3045 | profit rate:    2.1 | accuracy: 0.23
step_num: 9800 | loss: 0.2771 | profit rate:    4.8 | accuracy: 0.26
step_num: 10000 | loss: 0.3052 | profit rate:    0.5 | accuracy: 0.25
step_num: 10200 | loss: 0.3436 | profit rate:    0.3 | accuracy: 0.28
step_num: 10400 | loss: 0.3063 | profit rate:    0.4 | accuracy: 0.25
step_num: 10600 | loss: 0.2989 | profit rate:    0.2 | accuracy: 0.23
step_num: 10800 | loss: 0.2475 | profit rate:    0.8 | accuracy: 0.22
step_num: 11000 | loss: 0.2272 | profit rate:    0.9 | accuracy: 0.21
step_num: 11200 | loss: 0.1566 | profit rate:   11.5 | accuracy: 0.22
step_num: 11400 | loss: 0.2567 | profit rate:   53.1 | accuracy: 0.25
step_num: 11600 | loss: 0.3095 | profit rate:    5.0 | accuracy: 0.24
step_num: 11800 | loss: 0.3413 | profit rate:   12.4 | accuracy: 0.24
step_num: 12000 | loss: 0.3037 | profit rate:   13.7 | accuracy: 0.24
step_num: 12200 | loss: 0.3208 | profit rate:   59.3 | accuracy: 0.24
step_num: 12400 | loss: 0.3233 | profit rate:  304.9 | accuracy: 0.25
step_num: 12600 | loss: 0.3109 | profit rate:  586.6 | accuracy: 0.26
model saved @ step:12640,performance:827.964,accuracy:0.27
step_num: 12800 | loss: 0.3100 | profit rate:    1.6 | accuracy: 0.22
step_num: 13000 | loss: 0.3587 | profit rate:    4.3 | accuracy: 0.32
step_num: 13200 | loss: 0.3724 | profit rate:    0.7 | accuracy: 0.32
step_num: 13400 | loss: 0.4082 | profit rate:    1.4 | accuracy: 0.34
step_num: 13600 | loss: 0.3632 | profit rate:    0.8 | accuracy: 0.29
step_num: 13800 | loss: 0.3539 | profit rate:    0.9 | accuracy: 0.28
step_num: 14000 | loss: 0.3029 | profit rate:    1.1 | accuracy: 0.26
step_num: 14200 | loss: 0.2468 | profit rate:    1.5 | accuracy: 0.25
step_num: 14400 | loss: 0.2624 | profit rate:   78.3 | accuracy: 0.28
step_num: 14600 | loss: 0.2909 | profit rate:  445.5 | accuracy: 0.29
step_num: 14800 | loss: 0.3163 | profit rate:  178.9 | accuracy: 0.28
step_num: 15000 | loss: 0.3217 | profit rate:  667.3 | accuracy: 0.28
step_num: 15200 | loss: 0.3715 | profit rate:  657.3 | accuracy: 0.28
step_num: 15400 | loss: 0.3293 | profit rate:  879.1 | accuracy: 0.27
step_num: 15600 | loss: 0.3155 | profit rate: 2610.9 | accuracy: 0.28
episode:   5/5,耗时:1.95分/9.49分,训练集: | step: 15800 | average_treward:  171.2 | max_treward: 292.9834 | average profit rate: 2160.722
model saved @ step:15800,performance:5413.671,accuracy:0.28
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 26%|       | 107/408 [00:00<00:00, 1059.50it/s] 53%|    | 216/408 [00:00<00:00, 1071.09it/s] 81%| | 332/408 [00:00<00:00, 1109.12it/s]100%|| 408/408 [00:00<00:00, 1110.33it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 979.30
2023-07-24T12:00:00 | net performance [%] = -2.0703
2023-07-24T12:00:00 | number of trades [#] = 26
==================================================
Trial 12 Complete [00h 09m 32s]
net_wealth: 980.2776923477004

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 05m 01s

Search: Running Trial #13

Value             |Best Value So Far |Hyperparameter
9                 |12                |horizon
365               |730               |lookback
True              |True              |MarketFactor
20                |5                 |lags
0.98              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4292.000000   4301.000000
mean      0.000435    20113.607657  ...   20202.430277  20169.373185
std       0.027833    16040.642334  ...   16079.200001  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7761.477417   7730.930176
50%       0.000642    11571.842969  ...   11760.674805  11751.469727
75%       0.011590    29894.706152  ...   30029.208008  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.5812 | profit rate:    0.8 | accuracy: 0.31
step_num: 400 | loss: 0.5749 | profit rate:    0.8 | accuracy: 0.33
step_num: 600 | loss: 0.7328 | profit rate:    0.0 | accuracy: 0.31
step_num: 800 | loss: 0.5466 | profit rate:    0.0 | accuracy: 0.31
step_num: 1000 | loss: 0.6505 | profit rate:    0.0 | accuracy: 0.30
step_num: 1200 | loss: 0.5109 | profit rate:    0.0 | accuracy: 0.28
step_num: 1400 | loss: 0.5609 | profit rate:    0.0 | accuracy: 0.29
step_num: 1600 | loss: 0.5801 | profit rate:    0.0 | accuracy: 0.31
step_num: 1800 | loss: 0.4829 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.7590 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.7367 | profit rate:    0.0 | accuracy: 0.32
step_num: 2400 | loss: 0.7681 | profit rate:    0.0 | accuracy: 0.33
step_num: 2600 | loss: 0.7425 | profit rate:    0.0 | accuracy: 0.33
step_num: 2800 | loss: 0.5146 | profit rate:    0.0 | accuracy: 0.32
step_num: 3000 | loss: 0.6118 | profit rate:    0.0 | accuracy: 0.33
step_num: 3200 | loss: 0.6774 | profit rate:    0.0 | accuracy: 0.33
step_num: 3400 | loss: 0.6716 | profit rate:    0.0 | accuracy: 0.34
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3508 | average_treward: -107.0 | max_treward: 0.0000 | average profit rate:  0.007
step_num: 3600 | loss: 0.6411 | profit rate:    0.6 | accuracy: 0.34
step_num: 3800 | loss: 0.6235 | profit rate:   24.6 | accuracy: 0.42
step_num: 4000 | loss: 0.6573 | profit rate:  138.6 | accuracy: 0.43
step_num: 4200 | loss: 0.6426 | profit rate:   26.4 | accuracy: 0.40
step_num: 4400 | loss: 0.4475 | profit rate:    0.1 | accuracy: 0.36
step_num: 4600 | loss: 0.4256 | profit rate:    0.0 | accuracy: 0.30
step_num: 4800 | loss: 0.2630 | profit rate:    0.0 | accuracy: 0.28
step_num: 5000 | loss: 0.3081 | profit rate:    0.0 | accuracy: 0.26
step_num: 5200 | loss: 0.4352 | profit rate:    0.0 | accuracy: 0.26
step_num: 5400 | loss: 0.4838 | profit rate:    0.1 | accuracy: 0.27
step_num: 5600 | loss: 0.8894 | profit rate:    0.0 | accuracy: 0.27
step_num: 5800 | loss: 0.5211 | profit rate:    0.0 | accuracy: 0.26
step_num: 6000 | loss: 0.5480 | profit rate:    0.0 | accuracy: 0.27
step_num: 6200 | loss: 0.5812 | profit rate:    0.0 | accuracy: 0.27
step_num: 6400 | loss: 0.6384 | profit rate:    0.0 | accuracy: 0.28
step_num: 6600 | loss: 0.3333 | profit rate:    0.0 | accuracy: 0.27
step_num: 6800 | loss: 0.5019 | profit rate:    0.0 | accuracy: 0.28
step_num: 7000 | loss: 0.4508 | profit rate:    0.2 | accuracy: 0.28
step_num: 7200 | loss: 0.3235 | profit rate:    2.3 | accuracy: 0.26
step_num: 7400 | loss: 0.3463 | profit rate:   13.9 | accuracy: 0.30
step_num: 7600 | loss: 0.6489 | profit rate:    4.9 | accuracy: 0.31
step_num: 7800 | loss: 0.7411 | profit rate:    0.7 | accuracy: 0.29
step_num: 8000 | loss: 0.6991 | profit rate:    0.0 | accuracy: 0.25
step_num: 8200 | loss: 0.4946 | profit rate:    0.0 | accuracy: 0.23
step_num: 8400 | loss: 0.4525 | profit rate:    0.0 | accuracy: 0.22
step_num: 8600 | loss: 0.3314 | profit rate:    0.0 | accuracy: 0.20
step_num: 8800 | loss: 0.3427 | profit rate:    0.0 | accuracy: 0.20
step_num: 9000 | loss: 0.2089 | profit rate:    0.0 | accuracy: 0.19
step_num: 9200 | loss: 0.2809 | profit rate:    0.0 | accuracy: 0.18
step_num: 9400 | loss: 0.3946 | profit rate:    0.0 | accuracy: 0.18
step_num: 9600 | loss: 0.8370 | profit rate:    0.0 | accuracy: 0.20
step_num: 9800 | loss: 0.5576 | profit rate:    0.0 | accuracy: 0.22
step_num: 10000 | loss: 0.5979 | profit rate:    0.0 | accuracy: 0.23
step_num: 10200 | loss: 0.6012 | profit rate:    0.0 | accuracy: 0.24
step_num: 10400 | loss: 0.6118 | profit rate:    0.1 | accuracy: 0.25
episode:   3/5,耗时:0.70分/2.03分,训练集: | step: 10524 | average_treward:  -28.3 | max_treward: 31.2779 | average profit rate:  0.195
model saved @ step:10524,performance:0.389,accuracy:0.26
step_num: 10600 | loss: 0.7713 | profit rate:    1.1 | accuracy: 0.32
step_num: 10800 | loss: 0.3536 | profit rate:    5.0 | accuracy: 0.21
step_num: 11000 | loss: 0.3411 | profit rate:    5.7 | accuracy: 0.24
step_num: 11200 | loss: 0.9884 | profit rate:    9.8 | accuracy: 0.26
step_num: 11400 | loss: 0.4563 | profit rate:    0.5 | accuracy: 0.23
step_num: 11600 | loss: 0.2930 | profit rate:    0.8 | accuracy: 0.21
step_num: 11800 | loss: 0.5180 | profit rate:    0.6 | accuracy: 0.21
step_num: 12000 | loss: 0.4674 | profit rate:    0.9 | accuracy: 0.19
step_num: 12200 | loss: 0.3665 | profit rate:    1.0 | accuracy: 0.19
step_num: 12400 | loss: 0.4463 | profit rate:    0.3 | accuracy: 0.20
step_num: 12600 | loss: 0.4448 | profit rate:    0.1 | accuracy: 0.19
step_num: 12800 | loss: 0.6933 | profit rate:    0.2 | accuracy: 0.20
step_num: 13000 | loss: 0.5668 | profit rate:    0.1 | accuracy: 0.21
step_num: 13200 | loss: 0.4425 | profit rate:    0.1 | accuracy: 0.21
step_num: 13400 | loss: 0.5392 | profit rate:    0.2 | accuracy: 0.22
step_num: 13600 | loss: 1.0485 | profit rate:    3.1 | accuracy: 0.23
step_num: 13800 | loss: 1.2163 | profit rate:   12.2 | accuracy: 0.23
step_num: 14000 | loss: 0.6516 | profit rate:  100.5 | accuracy: 0.25
model saved @ step:14032,performance:99.192,accuracy:0.24
step_num: 14200 | loss: 0.7334 | profit rate:    9.0 | accuracy: 0.46
step_num: 14400 | loss: 0.4892 | profit rate:   13.5 | accuracy: 0.31
step_num: 14600 | loss: 0.5982 | profit rate:   10.5 | accuracy: 0.33
step_num: 14800 | loss: 0.7623 | profit rate:    0.9 | accuracy: 0.30
step_num: 15000 | loss: 0.8372 | profit rate:    0.0 | accuracy: 0.27
step_num: 15200 | loss: 0.7507 | profit rate:    0.0 | accuracy: 0.28
step_num: 15400 | loss: 0.3974 | profit rate:    0.0 | accuracy: 0.25
step_num: 15600 | loss: 0.5372 | profit rate:    0.1 | accuracy: 0.23
step_num: 15800 | loss: 0.4847 | profit rate:    0.0 | accuracy: 0.24
step_num: 16000 | loss: 0.4525 | profit rate:    0.1 | accuracy: 0.25
step_num: 16200 | loss: 0.7189 | profit rate:    0.1 | accuracy: 0.26
step_num: 16400 | loss: 0.7757 | profit rate:    0.2 | accuracy: 0.28
step_num: 16600 | loss: 0.5755 | profit rate:    0.6 | accuracy: 0.28
step_num: 16800 | loss: 0.6186 | profit rate:    7.0 | accuracy: 0.29
step_num: 17000 | loss: 0.6636 | profit rate:    5.9 | accuracy: 0.29
step_num: 17200 | loss: 0.7580 | profit rate:  365.6 | accuracy: 0.29
step_num: 17400 | loss: 0.6591 | profit rate:  946.0 | accuracy: 0.30
episode:   5/5,耗时:0.72分/3.47分,训练集: | step: 17540 | average_treward:   13.5 | max_treward: 106.4501 | average profit rate: 1208.615
model saved @ step:17540,performance:5943.296,accuracy:0.31
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 24%|       | 95/391 [00:00<00:00, 940.68it/s] 51%|     | 200/391 [00:00<00:00, 999.35it/s] 77%|  | 303/391 [00:00<00:00, 1009.00it/s]==================================================
100%|| 391/391 [00:00<00:00, 1003.00it/s]
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1151.14
2023-07-24T12:00:00 | net performance [%] = 15.1140
2023-07-24T12:00:00 | number of trades [#] = 32
==================================================
Trial 13 Complete [00h 03m 32s]
net_wealth: 1151.1404788079697

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 08m 33s

Search: Running Trial #14

Value             |Best Value So Far |Hyperparameter
5                 |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.85              |0.6               |gamma
0.0001            |5e-05             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4310.000000   4315.000000
mean      0.000441    20062.255222  ...   20136.939364  20118.633889
std       0.027818    16039.874230  ...   16077.430342  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7696.969971   7690.540039
50%       0.000642    11554.824463  ...   11742.710449  11715.610352
75%       0.011655    29873.081836  ...   29945.211914  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 1.0606 | profit rate:    8.8 | accuracy: 0.34
step_num: 600 | loss: 0.8044 | profit rate:   12.5 | accuracy: 0.34
step_num: 800 | loss: 0.7148 | profit rate:   12.2 | accuracy: 0.36
step_num: 1000 | loss: 0.7790 | profit rate:    4.5 | accuracy: 0.36
step_num: 1200 | loss: 0.6515 | profit rate:    0.7 | accuracy: 0.33
step_num: 1400 | loss: 0.5277 | profit rate:    1.0 | accuracy: 0.34
step_num: 1600 | loss: 0.4931 | profit rate:    0.6 | accuracy: 0.35
step_num: 1800 | loss: 0.5224 | profit rate:    0.4 | accuracy: 0.33
step_num: 2000 | loss: 0.4566 | profit rate:    0.4 | accuracy: 0.33
step_num: 2200 | loss: 0.4020 | profit rate:    0.3 | accuracy: 0.32
step_num: 2400 | loss: 0.3397 | profit rate:    0.1 | accuracy: 0.30
step_num: 2600 | loss: 0.3776 | profit rate:    0.2 | accuracy: 0.31
step_num: 2800 | loss: 0.5026 | profit rate:    0.2 | accuracy: 0.32
step_num: 3000 | loss: 0.5355 | profit rate:    0.1 | accuracy: 0.32
step_num: 3200 | loss: 0.5067 | profit rate:    0.2 | accuracy: 0.32
step_num: 3400 | loss: 0.5874 | profit rate:    0.0 | accuracy: 0.33
step_num: 3600 | loss: 0.6003 | profit rate:    0.0 | accuracy: 0.34
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3724 | average_treward:    6.5 | max_treward: 6.5401 | average profit rate:  0.101
model saved @ step:3724,performance:0.101,accuracy:0.34
step_num: 3800 | loss: 0.5158 | profit rate:    0.5 | accuracy: 0.03
step_num: 4000 | loss: 0.5136 | profit rate:    1.2 | accuracy: 0.26
step_num: 4200 | loss: 0.5220 | profit rate:    2.0 | accuracy: 0.37
step_num: 4400 | loss: 0.6294 | profit rate:    4.3 | accuracy: 0.39
step_num: 4600 | loss: 0.5341 | profit rate:   14.7 | accuracy: 0.40
step_num: 4800 | loss: 0.5028 | profit rate:    0.9 | accuracy: 0.37
step_num: 5000 | loss: 0.4206 | profit rate:    0.3 | accuracy: 0.34
step_num: 5200 | loss: 0.3932 | profit rate:    1.3 | accuracy: 0.36
step_num: 5400 | loss: 0.4980 | profit rate:    0.4 | accuracy: 0.36
step_num: 5600 | loss: 0.5181 | profit rate:    0.1 | accuracy: 0.35
step_num: 5800 | loss: 0.4544 | profit rate:    0.0 | accuracy: 0.35
step_num: 6000 | loss: 0.4117 | profit rate:    0.1 | accuracy: 0.34
step_num: 6200 | loss: 0.3589 | profit rate:    0.4 | accuracy: 0.34
step_num: 6400 | loss: 0.4563 | profit rate:    0.2 | accuracy: 0.34
step_num: 6600 | loss: 0.5621 | profit rate:    0.3 | accuracy: 0.34
step_num: 6800 | loss: 0.5732 | profit rate:    0.4 | accuracy: 0.35
step_num: 7000 | loss: 0.4823 | profit rate:    0.6 | accuracy: 0.35
step_num: 7200 | loss: 0.5707 | profit rate:    3.4 | accuracy: 0.36
step_num: 7400 | loss: 0.5295 | profit rate:    4.5 | accuracy: 0.36
model saved @ step:7448,performance:5.604,accuracy:0.36
step_num: 7600 | loss: 0.5142 | profit rate:    3.0 | accuracy: 0.21
step_num: 7800 | loss: 0.5883 | profit rate:    5.8 | accuracy: 0.38
step_num: 8000 | loss: 0.5952 | profit rate:    4.3 | accuracy: 0.38
step_num: 8200 | loss: 0.5733 | profit rate:   29.4 | accuracy: 0.39
step_num: 8400 | loss: 0.5399 | profit rate:   19.9 | accuracy: 0.41
step_num: 8600 | loss: 0.5039 | profit rate:  303.8 | accuracy: 0.41
step_num: 8800 | loss: 0.5070 | profit rate:  100.4 | accuracy: 0.41
step_num: 9000 | loss: 0.5252 | profit rate:  140.0 | accuracy: 0.42
step_num: 9200 | loss: 0.5600 | profit rate:   31.2 | accuracy: 0.41
step_num: 9400 | loss: 0.5800 | profit rate:    2.6 | accuracy: 0.41
step_num: 9600 | loss: 0.4579 | profit rate:    3.8 | accuracy: 0.40
step_num: 9800 | loss: 0.5134 | profit rate:  554.2 | accuracy: 0.42
step_num: 10000 | loss: 0.5521 | profit rate:  349.6 | accuracy: 0.42
step_num: 10200 | loss: 0.6550 | profit rate:  764.8 | accuracy: 0.42
step_num: 10400 | loss: 0.5918 | profit rate:  413.6 | accuracy: 0.42
step_num: 10600 | loss: 0.5941 | profit rate:  800.7 | accuracy: 0.42
step_num: 10800 | loss: 0.5816 | profit rate: 6118.4 | accuracy: 0.43
step_num: 11000 | loss: 0.6125 | profit rate: 6680.0 | accuracy: 0.43
episode:   3/5,耗时:0.70分/2.03分,训练集: | step: 11172 | average_treward:  105.6 | max_treward: 227.7507 | average profit rate: 3835.392
model saved @ step:11172,performance:11500.471,accuracy:0.43
step_num: 11200 | loss: 0.5953 | profit rate:   14.5 | accuracy: 0.83
step_num: 11400 | loss: 0.6282 | profit rate:    9.9 | accuracy: 0.44
step_num: 11600 | loss: 0.7096 | profit rate:   64.4 | accuracy: 0.49
step_num: 11800 | loss: 0.6079 | profit rate:    8.5 | accuracy: 0.42
step_num: 12000 | loss: 0.5473 | profit rate:   42.7 | accuracy: 0.43
step_num: 12200 | loss: 0.5317 | profit rate:  155.0 | accuracy: 0.46
step_num: 12400 | loss: 0.6239 | profit rate: 1481.1 | accuracy: 0.47
step_num: 12600 | loss: 0.5886 | profit rate: 1310.6 | accuracy: 0.46
step_num: 12800 | loss: 0.5884 | profit rate: 2420.5 | accuracy: 0.47
step_num: 13000 | loss: 0.5531 | profit rate:  115.2 | accuracy: 0.45
step_num: 13200 | loss: 0.5409 | profit rate:   38.0 | accuracy: 0.45
step_num: 13400 | loss: 0.4942 | profit rate:  321.7 | accuracy: 0.45
step_num: 13600 | loss: 0.5218 | profit rate: 35465.4 | accuracy: 0.46
step_num: 13800 | loss: 0.6593 | profit rate: 24756.5 | accuracy: 0.46
step_num: 14000 | loss: 0.6463 | profit rate: 34957.4 | accuracy: 0.46
step_num: 14200 | loss: 0.6151 | profit rate: 52860.0 | accuracy: 0.46
step_num: 14400 | loss: 0.5939 | profit rate: 32188.6 | accuracy: 0.45
step_num: 14600 | loss: 0.5961 | profit rate: 444122.7 | accuracy: 0.46
step_num: 14800 | loss: 0.5666 | profit rate: 1899448.1 | accuracy: 0.46
model saved @ step:14896,performance:2100952.103,accuracy:0.46
step_num: 15000 | loss: 0.6246 | profit rate:    2.2 | accuracy: 0.53
step_num: 15200 | loss: 0.6883 | profit rate:    7.1 | accuracy: 0.45
step_num: 15400 | loss: 0.7636 | profit rate:    5.5 | accuracy: 0.45
step_num: 15600 | loss: 0.6022 | profit rate:    7.1 | accuracy: 0.41
step_num: 15800 | loss: 0.5524 | profit rate:   11.4 | accuracy: 0.42
step_num: 16000 | loss: 0.5373 | profit rate:  434.3 | accuracy: 0.46
step_num: 16200 | loss: 0.5736 | profit rate:  293.4 | accuracy: 0.46
step_num: 16400 | loss: 0.5530 | profit rate: 2487.5 | accuracy: 0.47
step_num: 16600 | loss: 0.4750 | profit rate:  837.8 | accuracy: 0.45
step_num: 16800 | loss: 0.5247 | profit rate:  151.5 | accuracy: 0.44
step_num: 17000 | loss: 0.5243 | profit rate:   50.3 | accuracy: 0.43
step_num: 17200 | loss: 0.4903 | profit rate: 3800.6 | accuracy: 0.45
step_num: 17400 | loss: 0.5596 | profit rate: 45539.6 | accuracy: 0.46
step_num: 17600 | loss: 0.6076 | profit rate: 45454.8 | accuracy: 0.45
step_num: 17800 | loss: 0.5894 | profit rate: 102096.1 | accuracy: 0.46
step_num: 18000 | loss: 0.5654 | profit rate: 224615.1 | accuracy: 0.46
step_num: 18200 | loss: 0.5530 | profit rate: 123450.8 | accuracy: 0.45
step_num: 18400 | loss: 0.5733 | profit rate: 899600.1 | accuracy: 0.45
step_num: 18600 | loss: 0.5461 | profit rate: 1665487.8 | accuracy: 0.45
episode:   5/5,耗时:0.69分/3.43分,训练集: | step: 18620 | average_treward:  196.3 | max_treward: 338.7895 | average profit rate: 782163.060
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 22%|       | 91/408 [00:00<00:00, 909.93it/s] 50%|     | 203/408 [00:00<00:00, 1031.36it/s] 79%|  | 323/408 [00:00<00:00, 1107.71it/s]==================================================
100%|| 408/408 [00:00<00:00, 1094.74it/s]
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1246.52
2023-07-24T12:00:00 | net performance [%] = 24.6515
2023-07-24T12:00:00 | number of trades [#] = 4
==================================================
Trial 14 Complete [00h 03m 29s]
net_wealth: 1247.7628659044742

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 12m 02s

Search: Running Trial #15

Value             |Best Value So Far |Hyperparameter
2                 |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.92              |0.6               |gamma
0.0001            |5e-05             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4313.000000   4315.000000
mean      0.000441    20062.255222  ...   20125.961477  20118.633889
std       0.027818    16039.874230  ...   16077.223335  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7693.100098   7690.540039
50%       0.000642    11554.824463  ...   11733.030273  11715.610352
75%       0.011655    29873.081836  ...   29928.000000  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.4501 | profit rate:    1.4 | accuracy: 0.32
step_num: 1200 | loss: 0.4032 | profit rate:    2.4 | accuracy: 0.32
step_num: 1400 | loss: 0.3839 | profit rate:    2.8 | accuracy: 0.32
step_num: 1600 | loss: 0.3787 | profit rate:    3.6 | accuracy: 0.32
step_num: 1800 | loss: 0.3929 | profit rate:    3.7 | accuracy: 0.33
step_num: 2000 | loss: 0.3852 | profit rate:    4.6 | accuracy: 0.33
step_num: 2200 | loss: 0.3741 | profit rate:   17.9 | accuracy: 0.34
step_num: 2400 | loss: 0.3926 | profit rate:    7.2 | accuracy: 0.34
step_num: 2600 | loss: 0.3833 | profit rate:    8.6 | accuracy: 0.34
step_num: 2800 | loss: 0.3989 | profit rate:    7.4 | accuracy: 0.34
step_num: 3000 | loss: 0.3871 | profit rate:    5.2 | accuracy: 0.34
step_num: 3200 | loss: 0.4002 | profit rate:    4.5 | accuracy: 0.35
step_num: 3400 | loss: 0.3966 | profit rate:    5.4 | accuracy: 0.34
episode:   1/5,耗时:2.77分/2.77分,训练集: | step: 3539 | average_treward:  136.7 | max_treward: 136.7498 | average profit rate:  4.711
model saved @ step:3539,performance:4.711,accuracy:0.34
step_num: 3600 | loss: 0.4010 | profit rate:    1.5 | accuracy: 0.35
step_num: 3800 | loss: 0.3906 | profit rate:    2.2 | accuracy: 0.27
step_num: 4000 | loss: 0.3950 | profit rate:    2.3 | accuracy: 0.28
step_num: 4200 | loss: 0.3783 | profit rate:    6.1 | accuracy: 0.29
step_num: 4400 | loss: 0.3654 | profit rate:    5.3 | accuracy: 0.28
step_num: 4600 | loss: 0.3801 | profit rate:    5.7 | accuracy: 0.31
step_num: 4800 | loss: 0.3645 | profit rate:    4.5 | accuracy: 0.31
step_num: 5000 | loss: 0.3549 | profit rate:    3.9 | accuracy: 0.29
step_num: 5200 | loss: 0.3542 | profit rate:    6.4 | accuracy: 0.30
step_num: 5400 | loss: 0.3375 | profit rate:    5.0 | accuracy: 0.30
step_num: 5600 | loss: 0.3344 | profit rate:   13.2 | accuracy: 0.31
step_num: 5800 | loss: 0.3331 | profit rate:   61.8 | accuracy: 0.33
step_num: 6000 | loss: 0.3457 | profit rate:   11.7 | accuracy: 0.33
step_num: 6200 | loss: 0.3503 | profit rate:   19.7 | accuracy: 0.32
step_num: 6400 | loss: 0.3699 | profit rate:    8.9 | accuracy: 0.33
step_num: 6600 | loss: 0.3524 | profit rate:   10.1 | accuracy: 0.32
step_num: 6800 | loss: 0.3362 | profit rate:    8.3 | accuracy: 0.31
step_num: 7000 | loss: 0.3328 | profit rate:    7.8 | accuracy: 0.30
model saved @ step:7078,performance:7.809,accuracy:0.30
step_num: 7200 | loss: 0.3117 | profit rate:    0.9 | accuracy: 0.13
step_num: 7400 | loss: 0.2877 | profit rate:    0.9 | accuracy: 0.07
step_num: 7600 | loss: 0.2719 | profit rate:    1.0 | accuracy: 0.07
step_num: 7800 | loss: 0.2130 | profit rate:    1.5 | accuracy: 0.09
step_num: 8000 | loss: 0.1951 | profit rate:    1.8 | accuracy: 0.13
step_num: 8200 | loss: 0.2310 | profit rate:    1.2 | accuracy: 0.19
step_num: 8400 | loss: 0.1783 | profit rate:    1.2 | accuracy: 0.18
step_num: 8600 | loss: 0.1724 | profit rate:    2.1 | accuracy: 0.19
step_num: 8800 | loss: 0.1693 | profit rate:    1.7 | accuracy: 0.18
step_num: 9000 | loss: 0.1837 | profit rate:    1.8 | accuracy: 0.19
step_num: 9200 | loss: 0.2087 | profit rate:    4.8 | accuracy: 0.21
step_num: 9400 | loss: 0.2650 | profit rate:   20.0 | accuracy: 0.24
step_num: 9600 | loss: 0.2859 | profit rate:    9.8 | accuracy: 0.24
step_num: 9800 | loss: 0.3456 | profit rate:   14.4 | accuracy: 0.25
step_num: 10000 | loss: 0.3331 | profit rate:   14.9 | accuracy: 0.25
step_num: 10200 | loss: 0.2950 | profit rate:   19.9 | accuracy: 0.25
step_num: 10400 | loss: 0.3042 | profit rate:   14.9 | accuracy: 0.25
step_num: 10600 | loss: 0.2990 | profit rate:   16.6 | accuracy: 0.24
episode:   3/5,耗时:3.93分/10.58分,训练集: | step: 10617 | average_treward:  173.4 | max_treward: 227.0765 | average profit rate:  9.739
model saved @ step:10617,performance:16.698,accuracy:0.24
step_num: 10800 | loss: 0.2872 | profit rate:    0.9 | accuracy: 0.16
step_num: 11000 | loss: 0.3099 | profit rate:    1.1 | accuracy: 0.16
step_num: 11200 | loss: 0.2686 | profit rate:    2.8 | accuracy: 0.19
step_num: 11400 | loss: 0.2377 | profit rate:    3.4 | accuracy: 0.19
step_num: 11600 | loss: 0.2648 | profit rate:   10.5 | accuracy: 0.25
step_num: 11800 | loss: 0.2791 | profit rate:    5.9 | accuracy: 0.27
step_num: 12000 | loss: 0.2544 | profit rate:    7.4 | accuracy: 0.26
step_num: 12200 | loss: 0.2708 | profit rate:    8.5 | accuracy: 0.27
step_num: 12400 | loss: 0.2814 | profit rate:    8.7 | accuracy: 0.28
step_num: 12600 | loss: 0.3281 | profit rate:   12.0 | accuracy: 0.31
step_num: 12800 | loss: 0.3339 | profit rate:   71.9 | accuracy: 0.33
step_num: 13000 | loss: 0.3703 | profit rate:   71.0 | accuracy: 0.34
step_num: 13200 | loss: 0.3910 | profit rate:   68.4 | accuracy: 0.33
step_num: 13400 | loss: 0.3996 | profit rate:   52.1 | accuracy: 0.34
step_num: 13600 | loss: 0.3987 | profit rate:   81.2 | accuracy: 0.34
step_num: 13800 | loss: 0.3843 | profit rate:   78.5 | accuracy: 0.34
step_num: 14000 | loss: 0.4062 | profit rate:   85.3 | accuracy: 0.33
model saved @ step:14156,performance:78.039,accuracy:0.33
step_num: 14200 | loss: 0.3984 | profit rate:    1.4 | accuracy: 0.40
step_num: 14400 | loss: 0.3803 | profit rate:    1.6 | accuracy: 0.27
step_num: 14600 | loss: 0.3547 | profit rate:    1.4 | accuracy: 0.27
step_num: 14800 | loss: 0.3463 | profit rate:    3.5 | accuracy: 0.27
step_num: 15000 | loss: 0.3291 | profit rate:    3.4 | accuracy: 0.27
step_num: 15200 | loss: 0.3591 | profit rate:   12.0 | accuracy: 0.32
step_num: 15400 | loss: 0.3404 | profit rate:    7.7 | accuracy: 0.31
step_num: 15600 | loss: 0.3272 | profit rate:    8.2 | accuracy: 0.30
step_num: 15800 | loss: 0.3324 | profit rate:   12.9 | accuracy: 0.30
step_num: 16000 | loss: 0.3322 | profit rate:   11.9 | accuracy: 0.30
step_num: 16200 | loss: 0.3272 | profit rate:   32.9 | accuracy: 0.32
step_num: 16400 | loss: 0.3414 | profit rate:   92.5 | accuracy: 0.33
step_num: 16600 | loss: 0.3412 | profit rate:   78.1 | accuracy: 0.33
step_num: 16800 | loss: 0.3400 | profit rate:   88.0 | accuracy: 0.32
step_num: 17000 | loss: 0.3700 | profit rate:   67.8 | accuracy: 0.33
step_num: 17200 | loss: 0.3233 | profit rate:   84.6 | accuracy: 0.33
step_num: 17400 | loss: 0.3375 | profit rate:  119.7 | accuracy: 0.32
step_num: 17600 | loss: 0.3055 | profit rate:  102.8 | accuracy: 0.31
episode:   5/5,耗时:4.49分/18.91分,训练集: | step: 17695 | average_treward:  210.8 | max_treward: 269.7860 | average profit rate: 41.882
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 25%|       | 101/408 [00:00<00:00, 1008.82it/s] 52%|    | 213/408 [00:00<00:00, 1067.91it/s] 80%|  | 325/408 [00:00<00:00, 1091.61it/s]100%|| 408/408 [00:00<00:00, 1083.63it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1143.02
2023-07-24T12:00:00 | net performance [%] = 14.3020
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 15 Complete [00h 18m 58s]
net_wealth: 1144.1640952954076

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 31m 00s

Search: Running Trial #16

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.92              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.9523 | profit rate:    2.3 | accuracy: 0.35
step_num: 400 | loss: 0.6896 | profit rate:    2.6 | accuracy: 0.34
step_num: 600 | loss: 0.4860 | profit rate:    5.8 | accuracy: 0.36
step_num: 800 | loss: 0.6912 | profit rate:    0.2 | accuracy: 0.36
step_num: 1000 | loss: 1.0300 | profit rate:    1.6 | accuracy: 0.38
step_num: 1200 | loss: 1.3078 | profit rate:  753.9 | accuracy: 0.41
step_num: 1400 | loss: 0.9565 | profit rate:   92.3 | accuracy: 0.40
step_num: 1600 | loss: 0.6365 | profit rate:  256.8 | accuracy: 0.41
step_num: 1800 | loss: 0.8416 | profit rate:    2.8 | accuracy: 0.40
step_num: 2000 | loss: 0.5302 | profit rate:    1.0 | accuracy: 0.40
step_num: 2200 | loss: 0.4827 | profit rate:    0.5 | accuracy: 0.40
step_num: 2400 | loss: 1.2330 | profit rate: 27777.5 | accuracy: 0.42
step_num: 2600 | loss: 0.0897 | profit rate: 1756.4 | accuracy: 0.42
step_num: 2800 | loss: 0.9859 | profit rate: 3649.5 | accuracy: 0.41
step_num: 3000 | loss: 0.3254 | profit rate:  522.2 | accuracy: 0.41
step_num: 3200 | loss: 0.2035 | profit rate: 6617.2 | accuracy: 0.40
step_num: 3400 | loss: 0.1085 | profit rate: 38827.4 | accuracy: 0.39
step_num: 3600 | loss: 0.4911 | profit rate: 19841.6 | accuracy: 0.38
episode:   1/5,耗时:0.57分/0.57分,训练集: | step: 3707 | average_treward:  212.1 | max_treward: 212.1220 | average profit rate: 15129.610
model saved @ step:3707,performance:15129.610,accuracy:0.37
step_num: 3800 | loss: 1.5050 | profit rate:    0.0 | accuracy: 0.43
step_num: 4000 | loss: 0.0372 | profit rate:    0.0 | accuracy: 0.18
step_num: 4200 | loss: 0.6954 | profit rate:    0.0 | accuracy: 0.14
step_num: 4400 | loss: 0.1661 | profit rate:    0.0 | accuracy: 0.12
step_num: 4600 | loss: 0.0032 | profit rate:    0.0 | accuracy: 0.10
step_num: 4800 | loss: 0.9603 | profit rate:    0.1 | accuracy: 0.18
step_num: 5000 | loss: 0.7458 | profit rate:    3.2 | accuracy: 0.22
step_num: 5200 | loss: 0.1561 | profit rate:    2.3 | accuracy: 0.21
step_num: 5400 | loss: 1.6458 | profit rate:    0.0 | accuracy: 0.22
step_num: 5600 | loss: 0.6195 | profit rate:    0.0 | accuracy: 0.23
step_num: 5800 | loss: 0.1501 | profit rate:    0.0 | accuracy: 0.24
step_num: 6000 | loss: 1.2969 | profit rate:   93.8 | accuracy: 0.28
step_num: 6200 | loss: 0.6430 | profit rate: 23033.5 | accuracy: 0.30
step_num: 6400 | loss: 0.0711 | profit rate:  677.8 | accuracy: 0.28
step_num: 6600 | loss: 0.8860 | profit rate: 11899.0 | accuracy: 0.31
step_num: 6800 | loss: 0.2438 | profit rate:  773.9 | accuracy: 0.29
step_num: 7000 | loss: 0.0121 | profit rate:  470.7 | accuracy: 0.29
step_num: 7200 | loss: 0.0043 | profit rate:  278.6 | accuracy: 0.27
step_num: 7400 | loss: 0.0040 | profit rate:  248.9 | accuracy: 0.26
step_num: 7600 | loss: 0.1767 | profit rate:    0.0 | accuracy: 0.22
step_num: 7800 | loss: 0.1383 | profit rate:    0.0 | accuracy: 0.15
step_num: 8000 | loss: 0.1042 | profit rate:    0.0 | accuracy: 0.13
step_num: 8200 | loss: 0.1675 | profit rate:    0.0 | accuracy: 0.12
step_num: 8400 | loss: 1.0171 | profit rate:    0.0 | accuracy: 0.14
step_num: 8600 | loss: 1.2659 | profit rate:   11.6 | accuracy: 0.22
step_num: 8800 | loss: 0.4551 | profit rate:    3.6 | accuracy: 0.22
step_num: 9000 | loss: 0.7602 | profit rate:   15.5 | accuracy: 0.24
step_num: 9200 | loss: 0.1612 | profit rate:    0.0 | accuracy: 0.23
step_num: 9400 | loss: 0.4934 | profit rate:    0.0 | accuracy: 0.23
step_num: 9600 | loss: 0.4563 | profit rate:    0.0 | accuracy: 0.24
step_num: 9800 | loss: 0.8012 | profit rate: 3857.4 | accuracy: 0.28
step_num: 10000 | loss: 0.3406 | profit rate:  293.0 | accuracy: 0.28
step_num: 10200 | loss: 0.7657 | profit rate:  181.9 | accuracy: 0.28
step_num: 10400 | loss: 0.3716 | profit rate:  387.6 | accuracy: 0.29
step_num: 10600 | loss: 0.7791 | profit rate:  206.6 | accuracy: 0.28
step_num: 10800 | loss: 0.1348 | profit rate:   98.8 | accuracy: 0.27
step_num: 11000 | loss: 0.0511 | profit rate:   70.1 | accuracy: 0.26
episode:   3/5,耗时:0.57分/1.71分,训练集: | step: 11121 | average_treward:  147.8 | max_treward: 212.1220 | average profit rate: 5151.086
step_num: 11200 | loss: 1.6439 | profit rate:    0.3 | accuracy: 0.44
step_num: 11400 | loss: 0.0036 | profit rate:    0.0 | accuracy: 0.16
step_num: 11600 | loss: 0.4034 | profit rate:    0.0 | accuracy: 0.13
step_num: 11800 | loss: 0.1592 | profit rate:    0.0 | accuracy: 0.12
step_num: 12000 | loss: 0.0046 | profit rate:    0.0 | accuracy: 0.11
step_num: 12200 | loss: 0.9471 | profit rate:   31.0 | accuracy: 0.20
step_num: 12400 | loss: 0.9331 | profit rate:   83.6 | accuracy: 0.24
step_num: 12600 | loss: 0.1833 | profit rate:  162.3 | accuracy: 0.23
step_num: 12800 | loss: 1.8661 | profit rate:    0.1 | accuracy: 0.22
step_num: 13000 | loss: 0.4606 | profit rate:    0.2 | accuracy: 0.22
step_num: 13200 | loss: 0.2295 | profit rate:    0.1 | accuracy: 0.22
step_num: 13400 | loss: 1.2564 | profit rate:    7.1 | accuracy: 0.25
step_num: 13600 | loss: 0.7463 | profit rate:  297.7 | accuracy: 0.26
step_num: 13800 | loss: 0.5591 | profit rate:   51.2 | accuracy: 0.26
step_num: 14000 | loss: 0.7780 | profit rate:  261.5 | accuracy: 0.27
step_num: 14200 | loss: 0.5166 | profit rate:  417.6 | accuracy: 0.27
step_num: 14400 | loss: 0.1569 | profit rate:   55.6 | accuracy: 0.26
step_num: 14600 | loss: 0.0248 | profit rate:    8.5 | accuracy: 0.25
step_num: 14800 | loss: 0.0083 | profit rate:    8.7 | accuracy: 0.24
step_num: 15000 | loss: 0.3389 | profit rate:    0.0 | accuracy: 0.22
step_num: 15200 | loss: 0.0016 | profit rate:    0.0 | accuracy: 0.10
step_num: 15400 | loss: 0.0684 | profit rate:    0.0 | accuracy: 0.10
step_num: 15600 | loss: 0.1665 | profit rate:    0.1 | accuracy: 0.09
step_num: 15800 | loss: 0.4843 | profit rate:    0.3 | accuracy: 0.11
step_num: 16000 | loss: 1.1312 | profit rate:  470.0 | accuracy: 0.18
step_num: 16200 | loss: 0.0879 | profit rate:  100.3 | accuracy: 0.18
step_num: 16400 | loss: 0.1383 | profit rate:  118.8 | accuracy: 0.16
step_num: 16600 | loss: 0.1610 | profit rate:    0.4 | accuracy: 0.17
step_num: 16800 | loss: 0.4528 | profit rate:    1.1 | accuracy: 0.17
step_num: 17000 | loss: 1.0329 | profit rate:    0.7 | accuracy: 0.18
step_num: 17200 | loss: 0.8468 | profit rate: 1565.0 | accuracy: 0.21
step_num: 17400 | loss: 0.2171 | profit rate: 2394.9 | accuracy: 0.21
step_num: 17600 | loss: 0.8972 | profit rate:  376.6 | accuracy: 0.22
step_num: 17800 | loss: 0.1314 | profit rate: 7902.4 | accuracy: 0.24
step_num: 18000 | loss: 0.9236 | profit rate: 1304.0 | accuracy: 0.23
step_num: 18200 | loss: 0.2983 | profit rate:  615.1 | accuracy: 0.22
step_num: 18400 | loss: 0.0063 | profit rate:  874.0 | accuracy: 0.21
episode:   5/5,耗时:0.62分/2.93分,训练集: | step: 18535 | average_treward:  141.7 | max_treward: 212.1220 | average profit rate: 3320.257
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 21%|        | 81/391 [00:00<00:00, 809.92it/s] 43%|     | 169/391 [00:00<00:00, 849.73it/s] 66%|   | 258/391 [00:00<00:00, 864.15it/s] 90%| | 351/391 [00:00<00:00, 886.58it/s]==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
100%|| 391/391 [00:00<00:00, 870.25it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1326.30
2023-07-24T12:00:00 | net performance [%] = 32.6305
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 16 Complete [00h 02m 59s]
net_wealth: 1326.3048043054487

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 33m 59s

Search: Running Trial #17

Value             |Best Value So Far |Hyperparameter
2                 |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.85              |0.6               |gamma
0.0001            |5e-05             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4313.000000   4315.000000
mean      0.000441    20062.255222  ...   20125.961477  20118.633889
std       0.027818    16039.874230  ...   16077.223335  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7693.100098   7690.540039
50%       0.000642    11554.824463  ...   11733.030273  11715.610352
75%       0.011655    29873.081836  ...   29928.000000  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.8446 | profit rate:    0.2 | accuracy: 0.30
step_num: 800 | loss: 0.5483 | profit rate:    0.2 | accuracy: 0.30
step_num: 1000 | loss: 0.5061 | profit rate:    0.2 | accuracy: 0.31
step_num: 1200 | loss: 0.4287 | profit rate:    0.1 | accuracy: 0.30
step_num: 1400 | loss: 0.3787 | profit rate:    0.1 | accuracy: 0.30
step_num: 1600 | loss: 0.3591 | profit rate:    0.2 | accuracy: 0.30
step_num: 1800 | loss: 0.3879 | profit rate:    0.2 | accuracy: 0.32
step_num: 2000 | loss: 0.3897 | profit rate:    0.2 | accuracy: 0.33
step_num: 2200 | loss: 0.3509 | profit rate:    0.5 | accuracy: 0.32
step_num: 2400 | loss: 0.3571 | profit rate:    0.4 | accuracy: 0.32
step_num: 2600 | loss: 0.3488 | profit rate:    0.4 | accuracy: 0.31
step_num: 2800 | loss: 0.3465 | profit rate:    0.4 | accuracy: 0.32
step_num: 3000 | loss: 0.3351 | profit rate:    0.2 | accuracy: 0.32
step_num: 3200 | loss: 0.3460 | profit rate:    0.1 | accuracy: 0.31
step_num: 3400 | loss: 0.3219 | profit rate:    0.2 | accuracy: 0.30
episode:   1/5,耗时:0.76分/0.76分,训练集: | step: 3539 | average_treward:   22.0 | max_treward: 21.9875 | average profit rate:  0.135
model saved @ step:3539,performance:0.135,accuracy:0.30
step_num: 3600 | loss: 0.2989 | profit rate:    0.8 | accuracy: 0.08
step_num: 3800 | loss: 0.2300 | profit rate:    0.9 | accuracy: 0.10
step_num: 4000 | loss: 0.1992 | profit rate:    0.9 | accuracy: 0.12
step_num: 4200 | loss: 0.1870 | profit rate:    2.8 | accuracy: 0.19
step_num: 4400 | loss: 0.1884 | profit rate:    2.0 | accuracy: 0.20
step_num: 4600 | loss: 0.2893 | profit rate:    1.6 | accuracy: 0.24
step_num: 4800 | loss: 0.2854 | profit rate:    1.1 | accuracy: 0.23
step_num: 5000 | loss: 0.3188 | profit rate:    1.1 | accuracy: 0.24
step_num: 5200 | loss: 0.3451 | profit rate:    2.3 | accuracy: 0.26
step_num: 5400 | loss: 0.3288 | profit rate:    2.1 | accuracy: 0.27
step_num: 5600 | loss: 0.2935 | profit rate:    3.6 | accuracy: 0.27
step_num: 5800 | loss: 0.3069 | profit rate:    4.8 | accuracy: 0.28
step_num: 6000 | loss: 0.3459 | profit rate:    2.5 | accuracy: 0.28
step_num: 6200 | loss: 0.3530 | profit rate:    2.3 | accuracy: 0.29
step_num: 6400 | loss: 0.3619 | profit rate:    1.2 | accuracy: 0.29
step_num: 6600 | loss: 0.3900 | profit rate:    1.4 | accuracy: 0.30
step_num: 6800 | loss: 0.4256 | profit rate:    1.4 | accuracy: 0.31
step_num: 7000 | loss: 0.4039 | profit rate:    1.7 | accuracy: 0.30
model saved @ step:7078,performance:1.870,accuracy:0.30
step_num: 7200 | loss: 0.3860 | profit rate:    1.0 | accuracy: 0.15
step_num: 7400 | loss: 0.3533 | profit rate:    1.1 | accuracy: 0.22
step_num: 7600 | loss: 0.3177 | profit rate:    1.2 | accuracy: 0.24
step_num: 7800 | loss: 0.2980 | profit rate:    2.0 | accuracy: 0.30
step_num: 8000 | loss: 0.3262 | profit rate:    1.6 | accuracy: 0.32
step_num: 8200 | loss: 0.4029 | profit rate:    1.7 | accuracy: 0.35
step_num: 8400 | loss: 0.4023 | profit rate:    1.2 | accuracy: 0.34
step_num: 8600 | loss: 0.4011 | profit rate:    1.9 | accuracy: 0.34
step_num: 8800 | loss: 0.4015 | profit rate:    1.9 | accuracy: 0.34
step_num: 9000 | loss: 0.4041 | profit rate:    1.9 | accuracy: 0.36
step_num: 9200 | loss: 0.3602 | profit rate:    3.6 | accuracy: 0.36
step_num: 9400 | loss: 0.3987 | profit rate:    6.3 | accuracy: 0.37
step_num: 9600 | loss: 0.4032 | profit rate:    2.5 | accuracy: 0.37
step_num: 9800 | loss: 0.3811 | profit rate:    2.7 | accuracy: 0.37
step_num: 10000 | loss: 0.4377 | profit rate:    0.8 | accuracy: 0.37
step_num: 10200 | loss: 0.4329 | profit rate:    1.2 | accuracy: 0.37
step_num: 10400 | loss: 0.4210 | profit rate:    1.7 | accuracy: 0.37
step_num: 10600 | loss: 0.3836 | profit rate:    1.8 | accuracy: 0.36
episode:   3/5,耗时:0.93分/2.62分,训练集: | step: 10617 | average_treward:  138.7 | max_treward: 200.1304 | average profit rate:  1.281
step_num: 10800 | loss: 0.3305 | profit rate:    0.8 | accuracy: 0.10
step_num: 11000 | loss: 0.3083 | profit rate:    1.1 | accuracy: 0.22
step_num: 11200 | loss: 0.2856 | profit rate:    2.8 | accuracy: 0.27
step_num: 11400 | loss: 0.2956 | profit rate:    2.9 | accuracy: 0.30
step_num: 11600 | loss: 0.3575 | profit rate:    3.0 | accuracy: 0.33
step_num: 11800 | loss: 0.4048 | profit rate:    1.9 | accuracy: 0.35
step_num: 12000 | loss: 0.3982 | profit rate:    2.2 | accuracy: 0.34
step_num: 12200 | loss: 0.3992 | profit rate:    3.5 | accuracy: 0.34
step_num: 12400 | loss: 0.4134 | profit rate:    5.4 | accuracy: 0.36
step_num: 12600 | loss: 0.4258 | profit rate:    9.0 | accuracy: 0.38
step_num: 12800 | loss: 0.4102 | profit rate:   28.3 | accuracy: 0.39
step_num: 13000 | loss: 0.4717 | profit rate:   13.7 | accuracy: 0.40
step_num: 13200 | loss: 0.4576 | profit rate:   15.1 | accuracy: 0.39
step_num: 13400 | loss: 0.4657 | profit rate:    8.7 | accuracy: 0.40
step_num: 13600 | loss: 0.4788 | profit rate:    4.5 | accuracy: 0.39
step_num: 13800 | loss: 0.4286 | profit rate:    3.9 | accuracy: 0.39
step_num: 14000 | loss: 0.3805 | profit rate:    8.1 | accuracy: 0.38
model saved @ step:14156,performance:7.114,accuracy:0.38
step_num: 14200 | loss: 0.3735 | profit rate:    0.9 | accuracy: 0.22
step_num: 14400 | loss: 0.3257 | profit rate:    1.1 | accuracy: 0.19
step_num: 14600 | loss: 0.2910 | profit rate:    1.1 | accuracy: 0.24
step_num: 14800 | loss: 0.2599 | profit rate:    3.4 | accuracy: 0.28
step_num: 15000 | loss: 0.2997 | profit rate:    2.6 | accuracy: 0.30
step_num: 15200 | loss: 0.3709 | profit rate:    3.0 | accuracy: 0.34
step_num: 15400 | loss: 0.4083 | profit rate:    2.1 | accuracy: 0.33
step_num: 15600 | loss: 0.3757 | profit rate:    2.0 | accuracy: 0.33
step_num: 15800 | loss: 0.4095 | profit rate:    2.5 | accuracy: 0.33
step_num: 16000 | loss: 0.4249 | profit rate:    2.1 | accuracy: 0.34
step_num: 16200 | loss: 0.3848 | profit rate:    7.9 | accuracy: 0.36
step_num: 16400 | loss: 0.4267 | profit rate:   21.6 | accuracy: 0.38
step_num: 16600 | loss: 0.4640 | profit rate:   10.5 | accuracy: 0.37
step_num: 16800 | loss: 0.4255 | profit rate:   10.0 | accuracy: 0.37
step_num: 17000 | loss: 0.4459 | profit rate:    5.1 | accuracy: 0.37
step_num: 17200 | loss: 0.4313 | profit rate:    4.2 | accuracy: 0.37
step_num: 17400 | loss: 0.3911 | profit rate:    5.3 | accuracy: 0.36
step_num: 17600 | loss: 0.3290 | profit rate:   10.5 | accuracy: 0.35
episode:   5/5,耗时:0.94分/4.50分,训练集: | step: 17695 | average_treward:  172.2 | max_treward: 225.8103 | average profit rate:  4.318
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 22%|       | 90/408 [00:00<00:00, 899.24it/s] 46%|     | 189/408 [00:00<00:00, 930.67it/s] 70%|   | 285/408 [00:00<00:00, 942.85it/s] 95%|| 387/408 [00:00<00:00, 969.26it/s]100%|| 408/408 [00:00<00:00, 956.99it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1079.04
2023-07-24T12:00:00 | net performance [%] = 7.9043
2023-07-24T12:00:00 | number of trades [#] = 22
==================================================
Trial 17 Complete [00h 04m 33s]
net_wealth: 1080.122868691988

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 38m 32s

Search: Running Trial #18

Value             |Best Value So Far |Hyperparameter
1                 |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
8                 |5                 |lags
0.85              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.9920 | profit rate:    0.9 | accuracy: 0.35
step_num: 800 | loss: 0.7521 | profit rate:    0.7 | accuracy: 0.32
step_num: 1000 | loss: 0.6282 | profit rate:    0.6 | accuracy: 0.32
step_num: 1200 | loss: 0.5881 | profit rate:    1.6 | accuracy: 0.33
step_num: 1400 | loss: 0.5392 | profit rate:    1.2 | accuracy: 0.32
step_num: 1600 | loss: 0.4302 | profit rate:    1.2 | accuracy: 0.30
step_num: 1800 | loss: 0.3870 | profit rate:    1.9 | accuracy: 0.29
step_num: 2000 | loss: 0.3697 | profit rate:    0.8 | accuracy: 0.28
step_num: 2200 | loss: 0.2979 | profit rate:    2.1 | accuracy: 0.28
step_num: 2400 | loss: 0.3451 | profit rate:    2.5 | accuracy: 0.28
step_num: 2600 | loss: 0.3202 | profit rate:    2.3 | accuracy: 0.29
step_num: 2800 | loss: 0.3858 | profit rate:    1.9 | accuracy: 0.29
step_num: 3000 | loss: 0.4459 | profit rate:    1.7 | accuracy: 0.30
episode:   1/5,耗时:0.99分/0.99分,训练集: | step: 3155 | average_treward:   81.0 | max_treward: 81.0412 | average profit rate:  1.837
model saved @ step:3155,performance:1.837,accuracy:0.31
step_num: 3200 | loss: 0.4507 | profit rate:    0.9 | accuracy: 0.39
step_num: 3400 | loss: 0.4223 | profit rate:    0.7 | accuracy: 0.33
step_num: 3600 | loss: 0.4653 | profit rate:    0.7 | accuracy: 0.27
step_num: 3800 | loss: 0.4204 | profit rate:    0.6 | accuracy: 0.28
step_num: 4000 | loss: 0.3666 | profit rate:    0.7 | accuracy: 0.29
step_num: 4200 | loss: 0.3689 | profit rate:    0.6 | accuracy: 0.30
step_num: 4400 | loss: 0.3551 | profit rate:    1.2 | accuracy: 0.30
step_num: 4600 | loss: 0.3478 | profit rate:    1.4 | accuracy: 0.29
step_num: 4800 | loss: 0.3399 | profit rate:    1.9 | accuracy: 0.30
step_num: 5000 | loss: 0.3241 | profit rate:    4.6 | accuracy: 0.32
step_num: 5200 | loss: 0.3621 | profit rate:    2.5 | accuracy: 0.32
step_num: 5400 | loss: 0.3250 | profit rate:    3.8 | accuracy: 0.32
step_num: 5600 | loss: 0.3283 | profit rate:    4.4 | accuracy: 0.31
step_num: 5800 | loss: 0.3043 | profit rate:    4.0 | accuracy: 0.30
step_num: 6000 | loss: 0.3282 | profit rate:    3.4 | accuracy: 0.31
step_num: 6200 | loss: 0.3021 | profit rate:    2.6 | accuracy: 0.31
model saved @ step:6310,performance:2.098,accuracy:0.30
step_num: 6400 | loss: 0.3108 | profit rate:    0.8 | accuracy: 0.25
step_num: 6600 | loss: 0.3116 | profit rate:    0.5 | accuracy: 0.22
step_num: 6800 | loss: 0.2734 | profit rate:    0.5 | accuracy: 0.18
step_num: 7000 | loss: 0.2710 | profit rate:    0.9 | accuracy: 0.25
step_num: 7200 | loss: 0.2541 | profit rate:    0.6 | accuracy: 0.25
step_num: 7400 | loss: 0.2546 | profit rate:    0.7 | accuracy: 0.25
step_num: 7600 | loss: 0.2426 | profit rate:    2.0 | accuracy: 0.25
step_num: 7800 | loss: 0.2627 | profit rate:    2.0 | accuracy: 0.25
step_num: 8000 | loss: 0.2656 | profit rate:    3.8 | accuracy: 0.27
step_num: 8200 | loss: 0.2943 | profit rate:    4.0 | accuracy: 0.29
step_num: 8400 | loss: 0.3083 | profit rate:    2.7 | accuracy: 0.29
step_num: 8600 | loss: 0.2895 | profit rate:    3.5 | accuracy: 0.28
step_num: 8800 | loss: 0.2879 | profit rate:    3.9 | accuracy: 0.28
step_num: 9000 | loss: 0.2769 | profit rate:    3.9 | accuracy: 0.27
step_num: 9200 | loss: 0.2529 | profit rate:    3.9 | accuracy: 0.27
step_num: 9400 | loss: 0.2077 | profit rate:    3.2 | accuracy: 0.26
episode:   3/5,耗时:1.24分/3.44分,训练集: | step: 9465 | average_treward:  141.9 | max_treward: 230.8947 | average profit rate:  2.395
model saved @ step:9465,performance:3.251,accuracy:0.26
step_num: 9600 | loss: 0.1907 | profit rate:    0.9 | accuracy: 0.15
step_num: 9800 | loss: 0.1772 | profit rate:    0.7 | accuracy: 0.16
step_num: 10000 | loss: 0.1608 | profit rate:    0.8 | accuracy: 0.16
step_num: 10200 | loss: 0.1928 | profit rate:    0.9 | accuracy: 0.22
step_num: 10400 | loss: 0.2024 | profit rate:    0.6 | accuracy: 0.23
step_num: 10600 | loss: 0.2060 | profit rate:    1.4 | accuracy: 0.24
step_num: 10800 | loss: 0.2230 | profit rate:    1.7 | accuracy: 0.23
step_num: 11000 | loss: 0.2262 | profit rate:    1.7 | accuracy: 0.23
step_num: 11200 | loss: 0.2534 | profit rate:    3.9 | accuracy: 0.27
step_num: 11400 | loss: 0.2751 | profit rate:    5.0 | accuracy: 0.29
step_num: 11600 | loss: 0.3021 | profit rate:    4.7 | accuracy: 0.29
step_num: 11800 | loss: 0.2662 | profit rate:    5.6 | accuracy: 0.28
step_num: 12000 | loss: 0.2945 | profit rate:    5.6 | accuracy: 0.27
step_num: 12200 | loss: 0.2458 | profit rate:    5.7 | accuracy: 0.26
step_num: 12400 | loss: 0.2025 | profit rate:    6.1 | accuracy: 0.26
step_num: 12600 | loss: 0.1614 | profit rate:    5.5 | accuracy: 0.25
model saved @ step:12620,performance:5.526,accuracy:0.25
step_num: 12800 | loss: 0.1552 | profit rate:    0.9 | accuracy: 0.16
step_num: 13000 | loss: 0.1282 | profit rate:    0.8 | accuracy: 0.14
step_num: 13200 | loss: 0.1300 | profit rate:    1.0 | accuracy: 0.16
step_num: 13400 | loss: 0.1836 | profit rate:    0.8 | accuracy: 0.22
step_num: 13600 | loss: 0.1779 | profit rate:    0.7 | accuracy: 0.23
step_num: 13800 | loss: 0.2002 | profit rate:    1.4 | accuracy: 0.23
step_num: 14000 | loss: 0.2100 | profit rate:    1.8 | accuracy: 0.23
step_num: 14200 | loss: 0.2374 | profit rate:    2.1 | accuracy: 0.25
step_num: 14400 | loss: 0.2598 | profit rate:    4.7 | accuracy: 0.28
step_num: 14600 | loss: 0.2714 | profit rate:    3.5 | accuracy: 0.29
step_num: 14800 | loss: 0.2921 | profit rate:    6.4 | accuracy: 0.29
step_num: 15000 | loss: 0.3157 | profit rate:    7.0 | accuracy: 0.29
step_num: 15200 | loss: 0.2958 | profit rate:    7.9 | accuracy: 0.28
step_num: 15400 | loss: 0.2646 | profit rate:    6.6 | accuracy: 0.28
step_num: 15600 | loss: 0.2277 | profit rate:    7.4 | accuracy: 0.27
episode:   5/5,耗时:1.26分/5.97分,训练集: | step: 15775 | average_treward:  205.7 | max_treward: 311.0688 | average profit rate:  4.041
model saved @ step:15775,performance:7.491,accuracy:0.27
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 17%|        | 67/403 [00:00<00:00, 665.61it/s] 39%|      | 157/403 [00:00<00:00, 800.69it/s] 59%|    | 238/403 [00:00<00:00, 744.53it/s] 81%|  | 327/403 [00:00<00:00, 797.59it/s]100%|| 403/403 [00:00<00:00, 824.37it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1190.31
2023-07-24T12:00:00 | net performance [%] = 19.0307
2023-07-24T12:00:00 | number of trades [#] = 22
==================================================
Trial 18 Complete [00h 06m 01s]
net_wealth: 1191.4989398353075

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 44m 34s

Search: Running Trial #19

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
10                |5                 |lags
0.5               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4311.000000   4315.000000
mean      0.000441    20062.255222  ...   20133.281642  20118.633889
std       0.027818    16039.874230  ...   16077.358923  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7695.614990   7690.540039
50%       0.000642    11554.824463  ...   11741.480469  11715.610352
75%       0.011655    29873.081836  ...   29939.474609  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.9560 | profit rate:    1.0 | accuracy: 0.32
step_num: 400 | loss: 0.7735 | profit rate:    1.2 | accuracy: 0.33
step_num: 600 | loss: 0.7985 | profit rate:    1.1 | accuracy: 0.33
step_num: 800 | loss: 0.6369 | profit rate:    1.9 | accuracy: 0.32
step_num: 1000 | loss: 0.5822 | profit rate:    4.5 | accuracy: 0.34
step_num: 1200 | loss: 0.9311 | profit rate:    4.7 | accuracy: 0.35
step_num: 1400 | loss: 0.5944 | profit rate:    4.3 | accuracy: 0.36
step_num: 1600 | loss: 0.5316 | profit rate:    5.0 | accuracy: 0.36
step_num: 1800 | loss: 0.6698 | profit rate:    5.9 | accuracy: 0.36
step_num: 2000 | loss: 0.5345 | profit rate:    3.4 | accuracy: 0.37
step_num: 2200 | loss: 0.6916 | profit rate:   84.2 | accuracy: 0.39
step_num: 2400 | loss: 0.8520 | profit rate: 1425.2 | accuracy: 0.40
step_num: 2600 | loss: 0.6085 | profit rate: 1264.7 | accuracy: 0.40
step_num: 2800 | loss: 0.6446 | profit rate: 1705.8 | accuracy: 0.40
step_num: 3000 | loss: 0.6575 | profit rate: 3622.6 | accuracy: 0.41
step_num: 3200 | loss: 0.4995 | profit rate: 3108.4 | accuracy: 0.40
step_num: 3400 | loss: 0.5259 | profit rate: 6157.4 | accuracy: 0.40
step_num: 3600 | loss: 0.5386 | profit rate: 9741.4 | accuracy: 0.40
episode:   1/5,耗时:0.66分/0.66分,训练集: | step: 3672 | average_treward:  227.4 | max_treward: 227.3590 | average profit rate: 8706.268
model saved @ step:3672,performance:8706.268,accuracy:0.39
step_num: 3800 | loss: 0.6386 | profit rate:    0.2 | accuracy: 0.40
step_num: 4000 | loss: 0.5668 | profit rate:    0.9 | accuracy: 0.39
step_num: 4200 | loss: 0.6302 | profit rate:    1.4 | accuracy: 0.37
step_num: 4400 | loss: 0.5703 | profit rate:    6.1 | accuracy: 0.37
step_num: 4600 | loss: 0.4592 | profit rate:    4.5 | accuracy: 0.36
step_num: 4800 | loss: 0.6681 | profit rate:  206.6 | accuracy: 0.41
step_num: 5000 | loss: 0.6376 | profit rate:   57.2 | accuracy: 0.40
step_num: 5200 | loss: 0.5097 | profit rate:   68.7 | accuracy: 0.40
step_num: 5400 | loss: 0.5612 | profit rate:   14.3 | accuracy: 0.40
step_num: 5600 | loss: 0.4900 | profit rate:    6.1 | accuracy: 0.39
step_num: 5800 | loss: 0.5603 | profit rate:   25.0 | accuracy: 0.41
step_num: 6000 | loss: 0.6927 | profit rate:  800.0 | accuracy: 0.42
step_num: 6200 | loss: 0.7234 | profit rate: 1419.7 | accuracy: 0.43
step_num: 6400 | loss: 0.7187 | profit rate:  746.2 | accuracy: 0.43
step_num: 6600 | loss: 0.6181 | profit rate: 1409.7 | accuracy: 0.43
step_num: 6800 | loss: 0.5896 | profit rate: 1872.1 | accuracy: 0.43
step_num: 7000 | loss: 0.4883 | profit rate: 3596.7 | accuracy: 0.43
step_num: 7200 | loss: 0.5580 | profit rate: 3907.8 | accuracy: 0.42
step_num: 7400 | loss: 0.6131 | profit rate:    0.2 | accuracy: 0.33
step_num: 7600 | loss: 0.6542 | profit rate:    0.5 | accuracy: 0.42
step_num: 7800 | loss: 0.6499 | profit rate:    0.4 | accuracy: 0.39
step_num: 8000 | loss: 0.6959 | profit rate:    0.8 | accuracy: 0.39
step_num: 8200 | loss: 0.5424 | profit rate:    1.4 | accuracy: 0.39
step_num: 8400 | loss: 0.5035 | profit rate:   19.2 | accuracy: 0.43
step_num: 8600 | loss: 0.7110 | profit rate:    8.4 | accuracy: 0.42
step_num: 8800 | loss: 0.6255 | profit rate:   17.9 | accuracy: 0.44
step_num: 9000 | loss: 0.6835 | profit rate:    3.3 | accuracy: 0.43
step_num: 9200 | loss: 0.6198 | profit rate:    1.5 | accuracy: 0.42
step_num: 9400 | loss: 0.5133 | profit rate:    0.6 | accuracy: 0.41
step_num: 9600 | loss: 0.6353 | profit rate:   25.9 | accuracy: 0.43
step_num: 9800 | loss: 0.7456 | profit rate:   82.7 | accuracy: 0.44
step_num: 10000 | loss: 0.7981 | profit rate:   52.1 | accuracy: 0.44
step_num: 10200 | loss: 0.7035 | profit rate:  267.3 | accuracy: 0.44
step_num: 10400 | loss: 0.5549 | profit rate:  397.7 | accuracy: 0.44
step_num: 10600 | loss: 0.5404 | profit rate:  151.3 | accuracy: 0.44
step_num: 10800 | loss: 0.5406 | profit rate:  431.4 | accuracy: 0.43
step_num: 11000 | loss: 0.6525 | profit rate:  425.4 | accuracy: 0.43
episode:   3/5,耗时:0.70分/2.08分,训练集: | step: 11016 | average_treward:  195.5 | max_treward: 227.3590 | average profit rate: 5101.193
step_num: 11200 | loss: 0.6204 | profit rate:    0.6 | accuracy: 0.41
step_num: 11400 | loss: 0.5281 | profit rate:    1.1 | accuracy: 0.41
step_num: 11600 | loss: 0.6279 | profit rate:    1.2 | accuracy: 0.41
step_num: 11800 | loss: 0.6593 | profit rate:    2.4 | accuracy: 0.41
step_num: 12000 | loss: 0.4590 | profit rate:    6.9 | accuracy: 0.43
step_num: 12200 | loss: 0.6372 | profit rate:   43.9 | accuracy: 0.45
step_num: 12400 | loss: 0.5766 | profit rate:   25.5 | accuracy: 0.44
step_num: 12600 | loss: 0.5374 | profit rate:   44.5 | accuracy: 0.44
step_num: 12800 | loss: 0.6009 | profit rate:   13.2 | accuracy: 0.44
step_num: 13000 | loss: 0.5624 | profit rate:    3.0 | accuracy: 0.43
step_num: 13200 | loss: 0.5341 | profit rate:   35.9 | accuracy: 0.44
step_num: 13400 | loss: 0.6917 | profit rate:  657.1 | accuracy: 0.45
step_num: 13600 | loss: 0.6628 | profit rate:  286.9 | accuracy: 0.45
step_num: 13800 | loss: 0.7251 | profit rate: 1014.3 | accuracy: 0.45
step_num: 14000 | loss: 0.5713 | profit rate: 2399.5 | accuracy: 0.45
step_num: 14200 | loss: 0.5389 | profit rate: 1694.5 | accuracy: 0.45
step_num: 14400 | loss: 0.5246 | profit rate: 2738.4 | accuracy: 0.44
step_num: 14600 | loss: 0.5730 | profit rate: 5423.7 | accuracy: 0.44
step_num: 14800 | loss: 0.6442 | profit rate:    0.1 | accuracy: 0.27
step_num: 15000 | loss: 0.5974 | profit rate:    0.6 | accuracy: 0.41
step_num: 15200 | loss: 0.5945 | profit rate:    1.0 | accuracy: 0.41
step_num: 15400 | loss: 0.6251 | profit rate:    4.8 | accuracy: 0.42
step_num: 15600 | loss: 0.5848 | profit rate:    1.9 | accuracy: 0.41
step_num: 15800 | loss: 0.6585 | profit rate:   64.4 | accuracy: 0.45
step_num: 16000 | loss: 0.5609 | profit rate:   17.3 | accuracy: 0.43
step_num: 16200 | loss: 0.5061 | profit rate:   23.9 | accuracy: 0.44
step_num: 16400 | loss: 0.5199 | profit rate:    5.5 | accuracy: 0.43
step_num: 16600 | loss: 0.5743 | profit rate:    2.9 | accuracy: 0.43
step_num: 16800 | loss: 0.5617 | profit rate:    6.5 | accuracy: 0.44
step_num: 17000 | loss: 0.5638 | profit rate:  682.3 | accuracy: 0.46
step_num: 17200 | loss: 0.6285 | profit rate:  240.1 | accuracy: 0.45
step_num: 17400 | loss: 0.6277 | profit rate:   94.8 | accuracy: 0.45
step_num: 17600 | loss: 0.5905 | profit rate:  318.4 | accuracy: 0.45
step_num: 17800 | loss: 0.4853 | profit rate: 1075.2 | accuracy: 0.45
step_num: 18000 | loss: 0.5161 | profit rate: 1267.1 | accuracy: 0.44
step_num: 18200 | loss: 0.5000 | profit rate: 1563.8 | accuracy: 0.44
episode:   5/5,耗时:0.70分/3.51分,训练集: | step: 18360 | average_treward:  197.2 | max_treward: 227.3590 | average profit rate: 4519.307
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 23%|       | 93/401 [00:00<00:00, 920.79it/s] 49%|     | 196/401 [00:00<00:00, 983.19it/s] 77%|  | 307/401 [00:00<00:00, 1037.62it/s]100%|| 401/401 [00:00<00:00, 1036.03it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1539.06
2023-07-24T12:00:00 | net performance [%] = 53.9064
2023-07-24T12:00:00 | number of trades [#] = 54
==================================================
Trial 19 Complete [00h 03m 33s]
net_wealth: 1539.063728716439

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 48m 07s

Search: Running Trial #20

Value             |Best Value So Far |Hyperparameter
5                 |12                |horizon
730               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.98              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4310.000000   4315.000000
mean      0.000441    20062.255222  ...   20136.939364  20118.633889
std       0.027818    16039.874230  ...   16077.430342  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7696.969971   7690.540039
50%       0.000642    11554.824463  ...   11742.710449  11715.610352
75%       0.011655    29873.081836  ...   29945.211914  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.8064 | profit rate:    0.7 | accuracy: 0.34
step_num: 400 | loss: 0.7057 | profit rate:    0.8 | accuracy: 0.34
step_num: 600 | loss: 0.7096 | profit rate:    0.1 | accuracy: 0.32
step_num: 800 | loss: 0.6976 | profit rate:    0.1 | accuracy: 0.32
step_num: 1000 | loss: 0.6544 | profit rate:    0.1 | accuracy: 0.33
step_num: 1200 | loss: 0.8195 | profit rate:    0.0 | accuracy: 0.34
step_num: 1400 | loss: 0.5860 | profit rate:    0.0 | accuracy: 0.34
step_num: 1600 | loss: 0.5610 | profit rate:    0.0 | accuracy: 0.34
step_num: 1800 | loss: 0.6919 | profit rate:    0.0 | accuracy: 0.34
step_num: 2000 | loss: 0.5873 | profit rate:    0.0 | accuracy: 0.34
step_num: 2200 | loss: 0.6388 | profit rate:    0.0 | accuracy: 0.34
step_num: 2400 | loss: 0.6175 | profit rate:    0.0 | accuracy: 0.35
step_num: 2600 | loss: 0.6205 | profit rate:    0.0 | accuracy: 0.35
step_num: 2800 | loss: 0.5690 | profit rate:    0.0 | accuracy: 0.34
step_num: 3000 | loss: 0.6404 | profit rate:    0.0 | accuracy: 0.35
episode:   1/5,耗时:0.53分/0.53分,训练集: | step: 3174 | average_treward: -116.2 | max_treward: 0.0000 | average profit rate:  0.001
step_num: 3200 | loss: 0.5516 | profit rate:    1.1 | accuracy: 0.41
step_num: 3400 | loss: 0.5542 | profit rate:    0.3 | accuracy: 0.42
step_num: 3600 | loss: 0.5557 | profit rate:    0.3 | accuracy: 0.43
step_num: 3800 | loss: 0.6891 | profit rate:    0.0 | accuracy: 0.40
step_num: 4000 | loss: 0.5322 | profit rate:    0.0 | accuracy: 0.38
step_num: 4200 | loss: 0.6260 | profit rate:    0.0 | accuracy: 0.38
step_num: 4400 | loss: 0.5971 | profit rate:    0.0 | accuracy: 0.38
step_num: 4600 | loss: 0.5373 | profit rate:    0.0 | accuracy: 0.38
step_num: 4800 | loss: 0.5421 | profit rate:    0.0 | accuracy: 0.37
step_num: 5000 | loss: 0.6122 | profit rate:    0.0 | accuracy: 0.37
step_num: 5200 | loss: 0.5549 | profit rate:    0.0 | accuracy: 0.36
step_num: 5400 | loss: 0.5211 | profit rate:    0.0 | accuracy: 0.36
step_num: 5600 | loss: 0.5627 | profit rate:    0.0 | accuracy: 0.36
step_num: 5800 | loss: 0.5780 | profit rate:    0.0 | accuracy: 0.36
step_num: 6000 | loss: 0.6143 | profit rate:    0.0 | accuracy: 0.36
step_num: 6200 | loss: 0.6019 | profit rate:    0.0 | accuracy: 0.36
step_num: 6400 | loss: 0.5435 | profit rate:    1.5 | accuracy: 0.49
step_num: 6600 | loss: 0.5576 | profit rate:    0.3 | accuracy: 0.43
step_num: 6800 | loss: 0.5934 | profit rate:    0.1 | accuracy: 0.42
step_num: 7000 | loss: 0.7155 | profit rate:    0.0 | accuracy: 0.39
step_num: 7200 | loss: 0.5378 | profit rate:    0.0 | accuracy: 0.38
step_num: 7400 | loss: 0.5451 | profit rate:    0.0 | accuracy: 0.38
step_num: 7600 | loss: 0.6499 | profit rate:    0.0 | accuracy: 0.37
step_num: 7800 | loss: 0.5720 | profit rate:    0.0 | accuracy: 0.38
step_num: 8000 | loss: 0.5879 | profit rate:    0.0 | accuracy: 0.38
step_num: 8200 | loss: 0.6948 | profit rate:    0.0 | accuracy: 0.37
step_num: 8400 | loss: 0.5699 | profit rate:    0.0 | accuracy: 0.36
step_num: 8600 | loss: 0.6006 | profit rate:    0.0 | accuracy: 0.36
step_num: 8800 | loss: 0.6016 | profit rate:    0.0 | accuracy: 0.36
step_num: 9000 | loss: 0.5804 | profit rate:    0.0 | accuracy: 0.36
step_num: 9200 | loss: 0.5824 | profit rate:    0.0 | accuracy: 0.36
step_num: 9400 | loss: 0.5723 | profit rate:    0.0 | accuracy: 0.37
episode:   3/5,耗时:0.61分/1.74分,训练集: | step: 9522 | average_treward: -158.9 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 9600 | loss: 0.5580 | profit rate:    1.6 | accuracy: 0.52
step_num: 9800 | loss: 0.5797 | profit rate:    0.3 | accuracy: 0.42
step_num: 10000 | loss: 0.6241 | profit rate:    0.1 | accuracy: 0.41
step_num: 10200 | loss: 0.6985 | profit rate:    0.0 | accuracy: 0.39
step_num: 10400 | loss: 0.5286 | profit rate:    0.0 | accuracy: 0.38
step_num: 10600 | loss: 0.5753 | profit rate:    0.0 | accuracy: 0.38
step_num: 10800 | loss: 0.5908 | profit rate:    0.0 | accuracy: 0.37
step_num: 11000 | loss: 0.5654 | profit rate:    0.0 | accuracy: 0.37
step_num: 11200 | loss: 0.5233 | profit rate:    0.0 | accuracy: 0.37
step_num: 11400 | loss: 0.6130 | profit rate:    0.0 | accuracy: 0.37
step_num: 11600 | loss: 0.4935 | profit rate:    0.0 | accuracy: 0.36
step_num: 11800 | loss: 0.5749 | profit rate:    0.0 | accuracy: 0.36
step_num: 12000 | loss: 0.5847 | profit rate:    0.0 | accuracy: 0.36
step_num: 12200 | loss: 0.5852 | profit rate:    0.0 | accuracy: 0.36
step_num: 12400 | loss: 0.6130 | profit rate:    0.0 | accuracy: 0.36
step_num: 12600 | loss: 0.6065 | profit rate:    0.0 | accuracy: 0.36
step_num: 12800 | loss: 0.5391 | profit rate:    1.6 | accuracy: 0.50
step_num: 13000 | loss: 0.5339 | profit rate:    0.3 | accuracy: 0.41
step_num: 13200 | loss: 0.5529 | profit rate:    0.1 | accuracy: 0.39
step_num: 13400 | loss: 0.5229 | profit rate:    0.0 | accuracy: 0.38
step_num: 13600 | loss: 0.5592 | profit rate:    0.0 | accuracy: 0.36
step_num: 13800 | loss: 0.5072 | profit rate:    0.0 | accuracy: 0.36
step_num: 14000 | loss: 0.5434 | profit rate:    0.0 | accuracy: 0.36
step_num: 14200 | loss: 0.4544 | profit rate:    0.0 | accuracy: 0.36
step_num: 14400 | loss: 0.5637 | profit rate:    0.0 | accuracy: 0.37
step_num: 14600 | loss: 0.5216 | profit rate:    0.0 | accuracy: 0.36
step_num: 14800 | loss: 0.5768 | profit rate:    0.0 | accuracy: 0.36
step_num: 15000 | loss: 0.5572 | profit rate:    0.0 | accuracy: 0.36
step_num: 15200 | loss: 0.5842 | profit rate:    0.0 | accuracy: 0.36
step_num: 15400 | loss: 0.6107 | profit rate:    0.0 | accuracy: 0.35
step_num: 15600 | loss: 0.5333 | profit rate:    0.0 | accuracy: 0.36
step_num: 15800 | loss: 0.5329 | profit rate:    0.0 | accuracy: 0.36
episode:   5/5,耗时:0.61分/2.95分,训练集: | step: 15870 | average_treward: -143.3 | max_treward: 0.0000 | average profit rate:  0.000
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 21%|        | 85/408 [00:00<00:00, 848.57it/s] 47%|     | 192/408 [00:00<00:00, 968.74it/s] 75%|  | 305/408 [00:00<00:00, 1037.23it/s]100%|| 408/408 [00:00<00:00, 1002.65it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1177.44
2023-07-24T12:00:00 | net performance [%] = 17.7439
2023-07-24T12:00:00 | number of trades [#] = 22
==================================================
Trial 20 Complete [00h 03m 00s]
net_wealth: 1178.617891951453

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 01h 51m 08s

Search: Running Trial #21

Value             |Best Value So Far |Hyperparameter
13                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
8                 |5                 |lags
0.85              |0.6               |gamma
5e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4302.000000   4315.000000
mean      0.000441    20062.255222  ...   20165.724363  20118.633889
std       0.027818    16039.874230  ...   16078.496018  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7729.197632   7690.540039
50%       0.000642    11554.824463  ...   11751.060059  11715.610352
75%       0.011655    29873.081836  ...   30007.945801  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.1119 | profit rate:   65.4 | accuracy: 0.35
step_num: 1200 | loss: 0.6568 | profit rate: 4129.0 | accuracy: 0.36
step_num: 1400 | loss: 0.5641 | profit rate: 2321.6 | accuracy: 0.35
step_num: 1600 | loss: 0.5637 | profit rate: 16725.0 | accuracy: 0.37
step_num: 1800 | loss: 0.5851 | profit rate:  362.5 | accuracy: 0.36
step_num: 2000 | loss: 0.6059 | profit rate:  261.7 | accuracy: 0.37
step_num: 2200 | loss: 0.6063 | profit rate: 4875.7 | accuracy: 0.38
step_num: 2400 | loss: 0.6127 | profit rate: 657368310.4 | accuracy: 0.40
step_num: 2600 | loss: 0.6326 | profit rate: 16915739.8 | accuracy: 0.40
step_num: 2800 | loss: 0.6575 | profit rate: 130581925.4 | accuracy: 0.41
step_num: 3000 | loss: 0.6607 | profit rate: 51803119.1 | accuracy: 0.41
step_num: 3200 | loss: 0.6828 | profit rate: 19006686.9 | accuracy: 0.41
step_num: 3400 | loss: 0.7088 | profit rate: 158194.3 | accuracy: 0.40
step_num: 3600 | loss: 0.6733 | profit rate: 38679.6 | accuracy: 0.39
episode:   1/5,耗时:2.96分/2.96分,训练集: | step: 3719 | average_treward:  171.1 | max_treward: 171.0892 | average profit rate: 12305.961
model saved @ step:3719,performance:12305.961,accuracy:0.38
step_num: 3800 | loss: 0.6367 | profit rate:   53.7 | accuracy: 0.61
step_num: 4000 | loss: 0.6078 | profit rate:    7.4 | accuracy: 0.24
step_num: 4200 | loss: 0.5811 | profit rate:   17.9 | accuracy: 0.18
step_num: 4400 | loss: 0.5109 | profit rate:    2.4 | accuracy: 0.16
step_num: 4600 | loss: 0.4493 | profit rate:    0.8 | accuracy: 0.16
step_num: 4800 | loss: 0.4568 | profit rate:   50.0 | accuracy: 0.23
step_num: 5000 | loss: 0.4458 | profit rate:    4.4 | accuracy: 0.24
step_num: 5200 | loss: 0.3730 | profit rate:    8.4 | accuracy: 0.23
step_num: 5400 | loss: 0.3742 | profit rate:    0.1 | accuracy: 0.24
step_num: 5600 | loss: 0.3941 | profit rate:    0.0 | accuracy: 0.24
step_num: 5800 | loss: 0.3595 | profit rate:    0.0 | accuracy: 0.24
step_num: 6000 | loss: 0.3904 | profit rate: 8990.3 | accuracy: 0.28
step_num: 6200 | loss: 0.4564 | profit rate: 516740.5 | accuracy: 0.30
step_num: 6400 | loss: 0.4445 | profit rate: 602493.9 | accuracy: 0.30
step_num: 6600 | loss: 0.5252 | profit rate: 23889820.7 | accuracy: 0.32
step_num: 6800 | loss: 0.5040 | profit rate: 5418029.2 | accuracy: 0.31
step_num: 7000 | loss: 0.4889 | profit rate: 442125.5 | accuracy: 0.31
step_num: 7200 | loss: 0.5228 | profit rate: 184784.0 | accuracy: 0.31
step_num: 7400 | loss: 0.5145 | profit rate: 109398.0 | accuracy: 0.30
model saved @ step:7438,performance:137574.970,accuracy:0.30
step_num: 7600 | loss: 0.5383 | profit rate:    2.4 | accuracy: 0.44
step_num: 7800 | loss: 0.5367 | profit rate:    0.8 | accuracy: 0.22
step_num: 8000 | loss: 0.5198 | profit rate:    0.3 | accuracy: 0.21
step_num: 8200 | loss: 0.4457 | profit rate:    0.3 | accuracy: 0.18
step_num: 8400 | loss: 0.4389 | profit rate:    0.6 | accuracy: 0.19
step_num: 8600 | loss: 0.4481 | profit rate: 19881.0 | accuracy: 0.27
step_num: 8800 | loss: 0.4184 | profit rate: 2565.0 | accuracy: 0.25
step_num: 9000 | loss: 0.4099 | profit rate: 2709.3 | accuracy: 0.25
step_num: 9200 | loss: 0.4382 | profit rate:    4.7 | accuracy: 0.25
step_num: 9400 | loss: 0.4223 | profit rate:    6.6 | accuracy: 0.24
step_num: 9600 | loss: 0.3259 | profit rate:  113.8 | accuracy: 0.26
step_num: 9800 | loss: 0.4254 | profit rate: 170969103.5 | accuracy: 0.30
step_num: 10000 | loss: 0.4602 | profit rate: 26157755.3 | accuracy: 0.31
step_num: 10200 | loss: 0.4718 | profit rate: 376518823.8 | accuracy: 0.31
step_num: 10400 | loss: 0.5242 | profit rate: 1032180868.8 | accuracy: 0.32
step_num: 10600 | loss: 0.4419 | profit rate: 1467528178.2 | accuracy: 0.32
step_num: 10800 | loss: 0.4830 | profit rate: 149490128.5 | accuracy: 0.31
step_num: 11000 | loss: 0.4739 | profit rate: 681714909.3 | accuracy: 0.31
episode:   3/5,耗时:6.19分/13.29分,训练集: | step: 11157 | average_treward:  254.8 | max_treward: 355.1955 | average profit rate: 137737485.384
model saved @ step:11157,performance:413062575.221,accuracy:0.30
step_num: 11200 | loss: 0.4548 | profit rate:   22.9 | accuracy: 0.70
step_num: 11400 | loss: 0.5191 | profit rate:    1.0 | accuracy: 0.29
step_num: 11600 | loss: 0.4834 | profit rate:    0.5 | accuracy: 0.18
step_num: 11800 | loss: 0.4204 | profit rate:    0.0 | accuracy: 0.15
step_num: 12000 | loss: 0.4221 | profit rate:    0.2 | accuracy: 0.18
step_num: 12200 | loss: 0.3908 | profit rate:    2.1 | accuracy: 0.21
step_num: 12400 | loss: 0.3975 | profit rate:  986.7 | accuracy: 0.27
step_num: 12600 | loss: 0.3683 | profit rate: 1530.1 | accuracy: 0.24
step_num: 12800 | loss: 0.3711 | profit rate:  649.0 | accuracy: 0.24
step_num: 13000 | loss: 0.3952 | profit rate:    6.2 | accuracy: 0.25
step_num: 13200 | loss: 0.3732 | profit rate:    4.8 | accuracy: 0.25
step_num: 13400 | loss: 0.3751 | profit rate: 43768.8 | accuracy: 0.28
step_num: 13600 | loss: 0.4338 | profit rate: 1522294103.8 | accuracy: 0.30
step_num: 13800 | loss: 0.4517 | profit rate: 253019776.2 | accuracy: 0.30
step_num: 14000 | loss: 0.4858 | profit rate: 12677715670.3 | accuracy: 0.31
step_num: 14200 | loss: 0.4872 | profit rate: 2105870047.1 | accuracy: 0.31
step_num: 14400 | loss: 0.4555 | profit rate: 1451272519.2 | accuracy: 0.31
step_num: 14600 | loss: 0.4803 | profit rate: 582821597.5 | accuracy: 0.31
step_num: 14800 | loss: 0.5049 | profit rate: 769501559.0 | accuracy: 0.31
model saved @ step:14876,performance:690537309.094,accuracy:0.30
step_num: 15000 | loss: 0.5093 | profit rate:    0.3 | accuracy: 0.47
step_num: 15200 | loss: 0.5136 | profit rate:    4.7 | accuracy: 0.27
step_num: 15400 | loss: 0.5301 | profit rate:    1.7 | accuracy: 0.23
step_num: 15600 | loss: 0.4404 | profit rate:    0.6 | accuracy: 0.18
step_num: 15800 | loss: 0.4210 | profit rate:    1.6 | accuracy: 0.21
step_num: 16000 | loss: 0.4363 | profit rate: 3361.0 | accuracy: 0.27
step_num: 16200 | loss: 0.4187 | profit rate: 10670.2 | accuracy: 0.28
step_num: 16400 | loss: 0.3818 | profit rate: 21959.6 | accuracy: 0.27
step_num: 16600 | loss: 0.4138 | profit rate:  113.8 | accuracy: 0.27
step_num: 16800 | loss: 0.4252 | profit rate:   51.2 | accuracy: 0.26
step_num: 17000 | loss: 0.3720 | profit rate:   94.8 | accuracy: 0.27
step_num: 17200 | loss: 0.4318 | profit rate: 6028027.8 | accuracy: 0.31
step_num: 17400 | loss: 0.4375 | profit rate: 1624995849.4 | accuracy: 0.32
step_num: 17600 | loss: 0.4609 | profit rate: 1875324250.4 | accuracy: 0.32
step_num: 17800 | loss: 0.5103 | profit rate: 2198365398.1 | accuracy: 0.33
step_num: 18000 | loss: 0.5102 | profit rate: 1044193775.3 | accuracy: 0.32
step_num: 18200 | loss: 0.4385 | profit rate: 273500142.3 | accuracy: 0.32
step_num: 18400 | loss: 0.4745 | profit rate: 2688314377.8 | accuracy: 0.32
episode:   5/5,耗时:7.37分/27.60分,训练集: | step: 18595 | average_treward:  303.7 | max_treward: 396.2608 | average profit rate: 2274083733.467
model saved @ step:18595,performance:10266668902.087,accuracy:0.31
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 12%|        | 49/403 [00:00<00:00, 447.52it/s] 31%|       | 123/403 [00:00<00:00, 582.11it/s] 48%|     | 195/403 [00:00<00:00, 616.92it/s] 67%|   | 268/403 [00:00<00:00, 636.85it/s] 84%| | 339/403 [00:00<00:00, 641.26it/s]100%|| 403/403 [00:00<00:00, 628.99it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1312.97
2023-07-24T12:00:00 | net performance [%] = 31.2973
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 21 Complete [00h 28m 04s]
net_wealth: 1314.2868598886469

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 02h 19m 11s

Search: Running Trial #22

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
5                 |5                 |lags
0.85              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
2000              |64                |memory_size
16                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4303.000000   4315.000000
mean      0.000441    20062.255222  ...   20162.113925  20118.633889
std       0.027818    16039.874230  ...   16078.371573  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7724.814941   7690.540039
50%       0.000642    11554.824463  ...   11750.650391  11715.610352
75%       0.011655    29873.081836  ...   30003.260742  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.1008 | profit rate:    0.4 | accuracy: 0.35
step_num: 1200 | loss: 0.5618 | profit rate:    0.8 | accuracy: 0.36
step_num: 1400 | loss: 0.5468 | profit rate:    1.5 | accuracy: 0.36
step_num: 1600 | loss: 0.5608 | profit rate:    0.4 | accuracy: 0.35
step_num: 1800 | loss: 0.5261 | profit rate:    0.2 | accuracy: 0.36
step_num: 2000 | loss: 0.6013 | profit rate:    0.9 | accuracy: 0.36
step_num: 2200 | loss: 0.5239 | profit rate:   22.4 | accuracy: 0.37
step_num: 2400 | loss: 0.5740 | profit rate:    0.9 | accuracy: 0.37
step_num: 2600 | loss: 0.5959 | profit rate:    1.4 | accuracy: 0.37
step_num: 2800 | loss: 0.5948 | profit rate:    6.4 | accuracy: 0.38
step_num: 3000 | loss: 0.5910 | profit rate:    2.1 | accuracy: 0.37
step_num: 3200 | loss: 0.5574 | profit rate:    0.2 | accuracy: 0.36
step_num: 3400 | loss: 0.5368 | profit rate:    0.4 | accuracy: 0.35
episode:   1/5,耗时:4.72分/4.72分,训练集: | step: 3537 | average_treward:   68.3 | max_treward: 68.2520 | average profit rate:  0.317
model saved @ step:3537,performance:0.317,accuracy:0.34
step_num: 3600 | loss: 0.4573 | profit rate:    1.3 | accuracy: 0.14
step_num: 3800 | loss: 0.4223 | profit rate:    1.0 | accuracy: 0.09
step_num: 4000 | loss: 0.4003 | profit rate:    0.4 | accuracy: 0.10
step_num: 4200 | loss: 0.3692 | profit rate:    0.1 | accuracy: 0.14
step_num: 4400 | loss: 0.3099 | profit rate:    0.0 | accuracy: 0.14
step_num: 4600 | loss: 0.3142 | profit rate:    0.0 | accuracy: 0.18
step_num: 4800 | loss: 0.2554 | profit rate:    0.0 | accuracy: 0.18
step_num: 5000 | loss: 0.2483 | profit rate:    0.0 | accuracy: 0.18
step_num: 5200 | loss: 0.2640 | profit rate:    0.2 | accuracy: 0.18
step_num: 5400 | loss: 0.2447 | profit rate:    0.2 | accuracy: 0.17
step_num: 5600 | loss: 0.2578 | profit rate:    5.7 | accuracy: 0.18
step_num: 5800 | loss: 0.3059 | profit rate:  116.2 | accuracy: 0.20
step_num: 6000 | loss: 0.3061 | profit rate:  132.7 | accuracy: 0.20
step_num: 6200 | loss: 0.3296 | profit rate: 6038.8 | accuracy: 0.21
step_num: 6400 | loss: 0.3442 | profit rate: 1871.5 | accuracy: 0.22
step_num: 6600 | loss: 0.3305 | profit rate: 3819.0 | accuracy: 0.22
step_num: 6800 | loss: 0.3475 | profit rate: 5004.1 | accuracy: 0.22
step_num: 7000 | loss: 0.3610 | profit rate: 5487.5 | accuracy: 0.22
model saved @ step:7074,performance:4572.783,accuracy:0.22
step_num: 7200 | loss: 0.3071 | profit rate:    0.9 | accuracy: 0.15
step_num: 7400 | loss: 0.3099 | profit rate:    0.4 | accuracy: 0.10
step_num: 7600 | loss: 0.3023 | profit rate:    1.3 | accuracy: 0.13
step_num: 7800 | loss: 0.2671 | profit rate:    1.9 | accuracy: 0.15
step_num: 8000 | loss: 0.2437 | profit rate:    3.9 | accuracy: 0.16
step_num: 8200 | loss: 0.2341 | profit rate:   31.8 | accuracy: 0.17
step_num: 8400 | loss: 0.2103 | profit rate:  106.0 | accuracy: 0.17
step_num: 8600 | loss: 0.2182 | profit rate: 1233.4 | accuracy: 0.18
step_num: 8800 | loss: 0.2196 | profit rate:  923.9 | accuracy: 0.17
step_num: 9000 | loss: 0.1758 | profit rate:  777.4 | accuracy: 0.16
step_num: 9200 | loss: 0.2035 | profit rate: 1221.7 | accuracy: 0.18
step_num: 9400 | loss: 0.2479 | profit rate: 259673.3 | accuracy: 0.19
step_num: 9600 | loss: 0.2725 | profit rate: 1126443.5 | accuracy: 0.20
step_num: 9800 | loss: 0.2837 | profit rate: 4751623.4 | accuracy: 0.21
step_num: 10000 | loss: 0.2874 | profit rate: 1041654.0 | accuracy: 0.21
step_num: 10200 | loss: 0.2871 | profit rate: 732935.1 | accuracy: 0.21
step_num: 10400 | loss: 0.2960 | profit rate: 2039576.1 | accuracy: 0.22
step_num: 10600 | loss: 0.2652 | profit rate: 1987147.6 | accuracy: 0.21
episode:   3/5,耗时:6.79分/18.76分,训练集: | step: 10611 | average_treward:  183.0 | max_treward: 309.5111 | average profit rate: 663906.912
model saved @ step:10611,performance:1987147.637,accuracy:0.21
step_num: 10800 | loss: 0.2648 | profit rate:    1.4 | accuracy: 0.17
step_num: 11000 | loss: 0.2980 | profit rate:    0.6 | accuracy: 0.14
step_num: 11200 | loss: 0.2570 | profit rate:    3.9 | accuracy: 0.15
step_num: 11400 | loss: 0.2204 | profit rate:    5.7 | accuracy: 0.15
step_num: 11600 | loss: 0.2339 | profit rate:  489.2 | accuracy: 0.18
step_num: 11800 | loss: 0.2349 | profit rate:  418.0 | accuracy: 0.20
step_num: 12000 | loss: 0.1954 | profit rate:  858.3 | accuracy: 0.19
step_num: 12200 | loss: 0.2186 | profit rate: 6971.1 | accuracy: 0.20
step_num: 12400 | loss: 0.1938 | profit rate: 11237.7 | accuracy: 0.20
step_num: 12600 | loss: 0.2392 | profit rate: 35932.6 | accuracy: 0.20
step_num: 12800 | loss: 0.2513 | profit rate: 4520243.6 | accuracy: 0.21
step_num: 13000 | loss: 0.2760 | profit rate: 14301118.1 | accuracy: 0.22
step_num: 13200 | loss: 0.2752 | profit rate: 366150218.3 | accuracy: 0.23
step_num: 13400 | loss: 0.2895 | profit rate: 922862500.5 | accuracy: 0.23
step_num: 13600 | loss: 0.3158 | profit rate: 3841595233.0 | accuracy: 0.24
step_num: 13800 | loss: 0.3010 | profit rate: 60548505838.4 | accuracy: 0.24
step_num: 14000 | loss: 0.2744 | profit rate: 188902688830.8 | accuracy: 0.24
model saved @ step:14148,performance:173734142439.588,accuracy:0.23
step_num: 14200 | loss: 0.2467 | profit rate:    5.5 | accuracy: 0.32
step_num: 14400 | loss: 0.2713 | profit rate:    6.5 | accuracy: 0.22
step_num: 14600 | loss: 0.2583 | profit rate:    1.9 | accuracy: 0.19
step_num: 14800 | loss: 0.2684 | profit rate:   15.2 | accuracy: 0.21
step_num: 15000 | loss: 0.2403 | profit rate:   16.3 | accuracy: 0.19
step_num: 15200 | loss: 0.2410 | profit rate: 1183.3 | accuracy: 0.21
step_num: 15400 | loss: 0.2174 | profit rate:  960.7 | accuracy: 0.22
step_num: 15600 | loss: 0.2155 | profit rate: 3511.8 | accuracy: 0.21
step_num: 15800 | loss: 0.2081 | profit rate: 37063.1 | accuracy: 0.21
step_num: 16000 | loss: 0.1799 | profit rate: 82092.3 | accuracy: 0.20
step_num: 16200 | loss: 0.2219 | profit rate: 1070541.7 | accuracy: 0.21
step_num: 16400 | loss: 0.2060 | profit rate: 244521477.7 | accuracy: 0.22
step_num: 16600 | loss: 0.2497 | profit rate: 260578794.3 | accuracy: 0.23
step_num: 16800 | loss: 0.2651 | profit rate: 4630238827.6 | accuracy: 0.24
step_num: 17000 | loss: 0.2640 | profit rate: 6042249544.8 | accuracy: 0.24
step_num: 17200 | loss: 0.2684 | profit rate: 24314832042.7 | accuracy: 0.24
step_num: 17400 | loss: 0.2752 | profit rate: 703355551496.2 | accuracy: 0.24
step_num: 17600 | loss: 0.2538 | profit rate: 3167174373681.4 | accuracy: 0.24
episode:   5/5,耗时:5.80分/31.27分,训练集: | step: 17685 | average_treward:  318.1 | max_treward: 571.9473 | average profit rate: 671740660446.560
model saved @ step:17685,performance:3184967168072.473,accuracy:0.23
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 14%|        | 58/406 [00:00<00:00, 530.28it/s] 32%|      | 130/406 [00:00<00:00, 605.79it/s] 50%|     | 202/406 [00:00<00:00, 629.77it/s] 67%|   | 274/406 [00:00<00:00, 639.99it/s] 85%| | 346/406 [00:00<00:00, 646.58it/s]100%|| 406/406 [00:00<00:00, 649.20it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1252.90
2023-07-24T12:00:00 | net performance [%] = 25.2898
2023-07-24T12:00:00 | number of trades [#] = 40
==================================================
Trial 22 Complete [00h 31m 23s]
net_wealth: 1254.1525826871223

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 02h 50m 34s

Search: Running Trial #23

Value             |Best Value So Far |Hyperparameter
8                 |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
10                |5                 |lags
0.6               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4307.000000   4315.000000
mean      0.000441    20062.255222  ...   20147.798395  20118.633889
std       0.027818    16039.874230  ...   16077.761122  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7714.554932   7690.540039
50%       0.000642    11554.824463  ...   11744.910156  11715.610352
75%       0.011655    29873.081836  ...   29972.419922  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.2413 | profit rate:   50.5 | accuracy: 0.35
step_num: 1200 | loss: 0.9428 | profit rate:  676.6 | accuracy: 0.36
step_num: 1400 | loss: 0.7788 | profit rate:  794.4 | accuracy: 0.35
step_num: 1600 | loss: 0.6759 | profit rate:  636.7 | accuracy: 0.35
step_num: 1800 | loss: 0.6158 | profit rate:  120.0 | accuracy: 0.33
step_num: 2000 | loss: 0.5776 | profit rate:  147.8 | accuracy: 0.34
step_num: 2200 | loss: 0.5307 | profit rate:   39.1 | accuracy: 0.34
step_num: 2400 | loss: 0.5385 | profit rate:   70.0 | accuracy: 0.34
step_num: 2600 | loss: 0.5174 | profit rate:   23.0 | accuracy: 0.33
step_num: 2800 | loss: 0.5093 | profit rate:   10.9 | accuracy: 0.33
step_num: 3000 | loss: 0.5134 | profit rate:   20.8 | accuracy: 0.33
step_num: 3200 | loss: 0.4891 | profit rate:    6.4 | accuracy: 0.32
step_num: 3400 | loss: 0.4375 | profit rate:    5.0 | accuracy: 0.31
step_num: 3600 | loss: 0.4350 | profit rate:    1.9 | accuracy: 0.30
episode:   1/5,耗时:2.85分/2.85分,训练集: | step: 3672 | average_treward:  -37.7 | max_treward: 0.0000 | average profit rate:  1.588
step_num: 3800 | loss: 0.4290 | profit rate:    0.6 | accuracy: 0.30
step_num: 4000 | loss: 0.4398 | profit rate:   30.8 | accuracy: 0.36
step_num: 4200 | loss: 0.4290 | profit rate:  203.2 | accuracy: 0.32
step_num: 4400 | loss: 0.4143 | profit rate:  369.6 | accuracy: 0.30
step_num: 4600 | loss: 0.4045 | profit rate:   91.9 | accuracy: 0.28
step_num: 4800 | loss: 0.4084 | profit rate: 18371.5 | accuracy: 0.35
step_num: 5000 | loss: 0.4423 | profit rate: 3350.1 | accuracy: 0.35
step_num: 5200 | loss: 0.4202 | profit rate: 7722.9 | accuracy: 0.33
step_num: 5400 | loss: 0.4680 | profit rate:  199.3 | accuracy: 0.33
step_num: 5600 | loss: 0.4894 | profit rate:  103.5 | accuracy: 0.34
step_num: 5800 | loss: 0.4893 | profit rate: 2712.0 | accuracy: 0.37
step_num: 6000 | loss: 0.5376 | profit rate: 5700216.6 | accuracy: 0.39
step_num: 6200 | loss: 0.5406 | profit rate: 706163.3 | accuracy: 0.39
step_num: 6400 | loss: 0.5801 | profit rate: 161161.3 | accuracy: 0.39
step_num: 6600 | loss: 0.6128 | profit rate: 110269.4 | accuracy: 0.39
step_num: 6800 | loss: 0.5789 | profit rate: 141301.9 | accuracy: 0.38
step_num: 7000 | loss: 0.5547 | profit rate: 742576.3 | accuracy: 0.37
step_num: 7200 | loss: 0.5298 | profit rate: 842264.7 | accuracy: 0.36
model saved @ step:7344,performance:471299.997,accuracy:0.36
step_num: 7400 | loss: 0.5348 | profit rate:    0.3 | accuracy: 0.44
step_num: 7600 | loss: 0.5140 | profit rate:    0.6 | accuracy: 0.29
step_num: 7800 | loss: 0.4821 | profit rate:    1.6 | accuracy: 0.25
step_num: 8000 | loss: 0.4659 | profit rate:    3.2 | accuracy: 0.25
step_num: 8200 | loss: 0.4109 | profit rate:    4.3 | accuracy: 0.23
step_num: 8400 | loss: 0.3935 | profit rate:   57.2 | accuracy: 0.29
step_num: 8600 | loss: 0.4022 | profit rate:   79.0 | accuracy: 0.31
step_num: 8800 | loss: 0.4108 | profit rate:  386.3 | accuracy: 0.30
step_num: 9000 | loss: 0.4038 | profit rate:  145.1 | accuracy: 0.30
step_num: 9200 | loss: 0.4414 | profit rate:   68.4 | accuracy: 0.30
step_num: 9400 | loss: 0.4254 | profit rate:   35.1 | accuracy: 0.31
step_num: 9600 | loss: 0.4456 | profit rate: 102703.7 | accuracy: 0.34
step_num: 9800 | loss: 0.4939 | profit rate: 6998480.9 | accuracy: 0.36
step_num: 10000 | loss: 0.4717 | profit rate: 1046844.5 | accuracy: 0.35
step_num: 10200 | loss: 0.5276 | profit rate: 6068039.8 | accuracy: 0.36
step_num: 10400 | loss: 0.5320 | profit rate: 2668097.4 | accuracy: 0.35
step_num: 10600 | loss: 0.4756 | profit rate: 1397190.5 | accuracy: 0.34
step_num: 10800 | loss: 0.4611 | profit rate: 8181584.8 | accuracy: 0.34
step_num: 11000 | loss: 0.4390 | profit rate: 3254812.8 | accuracy: 0.33
episode:   3/5,耗时:2.24分/8.82分,训练集: | step: 11016 | average_treward:  160.8 | max_treward: 277.9195 | average profit rate: 1229363.581
model saved @ step:11016,performance:3216789.157,accuracy:0.33
step_num: 11200 | loss: 0.4801 | profit rate:    0.5 | accuracy: 0.30
step_num: 11400 | loss: 0.4245 | profit rate:    0.3 | accuracy: 0.18
step_num: 11600 | loss: 0.4080 | profit rate:    0.2 | accuracy: 0.18
step_num: 11800 | loss: 0.3641 | profit rate:    0.6 | accuracy: 0.19
step_num: 12000 | loss: 0.3476 | profit rate:    2.1 | accuracy: 0.22
step_num: 12200 | loss: 0.3695 | profit rate:  192.1 | accuracy: 0.27
step_num: 12400 | loss: 0.3466 | profit rate:   60.9 | accuracy: 0.25
step_num: 12600 | loss: 0.3340 | profit rate:  157.9 | accuracy: 0.26
step_num: 12800 | loss: 0.3677 | profit rate:   15.0 | accuracy: 0.27
step_num: 13000 | loss: 0.3775 | profit rate:    7.1 | accuracy: 0.27
step_num: 13200 | loss: 0.3530 | profit rate: 1909.7 | accuracy: 0.30
step_num: 13400 | loss: 0.4250 | profit rate: 2134730.0 | accuracy: 0.33
step_num: 13600 | loss: 0.4369 | profit rate: 3617193.0 | accuracy: 0.32
step_num: 13800 | loss: 0.4266 | profit rate: 59551218.1 | accuracy: 0.33
step_num: 14000 | loss: 0.4850 | profit rate: 39257182.8 | accuracy: 0.32
step_num: 14200 | loss: 0.4392 | profit rate: 11128452.9 | accuracy: 0.32
step_num: 14400 | loss: 0.4470 | profit rate: 84087911.7 | accuracy: 0.32
step_num: 14600 | loss: 0.4513 | profit rate: 221385789.2 | accuracy: 0.31
model saved @ step:14688,performance:165423435.870,accuracy:0.31
step_num: 14800 | loss: 0.4429 | profit rate:    0.2 | accuracy: 0.40
step_num: 15000 | loss: 0.4322 | profit rate:    0.1 | accuracy: 0.23
step_num: 15200 | loss: 0.4493 | profit rate:    0.1 | accuracy: 0.21
step_num: 15400 | loss: 0.3865 | profit rate:    0.3 | accuracy: 0.20
step_num: 15600 | loss: 0.3822 | profit rate:    0.6 | accuracy: 0.23
step_num: 15800 | loss: 0.4144 | profit rate:  406.1 | accuracy: 0.31
step_num: 16000 | loss: 0.3998 | profit rate:   65.1 | accuracy: 0.28
step_num: 16200 | loss: 0.3953 | profit rate:  136.8 | accuracy: 0.29
step_num: 16400 | loss: 0.3960 | profit rate:   15.8 | accuracy: 0.30
step_num: 16600 | loss: 0.3952 | profit rate:    8.2 | accuracy: 0.29
step_num: 16800 | loss: 0.3833 | profit rate:   78.4 | accuracy: 0.31
step_num: 17000 | loss: 0.4160 | profit rate: 850927.1 | accuracy: 0.35
step_num: 17200 | loss: 0.4465 | profit rate: 515590.0 | accuracy: 0.34
step_num: 17400 | loss: 0.4717 | profit rate: 4603107.1 | accuracy: 0.35
step_num: 17600 | loss: 0.4824 | profit rate: 11438944.2 | accuracy: 0.35
step_num: 17800 | loss: 0.4747 | profit rate: 22918704.3 | accuracy: 0.35
step_num: 18000 | loss: 0.4647 | profit rate: 109010586.6 | accuracy: 0.34
step_num: 18200 | loss: 0.4647 | profit rate: 243226716.6 | accuracy: 0.34
episode:   5/5,耗时:2.34分/13.39分,训练集: | step: 18360 | average_treward:  234.0 | max_treward: 351.0667 | average profit rate: 78007813.480
model saved @ step:18360,performance:220927540.787,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 26%|       | 106/401 [00:00<00:00, 1060.00it/s] 54%|    | 216/401 [00:00<00:00, 1083.53it/s] 82%| | 328/401 [00:00<00:00, 1099.32it/s]100%|| 401/401 [00:00<00:00, 1098.34it/s]
==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1240.41
2023-07-24T12:00:00 | net performance [%] = 24.0408
2023-07-24T12:00:00 | number of trades [#] = 4
==================================================
Trial 23 Complete [00h 13m 28s]
net_wealth: 1241.6493946741102

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 04m 02s

Search: Running Trial #24

Value             |Best Value So Far |Hyperparameter
9                 |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.6               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4306.000000   4315.000000
mean      0.000441    20062.255222  ...   20151.395964  20118.633889
std       0.027818    16039.874230  ...   16077.894500  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7715.610107   7690.540039
50%       0.000642    11554.824463  ...   11746.555176  11715.610352
75%       0.011655    29873.081836  ...   29983.155273  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.8532 | profit rate:    1.3 | accuracy: 0.34
step_num: 600 | loss: 0.6307 | profit rate:    3.6 | accuracy: 0.33
step_num: 800 | loss: 0.5712 | profit rate:   10.7 | accuracy: 0.31
step_num: 1000 | loss: 0.5925 | profit rate:   10.9 | accuracy: 0.32
step_num: 1200 | loss: 0.6799 | profit rate:    9.6 | accuracy: 0.34
step_num: 1400 | loss: 0.6377 | profit rate:   30.3 | accuracy: 0.34
step_num: 1600 | loss: 0.5526 | profit rate:   11.9 | accuracy: 0.34
step_num: 1800 | loss: 0.4980 | profit rate:    0.7 | accuracy: 0.34
step_num: 2000 | loss: 0.6023 | profit rate:    0.2 | accuracy: 0.34
step_num: 2200 | loss: 0.6210 | profit rate:  125.6 | accuracy: 0.36
step_num: 2400 | loss: 0.6960 | profit rate:  621.3 | accuracy: 0.37
step_num: 2600 | loss: 0.7000 | profit rate:  101.0 | accuracy: 0.37
step_num: 2800 | loss: 0.6518 | profit rate:  148.9 | accuracy: 0.38
step_num: 3000 | loss: 0.5955 | profit rate:   35.3 | accuracy: 0.37
step_num: 3200 | loss: 0.5787 | profit rate:   16.7 | accuracy: 0.37
step_num: 3400 | loss: 0.6152 | profit rate:   44.9 | accuracy: 0.36
step_num: 3600 | loss: 0.5474 | profit rate:   56.9 | accuracy: 0.36
episode:   1/5,耗时:0.82分/0.82分,训练集: | step: 3662 | average_treward:   79.3 | max_treward: 79.2976 | average profit rate: 57.947
model saved @ step:3662,performance:57.947,accuracy:0.36
step_num: 3800 | loss: 0.5706 | profit rate:    1.1 | accuracy: 0.37
step_num: 4000 | loss: 0.5530 | profit rate:   10.3 | accuracy: 0.33
step_num: 4200 | loss: 0.5245 | profit rate:    3.5 | accuracy: 0.30
step_num: 4400 | loss: 0.4261 | profit rate:    1.0 | accuracy: 0.28
step_num: 4600 | loss: 0.4307 | profit rate:    0.8 | accuracy: 0.28
step_num: 4800 | loss: 0.5064 | profit rate:    1.1 | accuracy: 0.32
step_num: 5000 | loss: 0.5178 | profit rate:    0.4 | accuracy: 0.31
step_num: 5200 | loss: 0.5492 | profit rate:    0.4 | accuracy: 0.31
step_num: 5400 | loss: 0.5708 | profit rate:    0.1 | accuracy: 0.32
step_num: 5600 | loss: 0.5318 | profit rate:    0.1 | accuracy: 0.32
step_num: 5800 | loss: 0.4361 | profit rate:    2.0 | accuracy: 0.33
step_num: 6000 | loss: 0.5572 | profit rate: 1243.6 | accuracy: 0.35
step_num: 6200 | loss: 0.6018 | profit rate:  302.8 | accuracy: 0.34
step_num: 6400 | loss: 0.5831 | profit rate:  697.6 | accuracy: 0.35
step_num: 6600 | loss: 0.5369 | profit rate: 2470.8 | accuracy: 0.35
step_num: 6800 | loss: 0.5206 | profit rate:  573.2 | accuracy: 0.35
step_num: 7000 | loss: 0.5365 | profit rate: 2292.4 | accuracy: 0.35
step_num: 7200 | loss: 0.5247 | profit rate: 2411.6 | accuracy: 0.34
model saved @ step:7324,performance:3413.261,accuracy:0.34
step_num: 7400 | loss: 0.5626 | profit rate:    0.1 | accuracy: 0.25
step_num: 7600 | loss: 0.4426 | profit rate:    0.4 | accuracy: 0.24
step_num: 7800 | loss: 0.4289 | profit rate:    0.1 | accuracy: 0.21
step_num: 8000 | loss: 0.2924 | profit rate:    0.5 | accuracy: 0.22
step_num: 8200 | loss: 0.3727 | profit rate:    0.2 | accuracy: 0.24
step_num: 8400 | loss: 0.3588 | profit rate:    3.6 | accuracy: 0.28
step_num: 8600 | loss: 0.4822 | profit rate:    0.6 | accuracy: 0.28
step_num: 8800 | loss: 0.4903 | profit rate:    0.4 | accuracy: 0.27
step_num: 9000 | loss: 0.4574 | profit rate:    0.6 | accuracy: 0.29
step_num: 9200 | loss: 0.5002 | profit rate:    0.4 | accuracy: 0.29
step_num: 9400 | loss: 0.4999 | profit rate:    1.4 | accuracy: 0.30
step_num: 9600 | loss: 0.5212 | profit rate: 3179.8 | accuracy: 0.33
step_num: 9800 | loss: 0.5591 | profit rate:  590.8 | accuracy: 0.33
step_num: 10000 | loss: 0.5385 | profit rate: 10669.5 | accuracy: 0.33
step_num: 10200 | loss: 0.4588 | profit rate: 15430.0 | accuracy: 0.34
step_num: 10400 | loss: 0.5080 | profit rate: 9521.1 | accuracy: 0.33
step_num: 10600 | loss: 0.4891 | profit rate: 7129.5 | accuracy: 0.33
step_num: 10800 | loss: 0.5062 | profit rate: 5486.9 | accuracy: 0.33
episode:   3/5,耗时:0.91分/2.64分,训练集: | step: 10986 | average_treward:  137.0 | max_treward: 190.0979 | average profit rate: 4521.331
model saved @ step:10986,performance:10092.784,accuracy:0.32
step_num: 11000 | loss: 0.4356 | profit rate:    0.7 | accuracy: 0.13
step_num: 11200 | loss: 0.4194 | profit rate:    0.2 | accuracy: 0.20
step_num: 11400 | loss: 0.4286 | profit rate:    0.1 | accuracy: 0.18
step_num: 11600 | loss: 0.3231 | profit rate:    0.1 | accuracy: 0.20
step_num: 11800 | loss: 0.3396 | profit rate:    0.1 | accuracy: 0.21
step_num: 12000 | loss: 0.3504 | profit rate:    1.4 | accuracy: 0.26
step_num: 12200 | loss: 0.5038 | profit rate:    0.4 | accuracy: 0.27
step_num: 12400 | loss: 0.4596 | profit rate:    0.3 | accuracy: 0.25
step_num: 12600 | loss: 0.4305 | profit rate:    0.1 | accuracy: 0.27
step_num: 12800 | loss: 0.4941 | profit rate:    0.5 | accuracy: 0.29
step_num: 13000 | loss: 0.4628 | profit rate:    1.0 | accuracy: 0.29
step_num: 13200 | loss: 0.4735 | profit rate: 17703.1 | accuracy: 0.33
step_num: 13400 | loss: 0.5689 | profit rate: 35397.0 | accuracy: 0.33
step_num: 13600 | loss: 0.5496 | profit rate: 12083.6 | accuracy: 0.33
step_num: 13800 | loss: 0.4844 | profit rate: 201629.4 | accuracy: 0.34
step_num: 14000 | loss: 0.5285 | profit rate: 88867.7 | accuracy: 0.33
step_num: 14200 | loss: 0.4548 | profit rate: 24459.2 | accuracy: 0.32
step_num: 14400 | loss: 0.4985 | profit rate: 31855.5 | accuracy: 0.32
step_num: 14600 | loss: 0.4729 | profit rate: 19531.2 | accuracy: 0.32
model saved @ step:14648,performance:22859.352,accuracy:0.32
step_num: 14800 | loss: 0.4630 | profit rate:    0.1 | accuracy: 0.21
step_num: 15000 | loss: 0.3587 | profit rate:    0.1 | accuracy: 0.18
step_num: 15200 | loss: 0.3617 | profit rate:    0.0 | accuracy: 0.20
step_num: 15400 | loss: 0.3313 | profit rate:    0.0 | accuracy: 0.20
step_num: 15600 | loss: 0.2854 | profit rate:    0.1 | accuracy: 0.22
step_num: 15800 | loss: 0.4985 | profit rate:    0.6 | accuracy: 0.27
step_num: 16000 | loss: 0.4504 | profit rate:    0.2 | accuracy: 0.25
step_num: 16200 | loss: 0.4467 | profit rate:    0.7 | accuracy: 0.27
step_num: 16400 | loss: 0.4550 | profit rate:    0.3 | accuracy: 0.28
step_num: 16600 | loss: 0.5205 | profit rate:    0.5 | accuracy: 0.28
step_num: 16800 | loss: 0.3965 | profit rate:   38.0 | accuracy: 0.31
step_num: 17000 | loss: 0.4940 | profit rate: 17393.6 | accuracy: 0.33
step_num: 17200 | loss: 0.5015 | profit rate: 5115.5 | accuracy: 0.32
step_num: 17400 | loss: 0.4633 | profit rate: 32964.7 | accuracy: 0.33
step_num: 17600 | loss: 0.4664 | profit rate: 18014.9 | accuracy: 0.33
step_num: 17800 | loss: 0.5007 | profit rate: 5867.7 | accuracy: 0.32
step_num: 18000 | loss: 0.4881 | profit rate: 19227.7 | accuracy: 0.32
step_num: 18200 | loss: 0.4947 | profit rate: 15108.2 | accuracy: 0.32
episode:   5/5,耗时:0.96分/4.53分,训练集: | step: 18310 | average_treward:  178.7 | max_treward: 241.4018 | average profit rate: 9904.667
model saved @ step:18310,performance:13099.988,accuracy:0.32
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 24%|       | 95/391 [00:00<00:00, 949.92it/s] 51%|     | 198/391 [00:00<00:00, 997.02it/s] 77%|  | 303/391 [00:00<00:00, 1020.87it/s]100%|| 391/391 [00:00<00:00, 1020.33it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1212.42
2023-07-24T12:00:00 | net performance [%] = 21.2420
2023-07-24T12:00:00 | number of trades [#] = 8
==================================================
Trial 24 Complete [00h 04m 35s]
net_wealth: 1213.6333514045625

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 08m 38s

Search: Running Trial #25

Value             |Best Value So Far |Hyperparameter
15                |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.92              |0.6               |gamma
0.0001            |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4286.000000   4301.000000
mean      0.000435    20113.607657  ...   20224.573864  20169.373185
std       0.027833    16040.642334  ...   16079.545659  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7778.380005   7730.930176
50%       0.000642    11571.842969  ...   11768.989746  11751.469727
75%       0.011590    29894.706152  ...   30071.020508  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.5755 | profit rate:    0.7 | accuracy: 0.34
step_num: 1200 | loss: 0.6374 | profit rate:    2.1 | accuracy: 0.33
step_num: 1400 | loss: 0.5585 | profit rate:    2.6 | accuracy: 0.33
step_num: 1600 | loss: 0.5409 | profit rate:    0.9 | accuracy: 0.33
step_num: 1800 | loss: 0.5614 | profit rate:    2.0 | accuracy: 0.34
step_num: 2000 | loss: 0.5803 | profit rate:    0.1 | accuracy: 0.35
step_num: 2200 | loss: 0.5630 | profit rate:    0.8 | accuracy: 0.36
step_num: 2400 | loss: 0.6168 | profit rate:    1.1 | accuracy: 0.37
step_num: 2600 | loss: 0.6327 | profit rate:    0.1 | accuracy: 0.37
step_num: 2800 | loss: 0.6275 | profit rate:    0.0 | accuracy: 0.36
step_num: 3000 | loss: 0.6190 | profit rate:    0.0 | accuracy: 0.36
episode:   1/5,耗时:1.35分/1.35分,训练集: | step: 3160 | average_treward:  -73.8 | max_treward: 0.0000 | average profit rate:  0.010
step_num: 3200 | loss: 0.6437 | profit rate:    1.1 | accuracy: 0.29
step_num: 3400 | loss: 0.6293 | profit rate:    3.1 | accuracy: 0.24
step_num: 3600 | loss: 0.6089 | profit rate:    0.6 | accuracy: 0.23
step_num: 3800 | loss: 0.5979 | profit rate:    3.3 | accuracy: 0.26
step_num: 4000 | loss: 0.5392 | profit rate:    1.6 | accuracy: 0.24
step_num: 4200 | loss: 0.4676 | profit rate:    0.6 | accuracy: 0.23
step_num: 4400 | loss: 0.4545 | profit rate:   18.2 | accuracy: 0.24
step_num: 4600 | loss: 0.4028 | profit rate:    5.7 | accuracy: 0.24
step_num: 4800 | loss: 0.4155 | profit rate:    1.8 | accuracy: 0.24
step_num: 5000 | loss: 0.4608 | profit rate: 21432.1 | accuracy: 0.28
step_num: 5200 | loss: 0.4548 | profit rate:  333.1 | accuracy: 0.28
step_num: 5400 | loss: 0.4642 | profit rate: 1549.8 | accuracy: 0.29
step_num: 5600 | loss: 0.4959 | profit rate: 4807.3 | accuracy: 0.30
step_num: 5800 | loss: 0.4463 | profit rate: 21283.9 | accuracy: 0.30
step_num: 6000 | loss: 0.4683 | profit rate: 2651.3 | accuracy: 0.29
step_num: 6200 | loss: 0.5028 | profit rate: 15339.9 | accuracy: 0.30
model saved @ step:6320,performance:156850.511,accuracy:0.30
step_num: 6400 | loss: 0.4939 | profit rate:    0.9 | accuracy: 0.19
step_num: 6600 | loss: 0.4909 | profit rate:    0.3 | accuracy: 0.19
step_num: 6800 | loss: 0.4708 | profit rate:    0.6 | accuracy: 0.20
step_num: 7000 | loss: 0.4932 | profit rate:  110.7 | accuracy: 0.27
step_num: 7200 | loss: 0.4722 | profit rate:   55.9 | accuracy: 0.28
step_num: 7400 | loss: 0.4325 | profit rate:   96.6 | accuracy: 0.29
step_num: 7600 | loss: 0.4482 | profit rate: 720292.1 | accuracy: 0.31
step_num: 7800 | loss: 0.4495 | profit rate: 941585.0 | accuracy: 0.33
step_num: 8000 | loss: 0.5089 | profit rate: 31893.3 | accuracy: 0.33
step_num: 8200 | loss: 0.5088 | profit rate: 27549561.7 | accuracy: 0.36
step_num: 8400 | loss: 0.5387 | profit rate: 8171420.5 | accuracy: 0.36
step_num: 8600 | loss: 0.5727 | profit rate: 13349288660.7 | accuracy: 0.38
step_num: 8800 | loss: 0.6106 | profit rate: 714629510.6 | accuracy: 0.37
step_num: 9000 | loss: 0.5701 | profit rate: 3796319346.4 | accuracy: 0.37
step_num: 9200 | loss: 0.5655 | profit rate: 224001072.7 | accuracy: 0.36
step_num: 9400 | loss: 0.5614 | profit rate: 16437861317.4 | accuracy: 0.37
episode:   3/5,耗时:1.90分/5.17分,训练集: | step: 9480 | average_treward:  159.9 | max_treward: 385.6947 | average profit rate: 5568212656.807
model saved @ step:9480,performance:16704481119.901,accuracy:0.37
step_num: 9600 | loss: 0.5666 | profit rate:    1.1 | accuracy: 0.23
step_num: 9800 | loss: 0.5371 | profit rate:    0.9 | accuracy: 0.21
step_num: 10000 | loss: 0.4792 | profit rate:   53.6 | accuracy: 0.27
step_num: 10200 | loss: 0.5092 | profit rate: 2768.5 | accuracy: 0.31
step_num: 10400 | loss: 0.4865 | profit rate: 12103.5 | accuracy: 0.32
step_num: 10600 | loss: 0.4575 | profit rate: 7992570.3 | accuracy: 0.34
step_num: 10800 | loss: 0.4445 | profit rate: 173667584.9 | accuracy: 0.34
step_num: 11000 | loss: 0.4680 | profit rate: 294820172.9 | accuracy: 0.35
step_num: 11200 | loss: 0.4921 | profit rate: 103775062775.6 | accuracy: 0.38
step_num: 11400 | loss: 0.5220 | profit rate: 3728354952254.4 | accuracy: 0.40
step_num: 11600 | loss: 0.5170 | profit rate: 1201477604423.0 | accuracy: 0.39
step_num: 11800 | loss: 0.5585 | profit rate: 758805478585995.0 | accuracy: 0.41
step_num: 12000 | loss: 0.5454 | profit rate: 362243828015529.3 | accuracy: 0.40
step_num: 12200 | loss: 0.5321 | profit rate: 2641049330098817.5 | accuracy: 0.39
step_num: 12400 | loss: 0.5420 | profit rate: 6317862405383837.0 | accuracy: 0.39
step_num: 12600 | loss: 0.5110 | profit rate: 69440331725939664.0 | accuracy: 0.39
model saved @ step:12640,performance:97161692302468912.000,accuracy:0.39
step_num: 12800 | loss: 0.5389 | profit rate:    0.4 | accuracy: 0.20
step_num: 13000 | loss: 0.5268 | profit rate:    1.4 | accuracy: 0.24
step_num: 13200 | loss: 0.4983 | profit rate:   23.7 | accuracy: 0.32
step_num: 13400 | loss: 0.4508 | profit rate:  899.3 | accuracy: 0.34
step_num: 13600 | loss: 0.4553 | profit rate: 5137.7 | accuracy: 0.35
step_num: 13800 | loss: 0.4845 | profit rate: 16368146.5 | accuracy: 0.37
step_num: 14000 | loss: 0.4331 | profit rate: 73238643.9 | accuracy: 0.36
step_num: 14200 | loss: 0.4643 | profit rate: 347605806.7 | accuracy: 0.38
step_num: 14400 | loss: 0.4527 | profit rate: 1452164444744.1 | accuracy: 0.41
step_num: 14600 | loss: 0.4410 | profit rate: 8126907364887.7 | accuracy: 0.42
step_num: 14800 | loss: 0.4866 | profit rate: 66640660869500.3 | accuracy: 0.42
step_num: 15000 | loss: 0.5364 | profit rate: 5706591682782270.0 | accuracy: 0.43
step_num: 15200 | loss: 0.5399 | profit rate: 7332147073190740.0 | accuracy: 0.42
step_num: 15400 | loss: 0.5342 | profit rate: 15018722164846578.0 | accuracy: 0.41
step_num: 15600 | loss: 0.5068 | profit rate: 197991835252493664.0 | accuracy: 0.41
episode:   5/5,耗时:1.96分/9.10分,训练集: | step: 15800 | average_treward:  366.9 | max_treward: 722.4146 | average profit rate: 481032707271323264.000
model saved @ step:15800,performance:2308001827349509120.000,accuracy:0.41
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 24%|       | 96/408 [00:00<00:00, 956.41it/s] 54%|    | 220/408 [00:00<00:00, 1122.96it/s] 84%| | 342/408 [00:00<00:00, 1161.94it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 1142.68it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 947.65
2023-07-24T12:00:00 | net performance [%] = -5.2352
2023-07-24T12:00:00 | number of trades [#] = 56
==================================================
Trial 25 Complete [00h 09m 09s]
net_wealth: 948.5962531099544

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 17m 47s

Search: Running Trial #26

Value             |Best Value So Far |Hyperparameter
11                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.8               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4304.000000   4315.000000
mean      0.000441    20062.255222  ...   20158.552772  20118.633889
std       0.027818    16039.874230  ...   16078.200687  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7720.229858   7690.540039
50%       0.000642    11554.824463  ...   11749.425293  11715.610352
75%       0.011655    29873.081836  ...   29998.575684  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 1.0765 | profit rate:   74.2 | accuracy: 0.34
step_num: 800 | loss: 0.9016 | profit rate:   43.9 | accuracy: 0.33
step_num: 1000 | loss: 0.7980 | profit rate:   66.3 | accuracy: 0.32
step_num: 1200 | loss: 0.7400 | profit rate:   46.0 | accuracy: 0.34
step_num: 1400 | loss: 0.6928 | profit rate:  100.5 | accuracy: 0.33
step_num: 1600 | loss: 0.6468 | profit rate:  178.8 | accuracy: 0.33
step_num: 1800 | loss: 0.6352 | profit rate:   11.0 | accuracy: 0.32
step_num: 2000 | loss: 0.6352 | profit rate:   23.1 | accuracy: 0.33
step_num: 2200 | loss: 0.5845 | profit rate:  131.9 | accuracy: 0.34
step_num: 2400 | loss: 0.6358 | profit rate:  540.0 | accuracy: 0.36
step_num: 2600 | loss: 0.7319 | profit rate:   17.3 | accuracy: 0.36
step_num: 2800 | loss: 0.6485 | profit rate:    4.3 | accuracy: 0.35
step_num: 3000 | loss: 0.7101 | profit rate:    3.5 | accuracy: 0.35
step_num: 3200 | loss: 0.6445 | profit rate:    1.7 | accuracy: 0.34
step_num: 3400 | loss: 0.4895 | profit rate:    9.4 | accuracy: 0.33
step_num: 3600 | loss: 0.3706 | profit rate:    8.0 | accuracy: 0.32
episode:   1/5,耗时:1.93分/1.93分,训练集: | step: 3724 | average_treward:   54.2 | max_treward: 54.1643 | average profit rate:  6.252
model saved @ step:3724,performance:6.252,accuracy:0.31
step_num: 3800 | loss: 0.4056 | profit rate:  152.4 | accuracy: 0.70
step_num: 4000 | loss: 0.3685 | profit rate:    0.6 | accuracy: 0.27
step_num: 4200 | loss: 0.3035 | profit rate:    0.4 | accuracy: 0.17
step_num: 4400 | loss: 0.2956 | profit rate:    0.3 | accuracy: 0.19
step_num: 4600 | loss: 0.3238 | profit rate:    0.7 | accuracy: 0.18
step_num: 4800 | loss: 0.3002 | profit rate:  589.2 | accuracy: 0.24
step_num: 5000 | loss: 0.3818 | profit rate: 5558.6 | accuracy: 0.28
step_num: 5200 | loss: 0.4211 | profit rate: 6763.6 | accuracy: 0.26
step_num: 5400 | loss: 0.4450 | profit rate:   38.9 | accuracy: 0.26
step_num: 5600 | loss: 0.5083 | profit rate:  204.5 | accuracy: 0.26
step_num: 5800 | loss: 0.5351 | profit rate:  492.2 | accuracy: 0.29
step_num: 6000 | loss: 0.5051 | profit rate: 79045060.9 | accuracy: 0.33
step_num: 6200 | loss: 0.6028 | profit rate: 4541679591.7 | accuracy: 0.35
step_num: 6400 | loss: 0.6481 | profit rate: 95076145.2 | accuracy: 0.34
step_num: 6600 | loss: 0.6354 | profit rate: 3988338974.1 | accuracy: 0.35
step_num: 6800 | loss: 0.5598 | profit rate: 141560786.5 | accuracy: 0.34
step_num: 7000 | loss: 0.5699 | profit rate: 60481935.4 | accuracy: 0.33
step_num: 7200 | loss: 0.4378 | profit rate: 61555580.0 | accuracy: 0.32
step_num: 7400 | loss: 0.4008 | profit rate: 8643376.3 | accuracy: 0.31
model saved @ step:7448,performance:8643376.262,accuracy:0.30
step_num: 7600 | loss: 0.4679 | profit rate:    0.2 | accuracy: 0.47
step_num: 7800 | loss: 0.3630 | profit rate:    0.0 | accuracy: 0.23
step_num: 8000 | loss: 0.3538 | profit rate:    0.0 | accuracy: 0.17
step_num: 8200 | loss: 0.3485 | profit rate:    0.0 | accuracy: 0.19
step_num: 8400 | loss: 0.3047 | profit rate:    0.1 | accuracy: 0.19
step_num: 8600 | loss: 0.3236 | profit rate: 4645.3 | accuracy: 0.28
step_num: 8800 | loss: 0.4155 | profit rate: 4621.7 | accuracy: 0.30
step_num: 9000 | loss: 0.3601 | profit rate: 2972.4 | accuracy: 0.27
step_num: 9200 | loss: 0.4661 | profit rate:  129.9 | accuracy: 0.28
step_num: 9400 | loss: 0.5380 | profit rate:  357.8 | accuracy: 0.30
step_num: 9600 | loss: 0.5921 | profit rate: 2961.8 | accuracy: 0.32
step_num: 9800 | loss: 0.5711 | profit rate: 1176379012.2 | accuracy: 0.36
step_num: 10000 | loss: 0.6944 | profit rate: 85282306.4 | accuracy: 0.37
step_num: 10200 | loss: 0.6001 | profit rate: 252869650.4 | accuracy: 0.35
step_num: 10400 | loss: 0.6695 | profit rate: 197991442.4 | accuracy: 0.36
step_num: 10600 | loss: 0.5479 | profit rate: 155311788.2 | accuracy: 0.35
step_num: 10800 | loss: 0.4789 | profit rate: 86301016.0 | accuracy: 0.34
step_num: 11000 | loss: 0.3161 | profit rate: 29066973.7 | accuracy: 0.32
episode:   3/5,耗时:2.24分/6.49分,训练集: | step: 11172 | average_treward:  228.3 | max_treward: 318.8615 | average profit rate: 8094680.558
step_num: 11200 | loss: 0.3409 | profit rate:  212.9 | accuracy: 0.93
step_num: 11400 | loss: 0.3463 | profit rate:    0.4 | accuracy: 0.30
step_num: 11600 | loss: 0.3461 | profit rate:    0.4 | accuracy: 0.22
step_num: 11800 | loss: 0.3086 | profit rate:    0.1 | accuracy: 0.20
step_num: 12000 | loss: 0.3343 | profit rate:    1.4 | accuracy: 0.21
step_num: 12200 | loss: 0.3649 | profit rate:   15.8 | accuracy: 0.25
step_num: 12400 | loss: 0.4063 | profit rate: 46144.9 | accuracy: 0.31
step_num: 12600 | loss: 0.4522 | profit rate: 118267.2 | accuracy: 0.31
step_num: 12800 | loss: 0.4624 | profit rate: 337030.5 | accuracy: 0.31
step_num: 13000 | loss: 0.5826 | profit rate: 2238.5 | accuracy: 0.31
step_num: 13200 | loss: 0.6565 | profit rate:  134.3 | accuracy: 0.32
step_num: 13400 | loss: 0.5953 | profit rate: 32000.2 | accuracy: 0.35
step_num: 13600 | loss: 0.6782 | profit rate: 654322068.4 | accuracy: 0.38
step_num: 13800 | loss: 0.6790 | profit rate: 850034230.6 | accuracy: 0.37
step_num: 14000 | loss: 0.6289 | profit rate: 15762933563.0 | accuracy: 0.38
step_num: 14200 | loss: 0.5856 | profit rate: 1794325914.1 | accuracy: 0.37
step_num: 14400 | loss: 0.5663 | profit rate: 695167191.6 | accuracy: 0.36
step_num: 14600 | loss: 0.3878 | profit rate: 1578349767.3 | accuracy: 0.34
step_num: 14800 | loss: 0.3479 | profit rate: 7048308294.5 | accuracy: 0.33
model saved @ step:14896,performance:6038118751.544,accuracy:0.33
step_num: 15000 | loss: 0.3997 | profit rate:    6.4 | accuracy: 0.54
step_num: 15200 | loss: 0.3275 | profit rate:   13.4 | accuracy: 0.30
step_num: 15400 | loss: 0.3358 | profit rate:   67.5 | accuracy: 0.28
step_num: 15600 | loss: 0.4361 | profit rate:  256.5 | accuracy: 0.31
step_num: 15800 | loss: 0.3839 | profit rate:  308.4 | accuracy: 0.26
step_num: 16000 | loss: 0.4115 | profit rate: 166925.1 | accuracy: 0.32
step_num: 16200 | loss: 0.5159 | profit rate: 147486.9 | accuracy: 0.35
step_num: 16400 | loss: 0.5149 | profit rate: 16737770.3 | accuracy: 0.35
step_num: 16600 | loss: 0.5384 | profit rate: 377259.4 | accuracy: 0.34
step_num: 16800 | loss: 0.6411 | profit rate: 6619.7 | accuracy: 0.34
step_num: 17000 | loss: 0.6654 | profit rate: 1031.7 | accuracy: 0.35
step_num: 17200 | loss: 0.6461 | profit rate: 6950091.9 | accuracy: 0.38
step_num: 17400 | loss: 0.7067 | profit rate: 1252362631.4 | accuracy: 0.40
step_num: 17600 | loss: 0.5964 | profit rate: 11014093258.6 | accuracy: 0.38
step_num: 17800 | loss: 0.6090 | profit rate: 77248000610.1 | accuracy: 0.40
step_num: 18000 | loss: 0.5423 | profit rate: 13437080896.2 | accuracy: 0.38
step_num: 18200 | loss: 0.5036 | profit rate: 9364680748.9 | accuracy: 0.37
step_num: 18400 | loss: 0.3759 | profit rate: 21539851409.4 | accuracy: 0.35
step_num: 18600 | loss: 0.3793 | profit rate: 131478037579.5 | accuracy: 0.35
episode:   5/5,耗时:2.27分/11.07分,训练集: | step: 18620 | average_treward:  281.5 | max_treward: 367.6068 | average profit rate: 26876300467.453
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 23%|       | 92/408 [00:00<00:00, 919.99it/s] 50%|     | 203/408 [00:00<00:00, 1031.76it/s] 76%|  | 312/408 [00:00<00:00, 1053.58it/s]==================================================
100%|| 408/408 [00:00<00:00, 1065.09it/s]
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1410.01
2023-07-24T12:00:00 | net performance [%] = 41.0013
2023-07-24T12:00:00 | number of trades [#] = 14
==================================================
Trial 26 Complete [00h 11m 07s]
net_wealth: 1411.424261415541

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 28m 54s

Search: Running Trial #27

Value             |Best Value So Far |Hyperparameter
2                 |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.92              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4313.000000   4315.000000
mean      0.000441    20062.255222  ...   20125.961477  20118.633889
std       0.027818    16039.874230  ...   16077.223335  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7693.100098   7690.540039
50%       0.000642    11554.824463  ...   11733.030273  11715.610352
75%       0.011655    29873.081836  ...   29928.000000  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.4834 | profit rate:    5.4 | accuracy: 0.36
step_num: 800 | loss: 0.4484 | profit rate:    3.7 | accuracy: 0.35
step_num: 1000 | loss: 0.4160 | profit rate:    4.8 | accuracy: 0.34
step_num: 1200 | loss: 0.3806 | profit rate:    2.7 | accuracy: 0.34
step_num: 1400 | loss: 0.3561 | profit rate:    1.5 | accuracy: 0.34
step_num: 1600 | loss: 0.3356 | profit rate:    2.2 | accuracy: 0.34
step_num: 1800 | loss: 0.3400 | profit rate:    2.7 | accuracy: 0.34
step_num: 2000 | loss: 0.3013 | profit rate:    2.3 | accuracy: 0.32
step_num: 2200 | loss: 0.2949 | profit rate:    2.7 | accuracy: 0.32
step_num: 2400 | loss: 0.3160 | profit rate:    3.0 | accuracy: 0.32
step_num: 2600 | loss: 0.3129 | profit rate:    3.6 | accuracy: 0.32
step_num: 2800 | loss: 0.2762 | profit rate:    4.0 | accuracy: 0.32
step_num: 3000 | loss: 0.2834 | profit rate:    3.0 | accuracy: 0.31
step_num: 3200 | loss: 0.2852 | profit rate:    3.7 | accuracy: 0.31
step_num: 3400 | loss: 0.2903 | profit rate:    8.9 | accuracy: 0.31
step_num: 3600 | loss: 0.2690 | profit rate:   10.5 | accuracy: 0.31
episode:   1/5,耗时:1.11分/1.11分,训练集: | step: 3707 | average_treward:  125.5 | max_treward: 125.4545 | average profit rate:  9.884
model saved @ step:3707,performance:9.884,accuracy:0.31
step_num: 3800 | loss: 0.3232 | profit rate:    0.4 | accuracy: 0.29
step_num: 4000 | loss: 0.3010 | profit rate:    1.3 | accuracy: 0.28
step_num: 4200 | loss: 0.3463 | profit rate:    1.5 | accuracy: 0.28
step_num: 4400 | loss: 0.2688 | profit rate:    2.0 | accuracy: 0.26
step_num: 4600 | loss: 0.2479 | profit rate:    4.1 | accuracy: 0.26
step_num: 4800 | loss: 0.2687 | profit rate:    3.5 | accuracy: 0.24
step_num: 5000 | loss: 0.2355 | profit rate:    3.7 | accuracy: 0.23
step_num: 5200 | loss: 0.1908 | profit rate:    5.2 | accuracy: 0.24
step_num: 5400 | loss: 0.2224 | profit rate:    1.7 | accuracy: 0.23
step_num: 5600 | loss: 0.1742 | profit rate:    1.9 | accuracy: 0.23
step_num: 5800 | loss: 0.1853 | profit rate:    2.0 | accuracy: 0.23
step_num: 6000 | loss: 0.1816 | profit rate:    2.4 | accuracy: 0.22
step_num: 6200 | loss: 0.1501 | profit rate:    6.1 | accuracy: 0.22
step_num: 6400 | loss: 0.1646 | profit rate:   22.1 | accuracy: 0.22
step_num: 6600 | loss: 0.1737 | profit rate:   13.9 | accuracy: 0.22
step_num: 6800 | loss: 0.1669 | profit rate:   34.3 | accuracy: 0.22
step_num: 7000 | loss: 0.2321 | profit rate:   37.9 | accuracy: 0.22
step_num: 7200 | loss: 0.2185 | profit rate:   45.9 | accuracy: 0.22
step_num: 7400 | loss: 0.2114 | profit rate:   63.0 | accuracy: 0.22
model saved @ step:7414,performance:63.011,accuracy:0.22
step_num: 7600 | loss: 0.1975 | profit rate:    0.7 | accuracy: 0.25
step_num: 7800 | loss: 0.1911 | profit rate:    0.9 | accuracy: 0.21
step_num: 8000 | loss: 0.2059 | profit rate:    1.2 | accuracy: 0.22
step_num: 8200 | loss: 0.2237 | profit rate:    1.6 | accuracy: 0.22
step_num: 8400 | loss: 0.1745 | profit rate:    2.0 | accuracy: 0.22
step_num: 8600 | loss: 0.2045 | profit rate:    3.1 | accuracy: 0.22
step_num: 8800 | loss: 0.1902 | profit rate:    2.1 | accuracy: 0.22
step_num: 9000 | loss: 0.1657 | profit rate:    3.0 | accuracy: 0.22
step_num: 9200 | loss: 0.1843 | profit rate:    0.9 | accuracy: 0.21
step_num: 9400 | loss: 0.2170 | profit rate:    1.1 | accuracy: 0.22
step_num: 9600 | loss: 0.1975 | profit rate:    0.8 | accuracy: 0.22
step_num: 9800 | loss: 0.1485 | profit rate:    1.7 | accuracy: 0.21
step_num: 10000 | loss: 0.2071 | profit rate:    2.4 | accuracy: 0.22
step_num: 10200 | loss: 0.1854 | profit rate:    2.3 | accuracy: 0.21
step_num: 10400 | loss: 0.1976 | profit rate:    3.2 | accuracy: 0.22
step_num: 10600 | loss: 0.1862 | profit rate:    5.7 | accuracy: 0.22
step_num: 10800 | loss: 0.2169 | profit rate:    8.9 | accuracy: 0.22
step_num: 11000 | loss: 0.1671 | profit rate:    8.5 | accuracy: 0.22
episode:   3/5,耗时:1.44分/3.90分,训练集: | step: 11121 | average_treward:  203.1 | max_treward: 249.7165 | average profit rate: 26.763
step_num: 11200 | loss: 0.1840 | profit rate:    0.8 | accuracy: 0.24
step_num: 11400 | loss: 0.1929 | profit rate:    0.3 | accuracy: 0.17
step_num: 11600 | loss: 0.1559 | profit rate:    0.3 | accuracy: 0.19
step_num: 11800 | loss: 0.1413 | profit rate:    0.4 | accuracy: 0.18
step_num: 12000 | loss: 0.1624 | profit rate:    0.5 | accuracy: 0.18
step_num: 12200 | loss: 0.1754 | profit rate:    0.4 | accuracy: 0.18
step_num: 12400 | loss: 0.1472 | profit rate:    0.2 | accuracy: 0.17
step_num: 12600 | loss: 0.1645 | profit rate:    0.4 | accuracy: 0.19
step_num: 12800 | loss: 0.1714 | profit rate:    0.2 | accuracy: 0.18
step_num: 13000 | loss: 0.1588 | profit rate:    0.2 | accuracy: 0.17
step_num: 13200 | loss: 0.1541 | profit rate:    0.3 | accuracy: 0.18
step_num: 13400 | loss: 0.1582 | profit rate:    0.4 | accuracy: 0.18
step_num: 13600 | loss: 0.1586 | profit rate:    0.9 | accuracy: 0.18
step_num: 13800 | loss: 0.1717 | profit rate:    1.8 | accuracy: 0.19
step_num: 14000 | loss: 0.1970 | profit rate:    1.3 | accuracy: 0.19
step_num: 14200 | loss: 0.1708 | profit rate:    2.0 | accuracy: 0.19
step_num: 14400 | loss: 0.2059 | profit rate:    4.5 | accuracy: 0.19
step_num: 14600 | loss: 0.1925 | profit rate:    5.4 | accuracy: 0.19
step_num: 14800 | loss: 0.1797 | profit rate:    6.5 | accuracy: 0.20
step_num: 15000 | loss: 0.1876 | profit rate:    1.4 | accuracy: 0.18
step_num: 15200 | loss: 0.1777 | profit rate:    2.4 | accuracy: 0.21
step_num: 15400 | loss: 0.1810 | profit rate:    5.3 | accuracy: 0.22
step_num: 15600 | loss: 0.2030 | profit rate:   11.3 | accuracy: 0.23
step_num: 15800 | loss: 0.2093 | profit rate:   11.2 | accuracy: 0.23
step_num: 16000 | loss: 0.1795 | profit rate:   25.0 | accuracy: 0.23
step_num: 16200 | loss: 0.1890 | profit rate:   18.3 | accuracy: 0.23
step_num: 16400 | loss: 0.2096 | profit rate:   26.2 | accuracy: 0.23
step_num: 16600 | loss: 0.1800 | profit rate:   18.9 | accuracy: 0.22
step_num: 16800 | loss: 0.1864 | profit rate:   31.3 | accuracy: 0.22
step_num: 17000 | loss: 0.1663 | profit rate:   34.4 | accuracy: 0.22
step_num: 17200 | loss: 0.1488 | profit rate:   74.7 | accuracy: 0.21
step_num: 17400 | loss: 0.1742 | profit rate:  167.2 | accuracy: 0.22
step_num: 17600 | loss: 0.1573 | profit rate:  242.9 | accuracy: 0.21
step_num: 17800 | loss: 0.1583 | profit rate:  332.6 | accuracy: 0.21
step_num: 18000 | loss: 0.1792 | profit rate:  881.6 | accuracy: 0.22
step_num: 18200 | loss: 0.2056 | profit rate: 2644.2 | accuracy: 0.22
step_num: 18400 | loss: 0.1948 | profit rate: 2018.9 | accuracy: 0.22
episode:   5/5,耗时:1.35分/6.63分,训练集: | step: 18535 | average_treward:  237.9 | max_treward: 358.6545 | average profit rate: 696.963
model saved @ step:18535,performance:3397.885,accuracy:0.22
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 26%|       | 101/391 [00:00<00:00, 1009.90it/s] 53%|    | 207/391 [00:00<00:00, 1033.60it/s] 82%| | 320/391 [00:00<00:00, 1072.61it/s]100%|| 391/391 [00:00<00:00, 1065.51it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1182.44
2023-07-24T12:00:00 | net performance [%] = 18.2438
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 27 Complete [00h 06m 41s]
net_wealth: 1183.6218882654118

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 35m 36s

Search: Running Trial #28

Value             |Best Value So Far |Hyperparameter
15                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
14                |5                 |lags
0.8               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4300.000000   4315.000000
mean      0.000441    20062.255222  ...   20173.020481  20118.633889
std       0.027818    16039.874230  ...   16078.674434  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7736.967529   7690.540039
50%       0.000642    11554.824463  ...   11753.029785  11715.610352
75%       0.011655    29873.081836  ...   30013.548340  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.7344 | profit rate:    0.1 | accuracy: 0.33
step_num: 600 | loss: 0.6444 | profit rate:    0.1 | accuracy: 0.33
step_num: 800 | loss: 0.5526 | profit rate:    0.7 | accuracy: 0.30
step_num: 1000 | loss: 0.6184 | profit rate:    0.1 | accuracy: 0.29
step_num: 1200 | loss: 0.7117 | profit rate:    0.0 | accuracy: 0.29
step_num: 1400 | loss: 0.5962 | profit rate:    0.0 | accuracy: 0.27
step_num: 1600 | loss: 0.5082 | profit rate:    0.0 | accuracy: 0.27
step_num: 1800 | loss: 0.5751 | profit rate:    0.0 | accuracy: 0.27
step_num: 2000 | loss: 0.5666 | profit rate:    0.0 | accuracy: 0.27
step_num: 2200 | loss: 0.5390 | profit rate:    0.0 | accuracy: 0.29
step_num: 2400 | loss: 0.7224 | profit rate:    0.8 | accuracy: 0.30
step_num: 2600 | loss: 0.6542 | profit rate:    4.1 | accuracy: 0.30
step_num: 2800 | loss: 0.5605 | profit rate:   22.1 | accuracy: 0.30
step_num: 3000 | loss: 0.4362 | profit rate:    5.1 | accuracy: 0.30
step_num: 3200 | loss: 0.5341 | profit rate:    4.5 | accuracy: 0.30
step_num: 3400 | loss: 0.4513 | profit rate:   11.3 | accuracy: 0.29
step_num: 3600 | loss: 0.4261 | profit rate:   58.6 | accuracy: 0.29
episode:   1/5,耗时:0.60分/0.60分,训练集: | step: 3668 | average_treward:  -23.9 | max_treward: 0.0000 | average profit rate: 55.388
step_num: 3800 | loss: 0.4360 | profit rate:    0.1 | accuracy: 0.26
step_num: 4000 | loss: 0.4877 | profit rate:    1.3 | accuracy: 0.21
step_num: 4200 | loss: 0.4740 | profit rate:    1.0 | accuracy: 0.22
step_num: 4400 | loss: 0.3570 | profit rate:    5.6 | accuracy: 0.21
step_num: 4600 | loss: 0.4079 | profit rate:    2.3 | accuracy: 0.21
step_num: 4800 | loss: 0.5626 | profit rate: 3313.4 | accuracy: 0.28
step_num: 5000 | loss: 0.6413 | profit rate: 1334.0 | accuracy: 0.27
step_num: 5200 | loss: 0.5626 | profit rate: 2645.8 | accuracy: 0.27
step_num: 5400 | loss: 0.5327 | profit rate:   18.9 | accuracy: 0.28
step_num: 5600 | loss: 0.6068 | profit rate:   11.0 | accuracy: 0.29
step_num: 5800 | loss: 0.5768 | profit rate:  405.9 | accuracy: 0.31
step_num: 6000 | loss: 0.7118 | profit rate: 218895910.5 | accuracy: 0.34
step_num: 6200 | loss: 0.7298 | profit rate: 110844945.2 | accuracy: 0.34
step_num: 6400 | loss: 0.7183 | profit rate: 221428946.1 | accuracy: 0.34
step_num: 6600 | loss: 0.6017 | profit rate: 1116173657.4 | accuracy: 0.35
step_num: 6800 | loss: 0.6163 | profit rate: 257264201.6 | accuracy: 0.34
step_num: 7000 | loss: 0.4789 | profit rate: 3489090022.1 | accuracy: 0.33
step_num: 7200 | loss: 0.4099 | profit rate: 4705910095.6 | accuracy: 0.32
model saved @ step:7336,performance:24156132168.342,accuracy:0.32
step_num: 7400 | loss: 0.4590 | profit rate:    0.0 | accuracy: 0.29
step_num: 7600 | loss: 0.5070 | profit rate:    0.2 | accuracy: 0.24
step_num: 7800 | loss: 0.5500 | profit rate:    0.2 | accuracy: 0.24
step_num: 8000 | loss: 0.3661 | profit rate:    2.2 | accuracy: 0.24
step_num: 8200 | loss: 0.4186 | profit rate:    7.0 | accuracy: 0.23
step_num: 8400 | loss: 0.5252 | profit rate: 5838.5 | accuracy: 0.30
step_num: 8600 | loss: 0.6905 | profit rate: 45358.1 | accuracy: 0.32
step_num: 8800 | loss: 0.6311 | profit rate: 162599.1 | accuracy: 0.30
step_num: 9000 | loss: 0.5860 | profit rate: 2863.3 | accuracy: 0.31
step_num: 9200 | loss: 0.6068 | profit rate:  697.8 | accuracy: 0.31
step_num: 9400 | loss: 0.7142 | profit rate:  656.4 | accuracy: 0.32
step_num: 9600 | loss: 0.6918 | profit rate: 1576863327.6 | accuracy: 0.37
step_num: 9800 | loss: 0.7951 | profit rate: 330422135463.9 | accuracy: 0.38
step_num: 10000 | loss: 0.7513 | profit rate: 181607421389.3 | accuracy: 0.37
step_num: 10200 | loss: 0.6714 | profit rate: 2097909071467.5 | accuracy: 0.38
step_num: 10400 | loss: 0.5819 | profit rate: 1241025925210.5 | accuracy: 0.37
step_num: 10600 | loss: 0.5136 | profit rate: 1959980922317.3 | accuracy: 0.36
step_num: 10800 | loss: 0.4244 | profit rate: 1582860174788.9 | accuracy: 0.35
step_num: 11000 | loss: 0.3306 | profit rate: 10606392755017.6 | accuracy: 0.35
episode:   3/5,耗时:0.69分/1.98分,训练集: | step: 11004 | average_treward:  200.2 | max_treward: 358.8549 | average profit rate: 3468355836033.098
model saved @ step:11004,performance:10380911375875.562,accuracy:0.35
step_num: 11200 | loss: 0.5529 | profit rate:    0.1 | accuracy: 0.29
step_num: 11400 | loss: 0.4840 | profit rate:    0.3 | accuracy: 0.26
step_num: 11600 | loss: 0.5033 | profit rate:    0.0 | accuracy: 0.23
step_num: 11800 | loss: 0.3976 | profit rate:    0.4 | accuracy: 0.23
step_num: 12000 | loss: 0.4466 | profit rate:   44.0 | accuracy: 0.27
step_num: 12200 | loss: 0.6301 | profit rate: 10429.7 | accuracy: 0.32
step_num: 12400 | loss: 0.7695 | profit rate: 22314.1 | accuracy: 0.31
step_num: 12600 | loss: 0.5754 | profit rate: 10747.1 | accuracy: 0.31
step_num: 12800 | loss: 0.5787 | profit rate:   52.7 | accuracy: 0.31
step_num: 13000 | loss: 0.6839 | profit rate:    5.3 | accuracy: 0.32
step_num: 13200 | loss: 0.7012 | profit rate: 2157823.6 | accuracy: 0.36
step_num: 13400 | loss: 0.8186 | profit rate: 84544925413.0 | accuracy: 0.38
step_num: 13600 | loss: 0.7470 | profit rate: 3815855445.2 | accuracy: 0.37
step_num: 13800 | loss: 0.7503 | profit rate: 750996722242.0 | accuracy: 0.38
step_num: 14000 | loss: 0.5272 | profit rate: 55509529688.2 | accuracy: 0.38
step_num: 14200 | loss: 0.5828 | profit rate: 21801622158.2 | accuracy: 0.37
step_num: 14400 | loss: 0.3779 | profit rate: 83781637954.0 | accuracy: 0.35
step_num: 14600 | loss: 0.3665 | profit rate: 1062019938859.4 | accuracy: 0.35
step_num: 14800 | loss: 0.4921 | profit rate:    0.0 | accuracy: 0.20
step_num: 15000 | loss: 0.5413 | profit rate:    0.0 | accuracy: 0.26
step_num: 15200 | loss: 0.5613 | profit rate:    0.0 | accuracy: 0.23
step_num: 15400 | loss: 0.4080 | profit rate:    0.1 | accuracy: 0.22
step_num: 15600 | loss: 0.4254 | profit rate:    0.1 | accuracy: 0.22
step_num: 15800 | loss: 0.5454 | profit rate: 3582.0 | accuracy: 0.31
step_num: 16000 | loss: 0.7593 | profit rate: 3392.9 | accuracy: 0.31
step_num: 16200 | loss: 0.6558 | profit rate: 12916.7 | accuracy: 0.30
step_num: 16400 | loss: 0.5217 | profit rate:    7.5 | accuracy: 0.30
step_num: 16600 | loss: 0.6203 | profit rate:    2.7 | accuracy: 0.32
step_num: 16800 | loss: 0.6488 | profit rate:  364.8 | accuracy: 0.34
step_num: 17000 | loss: 0.7953 | profit rate: 1198551516.0 | accuracy: 0.38
step_num: 17200 | loss: 0.8176 | profit rate: 330171654.8 | accuracy: 0.38
step_num: 17400 | loss: 0.7586 | profit rate: 404558853.6 | accuracy: 0.38
step_num: 17600 | loss: 0.6339 | profit rate: 2067109751.2 | accuracy: 0.38
step_num: 17800 | loss: 0.6207 | profit rate: 517289592.0 | accuracy: 0.37
step_num: 18000 | loss: 0.4828 | profit rate: 6195172198.6 | accuracy: 0.36
step_num: 18200 | loss: 0.4230 | profit rate: 9808238036.4 | accuracy: 0.35
episode:   5/5,耗时:0.70分/3.41分,训练集: | step: 18340 | average_treward:  250.6 | max_treward: 358.8549 | average profit rate: 2313686770873.913
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 24%|       | 94/397 [00:00<00:00, 936.55it/s] 51%|    | 204/397 [00:00<00:00, 1015.15it/s] 80%|  | 316/397 [00:00<00:00, 1057.77it/s]100%|| 397/397 [00:00<00:00, 1060.01it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1297.45
2023-07-24T12:00:00 | net performance [%] = 29.7450
2023-07-24T12:00:00 | number of trades [#] = 20
==================================================
Trial 28 Complete [00h 03m 28s]
net_wealth: 1298.7484447440493

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 39m 03s

Search: Running Trial #29

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
8                 |5                 |lags
0.95              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.1070 | profit rate:    0.3 | accuracy: 0.38
step_num: 400 | loss: 1.0166 | profit rate:    0.1 | accuracy: 0.36
step_num: 600 | loss: 0.6912 | profit rate:    0.1 | accuracy: 0.39
step_num: 800 | loss: 0.8811 | profit rate:    0.0 | accuracy: 0.37
step_num: 1000 | loss: 1.5153 | profit rate:    0.0 | accuracy: 0.36
step_num: 1200 | loss: 1.3069 | profit rate:    0.0 | accuracy: 0.33
step_num: 1400 | loss: 1.0074 | profit rate:    0.0 | accuracy: 0.35
step_num: 1600 | loss: 0.7297 | profit rate:    0.0 | accuracy: 0.35
step_num: 1800 | loss: 0.8406 | profit rate:    0.0 | accuracy: 0.36
step_num: 2000 | loss: 0.7411 | profit rate:    0.0 | accuracy: 0.36
step_num: 2200 | loss: 0.9836 | profit rate:    0.0 | accuracy: 0.35
step_num: 2400 | loss: 0.8629 | profit rate:    0.0 | accuracy: 0.34
step_num: 2600 | loss: 0.9012 | profit rate:    0.0 | accuracy: 0.34
step_num: 2800 | loss: 0.8284 | profit rate:    0.0 | accuracy: 0.34
step_num: 3000 | loss: 0.9095 | profit rate:    0.0 | accuracy: 0.35
step_num: 3200 | loss: 0.5813 | profit rate:    0.0 | accuracy: 0.35
step_num: 3400 | loss: 0.9553 | profit rate:    0.0 | accuracy: 0.35
step_num: 3600 | loss: 0.8816 | profit rate:    0.0 | accuracy: 0.36
episode:   1/5,耗时:0.47分/0.47分,训练集: | step: 3705 | average_treward:  -17.5 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3800 | loss: 0.6496 | profit rate:    9.8 | accuracy: 0.20
step_num: 4000 | loss: 0.8246 | profit rate:    3.7 | accuracy: 0.36
step_num: 4200 | loss: 0.8411 | profit rate:    0.3 | accuracy: 0.38
step_num: 4400 | loss: 0.8733 | profit rate:    0.1 | accuracy: 0.40
step_num: 4600 | loss: 0.8110 | profit rate:    0.2 | accuracy: 0.40
step_num: 4800 | loss: 0.9127 | profit rate:    0.0 | accuracy: 0.36
step_num: 5000 | loss: 0.5997 | profit rate:    0.0 | accuracy: 0.35
step_num: 5200 | loss: 0.6528 | profit rate:    0.0 | accuracy: 0.36
step_num: 5400 | loss: 0.9869 | profit rate:    0.0 | accuracy: 0.35
step_num: 5600 | loss: 0.6168 | profit rate:    0.0 | accuracy: 0.37
step_num: 5800 | loss: 0.6489 | profit rate:    0.0 | accuracy: 0.37
step_num: 6000 | loss: 0.7181 | profit rate:    0.0 | accuracy: 0.35
step_num: 6200 | loss: 0.7701 | profit rate:    0.0 | accuracy: 0.34
step_num: 6400 | loss: 0.9965 | profit rate:    0.0 | accuracy: 0.35
step_num: 6600 | loss: 0.5721 | profit rate:    0.0 | accuracy: 0.35
step_num: 6800 | loss: 0.8741 | profit rate:    0.0 | accuracy: 0.35
step_num: 7000 | loss: 0.9649 | profit rate:    0.0 | accuracy: 0.36
step_num: 7200 | loss: 0.5553 | profit rate:    0.0 | accuracy: 0.36
step_num: 7400 | loss: 0.7093 | profit rate:    0.0 | accuracy: 0.36
step_num: 7600 | loss: 1.0218 | profit rate:    0.6 | accuracy: 0.23
step_num: 7800 | loss: 0.7591 | profit rate:    0.3 | accuracy: 0.37
step_num: 8000 | loss: 0.6973 | profit rate:    0.4 | accuracy: 0.40
step_num: 8200 | loss: 0.7928 | profit rate:    0.1 | accuracy: 0.39
step_num: 8400 | loss: 0.6449 | profit rate:    0.0 | accuracy: 0.38
step_num: 8600 | loss: 0.4245 | profit rate:    0.0 | accuracy: 0.34
step_num: 8800 | loss: 0.8886 | profit rate:    0.0 | accuracy: 0.36
step_num: 9000 | loss: 0.4425 | profit rate:    0.0 | accuracy: 0.36
step_num: 9200 | loss: 0.8151 | profit rate:    0.0 | accuracy: 0.36
step_num: 9400 | loss: 0.4380 | profit rate:    0.0 | accuracy: 0.37
step_num: 9600 | loss: 0.4553 | profit rate:    0.0 | accuracy: 0.36
step_num: 9800 | loss: 0.6797 | profit rate:    0.0 | accuracy: 0.34
step_num: 10000 | loss: 0.8689 | profit rate:    0.0 | accuracy: 0.34
step_num: 10200 | loss: 0.8599 | profit rate:    0.0 | accuracy: 0.35
step_num: 10400 | loss: 0.7223 | profit rate:    0.0 | accuracy: 0.35
step_num: 10600 | loss: 0.5900 | profit rate:    0.0 | accuracy: 0.36
step_num: 10800 | loss: 0.8643 | profit rate:    0.0 | accuracy: 0.35
step_num: 11000 | loss: 0.5951 | profit rate:    0.0 | accuracy: 0.36
episode:   3/5,耗时:0.49分/1.46分,训练集: | step: 11115 | average_treward:  -15.7 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 11200 | loss: 0.5170 | profit rate:    6.5 | accuracy: 0.17
step_num: 11400 | loss: 0.7593 | profit rate:    2.3 | accuracy: 0.35
step_num: 11600 | loss: 0.9309 | profit rate:    0.2 | accuracy: 0.37
step_num: 11800 | loss: 0.8735 | profit rate:    0.1 | accuracy: 0.40
step_num: 12000 | loss: 0.6602 | profit rate:    0.1 | accuracy: 0.40
step_num: 12200 | loss: 0.4966 | profit rate:    0.0 | accuracy: 0.35
step_num: 12400 | loss: 0.6573 | profit rate:    0.0 | accuracy: 0.35
step_num: 12600 | loss: 0.7463 | profit rate:    0.0 | accuracy: 0.36
step_num: 12800 | loss: 0.5800 | profit rate:    0.0 | accuracy: 0.35
step_num: 13000 | loss: 0.5020 | profit rate:    0.0 | accuracy: 0.36
step_num: 13200 | loss: 0.4725 | profit rate:    0.0 | accuracy: 0.37
step_num: 13400 | loss: 0.9291 | profit rate:    0.0 | accuracy: 0.35
step_num: 13600 | loss: 0.7838 | profit rate:    0.0 | accuracy: 0.34
step_num: 13800 | loss: 0.8077 | profit rate:    0.0 | accuracy: 0.35
step_num: 14000 | loss: 0.5295 | profit rate:    0.0 | accuracy: 0.35
step_num: 14200 | loss: 0.7602 | profit rate:    0.0 | accuracy: 0.35
step_num: 14400 | loss: 0.6860 | profit rate:    0.0 | accuracy: 0.36
step_num: 14600 | loss: 0.7528 | profit rate:    0.0 | accuracy: 0.36
step_num: 14800 | loss: 0.6449 | profit rate:    0.0 | accuracy: 0.36
step_num: 15000 | loss: 0.8609 | profit rate:    1.6 | accuracy: 0.25
step_num: 15200 | loss: 0.7290 | profit rate:    0.4 | accuracy: 0.38
step_num: 15400 | loss: 0.6690 | profit rate:    0.2 | accuracy: 0.39
step_num: 15600 | loss: 0.6706 | profit rate:    0.0 | accuracy: 0.39
step_num: 15800 | loss: 0.7199 | profit rate:    0.0 | accuracy: 0.39
step_num: 16000 | loss: 0.4938 | profit rate:    0.0 | accuracy: 0.34
step_num: 16200 | loss: 0.7482 | profit rate:    0.0 | accuracy: 0.36
step_num: 16400 | loss: 0.5674 | profit rate:    0.0 | accuracy: 0.36
step_num: 16600 | loss: 0.7361 | profit rate:    0.0 | accuracy: 0.36
step_num: 16800 | loss: 0.5693 | profit rate:    0.0 | accuracy: 0.36
step_num: 17000 | loss: 0.5361 | profit rate:    0.0 | accuracy: 0.36
step_num: 17200 | loss: 0.8025 | profit rate:    0.0 | accuracy: 0.34
step_num: 17400 | loss: 0.7990 | profit rate:    0.0 | accuracy: 0.34
step_num: 17600 | loss: 0.6604 | profit rate:    0.0 | accuracy: 0.35
step_num: 17800 | loss: 0.7371 | profit rate:    0.0 | accuracy: 0.35
step_num: 18000 | loss: 0.6209 | profit rate:    0.0 | accuracy: 0.35
step_num: 18200 | loss: 0.8748 | profit rate:    0.0 | accuracy: 0.35
step_num: 18400 | loss: 0.6336 | profit rate:    0.0 | accuracy: 0.36
episode:   5/5,耗时:0.49分/2.44分,训练集: | step: 18525 | average_treward:   -9.5 | max_treward: 13.3524 | average profit rate:  0.000
model saved @ step:18525,performance:0.000,accuracy:0.37
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 23%|       | 92/403 [00:00<00:00, 910.97it/s] 51%|     | 206/403 [00:00<00:00, 1043.83it/s] 80%|  | 322/403 [00:00<00:00, 1091.74it/s]100%|| 403/403 [00:00<00:00, 1074.07it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1097.51
2023-07-24T12:00:00 | net performance [%] = 9.7508
2023-07-24T12:00:00 | number of trades [#] = 62
==================================================
Trial 29 Complete [00h 02m 30s]
net_wealth: 1097.5082331600368

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 41m 33s

Search: Running Trial #30

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
225               |730               |lookback
True              |True              |MarketFactor
7                 |5                 |lags
0.7               |0.6               |gamma
0.001             |5e-05             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.7596 | profit rate:    0.1 | accuracy: 0.29
step_num: 400 | loss: 0.7368 | profit rate:    0.1 | accuracy: 0.31
step_num: 600 | loss: 0.6541 | profit rate:    3.2 | accuracy: 0.35
step_num: 800 | loss: 0.5648 | profit rate:    0.4 | accuracy: 0.33
step_num: 1000 | loss: 0.4179 | profit rate:    0.0 | accuracy: 0.31
step_num: 1200 | loss: 0.6708 | profit rate:    0.0 | accuracy: 0.29
step_num: 1400 | loss: 0.0948 | profit rate:    0.0 | accuracy: 0.27
step_num: 1600 | loss: 0.3472 | profit rate:    0.0 | accuracy: 0.25
step_num: 1800 | loss: 0.2305 | profit rate:    0.0 | accuracy: 0.23
step_num: 2000 | loss: 0.0360 | profit rate:    0.0 | accuracy: 0.22
step_num: 2200 | loss: 0.4516 | profit rate:    0.9 | accuracy: 0.23
step_num: 2400 | loss: 0.6934 | profit rate:  738.1 | accuracy: 0.26
step_num: 2600 | loss: 0.1640 | profit rate:    9.1 | accuracy: 0.26
step_num: 2800 | loss: 0.5110 | profit rate:   34.0 | accuracy: 0.27
step_num: 3000 | loss: 0.4468 | profit rate:    9.1 | accuracy: 0.27
step_num: 3200 | loss: 0.0766 | profit rate:    4.9 | accuracy: 0.26
step_num: 3400 | loss: 0.0359 | profit rate:    4.9 | accuracy: 0.25
step_num: 3600 | loss: 0.1402 | profit rate:    3.7 | accuracy: 0.23
episode:   1/5,耗时:0.51分/0.51分,训练集: | step: 3661 | average_treward:   13.5 | max_treward: 13.4837 | average profit rate:  3.657
model saved @ step:3661,performance:3.657,accuracy:0.23
step_num: 3800 | loss: 0.8844 | profit rate:   41.7 | accuracy: 0.48
step_num: 4000 | loss: 0.0091 | profit rate:  262.5 | accuracy: 0.26
step_num: 4200 | loss: 0.3402 | profit rate: 1065.3 | accuracy: 0.24
step_num: 4400 | loss: 0.2562 | profit rate: 1134.5 | accuracy: 0.21
step_num: 4600 | loss: 1.4652 | profit rate:   24.7 | accuracy: 0.20
step_num: 4800 | loss: 1.0549 | profit rate: 3829.0 | accuracy: 0.25
step_num: 5000 | loss: 0.0893 | profit rate: 1374.2 | accuracy: 0.25
step_num: 5200 | loss: 0.1136 | profit rate: 1520.3 | accuracy: 0.22
step_num: 5400 | loss: 0.0905 | profit rate: 1160.7 | accuracy: 0.20
step_num: 5600 | loss: 0.0934 | profit rate: 1011.2 | accuracy: 0.19
step_num: 5800 | loss: 0.7328 | profit rate:   77.2 | accuracy: 0.18
step_num: 6000 | loss: 0.4760 | profit rate:   35.8 | accuracy: 0.17
step_num: 6200 | loss: 0.1326 | profit rate:   40.9 | accuracy: 0.17
step_num: 6400 | loss: 0.4160 | profit rate:   12.0 | accuracy: 0.16
step_num: 6600 | loss: 0.2416 | profit rate:   17.7 | accuracy: 0.17
step_num: 6800 | loss: 0.0965 | profit rate:   80.1 | accuracy: 0.17
step_num: 7000 | loss: 0.3579 | profit rate:   12.8 | accuracy: 0.16
step_num: 7200 | loss: 0.0393 | profit rate:   13.3 | accuracy: 0.16
step_num: 7400 | loss: 0.2876 | profit rate:    3.5 | accuracy: 0.15
step_num: 7600 | loss: 0.3483 | profit rate:   14.8 | accuracy: 0.17
step_num: 7800 | loss: 0.5065 | profit rate:    3.2 | accuracy: 0.12
step_num: 8000 | loss: 0.0818 | profit rate:    6.2 | accuracy: 0.10
step_num: 8200 | loss: 0.0110 | profit rate:    6.6 | accuracy: 0.08
step_num: 8400 | loss: 0.0103 | profit rate:    2.0 | accuracy: 0.08
step_num: 8600 | loss: 0.0212 | profit rate:    1.7 | accuracy: 0.06
step_num: 8800 | loss: 0.0016 | profit rate:    1.6 | accuracy: 0.06
step_num: 9000 | loss: 0.0024 | profit rate:    0.9 | accuracy: 0.05
step_num: 9200 | loss: 0.0153 | profit rate:    0.9 | accuracy: 0.05
step_num: 9400 | loss: 0.1658 | profit rate:    1.6 | accuracy: 0.05
step_num: 9600 | loss: 0.0577 | profit rate:    1.2 | accuracy: 0.06
step_num: 9800 | loss: 0.5981 | profit rate:    1.3 | accuracy: 0.08
step_num: 10000 | loss: 0.1420 | profit rate:    1.7 | accuracy: 0.09
step_num: 10200 | loss: 0.4093 | profit rate:    2.0 | accuracy: 0.10
step_num: 10400 | loss: 0.1106 | profit rate:    2.1 | accuracy: 0.10
step_num: 10600 | loss: 0.2432 | profit rate:    0.9 | accuracy: 0.10
step_num: 10800 | loss: 0.6046 | profit rate:    2.0 | accuracy: 0.10
episode:   3/5,耗时:0.55分/1.62分,训练集: | step: 10983 | average_treward:   12.0 | max_treward: 45.7557 | average profit rate:  6.321
model saved @ step:10983,performance:2.589,accuracy:0.10
step_num: 11000 | loss: 0.0987 | profit rate:    1.5 | accuracy: 0.33
step_num: 11200 | loss: 0.1268 | profit rate:    3.4 | accuracy: 0.16
step_num: 11400 | loss: 0.0492 | profit rate:    3.1 | accuracy: 0.08
step_num: 11600 | loss: 0.2483 | profit rate:    2.8 | accuracy: 0.07
step_num: 11800 | loss: 0.0568 | profit rate:    2.4 | accuracy: 0.06
step_num: 12000 | loss: 0.0416 | profit rate:    1.5 | accuracy: 0.06
step_num: 12200 | loss: 0.0076 | profit rate:    0.5 | accuracy: 0.05
step_num: 12400 | loss: 0.0048 | profit rate:    0.6 | accuracy: 0.05
step_num: 12600 | loss: 0.1865 | profit rate:    0.9 | accuracy: 0.05
step_num: 12800 | loss: 0.0026 | profit rate:    4.7 | accuracy: 0.05
step_num: 13000 | loss: 0.0890 | profit rate:    7.8 | accuracy: 0.06
step_num: 13200 | loss: 0.5456 | profit rate:   93.6 | accuracy: 0.07
step_num: 13400 | loss: 0.2943 | profit rate:  216.4 | accuracy: 0.08
step_num: 13600 | loss: 0.0689 | profit rate:   20.0 | accuracy: 0.09
step_num: 13800 | loss: 0.3072 | profit rate:  374.6 | accuracy: 0.09
step_num: 14000 | loss: 0.1199 | profit rate:   86.3 | accuracy: 0.09
step_num: 14200 | loss: 0.2122 | profit rate:   94.4 | accuracy: 0.09
step_num: 14400 | loss: 0.5047 | profit rate:  828.7 | accuracy: 0.10
step_num: 14600 | loss: 0.1524 | profit rate: 1317.7 | accuracy: 0.11
model saved @ step:14644,performance:1558.478,accuracy:0.11
step_num: 14800 | loss: 0.5235 | profit rate:   11.8 | accuracy: 0.22
step_num: 15000 | loss: 0.0044 | profit rate:    8.4 | accuracy: 0.13
step_num: 15200 | loss: 0.0592 | profit rate:    7.6 | accuracy: 0.10
step_num: 15400 | loss: 0.0328 | profit rate:    6.7 | accuracy: 0.09
step_num: 15600 | loss: 0.4540 | profit rate:    6.9 | accuracy: 0.10
step_num: 15800 | loss: 0.5367 | profit rate:   65.1 | accuracy: 0.14
step_num: 16000 | loss: 0.0107 | profit rate:  116.6 | accuracy: 0.12
step_num: 16200 | loss: 0.0034 | profit rate:  116.6 | accuracy: 0.11
step_num: 16400 | loss: 0.0052 | profit rate:  116.6 | accuracy: 0.10
step_num: 16600 | loss: 0.0046 | profit rate:   98.5 | accuracy: 0.09
step_num: 16800 | loss: 0.0502 | profit rate:  114.0 | accuracy: 0.08
step_num: 17000 | loss: 0.1741 | profit rate: 4165.1 | accuracy: 0.09
step_num: 17200 | loss: 0.0201 | profit rate: 1063.5 | accuracy: 0.10
step_num: 17400 | loss: 0.1407 | profit rate: 3248.4 | accuracy: 0.10
step_num: 17600 | loss: 0.0374 | profit rate: 2597.1 | accuracy: 0.10
step_num: 17800 | loss: 0.0016 | profit rate: 2846.3 | accuracy: 0.09
step_num: 18000 | loss: 0.2647 | profit rate: 5693.1 | accuracy: 0.09
step_num: 18200 | loss: 0.0865 | profit rate: 39249.4 | accuracy: 0.10
episode:   5/5,耗时:0.57分/2.76分,训练集: | step: 18305 | average_treward:   67.4 | max_treward: 155.4584 | average profit rate: 6212.783
model saved @ step:18305,performance:29486.474,accuracy:0.10
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 24%|       | 95/404 [00:00<00:00, 950.00it/s] 52%|    | 211/404 [00:00<00:00, 1072.60it/s] 80%|  | 324/404 [00:00<00:00, 1098.80it/s]100%|| 404/404 [00:00<00:00, 1088.52it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1329.69
2023-07-24T12:00:00 | net performance [%] = 32.9689
2023-07-24T12:00:00 | number of trades [#] = 16
==================================================
Trial 30 Complete [00h 02m 49s]
net_wealth: 1331.0197153732888

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 44m 23s

Search: Running Trial #31

Value             |Best Value So Far |Hyperparameter
6                 |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
8                 |5                 |lags
0.95              |0.6               |gamma
5e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4295.000000   4301.000000
mean      0.000435    20113.607657  ...   20191.527960  20169.373185
std       0.027833    16040.642334  ...   16078.872271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7755.915039   7730.930176
50%       0.000642    11571.842969  ...   11757.219727  11751.469727
75%       0.011590    29894.706152  ...   30018.430664  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.6095 | profit rate:    4.8 | accuracy: 0.35
step_num: 1200 | loss: 0.6922 | profit rate:    6.7 | accuracy: 0.35
step_num: 1400 | loss: 0.6523 | profit rate:    9.2 | accuracy: 0.34
step_num: 1600 | loss: 0.6505 | profit rate:   16.5 | accuracy: 0.34
step_num: 1800 | loss: 0.5685 | profit rate:    3.2 | accuracy: 0.34
step_num: 2000 | loss: 0.5734 | profit rate:    1.5 | accuracy: 0.33
step_num: 2200 | loss: 0.4954 | profit rate:   13.7 | accuracy: 0.34
step_num: 2400 | loss: 0.5252 | profit rate:  243.4 | accuracy: 0.35
step_num: 2600 | loss: 0.5162 | profit rate:  161.7 | accuracy: 0.35
step_num: 2800 | loss: 0.4979 | profit rate:  137.2 | accuracy: 0.34
step_num: 3000 | loss: 0.4983 | profit rate:   91.8 | accuracy: 0.34
step_num: 3200 | loss: 0.4873 | profit rate:   78.0 | accuracy: 0.34
step_num: 3400 | loss: 0.4572 | profit rate:   24.3 | accuracy: 0.34
step_num: 3600 | loss: 0.4772 | profit rate:   21.3 | accuracy: 0.34
episode:   1/5,耗时:1.69分/1.69分,训练集: | step: 3705 | average_treward:   90.2 | max_treward: 90.1723 | average profit rate: 20.790
model saved @ step:3705,performance:20.790,accuracy:0.33
step_num: 3800 | loss: 0.4648 | profit rate:    0.7 | accuracy: 0.40
step_num: 4000 | loss: 0.4679 | profit rate:    0.5 | accuracy: 0.27
step_num: 4200 | loss: 0.4571 | profit rate:    0.2 | accuracy: 0.25
step_num: 4400 | loss: 0.4323 | profit rate:    0.7 | accuracy: 0.25
step_num: 4600 | loss: 0.3949 | profit rate:    0.8 | accuracy: 0.24
step_num: 4800 | loss: 0.4114 | profit rate:    0.6 | accuracy: 0.26
step_num: 5000 | loss: 0.3938 | profit rate:    0.4 | accuracy: 0.25
step_num: 5200 | loss: 0.3750 | profit rate:    0.9 | accuracy: 0.25
step_num: 5400 | loss: 0.3695 | profit rate:    2.0 | accuracy: 0.25
step_num: 5600 | loss: 0.3240 | profit rate:    0.8 | accuracy: 0.24
step_num: 5800 | loss: 0.3087 | profit rate:    0.5 | accuracy: 0.23
step_num: 6000 | loss: 0.3203 | profit rate:    9.7 | accuracy: 0.25
step_num: 6200 | loss: 0.3027 | profit rate:   90.8 | accuracy: 0.25
step_num: 6400 | loss: 0.3210 | profit rate:  128.3 | accuracy: 0.25
step_num: 6600 | loss: 0.3541 | profit rate: 1745.8 | accuracy: 0.25
step_num: 6800 | loss: 0.3368 | profit rate:  255.7 | accuracy: 0.25
step_num: 7000 | loss: 0.3406 | profit rate:  244.5 | accuracy: 0.26
step_num: 7200 | loss: 0.3332 | profit rate:  250.4 | accuracy: 0.26
step_num: 7400 | loss: 0.3282 | profit rate:  190.1 | accuracy: 0.26
model saved @ step:7410,performance:192.471,accuracy:0.26
step_num: 7600 | loss: 0.3526 | profit rate:   11.8 | accuracy: 0.32
step_num: 7800 | loss: 0.3965 | profit rate:   35.5 | accuracy: 0.30
step_num: 8000 | loss: 0.3825 | profit rate:   33.1 | accuracy: 0.30
step_num: 8200 | loss: 0.3865 | profit rate:   64.4 | accuracy: 0.29
step_num: 8400 | loss: 0.3836 | profit rate:  104.1 | accuracy: 0.30
step_num: 8600 | loss: 0.4040 | profit rate:  206.4 | accuracy: 0.31
step_num: 8800 | loss: 0.3753 | profit rate:  298.2 | accuracy: 0.30
step_num: 9000 | loss: 0.3769 | profit rate:  734.4 | accuracy: 0.31
step_num: 9200 | loss: 0.3895 | profit rate: 5219.8 | accuracy: 0.31
step_num: 9400 | loss: 0.3768 | profit rate: 2149.2 | accuracy: 0.30
step_num: 9600 | loss: 0.3838 | profit rate: 37911.7 | accuracy: 0.31
step_num: 9800 | loss: 0.4194 | profit rate: 31335123.1 | accuracy: 0.33
step_num: 10000 | loss: 0.4129 | profit rate: 57307350.7 | accuracy: 0.33
step_num: 10200 | loss: 0.4041 | profit rate: 107222043.5 | accuracy: 0.33
step_num: 10400 | loss: 0.4213 | profit rate: 152924345.8 | accuracy: 0.33
step_num: 10600 | loss: 0.4282 | profit rate: 157200742.4 | accuracy: 0.34
step_num: 10800 | loss: 0.4171 | profit rate: 418687801.7 | accuracy: 0.34
step_num: 11000 | loss: 0.4080 | profit rate: 1590591485.0 | accuracy: 0.34
episode:   3/5,耗时:2.37分/6.34分,训练集: | step: 11115 | average_treward:  270.5 | max_treward: 498.0522 | average profit rate: 809418040.666
model saved @ step:11115,performance:2428253908.737,accuracy:0.33
step_num: 11200 | loss: 0.4283 | profit rate:   14.0 | accuracy: 0.47
step_num: 11400 | loss: 0.4568 | profit rate:   15.9 | accuracy: 0.35
step_num: 11600 | loss: 0.4637 | profit rate:   22.8 | accuracy: 0.33
step_num: 11800 | loss: 0.4454 | profit rate:   41.2 | accuracy: 0.31
step_num: 12000 | loss: 0.4554 | profit rate:   69.0 | accuracy: 0.31
step_num: 12200 | loss: 0.4407 | profit rate:  162.7 | accuracy: 0.33
step_num: 12400 | loss: 0.4076 | profit rate:  136.2 | accuracy: 0.32
step_num: 12600 | loss: 0.4098 | profit rate:  472.8 | accuracy: 0.32
step_num: 12800 | loss: 0.3942 | profit rate: 8453.8 | accuracy: 0.32
step_num: 13000 | loss: 0.3798 | profit rate: 5850.1 | accuracy: 0.31
step_num: 13200 | loss: 0.3626 | profit rate: 5587.7 | accuracy: 0.31
step_num: 13400 | loss: 0.4109 | profit rate: 2130046.6 | accuracy: 0.34
step_num: 13600 | loss: 0.3959 | profit rate: 157381935.2 | accuracy: 0.34
step_num: 13800 | loss: 0.4040 | profit rate: 542798950.6 | accuracy: 0.34
step_num: 14000 | loss: 0.4085 | profit rate: 6218815698.3 | accuracy: 0.34
step_num: 14200 | loss: 0.4006 | profit rate: 3228730634.7 | accuracy: 0.34
step_num: 14400 | loss: 0.4094 | profit rate: 12897833497.9 | accuracy: 0.34
step_num: 14600 | loss: 0.4533 | profit rate: 24598317678.1 | accuracy: 0.34
step_num: 14800 | loss: 0.4019 | profit rate: 110754006808.1 | accuracy: 0.34
model saved @ step:14820,performance:114323676857.443,accuracy:0.34
step_num: 15000 | loss: 0.4362 | profit rate:   51.0 | accuracy: 0.43
step_num: 15200 | loss: 0.4565 | profit rate:  351.7 | accuracy: 0.39
step_num: 15400 | loss: 0.4444 | profit rate:  672.4 | accuracy: 0.38
step_num: 15600 | loss: 0.4680 | profit rate:  493.8 | accuracy: 0.36
step_num: 15800 | loss: 0.4619 | profit rate:  302.3 | accuracy: 0.35
step_num: 16000 | loss: 0.4659 | profit rate:  678.4 | accuracy: 0.38
step_num: 16200 | loss: 0.4465 | profit rate:  792.2 | accuracy: 0.36
step_num: 16400 | loss: 0.4472 | profit rate: 2691.1 | accuracy: 0.37
step_num: 16600 | loss: 0.4505 | profit rate: 86053.4 | accuracy: 0.37
step_num: 16800 | loss: 0.4722 | profit rate: 55355.3 | accuracy: 0.36
step_num: 17000 | loss: 0.4451 | profit rate: 1950714.1 | accuracy: 0.37
step_num: 17200 | loss: 0.4518 | profit rate: 760033359.4 | accuracy: 0.38
step_num: 17400 | loss: 0.4370 | profit rate: 11372314936.3 | accuracy: 0.38
step_num: 17600 | loss: 0.4399 | profit rate: 22641205892.5 | accuracy: 0.37
step_num: 17800 | loss: 0.4619 | profit rate: 151234458653.1 | accuracy: 0.37
step_num: 18000 | loss: 0.3995 | profit rate: 142549029573.9 | accuracy: 0.36
step_num: 18200 | loss: 0.4361 | profit rate: 1189760787740.4 | accuracy: 0.37
step_num: 18400 | loss: 0.4373 | profit rate: 3817225704504.5 | accuracy: 0.37
episode:   5/5,耗时:2.32分/11.02分,训练集: | step: 18525 | average_treward:  422.3 | max_treward: 689.7392 | average profit rate: 2501180932946.085
model saved @ step:18525,performance:12389152733750.982,accuracy:0.37
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 27%|       | 107/403 [00:00<00:00, 1061.93it/s] 55%|    | 222/403 [00:00<00:00, 1113.57it/s] 84%| | 338/403 [00:00<00:00, 1132.70it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
100%|| 403/403 [00:00<00:00, 1126.40it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 779.95
2023-07-24T12:00:00 | net performance [%] = -22.0053
2023-07-24T12:00:00 | number of trades [#] = 44
==================================================
Trial 31 Complete [00h 11m 04s]
net_wealth: 780.7281236607195

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 55m 27s

Search: Running Trial #32

Value             |Best Value So Far |Hyperparameter
15                |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
14                |5                 |lags
0.8               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4300.000000   4315.000000
mean      0.000441    20062.255222  ...   20173.020481  20118.633889
std       0.027818    16039.874230  ...   16078.674434  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7736.967529   7690.540039
50%       0.000642    11554.824463  ...   11753.029785  11715.610352
75%       0.011655    29873.081836  ...   30013.548340  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.7370 | profit rate:    0.8 | accuracy: 0.31
step_num: 400 | loss: 0.6782 | profit rate:    1.7 | accuracy: 0.32
step_num: 600 | loss: 0.7183 | profit rate:    2.6 | accuracy: 0.34
step_num: 800 | loss: 0.5444 | profit rate:    0.6 | accuracy: 0.32
step_num: 1000 | loss: 0.6122 | profit rate:    0.4 | accuracy: 0.32
step_num: 1200 | loss: 0.7671 | profit rate:    0.0 | accuracy: 0.32
step_num: 1400 | loss: 0.5919 | profit rate:    0.0 | accuracy: 0.32
step_num: 1600 | loss: 0.5826 | profit rate:    0.0 | accuracy: 0.31
step_num: 1800 | loss: 0.4994 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.7068 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.6523 | profit rate:    0.0 | accuracy: 0.31
step_num: 2400 | loss: 0.7354 | profit rate:    0.0 | accuracy: 0.32
step_num: 2600 | loss: 0.5005 | profit rate:    0.0 | accuracy: 0.32
step_num: 2800 | loss: 0.4129 | profit rate:    0.0 | accuracy: 0.31
step_num: 3000 | loss: 0.4361 | profit rate:    0.0 | accuracy: 0.30
step_num: 3200 | loss: 0.3757 | profit rate:    0.0 | accuracy: 0.30
step_num: 3400 | loss: 0.1050 | profit rate:    0.0 | accuracy: 0.29
episode:   1/5,耗时:0.85分/0.85分,训练集: | step: 3528 | average_treward: -312.3 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3600 | loss: 0.2427 | profit rate:    1.0 | accuracy: 0.23
step_num: 3800 | loss: 0.2029 | profit rate:    0.6 | accuracy: 0.09
step_num: 4000 | loss: 0.0918 | profit rate:    0.4 | accuracy: 0.06
step_num: 4200 | loss: 0.1283 | profit rate:    3.2 | accuracy: 0.08
step_num: 4400 | loss: 0.1536 | profit rate:  163.0 | accuracy: 0.10
step_num: 4600 | loss: 0.7790 | profit rate: 6537.3 | accuracy: 0.17
step_num: 4800 | loss: 0.6155 | profit rate:  162.4 | accuracy: 0.18
step_num: 5000 | loss: 0.1727 | profit rate:  485.8 | accuracy: 0.16
step_num: 5200 | loss: 0.2385 | profit rate:  189.2 | accuracy: 0.16
step_num: 5400 | loss: 0.1973 | profit rate:  145.5 | accuracy: 0.16
step_num: 5600 | loss: 0.4527 | profit rate: 72609930.9 | accuracy: 0.19
step_num: 5800 | loss: 0.8157 | profit rate: 91705874664.3 | accuracy: 0.23
step_num: 6000 | loss: 0.6574 | profit rate: 178854730.1 | accuracy: 0.24
step_num: 6200 | loss: 0.2027 | profit rate: 523210287.3 | accuracy: 0.23
step_num: 6400 | loss: 0.5776 | profit rate: 8321344.2 | accuracy: 0.23
step_num: 6600 | loss: 0.1118 | profit rate: 15580202.7 | accuracy: 0.22
step_num: 6800 | loss: 0.0083 | profit rate: 15580202.7 | accuracy: 0.21
step_num: 7000 | loss: 0.0191 | profit rate: 17335411.2 | accuracy: 0.20
model saved @ step:7056,performance:17099711.756,accuracy:0.19
step_num: 7200 | loss: 0.0011 | profit rate:    1.3 | accuracy: 0.01
step_num: 7400 | loss: 0.0062 | profit rate:    1.2 | accuracy: 0.01
step_num: 7600 | loss: 0.0253 | profit rate:    0.9 | accuracy: 0.01
step_num: 7800 | loss: 0.0295 | profit rate:    1.0 | accuracy: 0.02
step_num: 8000 | loss: 0.4610 | profit rate: 45476.9 | accuracy: 0.13
step_num: 8200 | loss: 0.9718 | profit rate: 12285.1 | accuracy: 0.18
step_num: 8400 | loss: 0.2574 | profit rate: 9278.9 | accuracy: 0.16
step_num: 8600 | loss: 0.2886 | profit rate: 42022185.9 | accuracy: 0.17
step_num: 8800 | loss: 0.4400 | profit rate: 21930474.1 | accuracy: 0.20
step_num: 9000 | loss: 0.6995 | profit rate: 4183835.3 | accuracy: 0.22
step_num: 9200 | loss: 0.7452 | profit rate: 127825268544.0 | accuracy: 0.26
step_num: 9400 | loss: 0.9581 | profit rate: 21254945166.6 | accuracy: 0.28
step_num: 9600 | loss: 0.2925 | profit rate: 22424494476.8 | accuracy: 0.27
step_num: 9800 | loss: 0.4479 | profit rate: 60977323834.3 | accuracy: 0.27
step_num: 10000 | loss: 0.3755 | profit rate: 130535177941.3 | accuracy: 0.27
step_num: 10200 | loss: 0.1195 | profit rate: 402796422428.2 | accuracy: 0.26
step_num: 10400 | loss: 0.0804 | profit rate: 308501775806.1 | accuracy: 0.24
episode:   3/5,耗时:0.88分/2.60分,训练集: | step: 10584 | average_treward:   55.2 | max_treward: 314.6742 | average profit rate: 136046356902.501
model saved @ step:10584,performance:408121970995.747,accuracy:0.24
step_num: 10600 | loss: 0.0994 | profit rate:    0.3 | accuracy: 0.06
step_num: 10800 | loss: 0.1366 | profit rate:    0.3 | accuracy: 0.05
step_num: 11000 | loss: 0.1101 | profit rate:    0.0 | accuracy: 0.03
step_num: 11200 | loss: 0.0982 | profit rate:    0.1 | accuracy: 0.04
step_num: 11400 | loss: 0.0855 | profit rate:    0.1 | accuracy: 0.06
step_num: 11600 | loss: 0.9223 | profit rate: 1974.4 | accuracy: 0.17
step_num: 11800 | loss: 0.6553 | profit rate: 2082.6 | accuracy: 0.19
step_num: 12000 | loss: 0.1257 | profit rate: 1230.4 | accuracy: 0.17
step_num: 12200 | loss: 0.4373 | profit rate: 2995065.5 | accuracy: 0.19
step_num: 12400 | loss: 0.5471 | profit rate: 907380.7 | accuracy: 0.23
step_num: 12600 | loss: 0.6097 | profit rate: 1932529.8 | accuracy: 0.25
step_num: 12800 | loss: 0.7517 | profit rate: 467764356450.7 | accuracy: 0.29
step_num: 13000 | loss: 0.7645 | profit rate: 5445231284.0 | accuracy: 0.30
step_num: 13200 | loss: 0.1183 | profit rate: 5234876668.6 | accuracy: 0.28
step_num: 13400 | loss: 0.4932 | profit rate: 24437556985.6 | accuracy: 0.29
step_num: 13600 | loss: 0.1430 | profit rate: 92336134058.1 | accuracy: 0.27
step_num: 13800 | loss: 0.0940 | profit rate: 120230853343.3 | accuracy: 0.26
step_num: 14000 | loss: 0.0561 | profit rate: 135062236121.4 | accuracy: 0.25
step_num: 14200 | loss: 0.1175 | profit rate:    1.1 | accuracy: 0.15
step_num: 14400 | loss: 0.0705 | profit rate:    0.7 | accuracy: 0.05
step_num: 14600 | loss: 0.1770 | profit rate:    0.1 | accuracy: 0.05
step_num: 14800 | loss: 0.0782 | profit rate:    0.7 | accuracy: 0.06
step_num: 15000 | loss: 0.2272 | profit rate:  258.5 | accuracy: 0.12
step_num: 15200 | loss: 1.0033 | profit rate: 16631.7 | accuracy: 0.19
step_num: 15400 | loss: 0.4264 | profit rate: 3967.4 | accuracy: 0.19
step_num: 15600 | loss: 0.3285 | profit rate: 910389.0 | accuracy: 0.18
step_num: 15800 | loss: 0.4934 | profit rate: 1052293.5 | accuracy: 0.20
step_num: 16000 | loss: 0.5447 | profit rate: 1493518.2 | accuracy: 0.23
step_num: 16200 | loss: 0.6130 | profit rate: 521454156.6 | accuracy: 0.26
step_num: 16400 | loss: 0.8961 | profit rate: 11126223216.4 | accuracy: 0.28
step_num: 16600 | loss: 0.3610 | profit rate: 355148250.1 | accuracy: 0.27
step_num: 16800 | loss: 0.2026 | profit rate: 5803939810.9 | accuracy: 0.28
step_num: 17000 | loss: 0.4579 | profit rate: 1195386272.8 | accuracy: 0.27
step_num: 17200 | loss: 0.1400 | profit rate: 3314242678.9 | accuracy: 0.26
step_num: 17400 | loss: 0.0940 | profit rate: 2602136745.2 | accuracy: 0.25
step_num: 17600 | loss: 0.0477 | profit rate: 4473939979.2 | accuracy: 0.24
episode:   5/5,耗时:0.86分/4.35分,训练集: | step: 17640 | average_treward:  142.6 | max_treward: 314.6742 | average profit rate: 116535187480.129
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 27%|       | 108/397 [00:00<00:00, 1069.31it/s] 56%|    | 222/397 [00:00<00:00, 1097.86it/s] 84%| | 333/397 [00:00<00:00, 1098.38it/s]100%|| 397/397 [00:00<00:00, 1108.94it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1212.89
2023-07-24T12:00:00 | net performance [%] = 21.2894
2023-07-24T12:00:00 | number of trades [#] = 32
==================================================
Trial 32 Complete [00h 04m 24s]
net_wealth: 1214.108085877268

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 03h 59m 51s

Search: Running Trial #33

Value             |Best Value So Far |Hyperparameter
2                 |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
14                |5                 |lags
0.5               |0.6               |gamma
0.0001            |5e-05             |DQN_lr
256               |64                |memory_size
64                |16                |batch_size
0.5               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4313.000000   4315.000000
mean      0.000441    20062.255222  ...   20125.961477  20118.633889
std       0.027818    16039.874230  ...   16077.223335  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7693.100098   7690.540039
50%       0.000642    11554.824463  ...   11733.030273  11715.610352
75%       0.011655    29873.081836  ...   29928.000000  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.5492 | profit rate:    0.5 | accuracy: 0.22
step_num: 400 | loss: 0.4515 | profit rate:    0.3 | accuracy: 0.25
step_num: 600 | loss: 0.4605 | profit rate:    0.5 | accuracy: 0.28
step_num: 800 | loss: 0.5468 | profit rate:    0.4 | accuracy: 0.29
step_num: 1000 | loss: 0.6021 | profit rate:    0.8 | accuracy: 0.31
step_num: 1200 | loss: 0.5120 | profit rate:    0.8 | accuracy: 0.32
step_num: 1400 | loss: 0.3754 | profit rate:    1.1 | accuracy: 0.32
step_num: 1600 | loss: 0.5078 | profit rate:    0.6 | accuracy: 0.32
step_num: 1800 | loss: 0.3116 | profit rate:    0.6 | accuracy: 0.31
step_num: 2000 | loss: 0.3119 | profit rate:    0.9 | accuracy: 0.32
step_num: 2200 | loss: 0.4984 | profit rate:    6.1 | accuracy: 0.33
step_num: 2400 | loss: 0.4519 | profit rate:    5.5 | accuracy: 0.33
step_num: 2600 | loss: 0.4575 | profit rate:    7.1 | accuracy: 0.33
step_num: 2800 | loss: 0.3727 | profit rate:    6.8 | accuracy: 0.34
step_num: 3000 | loss: 0.4303 | profit rate:    3.0 | accuracy: 0.34
step_num: 3200 | loss: 0.4430 | profit rate:    2.7 | accuracy: 0.34
step_num: 3400 | loss: 0.3241 | profit rate:    2.4 | accuracy: 0.34
episode:   1/5,耗时:0.48分/0.48分,训练集: | step: 3528 | average_treward:   38.9 | max_treward: 38.9001 | average profit rate:  1.786
model saved @ step:3528,performance:1.786,accuracy:0.33
step_num: 3600 | loss: 0.2963 | profit rate:    0.6 | accuracy: 0.12
step_num: 3800 | loss: 0.1040 | profit rate:    0.4 | accuracy: 0.09
step_num: 4000 | loss: 0.1470 | profit rate:    0.5 | accuracy: 0.11
step_num: 4200 | loss: 0.2207 | profit rate:    0.6 | accuracy: 0.16
step_num: 4400 | loss: 0.3068 | profit rate:    1.2 | accuracy: 0.20
step_num: 4600 | loss: 0.6203 | profit rate:    1.4 | accuracy: 0.25
step_num: 4800 | loss: 0.3379 | profit rate:    0.6 | accuracy: 0.25
step_num: 5000 | loss: 0.2082 | profit rate:    0.6 | accuracy: 0.24
step_num: 5200 | loss: 0.2960 | profit rate:    0.4 | accuracy: 0.24
step_num: 5400 | loss: 0.0420 | profit rate:    0.4 | accuracy: 0.22
step_num: 5600 | loss: 0.1574 | profit rate:    1.2 | accuracy: 0.22
step_num: 5800 | loss: 0.4107 | profit rate:    2.6 | accuracy: 0.24
step_num: 6000 | loss: 0.3252 | profit rate:    2.5 | accuracy: 0.24
step_num: 6200 | loss: 0.2836 | profit rate:    4.3 | accuracy: 0.24
step_num: 6400 | loss: 0.3490 | profit rate:    2.7 | accuracy: 0.24
step_num: 6600 | loss: 0.2860 | profit rate:    2.8 | accuracy: 0.24
step_num: 6800 | loss: 0.2157 | profit rate:    2.6 | accuracy: 0.24
step_num: 7000 | loss: 0.2347 | profit rate:    2.5 | accuracy: 0.24
model saved @ step:7056,performance:2.765,accuracy:0.24
step_num: 7200 | loss: 0.2004 | profit rate:    0.7 | accuracy: 0.10
step_num: 7400 | loss: 0.2123 | profit rate:    1.1 | accuracy: 0.15
step_num: 7600 | loss: 0.1947 | profit rate:    1.9 | accuracy: 0.19
step_num: 7800 | loss: 0.2838 | profit rate:    1.8 | accuracy: 0.22
step_num: 8000 | loss: 0.3849 | profit rate:    2.5 | accuracy: 0.26
step_num: 8200 | loss: 0.4467 | profit rate:    2.2 | accuracy: 0.27
step_num: 8400 | loss: 0.1332 | profit rate:    2.3 | accuracy: 0.25
step_num: 8600 | loss: 0.1683 | profit rate:    3.3 | accuracy: 0.24
step_num: 8800 | loss: 0.1152 | profit rate:    3.5 | accuracy: 0.23
step_num: 9000 | loss: 0.0239 | profit rate:    3.5 | accuracy: 0.21
step_num: 9200 | loss: 0.3444 | profit rate:   21.4 | accuracy: 0.24
step_num: 9400 | loss: 0.5281 | profit rate:   17.4 | accuracy: 0.25
step_num: 9600 | loss: 0.3965 | profit rate:   38.8 | accuracy: 0.26
step_num: 9800 | loss: 0.3058 | profit rate:   47.9 | accuracy: 0.26
step_num: 10000 | loss: 0.3075 | profit rate:   39.6 | accuracy: 0.26
step_num: 10200 | loss: 0.1982 | profit rate:   38.1 | accuracy: 0.25
step_num: 10400 | loss: 0.1638 | profit rate:   47.7 | accuracy: 0.25
episode:   3/5,耗时:0.54分/1.56分,训练集: | step: 10584 | average_treward:  149.7 | max_treward: 253.1415 | average profit rate: 24.384
model saved @ step:10584,performance:68.601,accuracy:0.26
step_num: 10600 | loss: 0.3936 | profit rate:    0.9 | accuracy: 0.18
step_num: 10800 | loss: 0.2747 | profit rate:    0.8 | accuracy: 0.19
step_num: 11000 | loss: 0.3683 | profit rate:    0.9 | accuracy: 0.23
step_num: 11200 | loss: 0.2085 | profit rate:    1.0 | accuracy: 0.23
step_num: 11400 | loss: 0.2442 | profit rate:    1.3 | accuracy: 0.25
step_num: 11600 | loss: 0.3945 | profit rate:    1.9 | accuracy: 0.28
step_num: 11800 | loss: 0.4234 | profit rate:    1.1 | accuracy: 0.27
step_num: 12000 | loss: 0.0901 | profit rate:    1.2 | accuracy: 0.25
step_num: 12200 | loss: 0.1619 | profit rate:    1.1 | accuracy: 0.24
step_num: 12400 | loss: 0.0502 | profit rate:    1.0 | accuracy: 0.22
step_num: 12600 | loss: 0.1148 | profit rate:    1.7 | accuracy: 0.22
step_num: 12800 | loss: 0.4050 | profit rate:   10.7 | accuracy: 0.24
step_num: 13000 | loss: 0.4501 | profit rate:    9.1 | accuracy: 0.25
step_num: 13200 | loss: 0.2098 | profit rate:   22.4 | accuracy: 0.25
step_num: 13400 | loss: 0.3435 | profit rate:   13.3 | accuracy: 0.26
step_num: 13600 | loss: 0.3189 | profit rate:    9.9 | accuracy: 0.26
step_num: 13800 | loss: 0.2598 | profit rate:   14.1 | accuracy: 0.26
step_num: 14000 | loss: 0.2459 | profit rate:   24.1 | accuracy: 0.26
step_num: 14200 | loss: 0.3187 | profit rate:    0.9 | accuracy: 0.18
step_num: 14400 | loss: 0.2819 | profit rate:    1.3 | accuracy: 0.24
step_num: 14600 | loss: 0.2891 | profit rate:    1.9 | accuracy: 0.25
step_num: 14800 | loss: 0.2671 | profit rate:    2.2 | accuracy: 0.26
step_num: 15000 | loss: 0.2684 | profit rate:    2.3 | accuracy: 0.25
step_num: 15200 | loss: 0.4540 | profit rate:    1.7 | accuracy: 0.28
step_num: 15400 | loss: 0.2925 | profit rate:    1.1 | accuracy: 0.27
step_num: 15600 | loss: 0.1661 | profit rate:    1.3 | accuracy: 0.26
step_num: 15800 | loss: 0.2053 | profit rate:    1.6 | accuracy: 0.25
step_num: 16000 | loss: 0.0289 | profit rate:    1.7 | accuracy: 0.23
step_num: 16200 | loss: 0.0778 | profit rate:    1.8 | accuracy: 0.22
step_num: 16400 | loss: 0.2410 | profit rate:    2.0 | accuracy: 0.22
step_num: 16600 | loss: 0.2491 | profit rate:    2.6 | accuracy: 0.22
step_num: 16800 | loss: 0.2434 | profit rate:    5.9 | accuracy: 0.23
step_num: 17000 | loss: 0.3494 | profit rate:    2.8 | accuracy: 0.23
step_num: 17200 | loss: 0.3350 | profit rate:    3.6 | accuracy: 0.23
step_num: 17400 | loss: 0.2488 | profit rate:    4.5 | accuracy: 0.24
step_num: 17600 | loss: 0.3752 | profit rate:    5.9 | accuracy: 0.24
episode:   5/5,耗时:0.54分/2.67分,训练集: | step: 17640 | average_treward:  181.0 | max_treward: 253.1415 | average profit rate: 22.060
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 25%|       | 99/397 [00:00<00:00, 989.91it/s] 52%|    | 205/397 [00:00<00:00, 1025.16it/s] 78%|  | 309/397 [00:00<00:00, 1031.87it/s]100%|| 397/397 [00:00<00:00, 1041.99it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1131.22
2023-07-24T12:00:00 | net performance [%] = 13.1223
2023-07-24T12:00:00 | number of trades [#] = 8
==================================================
Trial 33 Complete [00h 02m 43s]
net_wealth: 1132.3556980803166

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 02m 35s

Search: Running Trial #34

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
730               |730               |lookback
False             |True              |MarketFactor
3                 |5                 |lags
0.7               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4303.000000   4315.000000
mean      0.000441    20062.255222  ...   20162.113925  20118.633889
std       0.027818    16039.874230  ...   16078.371573  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7724.814941   7690.540039
50%       0.000642    11554.824463  ...   11750.650391  11715.610352
75%       0.011655    29873.081836  ...   30003.260742  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.6175 | profit rate:    2.8 | accuracy: 0.35
step_num: 600 | loss: 0.6221 | profit rate:   14.3 | accuracy: 0.34
step_num: 800 | loss: 0.7259 | profit rate:    0.8 | accuracy: 0.34
step_num: 1000 | loss: 0.7234 | profit rate:    0.3 | accuracy: 0.33
step_num: 1200 | loss: 0.8252 | profit rate:    0.0 | accuracy: 0.32
step_num: 1400 | loss: 0.6574 | profit rate:    0.0 | accuracy: 0.32
step_num: 1600 | loss: 0.6109 | profit rate:    0.0 | accuracy: 0.35
step_num: 1800 | loss: 0.6332 | profit rate:  259.0 | accuracy: 0.37
step_num: 2000 | loss: 0.7894 | profit rate:   21.8 | accuracy: 0.38
step_num: 2200 | loss: 0.6788 | profit rate:  470.2 | accuracy: 0.38
step_num: 2400 | loss: 0.7191 | profit rate:   98.1 | accuracy: 0.39
step_num: 2600 | loss: 0.6666 | profit rate:    0.4 | accuracy: 0.37
step_num: 2800 | loss: 0.6786 | profit rate:    0.1 | accuracy: 0.36
step_num: 3000 | loss: 0.4096 | profit rate:    0.1 | accuracy: 0.35
episode:   1/5,耗时:0.70分/0.70分,训练集: | step: 3174 | average_treward:   -8.4 | max_treward: 0.0000 | average profit rate:  0.056
step_num: 3200 | loss: 0.2917 | profit rate:    0.6 | accuracy: 0.22
step_num: 3400 | loss: 0.4494 | profit rate:    3.0 | accuracy: 0.43
step_num: 3600 | loss: 0.4292 | profit rate:    1.6 | accuracy: 0.29
step_num: 3800 | loss: 0.4132 | profit rate:  143.5 | accuracy: 0.29
step_num: 4000 | loss: 0.4918 | profit rate:    1.5 | accuracy: 0.31
step_num: 4200 | loss: 0.6791 | profit rate:    2.1 | accuracy: 0.32
step_num: 4400 | loss: 0.6587 | profit rate:    0.0 | accuracy: 0.31
step_num: 4600 | loss: 0.5112 | profit rate:    0.2 | accuracy: 0.32
step_num: 4800 | loss: 0.6023 | profit rate:    9.2 | accuracy: 0.35
step_num: 5000 | loss: 0.6907 | profit rate: 148795.9 | accuracy: 0.37
step_num: 5200 | loss: 0.7095 | profit rate: 5983.3 | accuracy: 0.38
step_num: 5400 | loss: 0.7370 | profit rate: 97700.8 | accuracy: 0.39
step_num: 5600 | loss: 0.7324 | profit rate: 63892.8 | accuracy: 0.40
step_num: 5800 | loss: 0.5738 | profit rate: 1861.2 | accuracy: 0.38
step_num: 6000 | loss: 0.4753 | profit rate:   17.0 | accuracy: 0.36
step_num: 6200 | loss: 0.2217 | profit rate:   30.9 | accuracy: 0.35
model saved @ step:6348,performance:23.694,accuracy:0.33
step_num: 6400 | loss: 0.1263 | profit rate:    1.1 | accuracy: 0.15
step_num: 6600 | loss: 0.1314 | profit rate:    0.6 | accuracy: 0.13
step_num: 6800 | loss: 0.1344 | profit rate:    0.6 | accuracy: 0.09
step_num: 7000 | loss: 0.2967 | profit rate:   10.7 | accuracy: 0.17
step_num: 7200 | loss: 0.5267 | profit rate:    2.9 | accuracy: 0.22
step_num: 7400 | loss: 0.7149 | profit rate:    2.0 | accuracy: 0.23
step_num: 7600 | loss: 0.5287 | profit rate:    0.0 | accuracy: 0.22
step_num: 7800 | loss: 0.3495 | profit rate:    0.0 | accuracy: 0.23
step_num: 8000 | loss: 0.3878 | profit rate:    2.6 | accuracy: 0.28
step_num: 8200 | loss: 0.6528 | profit rate: 331748.8 | accuracy: 0.32
step_num: 8400 | loss: 0.6893 | profit rate: 1419.2 | accuracy: 0.32
step_num: 8600 | loss: 0.6491 | profit rate: 5307.2 | accuracy: 0.33
step_num: 8800 | loss: 0.6784 | profit rate:  558.2 | accuracy: 0.34
step_num: 9000 | loss: 0.5343 | profit rate:   49.6 | accuracy: 0.32
step_num: 9200 | loss: 0.3452 | profit rate:   23.2 | accuracy: 0.31
step_num: 9400 | loss: 0.1425 | profit rate:   23.2 | accuracy: 0.29
episode:   3/5,耗时:0.80分/2.30分,训练集: | step: 9522 | average_treward:   68.7 | max_treward: 119.5951 | average profit rate: 15.458
model saved @ step:9522,performance:22.624,accuracy:0.28
step_num: 9600 | loss: 0.0270 | profit rate:    0.9 | accuracy: 0.05
step_num: 9800 | loss: 0.0497 | profit rate:    2.0 | accuracy: 0.05
step_num: 10000 | loss: 0.0322 | profit rate:    2.0 | accuracy: 0.04
step_num: 10200 | loss: 0.2686 | profit rate:   83.2 | accuracy: 0.16
step_num: 10400 | loss: 0.5447 | profit rate:    3.0 | accuracy: 0.19
step_num: 10600 | loss: 0.6737 | profit rate:    1.6 | accuracy: 0.20
step_num: 10800 | loss: 0.4958 | profit rate:    0.1 | accuracy: 0.19
step_num: 11000 | loss: 0.2806 | profit rate:    0.0 | accuracy: 0.19
step_num: 11200 | loss: 0.3693 | profit rate:   74.0 | accuracy: 0.24
step_num: 11400 | loss: 0.6216 | profit rate: 1771059.8 | accuracy: 0.29
step_num: 11600 | loss: 0.7216 | profit rate: 7922.6 | accuracy: 0.30
step_num: 11800 | loss: 0.6462 | profit rate: 300237.6 | accuracy: 0.31
step_num: 12000 | loss: 0.6419 | profit rate: 9884.5 | accuracy: 0.31
step_num: 12200 | loss: 0.4814 | profit rate: 3689.4 | accuracy: 0.30
step_num: 12400 | loss: 0.2560 | profit rate: 2418.1 | accuracy: 0.28
step_num: 12600 | loss: 0.0612 | profit rate: 2328.2 | accuracy: 0.26
model saved @ step:12696,performance:2328.191,accuracy:0.26
step_num: 12800 | loss: 0.0276 | profit rate:    1.0 | accuracy: 0.05
step_num: 13000 | loss: 0.0201 | profit rate:    1.0 | accuracy: 0.03
step_num: 13200 | loss: 0.0244 | profit rate:    1.1 | accuracy: 0.03
step_num: 13400 | loss: 0.3244 | profit rate:   30.5 | accuracy: 0.17
step_num: 13600 | loss: 0.6725 | profit rate:    0.2 | accuracy: 0.19
step_num: 13800 | loss: 0.6677 | profit rate:    0.7 | accuracy: 0.20
step_num: 14000 | loss: 0.3904 | profit rate:    0.2 | accuracy: 0.19
step_num: 14200 | loss: 0.3644 | profit rate:    0.1 | accuracy: 0.20
step_num: 14400 | loss: 0.3863 | profit rate: 5322.2 | accuracy: 0.25
step_num: 14600 | loss: 0.6643 | profit rate: 18473946.1 | accuracy: 0.30
step_num: 14800 | loss: 0.7457 | profit rate: 15219.7 | accuracy: 0.30
step_num: 15000 | loss: 0.6864 | profit rate: 2289668.8 | accuracy: 0.32
step_num: 15200 | loss: 0.5393 | profit rate: 38087.7 | accuracy: 0.31
step_num: 15400 | loss: 0.4258 | profit rate: 11957.5 | accuracy: 0.30
step_num: 15600 | loss: 0.1415 | profit rate: 13599.0 | accuracy: 0.28
step_num: 15800 | loss: 0.0658 | profit rate: 12744.9 | accuracy: 0.26
episode:   5/5,耗时:0.78分/3.85分,训练集: | step: 15870 | average_treward:  113.8 | max_treward: 196.2740 | average profit rate: 3028.751
model saved @ step:15870,performance:12769.191,accuracy:0.26
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 25%|       | 101/408 [00:00<00:00, 1005.21it/s] 54%|    | 221/408 [00:00<00:00, 1114.99it/s] 83%| | 339/408 [00:00<00:00, 1139.72it/s]100%|| 408/408 [00:00<00:00, 1131.43it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1274.84
2023-07-24T12:00:00 | net performance [%] = 27.4836
2023-07-24T12:00:00 | number of trades [#] = 2
==================================================
Trial 34 Complete [00h 03m 54s]
net_wealth: 1276.1122412262098

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 06m 29s

Search: Running Trial #35

Value             |Best Value So Far |Hyperparameter
7                 |12                |horizon
225               |730               |lookback
True              |True              |MarketFactor
5                 |5                 |lags
0.8               |0.6               |gamma
0.001             |5e-05             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4294.000000   4301.000000
mean      0.000435    20113.607657  ...   20195.171043  20169.373185
std       0.027833    16040.642334  ...   16078.971923  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7758.522461   7730.930176
50%       0.000642    11571.842969  ...   11758.879883  11751.469727
75%       0.011590    29894.706152  ...   30019.495605  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8367 | profit rate:   32.9 | accuracy: 0.38
step_num: 400 | loss: 0.5721 | profit rate:   17.2 | accuracy: 0.34
step_num: 600 | loss: 0.5087 | profit rate:   21.9 | accuracy: 0.35
step_num: 800 | loss: 0.3694 | profit rate:   11.7 | accuracy: 0.34
step_num: 1000 | loss: 0.7960 | profit rate:    5.2 | accuracy: 0.34
step_num: 1200 | loss: 0.6721 | profit rate:    2.5 | accuracy: 0.32
step_num: 1400 | loss: 0.4960 | profit rate:    1.4 | accuracy: 0.31
step_num: 1600 | loss: 0.4900 | profit rate:    1.5 | accuracy: 0.31
step_num: 1800 | loss: 0.4287 | profit rate:    0.7 | accuracy: 0.30
step_num: 2000 | loss: 0.2926 | profit rate:    0.8 | accuracy: 0.29
step_num: 2200 | loss: 0.3233 | profit rate:    3.4 | accuracy: 0.28
step_num: 2400 | loss: 0.5365 | profit rate:  109.2 | accuracy: 0.29
step_num: 2600 | loss: 0.4913 | profit rate:    3.9 | accuracy: 0.29
step_num: 2800 | loss: 0.8768 | profit rate:   34.5 | accuracy: 0.30
step_num: 3000 | loss: 0.6449 | profit rate:   16.3 | accuracy: 0.30
step_num: 3200 | loss: 0.2544 | profit rate:    4.5 | accuracy: 0.30
step_num: 3400 | loss: 0.4334 | profit rate:    1.1 | accuracy: 0.30
step_num: 3600 | loss: 0.3231 | profit rate:    3.3 | accuracy: 0.30
episode:   1/5,耗时:0.44分/0.44分,训练集: | step: 3663 | average_treward:   10.7 | max_treward: 10.6604 | average profit rate:  3.789
model saved @ step:3663,performance:3.789,accuracy:0.30
step_num: 3800 | loss: 0.2389 | profit rate:    4.7 | accuracy: 0.21
step_num: 4000 | loss: 0.0193 | profit rate:    5.6 | accuracy: 0.17
step_num: 4200 | loss: 0.2572 | profit rate:    5.0 | accuracy: 0.15
step_num: 4400 | loss: 0.1516 | profit rate:    7.2 | accuracy: 0.15
step_num: 4600 | loss: 0.7909 | profit rate:    1.4 | accuracy: 0.18
step_num: 4800 | loss: 0.9112 | profit rate:  122.7 | accuracy: 0.27
step_num: 5000 | loss: 0.1397 | profit rate:   28.7 | accuracy: 0.26
step_num: 5200 | loss: 0.6380 | profit rate:   63.4 | accuracy: 0.27
step_num: 5400 | loss: 0.5732 | profit rate:    1.8 | accuracy: 0.27
step_num: 5600 | loss: 0.6273 | profit rate:    1.1 | accuracy: 0.28
step_num: 5800 | loss: 0.6604 | profit rate:    8.5 | accuracy: 0.30
step_num: 6000 | loss: 0.5448 | profit rate: 8710.0 | accuracy: 0.33
step_num: 6200 | loss: 0.1804 | profit rate:  297.8 | accuracy: 0.32
step_num: 6400 | loss: 0.6853 | profit rate:  388.1 | accuracy: 0.33
step_num: 6600 | loss: 0.1099 | profit rate: 1160.3 | accuracy: 0.33
step_num: 6800 | loss: 0.3497 | profit rate:  306.0 | accuracy: 0.32
step_num: 7000 | loss: 0.2679 | profit rate:  315.4 | accuracy: 0.30
step_num: 7200 | loss: 0.2987 | profit rate: 1097.5 | accuracy: 0.30
model saved @ step:7326,performance:5671.156,accuracy:0.30
step_num: 7400 | loss: 0.6539 | profit rate:   46.8 | accuracy: 0.60
step_num: 7600 | loss: 0.5160 | profit rate:    5.5 | accuracy: 0.33
step_num: 7800 | loss: 0.5029 | profit rate:    2.2 | accuracy: 0.22
step_num: 8000 | loss: 0.0106 | profit rate:    3.0 | accuracy: 0.19
step_num: 8200 | loss: 0.1442 | profit rate:    5.8 | accuracy: 0.18
step_num: 8400 | loss: 0.6676 | profit rate:   98.4 | accuracy: 0.25
step_num: 8600 | loss: 0.0383 | profit rate:   22.2 | accuracy: 0.25
step_num: 8800 | loss: 0.0722 | profit rate:   38.9 | accuracy: 0.23
step_num: 9000 | loss: 0.2553 | profit rate:   27.5 | accuracy: 0.24
step_num: 9200 | loss: 0.1906 | profit rate:   27.9 | accuracy: 0.24
step_num: 9400 | loss: 0.0552 | profit rate:   47.5 | accuracy: 0.24
step_num: 9600 | loss: 0.9363 | profit rate: 82832.0 | accuracy: 0.28
step_num: 9800 | loss: 0.7331 | profit rate: 210375.6 | accuracy: 0.29
step_num: 10000 | loss: 0.8689 | profit rate: 151560.8 | accuracy: 0.30
step_num: 10200 | loss: 0.8960 | profit rate: 212743.4 | accuracy: 0.31
step_num: 10400 | loss: 0.5799 | profit rate: 68700.3 | accuracy: 0.30
step_num: 10600 | loss: 0.0520 | profit rate: 27920.9 | accuracy: 0.29
step_num: 10800 | loss: 0.0993 | profit rate: 34332.6 | accuracy: 0.27
episode:   3/5,耗时:0.51分/1.45分,训练集: | step: 10989 | average_treward:  149.3 | max_treward: 220.2157 | average profit rate: 14996.841
step_num: 11000 | loss: 0.1202 | profit rate:    0.8 | accuracy: 0.25
step_num: 11200 | loss: 0.1800 | profit rate:    2.2 | accuracy: 0.18
step_num: 11400 | loss: 0.0326 | profit rate:    0.8 | accuracy: 0.13
step_num: 11600 | loss: 0.2355 | profit rate:    0.9 | accuracy: 0.12
step_num: 11800 | loss: 0.1173 | profit rate:    1.1 | accuracy: 0.10
step_num: 12000 | loss: 0.7699 | profit rate:   49.7 | accuracy: 0.16
step_num: 12200 | loss: 0.7650 | profit rate:  110.6 | accuracy: 0.22
step_num: 12400 | loss: 0.1199 | profit rate:   99.9 | accuracy: 0.20
step_num: 12600 | loss: 0.4823 | profit rate:   75.7 | accuracy: 0.21
step_num: 12800 | loss: 0.5833 | profit rate:   52.0 | accuracy: 0.21
step_num: 13000 | loss: 0.3079 | profit rate:   44.6 | accuracy: 0.22
step_num: 13200 | loss: 0.7192 | profit rate: 109002.9 | accuracy: 0.25
step_num: 13400 | loss: 0.6350 | profit rate: 907252.5 | accuracy: 0.28
step_num: 13600 | loss: 0.5659 | profit rate: 468327.1 | accuracy: 0.28
step_num: 13800 | loss: 0.5475 | profit rate: 4459615.7 | accuracy: 0.30
step_num: 14000 | loss: 0.6177 | profit rate: 1626124.8 | accuracy: 0.30
step_num: 14200 | loss: 0.0863 | profit rate: 350357.8 | accuracy: 0.29
step_num: 14400 | loss: 0.2535 | profit rate: 383593.2 | accuracy: 0.28
step_num: 14600 | loss: 0.1544 | profit rate: 252563.9 | accuracy: 0.27
model saved @ step:14652,performance:247940.559,accuracy:0.27
step_num: 14800 | loss: 0.0113 | profit rate:    0.6 | accuracy: 0.02
step_num: 15000 | loss: 0.0069 | profit rate:    0.6 | accuracy: 0.01
step_num: 15200 | loss: 0.1286 | profit rate:    0.7 | accuracy: 0.03
step_num: 15400 | loss: 0.0291 | profit rate:    1.1 | accuracy: 0.05
step_num: 15600 | loss: 0.6488 | profit rate:    1.5 | accuracy: 0.09
step_num: 15800 | loss: 0.7753 | profit rate:   92.3 | accuracy: 0.18
step_num: 16000 | loss: 0.0087 | profit rate:   39.3 | accuracy: 0.17
step_num: 16200 | loss: 0.2918 | profit rate:   76.6 | accuracy: 0.16
step_num: 16400 | loss: 0.2544 | profit rate:   20.7 | accuracy: 0.15
step_num: 16600 | loss: 0.3557 | profit rate:    9.8 | accuracy: 0.15
step_num: 16800 | loss: 0.2214 | profit rate:   31.3 | accuracy: 0.15
step_num: 17000 | loss: 0.7735 | profit rate: 12244.7 | accuracy: 0.18
step_num: 17200 | loss: 0.2858 | profit rate: 10975.6 | accuracy: 0.18
step_num: 17400 | loss: 0.6433 | profit rate: 16484.5 | accuracy: 0.21
step_num: 17600 | loss: 0.5502 | profit rate: 37899.2 | accuracy: 0.22
step_num: 17800 | loss: 0.5528 | profit rate: 20577.8 | accuracy: 0.22
step_num: 18000 | loss: 0.1968 | profit rate: 41678.0 | accuracy: 0.22
step_num: 18200 | loss: 0.4154 | profit rate: 42182.1 | accuracy: 0.22
episode:   5/5,耗时:0.49分/2.44分,训练集: | step: 18315 | average_treward:  179.9 | max_treward: 235.1047 | average profit rate: 67786.785
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 22%|       | 90/406 [00:00<00:00, 899.99it/s] 46%|     | 187/406 [00:00<00:00, 935.67it/s] 71%|   | 288/406 [00:00<00:00, 965.11it/s] 96%|| 391/406 [00:00<00:00, 986.73it/s]==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
100%|| 406/406 [00:00<00:00, 971.29it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1194.98
2023-07-24T12:00:00 | net performance [%] = 19.4979
2023-07-24T12:00:00 | number of trades [#] = 20
==================================================
Trial 35 Complete [00h 02m 29s]
net_wealth: 1196.17477005112

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 08m 59s

Search: Running Trial #36

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
7                 |5                 |lags
0.5               |0.6               |gamma
0.001             |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.1620 | profit rate:   77.9 | accuracy: 0.37
step_num: 1200 | loss: 0.4438 | profit rate:   26.5 | accuracy: 0.36
step_num: 1400 | loss: 0.3512 | profit rate:   56.2 | accuracy: 0.36
step_num: 1600 | loss: 0.3181 | profit rate:   11.4 | accuracy: 0.36
step_num: 1800 | loss: 0.2762 | profit rate:   50.4 | accuracy: 0.35
step_num: 2000 | loss: 0.2162 | profit rate:   17.7 | accuracy: 0.35
step_num: 2200 | loss: 0.1944 | profit rate:  349.6 | accuracy: 0.36
step_num: 2400 | loss: 0.2631 | profit rate:  121.5 | accuracy: 0.36
step_num: 2600 | loss: 0.2297 | profit rate:   41.7 | accuracy: 0.35
step_num: 2800 | loss: 0.2059 | profit rate:  808.8 | accuracy: 0.35
step_num: 3000 | loss: 0.1821 | profit rate:  382.5 | accuracy: 0.35
step_num: 3200 | loss: 0.1813 | profit rate:  914.2 | accuracy: 0.35
step_num: 3400 | loss: 0.1704 | profit rate:  555.4 | accuracy: 0.35
step_num: 3600 | loss: 0.1514 | profit rate: 4240.9 | accuracy: 0.35
episode:   1/5,耗时:1.63分/1.63分,训练集: | step: 3706 | average_treward:  158.7 | max_treward: 158.6778 | average profit rate: 2794.912
model saved @ step:3706,performance:2794.912,accuracy:0.35
step_num: 3800 | loss: 0.1306 | profit rate:   94.2 | accuracy: 0.41
step_num: 4000 | loss: 0.1327 | profit rate: 392430.0 | accuracy: 0.40
step_num: 4200 | loss: 0.1355 | profit rate: 3913738.3 | accuracy: 0.40
step_num: 4400 | loss: 0.1200 | profit rate: 12317081.8 | accuracy: 0.40
step_num: 4600 | loss: 0.1281 | profit rate: 16366997.2 | accuracy: 0.38
step_num: 4800 | loss: 0.1540 | profit rate: 10733626329.1 | accuracy: 0.40
step_num: 5000 | loss: 0.1176 | profit rate: 992266428777.6 | accuracy: 0.40
step_num: 5200 | loss: 0.0908 | profit rate: 64545064964539.8 | accuracy: 0.40
step_num: 5400 | loss: 0.0995 | profit rate: 6659682617056374.0 | accuracy: 0.39
step_num: 5600 | loss: 0.0922 | profit rate: 62505124372777080.0 | accuracy: 0.38
step_num: 5800 | loss: 0.1018 | profit rate: 2021245226870781952.0 | accuracy: 0.39
step_num: 6000 | loss: 0.0923 | profit rate: 37660849634707452723200.0 | accuracy: 0.40
step_num: 6200 | loss: 0.0995 | profit rate: 873149030047992367321972736.0 | accuracy: 0.41
step_num: 6400 | loss: 0.0955 | profit rate: 34633298810087177602516123648.0 | accuracy: 0.41
step_num: 6600 | loss: 0.0970 | profit rate: 1082974939345331491299877978112.0 | accuracy: 0.41
step_num: 6800 | loss: 0.0823 | profit rate: 69692614363268930289794182807552.0 | accuracy: 0.41
step_num: 7000 | loss: 0.0817 | profit rate: 10490673752828892485631330899460096.0 | accuracy: 0.42
step_num: 7200 | loss: 0.0811 | profit rate: 409485191379888513933611393345388544.0 | accuracy: 0.42
step_num: 7400 | loss: 0.0693 | profit rate: 4873161815478304290788189577066577920.0 | accuracy: 0.42
model saved @ step:7412,performance:5363267392669890187317553032788443136.000,accuracy:0.42
step_num: 7600 | loss: 0.0796 | profit rate: 1963532.8 | accuracy: 0.57
step_num: 7800 | loss: 0.0848 | profit rate: 2445259174.0 | accuracy: 0.54
step_num: 8000 | loss: 0.0891 | profit rate: 515236038765.4 | accuracy: 0.51
step_num: 8200 | loss: 0.0797 | profit rate: 86243151560947.5 | accuracy: 0.49
step_num: 8400 | loss: 0.0839 | profit rate: 9246474285554506.0 | accuracy: 0.53
step_num: 8600 | loss: 0.0870 | profit rate: 258879866897570496512.0 | accuracy: 0.53
step_num: 8800 | loss: 0.0846 | profit rate: 40435386324302985953280.0 | accuracy: 0.52
step_num: 9000 | loss: 0.0610 | profit rate: 2273157992858816490766336.0 | accuracy: 0.51
step_num: 9200 | loss: 0.0652 | profit rate: 4845234648411822160707846144.0 | accuracy: 0.51
step_num: 9400 | loss: 0.0696 | profit rate: 154222566889812578608001056768.0 | accuracy: 0.51
step_num: 9600 | loss: 0.0705 | profit rate: 143969563954122649749823508447232.0 | accuracy: 0.51
step_num: 9800 | loss: 0.0612 | profit rate: 46131723730081482903207659612076507136.0 | accuracy: 0.51
step_num: 10000 | loss: 0.0792 | profit rate: 38339594734736286430679408150289942839296.0 | accuracy: 0.51
step_num: 10200 | loss: 0.0610 | profit rate: 39758313179889779632934955571987812873928704.0 | accuracy: 0.51
step_num: 10400 | loss: 0.0772 | profit rate: 3983191790522153067118370147893213688177360896.0 | accuracy: 0.51
step_num: 10600 | loss: 0.0531 | profit rate: 501081858888960407675274325930207626056966340608.0 | accuracy: 0.51
step_num: 10800 | loss: 0.0646 | profit rate: 847536445774047771607135373247402368130939833286656.0 | accuracy: 0.51
step_num: 11000 | loss: 0.0632 | profit rate: 54333973096904381262322632144514691525753553970790400.0 | accuracy: 0.51
episode:   3/5,耗时:2.39分/6.23分,训练集: | step: 11118 | average_treward: 1120.8 | max_treward: 1917.9289 | average profit rate: 191584059545913956208684782263023391846584801520779264.000
model saved @ step:11118,performance:574752178637741868626054346789070175539754404562337792.000,accuracy:0.51
step_num: 11200 | loss: 0.0514 | profit rate: 5464.5 | accuracy: 0.67
step_num: 11400 | loss: 0.0626 | profit rate: 182912992985.7 | accuracy: 0.70
step_num: 11600 | loss: 0.0601 | profit rate: 1461222668271661.0 | accuracy: 0.65
step_num: 11800 | loss: 0.0448 | profit rate: 436462817293097408.0 | accuracy: 0.64
step_num: 12000 | loss: 0.0469 | profit rate: 2785216708996174970880.0 | accuracy: 0.63
step_num: 12200 | loss: 0.0688 | profit rate: 10641907263971727494873088.0 | accuracy: 0.64
step_num: 12400 | loss: 0.0560 | profit rate: 1388455302153314771080612675584.0 | accuracy: 0.65
step_num: 12600 | loss: 0.0583 | profit rate: 1827045092485329912221219608854528.0 | accuracy: 0.64
step_num: 12800 | loss: 0.0723 | profit rate: 220518601567025596290805294184305524736.0 | accuracy: 0.63
step_num: 13000 | loss: 0.0527 | profit rate: 82844765212618208850376183636493953138688.0 | accuracy: 0.63
step_num: 13200 | loss: 0.0516 | profit rate: 10454455773344634813105655548386129666375680.0 | accuracy: 0.63
step_num: 13400 | loss: 0.0664 | profit rate: 2638939157387571047717299674064224336662170173440.0 | accuracy: 0.63
step_num: 13600 | loss: 0.0491 | profit rate: 331341959969750892848610186829876109470703799068786688.0 | accuracy: 0.64
step_num: 13800 | loss: 0.0539 | profit rate: 279313671765227146946791978084558792678281232166642778112.0 | accuracy: 0.63
step_num: 14000 | loss: 0.0458 | profit rate: 707453953673009149144775830046459350200927684299570068586496.0 | accuracy: 0.63
step_num: 14200 | loss: 0.0684 | profit rate: 196629372778826594843403338551968576201352885507000577558577152.0 | accuracy: 0.62
step_num: 14400 | loss: 0.0536 | profit rate: 89684675847724614005141688689997057110997346383709540140965691392.0 | accuracy: 0.62
step_num: 14600 | loss: 0.0506 | profit rate: 359299566580741895645978428843943514127946712037392644934607002664960.0 | accuracy: 0.62
step_num: 14800 | loss: 0.0472 | profit rate: 56345790084565540108412478673823167588921766304353322501161909011611648.0 | accuracy: 0.62
model saved @ step:14824,performance:54825906919007447938940049605670212662853428951897030480845473581105152.000,accuracy:0.62
step_num: 15000 | loss: 0.0596 | profit rate: 114940465.2 | accuracy: 0.68
step_num: 15200 | loss: 0.0516 | profit rate: 60676076156819.6 | accuracy: 0.69
step_num: 15400 | loss: 0.0388 | profit rate: 112552679973047264.0 | accuracy: 0.67
step_num: 15600 | loss: 0.0379 | profit rate: 323540067945158344704.0 | accuracy: 0.65
step_num: 15800 | loss: 0.0391 | profit rate: 428572618044890224263168.0 | accuracy: 0.66
step_num: 16000 | loss: 0.0493 | profit rate: 412058283347900914415125397504.0 | accuracy: 0.67
step_num: 16200 | loss: 0.0310 | profit rate: 7505179562970253433651879032651776.0 | accuracy: 0.67
step_num: 16400 | loss: 0.0504 | profit rate: 6345502859704186301525547813617795072.0 | accuracy: 0.66
step_num: 16600 | loss: 0.0412 | profit rate: 4663384468101736836373354846054359733633024.0 | accuracy: 0.66
step_num: 16800 | loss: 0.0524 | profit rate: 1182903539996143683907782721200577572782473216.0 | accuracy: 0.66
step_num: 17000 | loss: 0.0448 | profit rate: 6579296612954029112688452077316113799709670244352.0 | accuracy: 0.67
step_num: 17200 | loss: 0.0511 | profit rate: 34185585897995295480140985855158643882369681848161796096.0 | accuracy: 0.67
step_num: 17400 | loss: 0.0400 | profit rate: 205188590942961754294008741766930989369081355302006404677632.0 | accuracy: 0.66
step_num: 17600 | loss: 0.0388 | profit rate: 2811930541034883850425793967761056276641489867522054750547738624.0 | accuracy: 0.66
step_num: 17800 | loss: 0.0489 | profit rate: 18309923011401488018442282767546892088061104433766872227975287275520.0 | accuracy: 0.66
step_num: 18000 | loss: 0.0450 | profit rate: 52432440183918866705823338772266778780017721839190118906841298859196416.0 | accuracy: 0.66
step_num: 18200 | loss: 0.0611 | profit rate: 462095077599985161664689904086588188484492394253175912969037643367390904320.0 | accuracy: 0.66
step_num: 18400 | loss: 0.0510 | profit rate: 88019112912615790585520027487425505287709446955384955130274023175847250231296.0 | accuracy: 0.66
episode:   5/5,耗时:2.26分/10.74分,训练集: | step: 18530 | average_treward: 1761.8 | max_treward: 2872.9869 | average profit rate: 807589552872159056049181794885228545788944676330153403054400422451831696785408.000
model saved @ step:18530,performance:4037947709534888165123921664035362869845123944677049416782924098279608449761280.000,accuracy:0.66
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 21%|       | 86/404 [00:00<00:00, 860.00it/s] 46%|     | 186/404 [00:00<00:00, 942.24it/s] 71%|   | 286/404 [00:00<00:00, 964.21it/s] 95%|| 384/404 [00:00<00:00, 970.42it/s]100%|| 404/404 [00:00<00:00, 957.30it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1290.08
2023-07-24T12:00:00 | net performance [%] = 29.0076
2023-07-24T12:00:00 | number of trades [#] = 56
==================================================
Trial 36 Complete [00h 10m 48s]
net_wealth: 1290.0764790603155

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 19m 47s

Search: Running Trial #37

Value             |Best Value So Far |Hyperparameter
13                |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
5                 |5                 |lags
0.7               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
16                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4288.000000   4301.000000
mean      0.000435    20113.607657  ...   20217.089827  20169.373185
std       0.027833    16040.642334  ...   16079.528271  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7773.282593   7730.930176
50%       0.000642    11571.842969  ...   11761.935059  11751.469727
75%       0.011590    29894.706152  ...   30060.440430  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.9191 | profit rate:    0.1 | accuracy: 0.32
step_num: 800 | loss: 0.6502 | profit rate:    0.1 | accuracy: 0.31
step_num: 1000 | loss: 0.5953 | profit rate:    0.0 | accuracy: 0.31
step_num: 1200 | loss: 0.5330 | profit rate:    0.0 | accuracy: 0.30
step_num: 1400 | loss: 0.4951 | profit rate:    0.0 | accuracy: 0.30
step_num: 1600 | loss: 0.4411 | profit rate:    0.0 | accuracy: 0.30
step_num: 1800 | loss: 0.4546 | profit rate:    0.0 | accuracy: 0.30
step_num: 2000 | loss: 0.5083 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.5180 | profit rate:    0.0 | accuracy: 0.32
step_num: 2400 | loss: 0.5091 | profit rate:   24.3 | accuracy: 0.33
step_num: 2600 | loss: 0.5726 | profit rate:    0.1 | accuracy: 0.33
step_num: 2800 | loss: 0.6174 | profit rate:    1.8 | accuracy: 0.34
step_num: 3000 | loss: 0.6235 | profit rate:    0.4 | accuracy: 0.34
step_num: 3200 | loss: 0.6166 | profit rate:    0.0 | accuracy: 0.33
step_num: 3400 | loss: 0.5319 | profit rate:    0.0 | accuracy: 0.32
step_num: 3600 | loss: 0.4551 | profit rate:    0.0 | accuracy: 0.32
episode:   1/5,耗时:2.00分/2.00分,训练集: | step: 3708 | average_treward:  -32.5 | max_treward: 0.0000 | average profit rate:  0.037
step_num: 3800 | loss: 0.3679 | profit rate:    6.8 | accuracy: 0.42
step_num: 4000 | loss: 0.3766 | profit rate:   67.4 | accuracy: 0.30
step_num: 4200 | loss: 0.3772 | profit rate: 5361.1 | accuracy: 0.34
step_num: 4400 | loss: 0.4534 | profit rate: 77208.6 | accuracy: 0.36
step_num: 4600 | loss: 0.4520 | profit rate: 6773.3 | accuracy: 0.34
step_num: 4800 | loss: 0.5908 | profit rate:    6.0 | accuracy: 0.34
step_num: 5000 | loss: 0.5223 | profit rate:    0.0 | accuracy: 0.32
step_num: 5200 | loss: 0.4713 | profit rate:    0.1 | accuracy: 0.29
step_num: 5400 | loss: 0.3445 | profit rate:    0.0 | accuracy: 0.27
step_num: 5600 | loss: 0.2896 | profit rate:    0.0 | accuracy: 0.25
step_num: 5800 | loss: 0.2169 | profit rate:    0.0 | accuracy: 0.24
step_num: 6000 | loss: 0.2071 | profit rate:   23.0 | accuracy: 0.26
step_num: 6200 | loss: 0.2533 | profit rate: 1918.5 | accuracy: 0.26
step_num: 6400 | loss: 0.2475 | profit rate: 1076.9 | accuracy: 0.26
step_num: 6600 | loss: 0.3526 | profit rate: 42936.0 | accuracy: 0.27
step_num: 6800 | loss: 0.3539 | profit rate: 10206.1 | accuracy: 0.27
step_num: 7000 | loss: 0.3653 | profit rate: 4393.8 | accuracy: 0.27
step_num: 7200 | loss: 0.3519 | profit rate: 2068.9 | accuracy: 0.27
step_num: 7400 | loss: 0.3650 | profit rate: 12387.9 | accuracy: 0.27
model saved @ step:7416,performance:12387.946,accuracy:0.27
step_num: 7600 | loss: 0.4319 | profit rate:   65.3 | accuracy: 0.42
step_num: 7800 | loss: 0.4122 | profit rate: 2069.4 | accuracy: 0.35
step_num: 8000 | loss: 0.4233 | profit rate: 7551.5 | accuracy: 0.34
step_num: 8200 | loss: 0.3765 | profit rate: 4755.7 | accuracy: 0.32
step_num: 8400 | loss: 0.4575 | profit rate:  158.4 | accuracy: 0.33
step_num: 8600 | loss: 0.4758 | profit rate:    8.2 | accuracy: 0.33
step_num: 8800 | loss: 0.3959 | profit rate:    2.2 | accuracy: 0.30
step_num: 9000 | loss: 0.3517 | profit rate:    3.2 | accuracy: 0.29
step_num: 9200 | loss: 0.3243 | profit rate:    2.1 | accuracy: 0.27
step_num: 9400 | loss: 0.2546 | profit rate:    1.0 | accuracy: 0.25
step_num: 9600 | loss: 0.2085 | profit rate:   51.6 | accuracy: 0.26
step_num: 9800 | loss: 0.2998 | profit rate: 8774592.8 | accuracy: 0.29
step_num: 10000 | loss: 0.3253 | profit rate: 1067564.5 | accuracy: 0.29
step_num: 10200 | loss: 0.3506 | profit rate: 4644642.1 | accuracy: 0.29
step_num: 10400 | loss: 0.4057 | profit rate: 27265946.1 | accuracy: 0.30
step_num: 10600 | loss: 0.4629 | profit rate: 105757383.7 | accuracy: 0.30
step_num: 10800 | loss: 0.4390 | profit rate: 3417246.4 | accuracy: 0.29
step_num: 11000 | loss: 0.3899 | profit rate: 14972691.5 | accuracy: 0.29
episode:   3/5,耗时:2.29分/6.56分,训练集: | step: 11124 | average_treward:  153.3 | max_treward: 318.1974 | average profit rate: 27812868.676
model saved @ step:11124,performance:83426218.045,accuracy:0.28
step_num: 11200 | loss: 0.4026 | profit rate:   11.5 | accuracy: 0.53
step_num: 11400 | loss: 0.3395 | profit rate:  179.5 | accuracy: 0.29
step_num: 11600 | loss: 0.3117 | profit rate: 1648.9 | accuracy: 0.25
step_num: 11800 | loss: 0.2686 | profit rate: 8806.5 | accuracy: 0.25
step_num: 12000 | loss: 0.3053 | profit rate: 3240.2 | accuracy: 0.25
step_num: 12200 | loss: 0.3664 | profit rate:  237.7 | accuracy: 0.26
step_num: 12400 | loss: 0.3188 | profit rate:  208.2 | accuracy: 0.26
step_num: 12600 | loss: 0.2886 | profit rate:  740.2 | accuracy: 0.26
step_num: 12800 | loss: 0.3396 | profit rate:  511.8 | accuracy: 0.25
step_num: 13000 | loss: 0.2932 | profit rate:  184.2 | accuracy: 0.24
step_num: 13200 | loss: 0.2306 | profit rate:  308.7 | accuracy: 0.23
step_num: 13400 | loss: 0.2578 | profit rate: 1198611.0 | accuracy: 0.25
step_num: 13600 | loss: 0.2966 | profit rate: 571967614.3 | accuracy: 0.26
step_num: 13800 | loss: 0.3004 | profit rate: 331472677.1 | accuracy: 0.26
step_num: 14000 | loss: 0.3175 | profit rate: 85527354613.8 | accuracy: 0.28
step_num: 14200 | loss: 0.3529 | profit rate: 116770533890.2 | accuracy: 0.28
step_num: 14400 | loss: 0.3822 | profit rate: 108035751945.4 | accuracy: 0.28
step_num: 14600 | loss: 0.4113 | profit rate: 11726738808.2 | accuracy: 0.29
step_num: 14800 | loss: 0.4151 | profit rate: 131867144092.0 | accuracy: 0.28
model saved @ step:14832,performance:129517145747.251,accuracy:0.28
step_num: 15000 | loss: 0.4185 | profit rate:  893.6 | accuracy: 0.53
step_num: 15200 | loss: 0.3818 | profit rate: 116638.0 | accuracy: 0.39
step_num: 15400 | loss: 0.4044 | profit rate: 2188069.6 | accuracy: 0.37
step_num: 15600 | loss: 0.3466 | profit rate: 2001439.5 | accuracy: 0.33
step_num: 15800 | loss: 0.3837 | profit rate: 159147.7 | accuracy: 0.33
step_num: 16000 | loss: 0.4053 | profit rate: 78070.2 | accuracy: 0.35
step_num: 16200 | loss: 0.3652 | profit rate: 83313.5 | accuracy: 0.33
step_num: 16400 | loss: 0.3048 | profit rate: 107921.8 | accuracy: 0.31
step_num: 16600 | loss: 0.3289 | profit rate: 257683.5 | accuracy: 0.30
step_num: 16800 | loss: 0.2962 | profit rate: 96653.7 | accuracy: 0.28
step_num: 17000 | loss: 0.2713 | profit rate: 8042703.0 | accuracy: 0.29
step_num: 17200 | loss: 0.2873 | profit rate: 143403738580.2 | accuracy: 0.31
step_num: 17400 | loss: 0.3081 | profit rate: 597968289629.6 | accuracy: 0.31
step_num: 17600 | loss: 0.3188 | profit rate: 6127054815741.5 | accuracy: 0.31
step_num: 17800 | loss: 0.3550 | profit rate: 562228544462328.1 | accuracy: 0.32
step_num: 18000 | loss: 0.4151 | profit rate: 2746953494768947.0 | accuracy: 0.32
step_num: 18200 | loss: 0.3707 | profit rate: 78421802937207.9 | accuracy: 0.32
step_num: 18400 | loss: 0.3852 | profit rate: 632992872474297.2 | accuracy: 0.32
episode:   5/5,耗时:2.25分/11.11分,训练集: | step: 18540 | average_treward:  299.3 | max_treward: 586.6563 | average profit rate: 659077123923012.750
model saved @ step:18540,performance:3295256019030710.000,accuracy:0.31
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 23%|       | 95/406 [00:00<00:00, 950.00it/s] 50%|     | 204/406 [00:00<00:00, 1032.35it/s] 79%|  | 321/406 [00:00<00:00, 1090.42it/s]100%|| 406/406 [00:00<00:00, 1082.36it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1388.31
2023-07-24T12:00:00 | net performance [%] = 38.8310
2023-07-24T12:00:00 | number of trades [#] = 34
==================================================
Trial 37 Complete [00h 11m 10s]
net_wealth: 1389.7000528138942

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 30m 57s

Search: Running Trial #38

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
730               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.6               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
0.5               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4311.000000   4315.000000
mean      0.000441    20062.255222  ...   20133.281642  20118.633889
std       0.027818    16039.874230  ...   16077.358923  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7695.614990   7690.540039
50%       0.000642    11554.824463  ...   11741.480469  11715.610352
75%       0.011655    29873.081836  ...   29939.474609  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.4772 | profit rate:    1.9 | accuracy: 0.42
step_num: 400 | loss: 0.4780 | profit rate:    2.5 | accuracy: 0.40
step_num: 600 | loss: 0.5182 | profit rate:    3.7 | accuracy: 0.40
step_num: 800 | loss: 0.4960 | profit rate:    4.0 | accuracy: 0.39
step_num: 1000 | loss: 0.4367 | profit rate:    5.7 | accuracy: 0.39
step_num: 1200 | loss: 0.4692 | profit rate:   23.3 | accuracy: 0.39
step_num: 1400 | loss: 0.3014 | profit rate:   19.2 | accuracy: 0.37
step_num: 1600 | loss: 0.2354 | profit rate:   19.2 | accuracy: 0.35
step_num: 1800 | loss: 0.4188 | profit rate:   11.7 | accuracy: 0.34
step_num: 2000 | loss: 0.2550 | profit rate:    5.2 | accuracy: 0.33
step_num: 2200 | loss: 0.2984 | profit rate:    2.2 | accuracy: 0.32
step_num: 2400 | loss: 0.2247 | profit rate:    1.6 | accuracy: 0.30
step_num: 2600 | loss: 0.2943 | profit rate:    1.1 | accuracy: 0.30
step_num: 2800 | loss: 0.3035 | profit rate:    0.4 | accuracy: 0.30
step_num: 3000 | loss: 0.3277 | profit rate:    0.3 | accuracy: 0.30
episode:   1/5,耗时:0.72分/0.72分,训练集: | step: 3157 | average_treward:    9.2 | max_treward: 9.1707 | average profit rate:  0.381
model saved @ step:3157,performance:0.381,accuracy:0.29
step_num: 3200 | loss: 0.1278 | profit rate:    0.9 | accuracy: 0.18
step_num: 3400 | loss: 0.3437 | profit rate:    1.5 | accuracy: 0.28
step_num: 3600 | loss: 0.2878 | profit rate:    2.1 | accuracy: 0.28
step_num: 3800 | loss: 0.1961 | profit rate:    1.3 | accuracy: 0.24
step_num: 4000 | loss: 0.1215 | profit rate:    0.9 | accuracy: 0.20
step_num: 4200 | loss: 0.0558 | profit rate:    0.9 | accuracy: 0.17
step_num: 4400 | loss: 0.0548 | profit rate:    0.9 | accuracy: 0.17
step_num: 4600 | loss: 0.0243 | profit rate:    0.8 | accuracy: 0.15
step_num: 4800 | loss: 0.1100 | profit rate:    0.8 | accuracy: 0.14
step_num: 5000 | loss: 0.0855 | profit rate:    0.4 | accuracy: 0.13
step_num: 5200 | loss: 0.0233 | profit rate:    0.6 | accuracy: 0.12
step_num: 5400 | loss: 0.1493 | profit rate:    0.8 | accuracy: 0.13
step_num: 5600 | loss: 0.1381 | profit rate:    0.7 | accuracy: 0.12
step_num: 5800 | loss: 0.2037 | profit rate:    2.4 | accuracy: 0.14
step_num: 6000 | loss: 0.2687 | profit rate:    3.0 | accuracy: 0.15
step_num: 6200 | loss: 0.2988 | profit rate:    4.6 | accuracy: 0.16
model saved @ step:6314,performance:14.114,accuracy:0.17
step_num: 6400 | loss: 0.2650 | profit rate:    1.0 | accuracy: 0.18
step_num: 6600 | loss: 0.1477 | profit rate:    1.4 | accuracy: 0.15
step_num: 6800 | loss: 0.1911 | profit rate:    0.6 | accuracy: 0.14
step_num: 7000 | loss: 0.1857 | profit rate:    0.2 | accuracy: 0.13
step_num: 7200 | loss: 0.0555 | profit rate:    0.1 | accuracy: 0.11
step_num: 7400 | loss: 0.0215 | profit rate:    0.1 | accuracy: 0.10
step_num: 7600 | loss: 0.0679 | profit rate:    0.1 | accuracy: 0.10
step_num: 7800 | loss: 0.0484 | profit rate:    0.1 | accuracy: 0.10
step_num: 8000 | loss: 0.0344 | profit rate:    0.1 | accuracy: 0.09
step_num: 8200 | loss: 0.0495 | profit rate:    0.1 | accuracy: 0.09
step_num: 8400 | loss: 0.0974 | profit rate:    0.2 | accuracy: 0.09
step_num: 8600 | loss: 0.1866 | profit rate:    0.1 | accuracy: 0.10
step_num: 8800 | loss: 0.2013 | profit rate:    0.1 | accuracy: 0.11
step_num: 9000 | loss: 0.0936 | profit rate:    0.1 | accuracy: 0.11
step_num: 9200 | loss: 0.0690 | profit rate:    0.1 | accuracy: 0.11
step_num: 9400 | loss: 0.0336 | profit rate:    0.1 | accuracy: 0.10
episode:   3/5,耗时:0.79分/2.31分,训练集: | step: 9471 | average_treward:   41.0 | max_treward: 116.2360 | average profit rate:  4.850
step_num: 9600 | loss: 0.0381 | profit rate:    1.0 | accuracy: 0.05
step_num: 9800 | loss: 0.1321 | profit rate:    1.3 | accuracy: 0.09
step_num: 10000 | loss: 0.0674 | profit rate:    1.6 | accuracy: 0.09
step_num: 10200 | loss: 0.1338 | profit rate:    1.0 | accuracy: 0.11
step_num: 10400 | loss: 0.0481 | profit rate:    0.9 | accuracy: 0.10
step_num: 10600 | loss: 0.1282 | profit rate:    1.7 | accuracy: 0.10
step_num: 10800 | loss: 0.1038 | profit rate:    8.1 | accuracy: 0.13
step_num: 11000 | loss: 0.2174 | profit rate:   15.1 | accuracy: 0.15
step_num: 11200 | loss: 0.1904 | profit rate:    8.1 | accuracy: 0.14
step_num: 11400 | loss: 0.0199 | profit rate:    7.4 | accuracy: 0.13
step_num: 11600 | loss: 0.0411 | profit rate:   13.7 | accuracy: 0.13
step_num: 11800 | loss: 0.1456 | profit rate:   34.3 | accuracy: 0.13
step_num: 12000 | loss: 0.1431 | profit rate:   39.1 | accuracy: 0.14
step_num: 12200 | loss: 0.2351 | profit rate:  136.7 | accuracy: 0.15
step_num: 12400 | loss: 0.2114 | profit rate:  111.6 | accuracy: 0.16
step_num: 12600 | loss: 0.3628 | profit rate:  386.6 | accuracy: 0.17
model saved @ step:12628,performance:411.826,accuracy:0.17
step_num: 12800 | loss: 0.2103 | profit rate:    2.4 | accuracy: 0.25
step_num: 13000 | loss: 0.2175 | profit rate:    1.6 | accuracy: 0.25
step_num: 13200 | loss: 0.2037 | profit rate:    0.7 | accuracy: 0.23
step_num: 13400 | loss: 0.0979 | profit rate:    1.0 | accuracy: 0.20
step_num: 13600 | loss: 0.0477 | profit rate:    0.6 | accuracy: 0.17
step_num: 13800 | loss: 0.0967 | profit rate:    1.0 | accuracy: 0.16
step_num: 14000 | loss: 0.0560 | profit rate:    2.3 | accuracy: 0.15
step_num: 14200 | loss: 0.0888 | profit rate:    4.0 | accuracy: 0.15
step_num: 14400 | loss: 0.1445 | profit rate:    4.3 | accuracy: 0.15
step_num: 14600 | loss: 0.0791 | profit rate:    5.2 | accuracy: 0.15
step_num: 14800 | loss: 0.1683 | profit rate:    9.1 | accuracy: 0.15
step_num: 15000 | loss: 0.1593 | profit rate:   23.9 | accuracy: 0.16
step_num: 15200 | loss: 0.1277 | profit rate:   19.1 | accuracy: 0.16
step_num: 15400 | loss: 0.1218 | profit rate:   31.0 | accuracy: 0.16
step_num: 15600 | loss: 0.1888 | profit rate:  123.2 | accuracy: 0.17
episode:   5/5,耗时:0.78分/3.87分,训练集: | step: 15785 | average_treward:  105.1 | max_treward: 212.6699 | average profit rate: 135.906
model saved @ step:15785,performance:253.151,accuracy:0.18
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 24%|       | 94/391 [00:00<00:00, 935.98it/s] 53%|    | 207/391 [00:00<00:00, 1045.81it/s] 82%| | 319/391 [00:00<00:00, 1074.70it/s]==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
100%|| 391/391 [00:00<00:00, 1062.22it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 949.59
2023-07-24T12:00:00 | net performance [%] = -5.0406
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 38 Complete [00h 03m 56s]
net_wealth: 949.5941643539905

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 34m 53s

Search: Running Trial #39

Value             |Best Value So Far |Hyperparameter
13                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.8               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
64                |64                |memory_size
64                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4302.000000   4315.000000
mean      0.000441    20062.255222  ...   20165.724363  20118.633889
std       0.027818    16039.874230  ...   16078.496018  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7729.197632   7690.540039
50%       0.000642    11554.824463  ...   11751.060059  11715.610352
75%       0.011655    29873.081836  ...   30007.945801  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 0.4350 | profit rate:    5.3 | accuracy: 0.35
step_num: 400 | loss: 0.4576 | profit rate:   10.7 | accuracy: 0.37
step_num: 600 | loss: 0.5860 | profit rate:   16.1 | accuracy: 0.37
step_num: 800 | loss: 0.6031 | profit rate:    0.4 | accuracy: 0.37
step_num: 1000 | loss: 0.5350 | profit rate:    3.9 | accuracy: 0.38
step_num: 1200 | loss: 0.5780 | profit rate:   17.4 | accuracy: 0.38
step_num: 1400 | loss: 0.4898 | profit rate:    0.4 | accuracy: 0.35
step_num: 1600 | loss: 0.5658 | profit rate:    0.1 | accuracy: 0.34
step_num: 1800 | loss: 0.4366 | profit rate:    0.1 | accuracy: 0.34
step_num: 2000 | loss: 0.7981 | profit rate:    0.1 | accuracy: 0.35
step_num: 2200 | loss: 0.8487 | profit rate:    0.0 | accuracy: 0.33
step_num: 2400 | loss: 0.1406 | profit rate:    0.0 | accuracy: 0.31
step_num: 2600 | loss: 0.8215 | profit rate:    0.0 | accuracy: 0.31
step_num: 2800 | loss: 0.0822 | profit rate:    0.0 | accuracy: 0.30
step_num: 3000 | loss: 0.9666 | profit rate:    0.0 | accuracy: 0.29
step_num: 3200 | loss: 0.6972 | profit rate:    0.0 | accuracy: 0.29
step_num: 3400 | loss: 0.2465 | profit rate:    0.0 | accuracy: 0.30
step_num: 3600 | loss: 0.5995 | profit rate:    0.0 | accuracy: 0.30
episode:   1/5,耗时:0.44分/0.44分,训练集: | step: 3662 | average_treward: -112.4 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3800 | loss: 0.3504 | profit rate:    2.8 | accuracy: 0.15
step_num: 4000 | loss: 0.5253 | profit rate:    6.6 | accuracy: 0.21
step_num: 4200 | loss: 0.2653 | profit rate:    3.5 | accuracy: 0.18
step_num: 4400 | loss: 0.0273 | profit rate:   72.8 | accuracy: 0.19
step_num: 4600 | loss: 0.5964 | profit rate:    2.3 | accuracy: 0.19
step_num: 4800 | loss: 0.8843 | profit rate:   38.1 | accuracy: 0.23
step_num: 5000 | loss: 0.8145 | profit rate:    1.2 | accuracy: 0.24
step_num: 5200 | loss: 0.3293 | profit rate:    7.0 | accuracy: 0.25
step_num: 5400 | loss: 0.2126 | profit rate:    0.1 | accuracy: 0.23
step_num: 5600 | loss: 0.0142 | profit rate:    0.1 | accuracy: 0.21
step_num: 5800 | loss: 0.2020 | profit rate:    0.3 | accuracy: 0.20
step_num: 6000 | loss: 0.0679 | profit rate:    0.1 | accuracy: 0.19
step_num: 6200 | loss: 0.0099 | profit rate:    0.2 | accuracy: 0.17
step_num: 6400 | loss: 0.4933 | profit rate:    0.9 | accuracy: 0.18
step_num: 6600 | loss: 0.0547 | profit rate:    3.9 | accuracy: 0.18
step_num: 6800 | loss: 0.3677 | profit rate:   15.6 | accuracy: 0.18
step_num: 7000 | loss: 0.0947 | profit rate:    2.4 | accuracy: 0.18
step_num: 7200 | loss: 0.4288 | profit rate:    6.9 | accuracy: 0.19
model saved @ step:7324,performance:86.134,accuracy:0.19
step_num: 7400 | loss: 0.4251 | profit rate:    3.1 | accuracy: 0.22
step_num: 7600 | loss: 0.5535 | profit rate:  194.2 | accuracy: 0.28
step_num: 7800 | loss: 0.4644 | profit rate: 1023.4 | accuracy: 0.30
step_num: 8000 | loss: 0.5930 | profit rate: 18339.6 | accuracy: 0.31
step_num: 8200 | loss: 0.2883 | profit rate: 19511.5 | accuracy: 0.29
step_num: 8400 | loss: 0.1470 | profit rate:    5.7 | accuracy: 0.26
step_num: 8600 | loss: 0.5143 | profit rate:  123.1 | accuracy: 0.25
step_num: 8800 | loss: 0.3157 | profit rate:  216.0 | accuracy: 0.26
step_num: 9000 | loss: 0.1012 | profit rate:  552.8 | accuracy: 0.25
step_num: 9200 | loss: 0.7229 | profit rate:   11.2 | accuracy: 0.24
step_num: 9400 | loss: 0.0594 | profit rate:   11.9 | accuracy: 0.23
step_num: 9600 | loss: 0.6567 | profit rate:  165.3 | accuracy: 0.24
step_num: 9800 | loss: 0.7932 | profit rate:  710.3 | accuracy: 0.25
step_num: 10000 | loss: 0.3854 | profit rate:   35.5 | accuracy: 0.24
step_num: 10200 | loss: 0.8325 | profit rate: 14579.4 | accuracy: 0.27
step_num: 10400 | loss: 0.1476 | profit rate: 8711.1 | accuracy: 0.26
step_num: 10600 | loss: 0.0052 | profit rate: 19659.2 | accuracy: 0.25
step_num: 10800 | loss: 0.2392 | profit rate: 51488.8 | accuracy: 0.25
episode:   3/5,耗时:0.48分/1.40分,训练集: | step: 10986 | average_treward:   50.5 | max_treward: 176.4764 | average profit rate: 59704.230
model saved @ step:10986,performance:179026.556,accuracy:0.24
step_num: 11000 | loss: 0.2292 | profit rate:    4.3 | accuracy: 0.80
step_num: 11200 | loss: 0.2410 | profit rate:    0.1 | accuracy: 0.25
step_num: 11400 | loss: 0.1869 | profit rate:    2.6 | accuracy: 0.28
step_num: 11600 | loss: 0.4593 | profit rate:    0.9 | accuracy: 0.27
step_num: 11800 | loss: 0.1909 | profit rate:    8.7 | accuracy: 0.24
step_num: 12000 | loss: 0.9991 | profit rate:    0.0 | accuracy: 0.24
step_num: 12200 | loss: 0.2820 | profit rate:    0.0 | accuracy: 0.26
step_num: 12400 | loss: 0.4200 | profit rate:    0.0 | accuracy: 0.27
step_num: 12600 | loss: 0.0665 | profit rate:    0.1 | accuracy: 0.24
step_num: 12800 | loss: 0.0302 | profit rate:    0.0 | accuracy: 0.22
step_num: 13000 | loss: 0.2526 | profit rate:    0.0 | accuracy: 0.22
step_num: 13200 | loss: 1.1952 | profit rate:  928.8 | accuracy: 0.25
step_num: 13400 | loss: 0.7252 | profit rate: 184491.1 | accuracy: 0.28
step_num: 13600 | loss: 0.6932 | profit rate:   59.3 | accuracy: 0.27
step_num: 13800 | loss: 0.5883 | profit rate: 4018.7 | accuracy: 0.29
step_num: 14000 | loss: 0.1307 | profit rate: 5394.2 | accuracy: 0.28
step_num: 14200 | loss: 0.0219 | profit rate: 6335.7 | accuracy: 0.28
step_num: 14400 | loss: 0.3263 | profit rate: 19861.2 | accuracy: 0.26
step_num: 14600 | loss: 0.0968 | profit rate: 41519.5 | accuracy: 0.26
model saved @ step:14648,performance:43038.916,accuracy:0.26
step_num: 14800 | loss: 0.6454 | profit rate:    0.2 | accuracy: 0.31
step_num: 15000 | loss: 0.6283 | profit rate:    2.7 | accuracy: 0.34
step_num: 15200 | loss: 0.2908 | profit rate:    0.3 | accuracy: 0.27
step_num: 15400 | loss: 0.0182 | profit rate:    4.2 | accuracy: 0.25
step_num: 15600 | loss: 1.1124 | profit rate:    0.1 | accuracy: 0.24
step_num: 15800 | loss: 1.1252 | profit rate:    0.2 | accuracy: 0.29
step_num: 16000 | loss: 0.6747 | profit rate:    0.4 | accuracy: 0.29
step_num: 16200 | loss: 0.2745 | profit rate:    5.6 | accuracy: 0.28
step_num: 16400 | loss: 0.0012 | profit rate:    2.1 | accuracy: 0.26
step_num: 16600 | loss: 0.2673 | profit rate:    0.4 | accuracy: 0.27
step_num: 16800 | loss: 0.7524 | profit rate:   88.7 | accuracy: 0.28
step_num: 17000 | loss: 0.7399 | profit rate: 108663492.7 | accuracy: 0.32
step_num: 17200 | loss: 0.0745 | profit rate: 8159731.1 | accuracy: 0.32
step_num: 17400 | loss: 0.9874 | profit rate: 26090516.3 | accuracy: 0.32
step_num: 17600 | loss: 0.2889 | profit rate: 342893852.9 | accuracy: 0.33
step_num: 17800 | loss: 0.4221 | profit rate: 985144132.6 | accuracy: 0.32
step_num: 18000 | loss: 0.0169 | profit rate: 1858981556.9 | accuracy: 0.30
step_num: 18200 | loss: 0.4491 | profit rate: 22052648419.0 | accuracy: 0.30
episode:   5/5,耗时:0.49分/2.38分,训练集: | step: 18310 | average_treward:  139.8 | max_treward: 359.1086 | average profit rate: 9865217262.256
model saved @ step:18310,performance:49325864159.675,accuracy:0.30
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 22%|       | 85/391 [00:00<00:00, 841.59it/s] 52%|    | 204/391 [00:00<00:00, 1045.06it/s] 82%| | 321/391 [00:00<00:00, 1101.92it/s]100%|| 391/391 [00:00<00:00, 1076.61it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1354.92
2023-07-24T12:00:00 | net performance [%] = 35.4924
2023-07-24T12:00:00 | number of trades [#] = 16
==================================================
Trial 39 Complete [00h 02m 27s]
net_wealth: 1354.9242996447347

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 37m 20s

Search: Running Trial #40

Value             |Best Value So Far |Hyperparameter
1                 |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.92              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.1361 | profit rate:    0.8 | accuracy: 0.32
step_num: 1200 | loss: 0.7285 | profit rate:    0.5 | accuracy: 0.32
step_num: 1400 | loss: 0.6468 | profit rate:    0.5 | accuracy: 0.32
step_num: 1600 | loss: 0.5992 | profit rate:    0.5 | accuracy: 0.32
step_num: 1800 | loss: 0.5981 | profit rate:    0.3 | accuracy: 0.33
step_num: 2000 | loss: 0.5578 | profit rate:    0.3 | accuracy: 0.32
step_num: 2200 | loss: 0.5229 | profit rate:    0.3 | accuracy: 0.33
step_num: 2400 | loss: 0.4946 | profit rate:    0.3 | accuracy: 0.33
step_num: 2600 | loss: 0.4658 | profit rate:    0.3 | accuracy: 0.33
step_num: 2800 | loss: 0.4419 | profit rate:    0.3 | accuracy: 0.32
step_num: 3000 | loss: 0.4009 | profit rate:    0.4 | accuracy: 0.31
episode:   1/5,耗时:0.85分/0.85分,训练集: | step: 3160 | average_treward:   36.2 | max_treward: 36.1979 | average profit rate:  0.313
model saved @ step:3160,performance:0.313,accuracy:0.30
step_num: 3200 | loss: 0.3852 | profit rate:    0.9 | accuracy: 0.20
step_num: 3400 | loss: 0.3814 | profit rate:    1.2 | accuracy: 0.22
step_num: 3600 | loss: 0.3551 | profit rate:    1.1 | accuracy: 0.25
step_num: 3800 | loss: 0.3406 | profit rate:    0.6 | accuracy: 0.25
step_num: 4000 | loss: 0.3351 | profit rate:    0.9 | accuracy: 0.26
step_num: 4200 | loss: 0.2926 | profit rate:    0.9 | accuracy: 0.27
step_num: 4400 | loss: 0.3043 | profit rate:    1.0 | accuracy: 0.26
step_num: 4600 | loss: 0.2612 | profit rate:    1.1 | accuracy: 0.26
step_num: 4800 | loss: 0.2706 | profit rate:    1.5 | accuracy: 0.26
step_num: 5000 | loss: 0.2774 | profit rate:    3.0 | accuracy: 0.28
step_num: 5200 | loss: 0.3170 | profit rate:    1.9 | accuracy: 0.27
step_num: 5400 | loss: 0.3077 | profit rate:    1.5 | accuracy: 0.27
step_num: 5600 | loss: 0.3065 | profit rate:    1.5 | accuracy: 0.28
step_num: 5800 | loss: 0.2917 | profit rate:    1.4 | accuracy: 0.28
step_num: 6000 | loss: 0.2872 | profit rate:    1.0 | accuracy: 0.27
step_num: 6200 | loss: 0.2822 | profit rate:    0.9 | accuracy: 0.27
model saved @ step:6320,performance:0.870,accuracy:0.26
step_num: 6400 | loss: 0.2651 | profit rate:    0.8 | accuracy: 0.19
step_num: 6600 | loss: 0.2667 | profit rate:    0.6 | accuracy: 0.16
step_num: 6800 | loss: 0.2693 | profit rate:    0.6 | accuracy: 0.22
step_num: 7000 | loss: 0.2671 | profit rate:    1.2 | accuracy: 0.28
step_num: 7200 | loss: 0.2593 | profit rate:    1.3 | accuracy: 0.27
step_num: 7400 | loss: 0.2296 | profit rate:    1.5 | accuracy: 0.26
step_num: 7600 | loss: 0.2271 | profit rate:    2.8 | accuracy: 0.26
step_num: 7800 | loss: 0.1968 | profit rate:    3.0 | accuracy: 0.26
step_num: 8000 | loss: 0.2178 | profit rate:    5.0 | accuracy: 0.28
step_num: 8200 | loss: 0.2456 | profit rate:    7.5 | accuracy: 0.29
step_num: 8400 | loss: 0.2389 | profit rate:    6.0 | accuracy: 0.29
step_num: 8600 | loss: 0.2729 | profit rate:    6.8 | accuracy: 0.29
step_num: 8800 | loss: 0.2629 | profit rate:    4.8 | accuracy: 0.28
step_num: 9000 | loss: 0.2398 | profit rate:    4.4 | accuracy: 0.28
step_num: 9200 | loss: 0.2395 | profit rate:    3.5 | accuracy: 0.27
step_num: 9400 | loss: 0.2574 | profit rate:    4.0 | accuracy: 0.27
episode:   3/5,耗时:1.18分/3.22分,训练集: | step: 9480 | average_treward:  150.7 | max_treward: 264.6391 | average profit rate:  1.652
model saved @ step:9480,performance:3.773,accuracy:0.26
step_num: 9600 | loss: 0.2393 | profit rate:    0.8 | accuracy: 0.21
step_num: 9800 | loss: 0.2363 | profit rate:    0.5 | accuracy: 0.18
step_num: 10000 | loss: 0.2254 | profit rate:    0.7 | accuracy: 0.26
step_num: 10200 | loss: 0.2447 | profit rate:    1.0 | accuracy: 0.29
step_num: 10400 | loss: 0.2271 | profit rate:    1.1 | accuracy: 0.28
step_num: 10600 | loss: 0.2226 | profit rate:    1.8 | accuracy: 0.28
step_num: 10800 | loss: 0.2154 | profit rate:    1.9 | accuracy: 0.27
step_num: 11000 | loss: 0.1931 | profit rate:    2.3 | accuracy: 0.27
step_num: 11200 | loss: 0.2180 | profit rate:    4.7 | accuracy: 0.29
step_num: 11400 | loss: 0.2522 | profit rate:    6.2 | accuracy: 0.30
step_num: 11600 | loss: 0.2568 | profit rate:    6.2 | accuracy: 0.31
step_num: 11800 | loss: 0.2757 | profit rate:    5.8 | accuracy: 0.31
step_num: 12000 | loss: 0.2675 | profit rate:    6.5 | accuracy: 0.30
step_num: 12200 | loss: 0.2547 | profit rate:    7.8 | accuracy: 0.30
step_num: 12400 | loss: 0.2496 | profit rate:    7.1 | accuracy: 0.29
step_num: 12600 | loss: 0.2486 | profit rate:    8.1 | accuracy: 0.28
model saved @ step:12640,performance:7.704,accuracy:0.28
step_num: 12800 | loss: 0.2610 | profit rate:    0.8 | accuracy: 0.22
step_num: 13000 | loss: 0.2636 | profit rate:    0.7 | accuracy: 0.23
step_num: 13200 | loss: 0.2520 | profit rate:    0.9 | accuracy: 0.25
step_num: 13400 | loss: 0.2602 | profit rate:    1.5 | accuracy: 0.29
step_num: 13600 | loss: 0.2382 | profit rate:    1.8 | accuracy: 0.29
step_num: 13800 | loss: 0.2347 | profit rate:    4.5 | accuracy: 0.30
step_num: 14000 | loss: 0.2241 | profit rate:    5.1 | accuracy: 0.29
step_num: 14200 | loss: 0.2076 | profit rate:    6.8 | accuracy: 0.30
step_num: 14400 | loss: 0.2456 | profit rate:   11.1 | accuracy: 0.32
step_num: 14600 | loss: 0.2680 | profit rate:   19.5 | accuracy: 0.34
step_num: 14800 | loss: 0.2815 | profit rate:   27.3 | accuracy: 0.34
step_num: 15000 | loss: 0.3042 | profit rate:   22.5 | accuracy: 0.34
step_num: 15200 | loss: 0.2963 | profit rate:   21.0 | accuracy: 0.33
step_num: 15400 | loss: 0.2923 | profit rate:   17.4 | accuracy: 0.33
step_num: 15600 | loss: 0.3068 | profit rate:   20.3 | accuracy: 0.32
episode:   5/5,耗时:1.16分/5.56分,训练集: | step: 15800 | average_treward:  234.1 | max_treward: 360.9156 | average profit rate:  6.482
model saved @ step:15800,performance:19.749,accuracy:0.31
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 25%|       | 104/408 [00:00<00:00, 1030.36it/s] 52%|    | 213/408 [00:00<00:00, 1065.03it/s] 79%|  | 323/408 [00:00<00:00, 1080.96it/s]100%|| 408/408 [00:00<00:00, 1090.96it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1496.90
2023-07-24T12:00:00 | net performance [%] = 49.6904
2023-07-24T12:00:00 | number of trades [#] = 90
==================================================
Trial 40 Complete [00h 05m 37s]
net_wealth: 1498.402520593829

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 42m 56s

Search: Running Trial #41

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.7               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 0.8929 | profit rate:    0.4 | accuracy: 0.35
step_num: 1200 | loss: 0.7267 | profit rate:    0.3 | accuracy: 0.34
step_num: 1400 | loss: 0.6618 | profit rate:    0.4 | accuracy: 0.35
step_num: 1600 | loss: 0.6550 | profit rate:    0.9 | accuracy: 0.35
step_num: 1800 | loss: 0.6779 | profit rate:    1.5 | accuracy: 0.35
step_num: 2000 | loss: 0.5963 | profit rate:    4.2 | accuracy: 0.34
step_num: 2200 | loss: 0.6104 | profit rate:  621.8 | accuracy: 0.34
step_num: 2400 | loss: 0.5651 | profit rate:  603.2 | accuracy: 0.33
step_num: 2600 | loss: 0.5773 | profit rate:  923.3 | accuracy: 0.33
step_num: 2800 | loss: 0.5723 | profit rate: 6596.4 | accuracy: 0.34
step_num: 3000 | loss: 0.5536 | profit rate: 23214.2 | accuracy: 0.34
step_num: 3200 | loss: 0.5514 | profit rate: 38422.1 | accuracy: 0.34
step_num: 3400 | loss: 0.5678 | profit rate: 655792.3 | accuracy: 0.35
step_num: 3600 | loss: 0.5842 | profit rate: 76684.5 | accuracy: 0.34
episode:   1/5,耗时:1.06分/1.06分,训练集: | step: 3662 | average_treward:  203.1 | max_treward: 203.0627 | average profit rate: 90448.624
model saved @ step:3662,performance:90448.624,accuracy:0.35
step_num: 3800 | loss: 0.5234 | profit rate:    0.6 | accuracy: 0.19
step_num: 4000 | loss: 0.5854 | profit rate:   49.7 | accuracy: 0.40
step_num: 4200 | loss: 0.6311 | profit rate:    0.3 | accuracy: 0.32
step_num: 4400 | loss: 0.6434 | profit rate:  166.1 | accuracy: 0.37
step_num: 4600 | loss: 0.6601 | profit rate:   40.2 | accuracy: 0.36
step_num: 4800 | loss: 0.6486 | profit rate: 58855.5 | accuracy: 0.39
step_num: 5000 | loss: 0.6538 | profit rate: 54287.1 | accuracy: 0.39
step_num: 5200 | loss: 0.6581 | profit rate: 446117.4 | accuracy: 0.39
step_num: 5400 | loss: 0.6482 | profit rate: 4899.8 | accuracy: 0.36
step_num: 5600 | loss: 0.6001 | profit rate:  502.1 | accuracy: 0.36
step_num: 5800 | loss: 0.6314 | profit rate: 51788.8 | accuracy: 0.37
step_num: 6000 | loss: 0.6256 | profit rate: 56934576.3 | accuracy: 0.38
step_num: 6200 | loss: 0.6079 | profit rate: 4810610.4 | accuracy: 0.37
step_num: 6400 | loss: 0.5874 | profit rate: 525053.3 | accuracy: 0.37
step_num: 6600 | loss: 0.6275 | profit rate: 18646085.5 | accuracy: 0.38
step_num: 6800 | loss: 0.5783 | profit rate: 2046667.8 | accuracy: 0.36
step_num: 7000 | loss: 0.5883 | profit rate: 1420204532.5 | accuracy: 0.37
step_num: 7200 | loss: 0.5352 | profit rate: 991490221.7 | accuracy: 0.36
model saved @ step:7324,performance:1194609000.272,accuracy:0.36
step_num: 7400 | loss: 0.5067 | profit rate:    0.6 | accuracy: 0.22
step_num: 7600 | loss: 0.5332 | profit rate:    0.7 | accuracy: 0.28
step_num: 7800 | loss: 0.5570 | profit rate:    1.0 | accuracy: 0.30
step_num: 8000 | loss: 0.5252 | profit rate:  389.7 | accuracy: 0.31
step_num: 8200 | loss: 0.4929 | profit rate:  652.1 | accuracy: 0.31
step_num: 8400 | loss: 0.4999 | profit rate: 214603.8 | accuracy: 0.34
step_num: 8600 | loss: 0.5230 | profit rate: 1654699.7 | accuracy: 0.35
step_num: 8800 | loss: 0.5198 | profit rate: 1052748.0 | accuracy: 0.35
step_num: 9000 | loss: 0.5400 | profit rate: 5816546.2 | accuracy: 0.34
step_num: 9200 | loss: 0.5331 | profit rate: 160155.7 | accuracy: 0.33
step_num: 9400 | loss: 0.5552 | profit rate: 394988.9 | accuracy: 0.33
step_num: 9600 | loss: 0.5496 | profit rate: 20650992923.3 | accuracy: 0.36
step_num: 9800 | loss: 0.5556 | profit rate: 245691987230.5 | accuracy: 0.35
step_num: 10000 | loss: 0.5471 | profit rate: 1156503219199.6 | accuracy: 0.36
step_num: 10200 | loss: 0.5967 | profit rate: 15582565103108.0 | accuracy: 0.37
step_num: 10400 | loss: 0.5620 | profit rate: 57144764990643.4 | accuracy: 0.36
step_num: 10600 | loss: 0.5332 | profit rate: 10590254194356570.0 | accuracy: 0.37
step_num: 10800 | loss: 0.5319 | profit rate: 83540181564336880.0 | accuracy: 0.36
episode:   3/5,耗时:1.43分/3.92分,训练集: | step: 10986 | average_treward:  311.0 | max_treward: 490.3220 | average profit rate: 56093527888435816.000
model saved @ step:10986,performance:168280582470608000.000,accuracy:0.36
step_num: 11000 | loss: 0.5383 | profit rate:    3.4 | accuracy: 0.53
step_num: 11200 | loss: 0.5896 | profit rate:    7.8 | accuracy: 0.37
step_num: 11400 | loss: 0.5507 | profit rate:  170.7 | accuracy: 0.39
step_num: 11600 | loss: 0.5533 | profit rate:   10.9 | accuracy: 0.32
step_num: 11800 | loss: 0.5295 | profit rate: 22935.4 | accuracy: 0.34
step_num: 12000 | loss: 0.5509 | profit rate: 114254.5 | accuracy: 0.36
step_num: 12200 | loss: 0.5632 | profit rate: 40694.3 | accuracy: 0.36
step_num: 12400 | loss: 0.5956 | profit rate: 682226.2 | accuracy: 0.39
step_num: 12600 | loss: 0.6061 | profit rate: 11716253.3 | accuracy: 0.37
step_num: 12800 | loss: 0.6043 | profit rate: 219728.9 | accuracy: 0.35
step_num: 13000 | loss: 0.6066 | profit rate: 121684.3 | accuracy: 0.36
step_num: 13200 | loss: 0.5965 | profit rate: 19166832700.9 | accuracy: 0.38
step_num: 13400 | loss: 0.6003 | profit rate: 5580341554.1 | accuracy: 0.38
step_num: 13600 | loss: 0.5865 | profit rate: 4320839739.8 | accuracy: 0.38
step_num: 13800 | loss: 0.6150 | profit rate: 287090873642.5 | accuracy: 0.39
step_num: 14000 | loss: 0.6099 | profit rate: 1833257478846.9 | accuracy: 0.39
step_num: 14200 | loss: 0.5605 | profit rate: 50334853181208.1 | accuracy: 0.39
step_num: 14400 | loss: 0.5466 | profit rate: 4854849760919342.0 | accuracy: 0.38
step_num: 14600 | loss: 0.5003 | profit rate: 5975464437984660.0 | accuracy: 0.38
step_num: 14800 | loss: 0.5600 | profit rate:    4.0 | accuracy: 0.29
step_num: 15000 | loss: 0.5452 | profit rate:  281.9 | accuracy: 0.42
step_num: 15200 | loss: 0.5960 | profit rate:   13.4 | accuracy: 0.32
step_num: 15400 | loss: 0.5165 | profit rate: 90495.5 | accuracy: 0.35
step_num: 15600 | loss: 0.5322 | profit rate: 5289.5 | accuracy: 0.36
step_num: 15800 | loss: 0.5646 | profit rate: 4308914.2 | accuracy: 0.39
step_num: 16000 | loss: 0.5581 | profit rate: 2535153.0 | accuracy: 0.40
step_num: 16200 | loss: 0.5857 | profit rate: 15307897.0 | accuracy: 0.39
step_num: 16400 | loss: 0.6075 | profit rate: 2708265.0 | accuracy: 0.36
step_num: 16600 | loss: 0.5980 | profit rate: 259782.4 | accuracy: 0.37
step_num: 16800 | loss: 0.6096 | profit rate: 249173194.0 | accuracy: 0.39
step_num: 17000 | loss: 0.6019 | profit rate: 10739600010743.2 | accuracy: 0.40
step_num: 17200 | loss: 0.5808 | profit rate: 60934706859674.7 | accuracy: 0.40
step_num: 17400 | loss: 0.6174 | profit rate: 40337934558985.8 | accuracy: 0.40
step_num: 17600 | loss: 0.6269 | profit rate: 1369397414741848.0 | accuracy: 0.40
step_num: 17800 | loss: 0.5770 | profit rate: 625950609693094.6 | accuracy: 0.39
step_num: 18000 | loss: 0.5114 | profit rate: 204975161563148864.0 | accuracy: 0.39
step_num: 18200 | loss: 0.5340 | profit rate: 1214692929495500288.0 | accuracy: 0.38
episode:   5/5,耗时:1.42分/6.76分,训练集: | step: 18310 | average_treward:  376.7 | max_treward: 500.5490 | average profit rate: 248729126692557472.000
model saved @ step:18310,performance:1065319287375885312.000,accuracy:0.38
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 26%|       | 103/391 [00:00<00:00, 1019.80it/s] 52%|    | 205/391 [00:00<00:00, 1019.87it/s] 79%|  | 307/391 [00:00<00:00, 1006.17it/s]100%|| 391/391 [00:00<00:00, 1007.46it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1095.36
2023-07-24T12:00:00 | net performance [%] = 9.5365
2023-07-24T12:00:00 | number of trades [#] = 24
==================================================
Trial 41 Complete [00h 06m 49s]
net_wealth: 1096.4614494570308

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 49m 46s

Search: Running Trial #42

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
8                 |5                 |lags
0.6               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.8585 | profit rate:    1.0 | accuracy: 0.33
step_num: 600 | loss: 0.5619 | profit rate:    0.7 | accuracy: 0.33
step_num: 800 | loss: 0.6421 | profit rate:    0.5 | accuracy: 0.34
step_num: 1000 | loss: 0.5374 | profit rate:    0.9 | accuracy: 0.34
step_num: 1200 | loss: 0.5481 | profit rate:    2.8 | accuracy: 0.35
step_num: 1400 | loss: 0.4958 | profit rate:    2.6 | accuracy: 0.34
step_num: 1600 | loss: 0.5176 | profit rate:    4.6 | accuracy: 0.34
step_num: 1800 | loss: 0.4958 | profit rate:    1.4 | accuracy: 0.34
step_num: 2000 | loss: 0.3821 | profit rate:    1.4 | accuracy: 0.33
step_num: 2200 | loss: 0.4179 | profit rate:    2.4 | accuracy: 0.34
step_num: 2400 | loss: 0.4743 | profit rate:   28.7 | accuracy: 0.36
step_num: 2600 | loss: 0.5423 | profit rate:    6.5 | accuracy: 0.35
step_num: 2800 | loss: 0.5392 | profit rate:   14.3 | accuracy: 0.35
step_num: 3000 | loss: 0.5223 | profit rate:    9.5 | accuracy: 0.35
step_num: 3200 | loss: 0.4097 | profit rate:    7.7 | accuracy: 0.34
step_num: 3400 | loss: 0.3675 | profit rate:   15.7 | accuracy: 0.34
step_num: 3600 | loss: 0.2960 | profit rate:   38.0 | accuracy: 0.34
episode:   1/5,耗时:0.88分/0.88分,训练集: | step: 3705 | average_treward:   88.3 | max_treward: 88.2647 | average profit rate: 25.866
model saved @ step:3705,performance:25.866,accuracy:0.33
step_num: 3800 | loss: 0.3995 | profit rate:    3.0 | accuracy: 0.36
step_num: 4000 | loss: 0.4120 | profit rate:    1.6 | accuracy: 0.29
step_num: 4200 | loss: 0.3813 | profit rate:    1.9 | accuracy: 0.24
step_num: 4400 | loss: 0.2603 | profit rate:    2.8 | accuracy: 0.23
step_num: 4600 | loss: 0.2298 | profit rate:    1.2 | accuracy: 0.22
step_num: 4800 | loss: 0.3205 | profit rate:    1.5 | accuracy: 0.23
step_num: 5000 | loss: 0.2355 | profit rate:    2.0 | accuracy: 0.21
step_num: 5200 | loss: 0.1757 | profit rate:    2.3 | accuracy: 0.19
step_num: 5400 | loss: 0.1088 | profit rate:    2.3 | accuracy: 0.19
step_num: 5600 | loss: 0.0720 | profit rate:    1.9 | accuracy: 0.17
step_num: 5800 | loss: 0.1042 | profit rate:    2.0 | accuracy: 0.17
step_num: 6000 | loss: 0.1516 | profit rate:    5.7 | accuracy: 0.17
step_num: 6200 | loss: 0.1897 | profit rate:    9.1 | accuracy: 0.18
step_num: 6400 | loss: 0.2047 | profit rate:   11.1 | accuracy: 0.17
step_num: 6600 | loss: 0.1773 | profit rate:   14.1 | accuracy: 0.17
step_num: 6800 | loss: 0.1863 | profit rate:   28.1 | accuracy: 0.18
step_num: 7000 | loss: 0.2015 | profit rate:   22.6 | accuracy: 0.18
step_num: 7200 | loss: 0.2698 | profit rate:   33.5 | accuracy: 0.18
step_num: 7400 | loss: 0.2326 | profit rate:   20.2 | accuracy: 0.18
model saved @ step:7410,performance:20.364,accuracy:0.18
step_num: 7600 | loss: 0.2860 | profit rate:    1.5 | accuracy: 0.20
step_num: 7800 | loss: 0.2685 | profit rate:    1.5 | accuracy: 0.15
step_num: 8000 | loss: 0.1381 | profit rate:    1.4 | accuracy: 0.12
step_num: 8200 | loss: 0.0806 | profit rate:    1.8 | accuracy: 0.12
step_num: 8400 | loss: 0.0984 | profit rate:    1.3 | accuracy: 0.12
step_num: 8600 | loss: 0.1460 | profit rate:    2.1 | accuracy: 0.13
step_num: 8800 | loss: 0.1403 | profit rate:    1.9 | accuracy: 0.12
step_num: 9000 | loss: 0.1341 | profit rate:    3.0 | accuracy: 0.13
step_num: 9200 | loss: 0.1657 | profit rate:    1.3 | accuracy: 0.13
step_num: 9400 | loss: 0.1444 | profit rate:    0.9 | accuracy: 0.12
step_num: 9600 | loss: 0.1065 | profit rate:    1.4 | accuracy: 0.13
step_num: 9800 | loss: 0.1479 | profit rate:   28.5 | accuracy: 0.14
step_num: 10000 | loss: 0.1618 | profit rate:   43.4 | accuracy: 0.14
step_num: 10200 | loss: 0.2310 | profit rate:   52.1 | accuracy: 0.15
step_num: 10400 | loss: 0.2598 | profit rate:   92.4 | accuracy: 0.16
step_num: 10600 | loss: 0.2509 | profit rate:   85.0 | accuracy: 0.16
step_num: 10800 | loss: 0.2306 | profit rate:   82.8 | accuracy: 0.16
step_num: 11000 | loss: 0.1840 | profit rate:  137.2 | accuracy: 0.16
episode:   3/5,耗时:0.95分/2.80分,训练集: | step: 11115 | average_treward:  141.8 | max_treward: 216.0864 | average profit rate: 56.619
model saved @ step:11115,performance:123.628,accuracy:0.17
step_num: 11200 | loss: 0.2516 | profit rate:    1.8 | accuracy: 0.24
step_num: 11400 | loss: 0.3354 | profit rate:    2.9 | accuracy: 0.24
step_num: 11600 | loss: 0.2957 | profit rate:    3.5 | accuracy: 0.20
step_num: 11800 | loss: 0.1769 | profit rate:    4.7 | accuracy: 0.18
step_num: 12000 | loss: 0.1720 | profit rate:    3.6 | accuracy: 0.18
step_num: 12200 | loss: 0.1545 | profit rate:    6.3 | accuracy: 0.18
step_num: 12400 | loss: 0.1632 | profit rate:    9.5 | accuracy: 0.17
step_num: 12600 | loss: 0.1396 | profit rate:   14.4 | accuracy: 0.17
step_num: 12800 | loss: 0.1457 | profit rate:   10.6 | accuracy: 0.17
step_num: 13000 | loss: 0.1123 | profit rate:    9.5 | accuracy: 0.17
step_num: 13200 | loss: 0.0948 | profit rate:   10.3 | accuracy: 0.16
step_num: 13400 | loss: 0.1332 | profit rate:   36.8 | accuracy: 0.17
step_num: 13600 | loss: 0.1933 | profit rate:  279.4 | accuracy: 0.17
step_num: 13800 | loss: 0.3100 | profit rate:  316.5 | accuracy: 0.19
step_num: 14000 | loss: 0.3114 | profit rate: 1440.0 | accuracy: 0.20
step_num: 14200 | loss: 0.3584 | profit rate: 3292.7 | accuracy: 0.21
step_num: 14400 | loss: 0.3276 | profit rate: 1605.5 | accuracy: 0.21
step_num: 14600 | loss: 0.2222 | profit rate: 1369.2 | accuracy: 0.21
step_num: 14800 | loss: 0.2262 | profit rate: 1059.6 | accuracy: 0.21
model saved @ step:14820,performance:1132.740,accuracy:0.21
step_num: 15000 | loss: 0.2242 | profit rate:    1.6 | accuracy: 0.15
step_num: 15200 | loss: 0.2599 | profit rate:    3.4 | accuracy: 0.17
step_num: 15400 | loss: 0.1772 | profit rate:    5.4 | accuracy: 0.17
step_num: 15600 | loss: 0.1878 | profit rate:    3.9 | accuracy: 0.18
step_num: 15800 | loss: 0.2300 | profit rate:    3.2 | accuracy: 0.18
step_num: 16000 | loss: 0.1963 | profit rate:   10.7 | accuracy: 0.18
step_num: 16200 | loss: 0.0911 | profit rate:    7.9 | accuracy: 0.17
step_num: 16400 | loss: 0.0814 | profit rate:   11.1 | accuracy: 0.16
step_num: 16600 | loss: 0.0811 | profit rate:   10.3 | accuracy: 0.16
step_num: 16800 | loss: 0.0893 | profit rate:   10.5 | accuracy: 0.15
step_num: 17000 | loss: 0.1086 | profit rate:   18.5 | accuracy: 0.15
step_num: 17200 | loss: 0.1363 | profit rate:  300.9 | accuracy: 0.17
step_num: 17400 | loss: 0.2305 | profit rate:  304.3 | accuracy: 0.17
step_num: 17600 | loss: 0.2419 | profit rate: 1631.6 | accuracy: 0.18
step_num: 17800 | loss: 0.2960 | profit rate: 4633.7 | accuracy: 0.20
step_num: 18000 | loss: 0.3035 | profit rate: 12930.9 | accuracy: 0.20
step_num: 18200 | loss: 0.2757 | profit rate: 13047.2 | accuracy: 0.20
step_num: 18400 | loss: 0.2213 | profit rate: 22177.2 | accuracy: 0.20
episode:   5/5,耗时:0.93分/4.68分,训练集: | step: 18525 | average_treward:  201.0 | max_treward: 318.5854 | average profit rate: 4315.241
model saved @ step:18525,performance:20273.609,accuracy:0.21
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 26%|       | 103/403 [00:00<00:00, 1019.81it/s] 52%|    | 209/403 [00:00<00:00, 1039.01it/s] 78%|  | 316/403 [00:00<00:00, 1051.46it/s]100%|| 403/403 [00:00<00:00, 1060.59it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1010.91
2023-07-24T12:00:00 | net performance [%] = 1.0914
2023-07-24T12:00:00 | number of trades [#] = 48
==================================================
Trial 42 Complete [00h 04m 44s]
net_wealth: 1010.9135455644911

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 54m 30s

Search: Running Trial #43

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.5               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4287.000000   4301.000000
mean      0.000435    20113.607657  ...   20220.812309  20169.373185
std       0.027833    16040.642334  ...   16079.556022  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7775.560059   7730.930176
50%       0.000642    11571.842969  ...   11762.459961  11751.469727
75%       0.011590    29894.706152  ...   30065.730469  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.4535 | profit rate:    2.7 | accuracy: 0.35
step_num: 400 | loss: 0.4680 | profit rate:    4.4 | accuracy: 0.35
step_num: 600 | loss: 0.9367 | profit rate:   80.0 | accuracy: 0.37
step_num: 800 | loss: 0.9453 | profit rate:    2.9 | accuracy: 0.37
step_num: 1000 | loss: 0.5310 | profit rate:    0.2 | accuracy: 0.35
step_num: 1200 | loss: 0.2900 | profit rate:    0.1 | accuracy: 0.33
step_num: 1400 | loss: 0.7240 | profit rate:    0.0 | accuracy: 0.34
step_num: 1600 | loss: 0.6953 | profit rate:    0.0 | accuracy: 0.34
step_num: 1800 | loss: 0.8761 | profit rate: 2990.2 | accuracy: 0.38
step_num: 2000 | loss: 0.5820 | profit rate:  265.0 | accuracy: 0.38
step_num: 2200 | loss: 0.5629 | profit rate:  232.4 | accuracy: 0.37
step_num: 2400 | loss: 0.6980 | profit rate:   52.4 | accuracy: 0.37
step_num: 2600 | loss: 0.4000 | profit rate:    8.8 | accuracy: 0.36
step_num: 2800 | loss: 0.1692 | profit rate:    2.7 | accuracy: 0.33
step_num: 3000 | loss: 0.4383 | profit rate:    1.0 | accuracy: 0.32
episode:   1/5,耗时:0.43分/0.43分,训练集: | step: 3160 | average_treward:  -23.6 | max_treward: 0.0000 | average profit rate:  0.595
step_num: 3200 | loss: 0.0613 | profit rate:    0.7 | accuracy: 0.07
step_num: 3400 | loss: 0.0618 | profit rate:    0.7 | accuracy: 0.05
step_num: 3600 | loss: 0.1037 | profit rate:    1.0 | accuracy: 0.05
step_num: 3800 | loss: 0.4963 | profit rate:    0.8 | accuracy: 0.07
step_num: 4000 | loss: 0.0042 | profit rate:    0.4 | accuracy: 0.06
step_num: 4200 | loss: 0.0501 | profit rate:    0.3 | accuracy: 0.05
step_num: 4400 | loss: 0.0030 | profit rate:    0.3 | accuracy: 0.04
step_num: 4600 | loss: 0.0171 | profit rate:    0.3 | accuracy: 0.04
step_num: 4800 | loss: 0.0101 | profit rate:    0.3 | accuracy: 0.03
step_num: 5000 | loss: 0.0789 | profit rate:    0.3 | accuracy: 0.03
step_num: 5200 | loss: 0.0149 | profit rate:    0.3 | accuracy: 0.03
step_num: 5400 | loss: 0.0019 | profit rate:    0.2 | accuracy: 0.03
step_num: 5600 | loss: 0.0025 | profit rate:    0.2 | accuracy: 0.03
step_num: 5800 | loss: 0.0009 | profit rate:    0.2 | accuracy: 0.03
step_num: 6000 | loss: 0.0036 | profit rate:    0.3 | accuracy: 0.03
step_num: 6200 | loss: 0.0365 | profit rate:    0.2 | accuracy: 0.03
model saved @ step:6320,performance:0.177,accuracy:0.03
step_num: 6400 | loss: 0.0173 | profit rate:    1.0 | accuracy: 0.06
step_num: 6600 | loss: 0.0263 | profit rate:    1.0 | accuracy: 0.03
step_num: 6800 | loss: 0.0353 | profit rate:    1.0 | accuracy: 0.03
step_num: 7000 | loss: 0.0047 | profit rate:    1.0 | accuracy: 0.02
step_num: 7200 | loss: 0.0013 | profit rate:    1.1 | accuracy: 0.02
step_num: 7400 | loss: 0.0467 | profit rate:    1.3 | accuracy: 0.02
step_num: 7600 | loss: 0.0009 | profit rate:    1.2 | accuracy: 0.02
step_num: 7800 | loss: 0.0159 | profit rate:    1.2 | accuracy: 0.02
step_num: 8000 | loss: 0.0010 | profit rate:    1.2 | accuracy: 0.02
step_num: 8200 | loss: 0.1081 | profit rate:    0.9 | accuracy: 0.02
step_num: 8400 | loss: 0.0159 | profit rate:    0.9 | accuracy: 0.02
step_num: 8600 | loss: 0.0004 | profit rate:    0.9 | accuracy: 0.02
step_num: 8800 | loss: 0.0374 | profit rate:    0.9 | accuracy: 0.02
step_num: 9000 | loss: 0.0009 | profit rate:    0.9 | accuracy: 0.02
step_num: 9200 | loss: 0.0034 | profit rate:    0.9 | accuracy: 0.02
step_num: 9400 | loss: 0.0189 | profit rate:    0.9 | accuracy: 0.02
episode:   3/5,耗时:0.50分/1.41分,训练集: | step: 9480 | average_treward:    7.1 | max_treward: 36.4382 | average profit rate:  0.555
model saved @ step:9480,performance:0.894,accuracy:0.02
step_num: 9600 | loss: 0.0162 | profit rate:    1.0 | accuracy: 0.05
step_num: 9800 | loss: 0.0015 | profit rate:    0.8 | accuracy: 0.02
step_num: 10000 | loss: 0.0184 | profit rate:    0.5 | accuracy: 0.03
step_num: 10200 | loss: 0.0009 | profit rate:    0.5 | accuracy: 0.02
step_num: 10400 | loss: 0.0007 | profit rate:    0.5 | accuracy: 0.02
step_num: 10600 | loss: 0.0027 | profit rate:    0.5 | accuracy: 0.02
step_num: 10800 | loss: 0.0003 | profit rate:    0.5 | accuracy: 0.02
step_num: 11000 | loss: 0.0533 | profit rate:    0.5 | accuracy: 0.02
step_num: 11200 | loss: 0.1865 | profit rate:    2.8 | accuracy: 0.02
step_num: 11400 | loss: 0.7926 | profit rate:   90.2 | accuracy: 0.06
step_num: 11600 | loss: 0.0325 | profit rate:    0.7 | accuracy: 0.07
step_num: 11800 | loss: 0.3217 | profit rate:    3.5 | accuracy: 0.08
step_num: 12000 | loss: 0.2389 | profit rate:    1.3 | accuracy: 0.08
step_num: 12200 | loss: 0.1524 | profit rate:   13.2 | accuracy: 0.09
step_num: 12400 | loss: 0.0017 | profit rate:   51.1 | accuracy: 0.09
step_num: 12600 | loss: 0.0440 | profit rate:   44.6 | accuracy: 0.09
model saved @ step:12640,performance:59.594,accuracy:0.09
step_num: 12800 | loss: 0.4122 | profit rate:   26.1 | accuracy: 0.43
step_num: 13000 | loss: 0.7835 | profit rate:   18.1 | accuracy: 0.39
step_num: 13200 | loss: 0.2039 | profit rate:    0.1 | accuracy: 0.30
step_num: 13400 | loss: 0.2475 | profit rate:    0.3 | accuracy: 0.27
step_num: 13600 | loss: 0.0369 | profit rate:    0.8 | accuracy: 0.24
step_num: 13800 | loss: 0.0038 | profit rate:    0.6 | accuracy: 0.21
step_num: 14000 | loss: 0.2212 | profit rate:    1.0 | accuracy: 0.20
step_num: 14200 | loss: 0.8331 | profit rate:    0.0 | accuracy: 0.21
step_num: 14400 | loss: 0.0054 | profit rate:    0.0 | accuracy: 0.19
step_num: 14600 | loss: 0.0010 | profit rate:    0.0 | accuracy: 0.17
step_num: 14800 | loss: 0.0008 | profit rate:    0.0 | accuracy: 0.16
step_num: 15000 | loss: 0.0145 | profit rate:    0.0 | accuracy: 0.15
step_num: 15200 | loss: 0.1159 | profit rate:    0.0 | accuracy: 0.14
step_num: 15400 | loss: 0.0013 | profit rate:    0.0 | accuracy: 0.13
step_num: 15600 | loss: 0.0005 | profit rate:    0.0 | accuracy: 0.12
episode:   5/5,耗时:0.48分/2.38分,训练集: | step: 15800 | average_treward:   15.0 | max_treward: 112.4378 | average profit rate: 12.252
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 23%|       | 92/408 [00:00<00:00, 914.23it/s] 47%|     | 191/408 [00:00<00:00, 958.34it/s] 72%|  | 292/408 [00:00<00:00, 977.44it/s] 99%|| 404/408 [00:00<00:00, 1029.46it/s]100%|| 408/408 [00:00<00:00, 1003.21it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1346.37
2023-07-24T12:00:00 | net performance [%] = 34.6371
2023-07-24T12:00:00 | number of trades [#] = 6
==================================================
Trial 43 Complete [00h 02m 26s]
net_wealth: 1347.7187192598628

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 04h 56m 56s

Search: Running Trial #44

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
225               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.5               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4289.000000   4301.000000
mean      0.000435    20113.607657  ...   20213.385127  20169.373185
std       0.027833    16040.642334  ...   16079.483780  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7769.270020   7730.930176
50%       0.000642    11571.842969  ...   11761.410156  11751.469727
75%       0.011590    29894.706152  ...   30055.150391  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 1000 | loss: 1.3597 | profit rate:    0.5 | accuracy: 0.33
step_num: 1200 | loss: 0.5345 | profit rate:    0.2 | accuracy: 0.32
step_num: 1400 | loss: 0.4886 | profit rate:    0.5 | accuracy: 0.32
step_num: 1600 | loss: 0.4616 | profit rate:    0.3 | accuracy: 0.32
step_num: 1800 | loss: 0.4460 | profit rate:    2.4 | accuracy: 0.32
step_num: 2000 | loss: 0.4305 | profit rate:    0.8 | accuracy: 0.32
step_num: 2200 | loss: 0.4204 | profit rate:    7.8 | accuracy: 0.32
step_num: 2400 | loss: 0.3938 | profit rate:  128.0 | accuracy: 0.33
step_num: 2600 | loss: 0.3642 | profit rate:   18.9 | accuracy: 0.32
step_num: 2800 | loss: 0.3599 | profit rate:  247.0 | accuracy: 0.33
step_num: 3000 | loss: 0.3416 | profit rate:   54.9 | accuracy: 0.32
step_num: 3200 | loss: 0.3118 | profit rate:  496.6 | accuracy: 0.32
step_num: 3400 | loss: 0.3255 | profit rate:  247.1 | accuracy: 0.32
step_num: 3600 | loss: 0.3182 | profit rate:  751.2 | accuracy: 0.32
episode:   1/5,耗时:1.65分/1.65分,训练集: | step: 3665 | average_treward:   68.6 | max_treward: 68.6366 | average profit rate: 834.904
model saved @ step:3665,performance:834.904,accuracy:0.32
step_num: 3800 | loss: 0.2922 | profit rate:   14.9 | accuracy: 0.40
step_num: 4000 | loss: 0.2670 | profit rate:  136.5 | accuracy: 0.31
step_num: 4200 | loss: 0.2735 | profit rate:  102.9 | accuracy: 0.28
step_num: 4400 | loss: 0.2369 | profit rate:  100.9 | accuracy: 0.26
step_num: 4600 | loss: 0.2215 | profit rate:   80.0 | accuracy: 0.27
step_num: 4800 | loss: 0.2420 | profit rate: 2436.2 | accuracy: 0.29
step_num: 5000 | loss: 0.2183 | profit rate: 6980.0 | accuracy: 0.29
step_num: 5200 | loss: 0.2007 | profit rate: 35746.0 | accuracy: 0.29
step_num: 5400 | loss: 0.1843 | profit rate: 8730856.9 | accuracy: 0.30
step_num: 5600 | loss: 0.1748 | profit rate: 15628374.8 | accuracy: 0.29
step_num: 5800 | loss: 0.1562 | profit rate: 283358481.9 | accuracy: 0.30
step_num: 6000 | loss: 0.1656 | profit rate: 303005524459.2 | accuracy: 0.31
step_num: 6200 | loss: 0.1571 | profit rate: 1810431757270.0 | accuracy: 0.31
step_num: 6400 | loss: 0.1399 | profit rate: 82612719191904.3 | accuracy: 0.31
step_num: 6600 | loss: 0.1487 | profit rate: 1393833913077695.8 | accuracy: 0.31
step_num: 6800 | loss: 0.1512 | profit rate: 28707481830733004.0 | accuracy: 0.32
step_num: 7000 | loss: 0.1470 | profit rate: 219916831547746112.0 | accuracy: 0.31
step_num: 7200 | loss: 0.1506 | profit rate: 3690152246768840704.0 | accuracy: 0.32
model saved @ step:7330,performance:14043462474933338112.000,accuracy:0.32
step_num: 7400 | loss: 0.1500 | profit rate:   66.1 | accuracy: 0.55
step_num: 7600 | loss: 0.1373 | profit rate: 4322.0 | accuracy: 0.37
step_num: 7800 | loss: 0.1364 | profit rate: 8733.9 | accuracy: 0.32
step_num: 8000 | loss: 0.1266 | profit rate: 52815.0 | accuracy: 0.31
step_num: 8200 | loss: 0.1171 | profit rate: 434609.8 | accuracy: 0.32
step_num: 8400 | loss: 0.1359 | profit rate: 13423832.4 | accuracy: 0.33
step_num: 8600 | loss: 0.1205 | profit rate: 478593860.6 | accuracy: 0.32
step_num: 8800 | loss: 0.1209 | profit rate: 6219962050.1 | accuracy: 0.32
step_num: 9000 | loss: 0.1140 | profit rate: 4091505275950.6 | accuracy: 0.34
step_num: 9200 | loss: 0.0959 | profit rate: 29655607043933.8 | accuracy: 0.33
step_num: 9400 | loss: 0.1024 | profit rate: 696378806212440.2 | accuracy: 0.34
step_num: 9600 | loss: 0.1201 | profit rate: 2546395819602533376.0 | accuracy: 0.35
step_num: 9800 | loss: 0.1082 | profit rate: 783348280836229562368.0 | accuracy: 0.35
step_num: 10000 | loss: 0.0882 | profit rate: 633156896747270868828160.0 | accuracy: 0.35
step_num: 10200 | loss: 0.1009 | profit rate: 39923208899547557458345984.0 | accuracy: 0.35
step_num: 10400 | loss: 0.0961 | profit rate: 831820498506997978460323840.0 | accuracy: 0.35
step_num: 10600 | loss: 0.1300 | profit rate: 177000105800365669324496568320.0 | accuracy: 0.35
step_num: 10800 | loss: 0.1055 | profit rate: 5609577603937916866588317843456.0 | accuracy: 0.36
episode:   3/5,耗时:2.35分/6.28分,训练集: | step: 10995 | average_treward:  691.8 | max_treward: 1270.2277 | average profit rate: 17626121990536206944408935858176.000
model saved @ step:10995,performance:52878365971594580861388480053248.000,accuracy:0.36
step_num: 11000 | loss: 0.0871 | profit rate:    1.6 | accuracy: 0.67
step_num: 11200 | loss: 0.1057 | profit rate: 19269.1 | accuracy: 0.47
step_num: 11400 | loss: 0.1066 | profit rate: 558691.6 | accuracy: 0.38
step_num: 11600 | loss: 0.0902 | profit rate: 9539754.6 | accuracy: 0.37
step_num: 11800 | loss: 0.0932 | profit rate: 304611715.8 | accuracy: 0.36
step_num: 12000 | loss: 0.0974 | profit rate: 165530598069.5 | accuracy: 0.39
step_num: 12200 | loss: 0.1016 | profit rate: 141192130099493.0 | accuracy: 0.39
step_num: 12400 | loss: 0.1101 | profit rate: 3349937317452778.5 | accuracy: 0.38
step_num: 12600 | loss: 0.0958 | profit rate: 823958930910188544.0 | accuracy: 0.40
step_num: 12800 | loss: 0.0914 | profit rate: 223744544385176633344.0 | accuracy: 0.40
step_num: 13000 | loss: 0.0955 | profit rate: 1209284615782943162368.0 | accuracy: 0.39
step_num: 13200 | loss: 0.0928 | profit rate: 3043154006637497857081344.0 | accuracy: 0.40
step_num: 13400 | loss: 0.0805 | profit rate: 1178922385931678971489943552.0 | accuracy: 0.40
step_num: 13600 | loss: 0.0957 | profit rate: 135125431232502534987229167616.0 | accuracy: 0.40
step_num: 13800 | loss: 0.0825 | profit rate: 280226046343570203540708927733760.0 | accuracy: 0.41
step_num: 14000 | loss: 0.0956 | profit rate: 26130089905660247551863939412262912.0 | accuracy: 0.41
step_num: 14200 | loss: 0.0916 | profit rate: 2747405547326446957861598242619260928.0 | accuracy: 0.42
step_num: 14400 | loss: 0.0969 | profit rate: 246954956333430773702602830445111410688.0 | accuracy: 0.42
step_num: 14600 | loss: 0.0853 | profit rate: 11882007479575245449256026450819031236608.0 | accuracy: 0.42
model saved @ step:14660,performance:14210315940793082824425636879471608856576.000,accuracy:0.42
step_num: 14800 | loss: 0.0902 | profit rate: 36097.1 | accuracy: 0.56
step_num: 15000 | loss: 0.0906 | profit rate: 9131924.9 | accuracy: 0.48
step_num: 15200 | loss: 0.1066 | profit rate: 285910492.3 | accuracy: 0.43
step_num: 15400 | loss: 0.0935 | profit rate: 4945072051.1 | accuracy: 0.41
step_num: 15600 | loss: 0.0721 | profit rate: 178882696086.4 | accuracy: 0.42
step_num: 15800 | loss: 0.0970 | profit rate: 1851140384349348.2 | accuracy: 0.44
step_num: 16000 | loss: 0.0685 | profit rate: 154677199825850816.0 | accuracy: 0.44
step_num: 16200 | loss: 0.0811 | profit rate: 9579043450278156288.0 | accuracy: 0.44
step_num: 16400 | loss: 0.0652 | profit rate: 9169998568696094654464.0 | accuracy: 0.44
step_num: 16600 | loss: 0.0802 | profit rate: 89160458379942718078976.0 | accuracy: 0.44
step_num: 16800 | loss: 0.0937 | profit rate: 49441828576353843150848000.0 | accuracy: 0.45
step_num: 17000 | loss: 0.0990 | profit rate: 4273494401987485398369604468736.0 | accuracy: 0.46
step_num: 17200 | loss: 0.0805 | profit rate: 2731767566915689003604654247903232.0 | accuracy: 0.46
step_num: 17400 | loss: 0.0738 | profit rate: 3564341586638420602029459238973079552.0 | accuracy: 0.46
step_num: 17600 | loss: 0.0932 | profit rate: 657446530751633778314608126248762736640.0 | accuracy: 0.47
step_num: 17800 | loss: 0.0888 | profit rate: 72954155557647790927366397215124507066368.0 | accuracy: 0.47
step_num: 18000 | loss: 0.0800 | profit rate: 8633557136356337330366970930556837866504192.0 | accuracy: 0.46
step_num: 18200 | loss: 0.0826 | profit rate: 647702150483998653542695662949106492727361536.0 | accuracy: 0.47
episode:   5/5,耗时:2.28分/10.85分,训练集: | step: 18325 | average_treward: 1102.9 | max_treward: 1848.9619 | average profit rate: 1181289837867015827357400493695464538135068672.000
model saved @ step:18325,performance:5906434979019085933457441002921635767641964544.000,accuracy:0.47
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 19%|        | 79/408 [00:00<00:00, 790.00it/s] 45%|     | 184/408 [00:00<00:00, 942.94it/s] 69%|   | 283/408 [00:00<00:00, 964.29it/s] 94%|| 384/408 [00:00<00:00, 982.33it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 962.21it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1037.71
2023-07-24T12:00:00 | net performance [%] = 3.7709
2023-07-24T12:00:00 | number of trades [#] = 80
==================================================
Trial 44 Complete [00h 10m 55s]
net_wealth: 1038.7476258817776

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 07m 51s

Search: Running Trial #45

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
14                |5                 |lags
0.7               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.5861 | profit rate:    0.1 | accuracy: 0.32
step_num: 600 | loss: 0.5227 | profit rate:    0.4 | accuracy: 0.35
step_num: 800 | loss: 0.5870 | profit rate:    0.2 | accuracy: 0.37
step_num: 1000 | loss: 0.5115 | profit rate:    0.0 | accuracy: 0.36
step_num: 1200 | loss: 0.4832 | profit rate:    0.0 | accuracy: 0.36
step_num: 1400 | loss: 0.4727 | profit rate:    0.0 | accuracy: 0.34
step_num: 1600 | loss: 0.3812 | profit rate:    0.0 | accuracy: 0.32
step_num: 1800 | loss: 0.3066 | profit rate:    0.0 | accuracy: 0.30
step_num: 2000 | loss: 0.1850 | profit rate:    0.0 | accuracy: 0.28
step_num: 2200 | loss: 0.1514 | profit rate:    0.2 | accuracy: 0.29
step_num: 2400 | loss: 0.4506 | profit rate:  180.2 | accuracy: 0.32
step_num: 2600 | loss: 0.6743 | profit rate:    0.1 | accuracy: 0.32
step_num: 2800 | loss: 0.4860 | profit rate:    0.9 | accuracy: 0.30
step_num: 3000 | loss: 0.3007 | profit rate:    0.7 | accuracy: 0.30
step_num: 3200 | loss: 0.2616 | profit rate:    2.5 | accuracy: 0.29
step_num: 3400 | loss: 0.1845 | profit rate:    7.2 | accuracy: 0.28
step_num: 3600 | loss: 0.2657 | profit rate:   71.0 | accuracy: 0.29
episode:   1/5,耗时:0.83分/0.83分,训练集: | step: 3668 | average_treward:   86.0 | max_treward: 86.0029 | average profit rate: 81.498
model saved @ step:3668,performance:81.498,accuracy:0.29
step_num: 3800 | loss: 0.4431 | profit rate:    0.0 | accuracy: 0.27
step_num: 4000 | loss: 0.4951 | profit rate:    0.1 | accuracy: 0.32
step_num: 4200 | loss: 0.4227 | profit rate:    0.9 | accuracy: 0.30
step_num: 4400 | loss: 0.3514 | profit rate:    0.1 | accuracy: 0.28
step_num: 4600 | loss: 0.4679 | profit rate:    0.0 | accuracy: 0.27
step_num: 4800 | loss: 0.3717 | profit rate:    0.0 | accuracy: 0.26
step_num: 5000 | loss: 0.2383 | profit rate:    0.0 | accuracy: 0.23
step_num: 5200 | loss: 0.1857 | profit rate:    0.0 | accuracy: 0.23
step_num: 5400 | loss: 0.1865 | profit rate:    0.0 | accuracy: 0.22
step_num: 5600 | loss: 0.1223 | profit rate:    0.0 | accuracy: 0.20
step_num: 5800 | loss: 0.0375 | profit rate:    0.0 | accuracy: 0.18
step_num: 6000 | loss: 0.0903 | profit rate:    0.0 | accuracy: 0.18
step_num: 6200 | loss: 0.1925 | profit rate:    0.0 | accuracy: 0.18
step_num: 6400 | loss: 0.2894 | profit rate:    0.0 | accuracy: 0.18
step_num: 6600 | loss: 0.1883 | profit rate:    0.0 | accuracy: 0.18
step_num: 6800 | loss: 0.1441 | profit rate:    0.0 | accuracy: 0.18
step_num: 7000 | loss: 0.2389 | profit rate:    0.0 | accuracy: 0.19
step_num: 7200 | loss: 0.3051 | profit rate:    0.0 | accuracy: 0.20
step_num: 7400 | loss: 0.4238 | profit rate:    0.9 | accuracy: 0.29
step_num: 7600 | loss: 0.3896 | profit rate:    0.2 | accuracy: 0.19
step_num: 7800 | loss: 0.2838 | profit rate:    3.2 | accuracy: 0.22
step_num: 8000 | loss: 0.2162 | profit rate:    3.3 | accuracy: 0.18
step_num: 8200 | loss: 0.1063 | profit rate:    4.4 | accuracy: 0.17
step_num: 8400 | loss: 0.1890 | profit rate:    0.3 | accuracy: 0.17
step_num: 8600 | loss: 0.1597 | profit rate:    1.3 | accuracy: 0.17
step_num: 8800 | loss: 0.1698 | profit rate:    2.0 | accuracy: 0.17
step_num: 9000 | loss: 0.1611 | profit rate:    0.3 | accuracy: 0.17
step_num: 9200 | loss: 0.1117 | profit rate:    0.2 | accuracy: 0.16
step_num: 9400 | loss: 0.1001 | profit rate:    0.2 | accuracy: 0.15
step_num: 9600 | loss: 0.1789 | profit rate:    0.0 | accuracy: 0.15
step_num: 9800 | loss: 0.1181 | profit rate:    0.0 | accuracy: 0.14
step_num: 10000 | loss: 0.0902 | profit rate:    0.0 | accuracy: 0.13
step_num: 10200 | loss: 0.1310 | profit rate:    0.0 | accuracy: 0.14
step_num: 10400 | loss: 0.1414 | profit rate:    0.0 | accuracy: 0.14
step_num: 10600 | loss: 0.1597 | profit rate:    0.0 | accuracy: 0.14
step_num: 10800 | loss: 0.0915 | profit rate:    0.0 | accuracy: 0.13
step_num: 11000 | loss: 0.1069 | profit rate:    0.0 | accuracy: 0.13
episode:   3/5,耗时:0.90分/2.67分,训练集: | step: 11004 | average_treward:   15.0 | max_treward: 86.0029 | average profit rate: 27.180
step_num: 11200 | loss: 0.1754 | profit rate:   10.3 | accuracy: 0.27
step_num: 11400 | loss: 0.2714 | profit rate:  576.6 | accuracy: 0.32
step_num: 11600 | loss: 0.2929 | profit rate: 1597.7 | accuracy: 0.29
step_num: 11800 | loss: 0.2459 | profit rate: 1887.2 | accuracy: 0.27
step_num: 12000 | loss: 0.2524 | profit rate:  234.2 | accuracy: 0.26
step_num: 12200 | loss: 0.2405 | profit rate:  632.9 | accuracy: 0.26
step_num: 12400 | loss: 0.1831 | profit rate: 1179.8 | accuracy: 0.24
step_num: 12600 | loss: 0.1778 | profit rate:  473.2 | accuracy: 0.24
step_num: 12800 | loss: 0.1913 | profit rate:   83.2 | accuracy: 0.22
step_num: 13000 | loss: 0.1185 | profit rate:   37.6 | accuracy: 0.21
step_num: 13200 | loss: 0.0766 | profit rate:   13.6 | accuracy: 0.20
step_num: 13400 | loss: 0.0905 | profit rate:    3.6 | accuracy: 0.18
step_num: 13600 | loss: 0.1018 | profit rate:    5.2 | accuracy: 0.18
step_num: 13800 | loss: 0.1028 | profit rate:    1.0 | accuracy: 0.17
step_num: 14000 | loss: 0.1738 | profit rate:    4.4 | accuracy: 0.17
step_num: 14200 | loss: 0.1913 | profit rate:    2.8 | accuracy: 0.17
step_num: 14400 | loss: 0.1777 | profit rate:   42.7 | accuracy: 0.18
step_num: 14600 | loss: 0.2197 | profit rate:   51.6 | accuracy: 0.18
model saved @ step:14672,performance:89.275,accuracy:0.18
step_num: 14800 | loss: 0.2378 | profit rate:    0.1 | accuracy: 0.10
step_num: 15000 | loss: 0.2775 | profit rate:    8.8 | accuracy: 0.22
step_num: 15200 | loss: 0.3289 | profit rate:    8.0 | accuracy: 0.24
step_num: 15400 | loss: 0.3243 | profit rate:    0.5 | accuracy: 0.22
step_num: 15600 | loss: 0.2224 | profit rate:    2.6 | accuracy: 0.23
step_num: 15800 | loss: 0.1578 | profit rate:    9.0 | accuracy: 0.22
step_num: 16000 | loss: 0.1678 | profit rate:   14.1 | accuracy: 0.22
step_num: 16200 | loss: 0.2086 | profit rate:    7.6 | accuracy: 0.22
step_num: 16400 | loss: 0.2135 | profit rate:    1.4 | accuracy: 0.21
step_num: 16600 | loss: 0.1582 | profit rate:    0.9 | accuracy: 0.20
step_num: 16800 | loss: 0.1431 | profit rate:    0.2 | accuracy: 0.19
step_num: 17000 | loss: 0.1691 | profit rate:    0.0 | accuracy: 0.18
step_num: 17200 | loss: 0.1586 | profit rate:    0.1 | accuracy: 0.18
step_num: 17400 | loss: 0.1214 | profit rate:    0.1 | accuracy: 0.17
step_num: 17600 | loss: 0.1043 | profit rate:    0.1 | accuracy: 0.17
step_num: 17800 | loss: 0.1087 | profit rate:    0.1 | accuracy: 0.16
step_num: 18000 | loss: 0.1539 | profit rate:    1.1 | accuracy: 0.17
step_num: 18200 | loss: 0.1109 | profit rate:    1.0 | accuracy: 0.17
episode:   5/5,耗时:0.90分/4.47分,训练集: | step: 18340 | average_treward:   45.8 | max_treward: 97.4586 | average profit rate: 34.359
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 24%|       | 96/397 [00:00<00:00, 950.88it/s] 50%|     | 200/397 [00:00<00:00, 997.30it/s] 76%|  | 302/397 [00:00<00:00, 1007.57it/s]100%|| 397/397 [00:00<00:00, 1025.95it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1051.97
2023-07-24T12:00:00 | net performance [%] = 5.1969
2023-07-24T12:00:00 | number of trades [#] = 4
==================================================
Trial 45 Complete [00h 04m 31s]
net_wealth: 1051.9686384434326

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 12m 23s

Search: Running Trial #46

Value             |Best Value So Far |Hyperparameter
11                |12                |horizon
225               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.6               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4290.000000   4301.000000
mean      0.000435    20113.607657  ...   20209.671704  20169.373185
std       0.027833    16040.642334  ...   16079.448796  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7766.127563   7730.930176
50%       0.000642    11571.842969  ...   11761.109863  11751.469727
75%       0.011590    29894.706152  ...   30046.502930  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 1.0849 | profit rate:    2.7 | accuracy: 0.34
step_num: 400 | loss: 0.7209 | profit rate:    1.3 | accuracy: 0.33
step_num: 600 | loss: 0.9678 | profit rate:    3.0 | accuracy: 0.33
step_num: 800 | loss: 0.3591 | profit rate:    3.5 | accuracy: 0.30
step_num: 1000 | loss: 1.6493 | profit rate:    0.0 | accuracy: 0.29
step_num: 1200 | loss: 0.6439 | profit rate:    0.0 | accuracy: 0.30
step_num: 1400 | loss: 0.5417 | profit rate:    0.1 | accuracy: 0.30
step_num: 1600 | loss: 0.9497 | profit rate:    0.0 | accuracy: 0.30
step_num: 1800 | loss: 0.7893 | profit rate:    0.0 | accuracy: 0.29
step_num: 2000 | loss: 0.7238 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.9462 | profit rate:    0.0 | accuracy: 0.31
step_num: 2400 | loss: 0.9858 | profit rate:    0.0 | accuracy: 0.32
step_num: 2600 | loss: 0.3327 | profit rate:    0.0 | accuracy: 0.32
step_num: 2800 | loss: 0.7561 | profit rate:    0.0 | accuracy: 0.33
step_num: 3000 | loss: 0.5227 | profit rate:    0.0 | accuracy: 0.33
step_num: 3200 | loss: 0.4075 | profit rate:    0.0 | accuracy: 0.33
step_num: 3400 | loss: 0.4466 | profit rate:    0.0 | accuracy: 0.31
step_num: 3600 | loss: 0.5991 | profit rate:    0.0 | accuracy: 0.31
episode:   1/5,耗时:0.50分/0.50分,训练集: | step: 3665 | average_treward:  -86.2 | max_treward: 0.0000 | average profit rate:  0.001
step_num: 3800 | loss: 0.7502 | profit rate:    0.5 | accuracy: 0.18
step_num: 4000 | loss: 0.6450 | profit rate:    0.4 | accuracy: 0.30
step_num: 4200 | loss: 0.5243 | profit rate:    1.7 | accuracy: 0.31
step_num: 4400 | loss: 0.1616 | profit rate:    1.1 | accuracy: 0.29
step_num: 4600 | loss: 0.8152 | profit rate:    0.1 | accuracy: 0.28
step_num: 4800 | loss: 0.7264 | profit rate:    0.1 | accuracy: 0.30
step_num: 5000 | loss: 0.3775 | profit rate:    0.2 | accuracy: 0.31
step_num: 5200 | loss: 0.5396 | profit rate:    0.1 | accuracy: 0.30
step_num: 5400 | loss: 0.5315 | profit rate:    0.0 | accuracy: 0.29
step_num: 5600 | loss: 0.7609 | profit rate:    0.0 | accuracy: 0.32
step_num: 5800 | loss: 0.8787 | profit rate:    0.0 | accuracy: 0.33
step_num: 6000 | loss: 0.8124 | profit rate:    0.9 | accuracy: 0.35
step_num: 6200 | loss: 0.4248 | profit rate:    0.1 | accuracy: 0.35
step_num: 6400 | loss: 0.7688 | profit rate:    0.7 | accuracy: 0.36
step_num: 6600 | loss: 0.5535 | profit rate:    1.8 | accuracy: 0.36
step_num: 6800 | loss: 0.6189 | profit rate:    0.8 | accuracy: 0.36
step_num: 7000 | loss: 0.3022 | profit rate:    0.2 | accuracy: 0.35
step_num: 7200 | loss: 0.4389 | profit rate:    0.3 | accuracy: 0.34
model saved @ step:7330,performance:0.157,accuracy:0.34
step_num: 7400 | loss: 0.6268 | profit rate:    0.2 | accuracy: 0.14
step_num: 7600 | loss: 0.7576 | profit rate:    0.3 | accuracy: 0.29
step_num: 7800 | loss: 0.6011 | profit rate:    0.4 | accuracy: 0.32
step_num: 8000 | loss: 0.6919 | profit rate:    0.1 | accuracy: 0.32
step_num: 8200 | loss: 0.5112 | profit rate:    0.1 | accuracy: 0.29
step_num: 8400 | loss: 0.7736 | profit rate:    0.0 | accuracy: 0.31
step_num: 8600 | loss: 0.7372 | profit rate:    0.1 | accuracy: 0.33
step_num: 8800 | loss: 0.1704 | profit rate:    0.1 | accuracy: 0.31
step_num: 9000 | loss: 0.2999 | profit rate:    0.0 | accuracy: 0.31
step_num: 9200 | loss: 0.5573 | profit rate:    0.0 | accuracy: 0.32
step_num: 9400 | loss: 0.6935 | profit rate:    0.0 | accuracy: 0.34
step_num: 9600 | loss: 0.9737 | profit rate:   75.4 | accuracy: 0.36
step_num: 9800 | loss: 0.9100 | profit rate:  290.3 | accuracy: 0.38
step_num: 10000 | loss: 0.9166 | profit rate:  324.5 | accuracy: 0.38
step_num: 10200 | loss: 0.8791 | profit rate: 3652.8 | accuracy: 0.39
step_num: 10400 | loss: 0.5683 | profit rate:  159.4 | accuracy: 0.38
step_num: 10600 | loss: 0.2730 | profit rate:   13.8 | accuracy: 0.37
step_num: 10800 | loss: 0.1628 | profit rate:   22.3 | accuracy: 0.36
episode:   3/5,耗时:0.58分/1.63分,训练集: | step: 10995 | average_treward:    2.3 | max_treward: 67.3868 | average profit rate:  4.023
model saved @ step:10995,performance:11.910,accuracy:0.35
step_num: 11000 | loss: 0.6837 | profit rate:    0.6 | accuracy: 0.17
step_num: 11200 | loss: 0.4687 | profit rate:    0.1 | accuracy: 0.20
step_num: 11400 | loss: 0.5934 | profit rate:    0.0 | accuracy: 0.27
step_num: 11600 | loss: 0.5211 | profit rate:    0.2 | accuracy: 0.30
step_num: 11800 | loss: 0.2040 | profit rate:    0.1 | accuracy: 0.27
step_num: 12000 | loss: 0.9239 | profit rate:    0.1 | accuracy: 0.29
step_num: 12200 | loss: 0.8362 | profit rate:    0.4 | accuracy: 0.31
step_num: 12400 | loss: 0.4669 | profit rate:    0.4 | accuracy: 0.31
step_num: 12600 | loss: 0.8953 | profit rate:    0.2 | accuracy: 0.31
step_num: 12800 | loss: 0.6632 | profit rate:    0.1 | accuracy: 0.31
step_num: 13000 | loss: 0.5840 | profit rate:    0.1 | accuracy: 0.32
step_num: 13200 | loss: 0.6596 | profit rate:  111.5 | accuracy: 0.35
step_num: 13400 | loss: 0.7985 | profit rate: 12855.1 | accuracy: 0.37
step_num: 13600 | loss: 0.4125 | profit rate:  327.9 | accuracy: 0.36
step_num: 13800 | loss: 0.7773 | profit rate: 51954.3 | accuracy: 0.38
step_num: 14000 | loss: 0.5615 | profit rate: 1924.4 | accuracy: 0.37
step_num: 14200 | loss: 0.3192 | profit rate: 1096.4 | accuracy: 0.36
step_num: 14400 | loss: 0.1626 | profit rate:  442.8 | accuracy: 0.35
step_num: 14600 | loss: 0.6051 | profit rate:  286.5 | accuracy: 0.34
model saved @ step:14660,performance:331.935,accuracy:0.34
step_num: 14800 | loss: 0.3917 | profit rate:    0.2 | accuracy: 0.18
step_num: 15000 | loss: 0.4935 | profit rate:    0.4 | accuracy: 0.26
step_num: 15200 | loss: 0.5518 | profit rate:    1.0 | accuracy: 0.28
step_num: 15400 | loss: 0.1756 | profit rate:    2.8 | accuracy: 0.26
step_num: 15600 | loss: 0.6520 | profit rate:    2.1 | accuracy: 0.26
step_num: 15800 | loss: 0.9048 | profit rate:  650.6 | accuracy: 0.31
step_num: 16000 | loss: 0.1544 | profit rate:  383.7 | accuracy: 0.31
step_num: 16200 | loss: 0.5502 | profit rate: 1054.3 | accuracy: 0.30
step_num: 16400 | loss: 0.5124 | profit rate:  258.4 | accuracy: 0.29
step_num: 16600 | loss: 0.6905 | profit rate:  216.1 | accuracy: 0.31
step_num: 16800 | loss: 0.7496 | profit rate: 4761.2 | accuracy: 0.34
step_num: 17000 | loss: 0.8247 | profit rate: 617456471.2 | accuracy: 0.37
step_num: 17200 | loss: 0.1744 | profit rate: 21404114.1 | accuracy: 0.37
step_num: 17400 | loss: 0.6631 | profit rate: 62852822.1 | accuracy: 0.37
step_num: 17600 | loss: 0.6186 | profit rate: 97465603.2 | accuracy: 0.38
step_num: 17800 | loss: 0.6967 | profit rate: 78299266.4 | accuracy: 0.37
step_num: 18000 | loss: 0.1688 | profit rate: 29521412.4 | accuracy: 0.36
step_num: 18200 | loss: 0.4664 | profit rate: 15443619.1 | accuracy: 0.35
episode:   5/5,耗时:0.56分/2.75分,训练集: | step: 18325 | average_treward:   80.3 | max_treward: 274.4002 | average profit rate: 2872301.827
model saved @ step:18325,performance:14361165.132,accuracy:0.34
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 23%|       | 93/408 [00:00<00:00, 920.79it/s] 48%|     | 194/408 [00:00<00:00, 961.78it/s] 72%|  | 295/408 [00:00<00:00, 979.56it/s] 97%|| 395/408 [00:00<00:00, 987.53it/s]==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
100%|| 408/408 [00:00<00:00, 977.77it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1259.61
2023-07-24T12:00:00 | net performance [%] = 25.9607
2023-07-24T12:00:00 | number of trades [#] = 86
==================================================
Trial 46 Complete [00h 02m 48s]
net_wealth: 1259.6065806627328

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 15m 11s

Search: Running Trial #47

Value             |Best Value So Far |Hyperparameter
3                 |12                |horizon
730               |730               |lookback
True              |True              |MarketFactor
7                 |5                 |lags
0.92              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
64                |16                |batch_size
1                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4298.000000   4301.000000
mean      0.000435    20113.607657  ...   20180.392273  20169.373185
std       0.027833    16040.642334  ...   16078.781641  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7741.750122   7730.930176
50%       0.000642    11571.842969  ...   11754.949707  11751.469727
75%       0.011590    29894.706152  ...   30015.383301  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 1.4503 | profit rate:    2.0 | accuracy: 0.34
step_num: 800 | loss: 1.0279 | profit rate:    0.9 | accuracy: 0.33
step_num: 1000 | loss: 0.8140 | profit rate:    1.0 | accuracy: 0.33
step_num: 1200 | loss: 0.7339 | profit rate:    0.2 | accuracy: 0.32
step_num: 1400 | loss: 0.6167 | profit rate:    0.3 | accuracy: 0.32
step_num: 1600 | loss: 0.4988 | profit rate:    0.4 | accuracy: 0.32
step_num: 1800 | loss: 0.4542 | profit rate:    1.7 | accuracy: 0.32
step_num: 2000 | loss: 0.5114 | profit rate:    0.9 | accuracy: 0.31
step_num: 2200 | loss: 0.4385 | profit rate:    1.1 | accuracy: 0.30
step_num: 2400 | loss: 0.4084 | profit rate:    0.8 | accuracy: 0.29
step_num: 2600 | loss: 0.4244 | profit rate:    0.5 | accuracy: 0.29
step_num: 2800 | loss: 0.4267 | profit rate:    0.7 | accuracy: 0.30
step_num: 3000 | loss: 0.4149 | profit rate:    1.3 | accuracy: 0.31
episode:   1/5,耗时:0.67分/0.67分,训练集: | step: 3156 | average_treward:  103.1 | max_treward: 103.1144 | average profit rate:  1.250
model saved @ step:3156,performance:1.250,accuracy:0.31
step_num: 3200 | loss: 0.4538 | profit rate:    1.1 | accuracy: 0.18
step_num: 3400 | loss: 0.4478 | profit rate:    2.1 | accuracy: 0.28
step_num: 3600 | loss: 0.4962 | profit rate:    1.7 | accuracy: 0.32
step_num: 3800 | loss: 0.5084 | profit rate:    2.8 | accuracy: 0.35
step_num: 4000 | loss: 0.4492 | profit rate:    2.8 | accuracy: 0.31
step_num: 4200 | loss: 0.3724 | profit rate:    2.5 | accuracy: 0.29
step_num: 4400 | loss: 0.4416 | profit rate:    0.2 | accuracy: 0.29
step_num: 4600 | loss: 0.3643 | profit rate:    0.3 | accuracy: 0.29
step_num: 4800 | loss: 0.3588 | profit rate:    0.8 | accuracy: 0.31
step_num: 5000 | loss: 0.4252 | profit rate:   10.4 | accuracy: 0.33
step_num: 5200 | loss: 0.4713 | profit rate:    9.8 | accuracy: 0.33
step_num: 5400 | loss: 0.4333 | profit rate:    5.9 | accuracy: 0.32
step_num: 5600 | loss: 0.4360 | profit rate:    3.9 | accuracy: 0.31
step_num: 5800 | loss: 0.3988 | profit rate:    3.0 | accuracy: 0.30
step_num: 6000 | loss: 0.3939 | profit rate:   11.4 | accuracy: 0.31
step_num: 6200 | loss: 0.3555 | profit rate:   10.1 | accuracy: 0.31
model saved @ step:6312,performance:5.489,accuracy:0.31
step_num: 6400 | loss: 0.3473 | profit rate:    1.0 | accuracy: 0.11
step_num: 6600 | loss: 0.3737 | profit rate:    4.1 | accuracy: 0.28
step_num: 6800 | loss: 0.4111 | profit rate:    2.5 | accuracy: 0.27
step_num: 7000 | loss: 0.4242 | profit rate:    2.7 | accuracy: 0.34
step_num: 7200 | loss: 0.3766 | profit rate:    2.4 | accuracy: 0.30
step_num: 7400 | loss: 0.3991 | profit rate:    1.6 | accuracy: 0.29
step_num: 7600 | loss: 0.3909 | profit rate:    0.5 | accuracy: 0.29
step_num: 7800 | loss: 0.3737 | profit rate:    0.7 | accuracy: 0.30
step_num: 8000 | loss: 0.4013 | profit rate:    7.0 | accuracy: 0.33
step_num: 8200 | loss: 0.4654 | profit rate:   46.1 | accuracy: 0.36
step_num: 8400 | loss: 0.4954 | profit rate:   60.7 | accuracy: 0.36
step_num: 8600 | loss: 0.4924 | profit rate:   42.5 | accuracy: 0.35
step_num: 8800 | loss: 0.4529 | profit rate:   28.0 | accuracy: 0.33
step_num: 9000 | loss: 0.4107 | profit rate:   21.9 | accuracy: 0.32
step_num: 9200 | loss: 0.3715 | profit rate:   70.7 | accuracy: 0.33
step_num: 9400 | loss: 0.3286 | profit rate:   70.1 | accuracy: 0.33
episode:   3/5,耗时:0.80分/2.29分,训练集: | step: 9468 | average_treward:  172.5 | max_treward: 249.9343 | average profit rate: 24.185
model saved @ step:9468,performance:65.816,accuracy:0.33
step_num: 9600 | loss: 0.3030 | profit rate:    1.1 | accuracy: 0.09
step_num: 9800 | loss: 0.3100 | profit rate:    2.3 | accuracy: 0.23
step_num: 10000 | loss: 0.3718 | profit rate:    2.0 | accuracy: 0.26
step_num: 10200 | loss: 0.3824 | profit rate:    3.2 | accuracy: 0.33
step_num: 10400 | loss: 0.3751 | profit rate:    3.4 | accuracy: 0.30
step_num: 10600 | loss: 0.4165 | profit rate:    0.5 | accuracy: 0.30
step_num: 10800 | loss: 0.4209 | profit rate:    0.5 | accuracy: 0.29
step_num: 11000 | loss: 0.4313 | profit rate:    0.6 | accuracy: 0.31
step_num: 11200 | loss: 0.3926 | profit rate:   13.2 | accuracy: 0.35
step_num: 11400 | loss: 0.5054 | profit rate:   20.7 | accuracy: 0.37
step_num: 11600 | loss: 0.5141 | profit rate:   33.6 | accuracy: 0.36
step_num: 11800 | loss: 0.4940 | profit rate:   26.4 | accuracy: 0.36
step_num: 12000 | loss: 0.4602 | profit rate:   18.1 | accuracy: 0.34
step_num: 12200 | loss: 0.3882 | profit rate:   22.5 | accuracy: 0.33
step_num: 12400 | loss: 0.3478 | profit rate:   60.4 | accuracy: 0.33
step_num: 12600 | loss: 0.3144 | profit rate:   74.1 | accuracy: 0.33
model saved @ step:12624,performance:74.078,accuracy:0.33
step_num: 12800 | loss: 0.2680 | profit rate:    1.3 | accuracy: 0.15
step_num: 13000 | loss: 0.2932 | profit rate:    2.4 | accuracy: 0.22
step_num: 13200 | loss: 0.3166 | profit rate:    3.9 | accuracy: 0.27
step_num: 13400 | loss: 0.3883 | profit rate:    2.0 | accuracy: 0.31
step_num: 13600 | loss: 0.3483 | profit rate:    1.9 | accuracy: 0.29
step_num: 13800 | loss: 0.4237 | profit rate:    0.7 | accuracy: 0.29
step_num: 14000 | loss: 0.4100 | profit rate:    1.2 | accuracy: 0.28
step_num: 14200 | loss: 0.4165 | profit rate:    2.5 | accuracy: 0.32
step_num: 14400 | loss: 0.4373 | profit rate:   73.5 | accuracy: 0.35
step_num: 14600 | loss: 0.5313 | profit rate:   65.5 | accuracy: 0.37
step_num: 14800 | loss: 0.5035 | profit rate:  119.2 | accuracy: 0.36
step_num: 15000 | loss: 0.5325 | profit rate:   54.7 | accuracy: 0.36
step_num: 15200 | loss: 0.4706 | profit rate:   55.1 | accuracy: 0.34
step_num: 15400 | loss: 0.3642 | profit rate:   61.9 | accuracy: 0.33
step_num: 15600 | loss: 0.3116 | profit rate:  122.6 | accuracy: 0.33
episode:   5/5,耗时:0.81分/3.90分,训练集: | step: 15780 | average_treward:  207.2 | max_treward: 265.7514 | average profit rate: 63.823
model saved @ step:15780,performance:172.481,accuracy:0.33
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 25%|       | 99/404 [00:00<00:00, 990.00it/s] 51%|    | 208/404 [00:00<00:00, 1030.64it/s] 79%|  | 319/404 [00:00<00:00, 1062.53it/s]==================================================
100%|| 404/404 [00:00<00:00, 1068.90it/s]
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 993.04
2023-07-24T12:00:00 | net performance [%] = -0.6965
2023-07-24T12:00:00 | number of trades [#] = 28
==================================================
Trial 47 Complete [00h 03m 57s]
net_wealth: 994.0290372163109

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 19m 09s

Search: Running Trial #48

Value             |Best Value So Far |Hyperparameter
1                 |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
14                |5                 |lags
0.6               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
256               |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4300.000000   4301.000000
mean      0.000435    20113.607657  ...   20173.020481  20169.373185
std       0.027833    16040.642334  ...   16078.674434  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7736.967529   7730.930176
50%       0.000642    11571.842969  ...   11753.029785  11751.469727
75%       0.011590    29894.706152  ...   30013.548340  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8535 | profit rate:    0.9 | accuracy: 0.35
step_num: 400 | loss: 0.6226 | profit rate:    0.7 | accuracy: 0.34
step_num: 600 | loss: 0.5268 | profit rate:    0.7 | accuracy: 0.32
step_num: 800 | loss: 0.3840 | profit rate:    1.1 | accuracy: 0.31
step_num: 1000 | loss: 0.4009 | profit rate:    0.7 | accuracy: 0.31
step_num: 1200 | loss: 0.4422 | profit rate:    0.9 | accuracy: 0.33
step_num: 1400 | loss: 0.4166 | profit rate:    0.8 | accuracy: 0.33
step_num: 1600 | loss: 0.3757 | profit rate:    0.7 | accuracy: 0.33
step_num: 1800 | loss: 0.4062 | profit rate:    0.5 | accuracy: 0.33
step_num: 2000 | loss: 0.4016 | profit rate:    0.5 | accuracy: 0.33
step_num: 2200 | loss: 0.3822 | profit rate:    0.8 | accuracy: 0.34
step_num: 2400 | loss: 0.3662 | profit rate:    1.1 | accuracy: 0.34
step_num: 2600 | loss: 0.4215 | profit rate:    0.7 | accuracy: 0.34
step_num: 2800 | loss: 0.3187 | profit rate:    0.6 | accuracy: 0.33
step_num: 3000 | loss: 0.2815 | profit rate:    0.4 | accuracy: 0.33
step_num: 3200 | loss: 0.1629 | profit rate:    0.4 | accuracy: 0.32
step_num: 3400 | loss: 0.1920 | profit rate:    0.5 | accuracy: 0.31
step_num: 3600 | loss: 0.1362 | profit rate:    0.4 | accuracy: 0.30
episode:   1/5,耗时:0.92分/0.92分,训练集: | step: 3699 | average_treward:  114.5 | max_treward: 114.4976 | average profit rate:  0.406
model saved @ step:3699,performance:0.406,accuracy:0.29
step_num: 3800 | loss: 0.1224 | profit rate:    1.1 | accuracy: 0.07
step_num: 4000 | loss: 0.0858 | profit rate:    1.1 | accuracy: 0.08
step_num: 4200 | loss: 0.1612 | profit rate:    1.3 | accuracy: 0.12
step_num: 4400 | loss: 0.1016 | profit rate:    1.1 | accuracy: 0.12
step_num: 4600 | loss: 0.0998 | profit rate:    1.3 | accuracy: 0.12
step_num: 4800 | loss: 0.0747 | profit rate:    1.4 | accuracy: 0.12
step_num: 5000 | loss: 0.0546 | profit rate:    1.7 | accuracy: 0.11
step_num: 5200 | loss: 0.1111 | profit rate:    1.7 | accuracy: 0.12
step_num: 5400 | loss: 0.1897 | profit rate:    2.3 | accuracy: 0.14
step_num: 5600 | loss: 0.1882 | profit rate:    2.1 | accuracy: 0.15
step_num: 5800 | loss: 0.1853 | profit rate:    2.8 | accuracy: 0.16
step_num: 6000 | loss: 0.1794 | profit rate:    5.2 | accuracy: 0.18
step_num: 6200 | loss: 0.3009 | profit rate:    6.4 | accuracy: 0.19
step_num: 6400 | loss: 0.3007 | profit rate:   10.8 | accuracy: 0.20
step_num: 6600 | loss: 0.2524 | profit rate:   11.9 | accuracy: 0.20
step_num: 6800 | loss: 0.1809 | profit rate:   11.9 | accuracy: 0.20
step_num: 7000 | loss: 0.1441 | profit rate:   10.8 | accuracy: 0.20
step_num: 7200 | loss: 0.1586 | profit rate:   16.8 | accuracy: 0.20
model saved @ step:7398,performance:17.727,accuracy:0.20
step_num: 7400 | loss: 0.0803 | profit rate:    1.1 | accuracy: 0.33
step_num: 7600 | loss: 0.2719 | profit rate:    1.6 | accuracy: 0.25
step_num: 7800 | loss: 0.1712 | profit rate:    2.1 | accuracy: 0.23
step_num: 8000 | loss: 0.2221 | profit rate:    2.4 | accuracy: 0.22
step_num: 8200 | loss: 0.2264 | profit rate:    5.0 | accuracy: 0.23
step_num: 8400 | loss: 0.1291 | profit rate:    4.9 | accuracy: 0.22
step_num: 8600 | loss: 0.1170 | profit rate:    4.9 | accuracy: 0.20
step_num: 8800 | loss: 0.0894 | profit rate:    6.1 | accuracy: 0.20
step_num: 9000 | loss: 0.1583 | profit rate:    6.2 | accuracy: 0.20
step_num: 9200 | loss: 0.1593 | profit rate:    7.9 | accuracy: 0.21
step_num: 9400 | loss: 0.2213 | profit rate:    7.7 | accuracy: 0.22
step_num: 9600 | loss: 0.2219 | profit rate:   13.9 | accuracy: 0.23
step_num: 9800 | loss: 0.2332 | profit rate:   15.4 | accuracy: 0.24
step_num: 10000 | loss: 0.3478 | profit rate:   21.6 | accuracy: 0.24
step_num: 10200 | loss: 0.2633 | profit rate:   28.4 | accuracy: 0.24
step_num: 10400 | loss: 0.1892 | profit rate:   35.8 | accuracy: 0.24
step_num: 10600 | loss: 0.1274 | profit rate:   35.8 | accuracy: 0.24
step_num: 10800 | loss: 0.1573 | profit rate:   43.3 | accuracy: 0.24
step_num: 11000 | loss: 0.1344 | profit rate:   45.6 | accuracy: 0.23
episode:   3/5,耗时:0.95分/2.82分,训练集: | step: 11097 | average_treward:  267.0 | max_treward: 371.1155 | average profit rate: 21.293
model saved @ step:11097,performance:45.746,accuracy:0.23
step_num: 11200 | loss: 0.2029 | profit rate:    0.8 | accuracy: 0.20
step_num: 11400 | loss: 0.1321 | profit rate:    1.0 | accuracy: 0.14
step_num: 11600 | loss: 0.0629 | profit rate:    1.3 | accuracy: 0.14
step_num: 11800 | loss: 0.1112 | profit rate:    1.9 | accuracy: 0.15
step_num: 12000 | loss: 0.1519 | profit rate:    2.5 | accuracy: 0.17
step_num: 12200 | loss: 0.0928 | profit rate:    2.4 | accuracy: 0.16
step_num: 12400 | loss: 0.0989 | profit rate:    3.0 | accuracy: 0.16
step_num: 12600 | loss: 0.1472 | profit rate:    3.3 | accuracy: 0.18
step_num: 12800 | loss: 0.1621 | profit rate:    6.3 | accuracy: 0.18
step_num: 13000 | loss: 0.1263 | profit rate:    6.8 | accuracy: 0.18
step_num: 13200 | loss: 0.1408 | profit rate:   10.8 | accuracy: 0.19
step_num: 13400 | loss: 0.2183 | profit rate:   22.4 | accuracy: 0.20
step_num: 13600 | loss: 0.2702 | profit rate:   24.8 | accuracy: 0.21
step_num: 13800 | loss: 0.3128 | profit rate:   51.2 | accuracy: 0.22
step_num: 14000 | loss: 0.2036 | profit rate:   60.6 | accuracy: 0.22
step_num: 14200 | loss: 0.0864 | profit rate:   68.0 | accuracy: 0.21
step_num: 14400 | loss: 0.1269 | profit rate:   60.1 | accuracy: 0.21
step_num: 14600 | loss: 0.1031 | profit rate:   83.9 | accuracy: 0.21
model saved @ step:14796,performance:86.297,accuracy:0.21
step_num: 14800 | loss: 0.1080 | profit rate:    1.1 | accuracy: 0.40
step_num: 15000 | loss: 0.2127 | profit rate:    2.0 | accuracy: 0.27
step_num: 15200 | loss: 0.1232 | profit rate:    2.9 | accuracy: 0.21
step_num: 15400 | loss: 0.1622 | profit rate:    4.4 | accuracy: 0.21
step_num: 15600 | loss: 0.1595 | profit rate:    9.7 | accuracy: 0.23
step_num: 15800 | loss: 0.1369 | profit rate:   10.4 | accuracy: 0.22
step_num: 16000 | loss: 0.1352 | profit rate:   10.1 | accuracy: 0.22
step_num: 16200 | loss: 0.1424 | profit rate:   11.6 | accuracy: 0.22
step_num: 16400 | loss: 0.1553 | profit rate:   11.4 | accuracy: 0.22
step_num: 16600 | loss: 0.1767 | profit rate:   20.4 | accuracy: 0.22
step_num: 16800 | loss: 0.1553 | profit rate:   25.4 | accuracy: 0.23
step_num: 17000 | loss: 0.1388 | profit rate:   44.9 | accuracy: 0.23
step_num: 17200 | loss: 0.2161 | profit rate:   70.1 | accuracy: 0.24
step_num: 17400 | loss: 0.2502 | profit rate:   72.4 | accuracy: 0.24
step_num: 17600 | loss: 0.1937 | profit rate:   83.2 | accuracy: 0.24
step_num: 17800 | loss: 0.0835 | profit rate:  117.1 | accuracy: 0.24
step_num: 18000 | loss: 0.0886 | profit rate:  139.8 | accuracy: 0.23
step_num: 18200 | loss: 0.1148 | profit rate:  191.7 | accuracy: 0.23
step_num: 18400 | loss: 0.0886 | profit rate:  214.3 | accuracy: 0.23
episode:   5/5,耗时:0.92分/4.68分,训练集: | step: 18495 | average_treward:  324.4 | max_treward: 425.8604 | average profit rate: 73.097
model saved @ step:18495,performance:215.308,accuracy:0.23
----------------------------------------finished----------------------------------------
  0%|          | 0/397 [00:00<?, ?it/s] 21%|       | 85/397 [00:00<00:00, 849.75it/s] 49%|     | 195/397 [00:00<00:00, 996.94it/s] 76%|  | 301/397 [00:00<00:00, 1021.07it/s]100%|| 397/397 [00:00<00:00, 1017.87it/s]
==================================================
2023-01-07T12:00:00 | *** START BACKTEST ***
2023-01-07T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1229.34
2023-07-24T12:00:00 | net performance [%] = 22.9337
2023-07-24T12:00:00 | number of trades [#] = 18
==================================================
Trial 48 Complete [00h 04m 44s]
net_wealth: 1230.5678015989079

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 23m 53s

Search: Running Trial #49

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
365               |730               |lookback
True              |True              |MarketFactor
5                 |5                 |lags
0.98              |0.6               |gamma
0.001             |5e-05             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 600 | loss: 0.4488 | profit rate:    0.2 | accuracy: 0.33
step_num: 800 | loss: 0.4932 | profit rate:    0.1 | accuracy: 0.32
step_num: 1000 | loss: 0.4258 | profit rate:    0.1 | accuracy: 0.32
step_num: 1200 | loss: 0.5085 | profit rate:    0.1 | accuracy: 0.32
step_num: 1400 | loss: 0.5113 | profit rate:    0.0 | accuracy: 0.32
step_num: 1600 | loss: 0.4978 | profit rate:    0.0 | accuracy: 0.33
step_num: 1800 | loss: 0.5010 | profit rate:    0.0 | accuracy: 0.32
step_num: 2000 | loss: 0.5157 | profit rate:    0.0 | accuracy: 0.32
step_num: 2200 | loss: 0.4151 | profit rate:    0.0 | accuracy: 0.32
step_num: 2400 | loss: 0.3696 | profit rate:    0.0 | accuracy: 0.32
step_num: 2600 | loss: 0.3772 | profit rate:    0.0 | accuracy: 0.32
step_num: 2800 | loss: 0.3978 | profit rate:    0.0 | accuracy: 0.32
step_num: 3000 | loss: 0.3821 | profit rate:    0.0 | accuracy: 0.31
step_num: 3200 | loss: 0.3106 | profit rate:    0.0 | accuracy: 0.31
step_num: 3400 | loss: 0.2740 | profit rate:    0.0 | accuracy: 0.30
episode:   1/5,耗时:1.06分/1.06分,训练集: | step: 3523 | average_treward:  -14.2 | max_treward: 0.0000 | average profit rate:  0.004
step_num: 3600 | loss: 0.2383 | profit rate:    1.0 | accuracy: 0.23
step_num: 3800 | loss: 0.1933 | profit rate:    1.4 | accuracy: 0.23
step_num: 4000 | loss: 0.2131 | profit rate:    2.5 | accuracy: 0.26
step_num: 4200 | loss: 0.1929 | profit rate:    1.3 | accuracy: 0.25
step_num: 4400 | loss: 0.1914 | profit rate:    0.9 | accuracy: 0.25
step_num: 4600 | loss: 0.2329 | profit rate:    0.4 | accuracy: 0.24
step_num: 4800 | loss: 0.2043 | profit rate:    0.5 | accuracy: 0.24
step_num: 5000 | loss: 0.2146 | profit rate:    1.0 | accuracy: 0.24
step_num: 5200 | loss: 0.1889 | profit rate:    0.8 | accuracy: 0.24
step_num: 5400 | loss: 0.2188 | profit rate:    0.7 | accuracy: 0.24
step_num: 5600 | loss: 0.2575 | profit rate:    1.5 | accuracy: 0.24
step_num: 5800 | loss: 0.2303 | profit rate:    0.9 | accuracy: 0.24
step_num: 6000 | loss: 0.2905 | profit rate:    0.5 | accuracy: 0.23
step_num: 6200 | loss: 0.2419 | profit rate:    1.4 | accuracy: 0.23
step_num: 6400 | loss: 0.2558 | profit rate:    0.8 | accuracy: 0.22
step_num: 6600 | loss: 0.2241 | profit rate:    1.4 | accuracy: 0.22
step_num: 6800 | loss: 0.1881 | profit rate:    1.7 | accuracy: 0.22
step_num: 7000 | loss: 0.2256 | profit rate:    2.3 | accuracy: 0.22
model saved @ step:7046,performance:2.057,accuracy:0.22
step_num: 7200 | loss: 0.1885 | profit rate:    1.7 | accuracy: 0.19
step_num: 7400 | loss: 0.2366 | profit rate:    2.6 | accuracy: 0.22
step_num: 7600 | loss: 0.2332 | profit rate:    3.6 | accuracy: 0.21
step_num: 7800 | loss: 0.1977 | profit rate:    4.9 | accuracy: 0.20
step_num: 8000 | loss: 0.2012 | profit rate:    5.4 | accuracy: 0.21
step_num: 8200 | loss: 0.1471 | profit rate:    3.2 | accuracy: 0.21
step_num: 8400 | loss: 0.1783 | profit rate:    4.2 | accuracy: 0.20
step_num: 8600 | loss: 0.1652 | profit rate:   14.7 | accuracy: 0.20
step_num: 8800 | loss: 0.2194 | profit rate:   19.0 | accuracy: 0.19
step_num: 9000 | loss: 0.1996 | profit rate:   39.1 | accuracy: 0.20
step_num: 9200 | loss: 0.3252 | profit rate:  264.3 | accuracy: 0.21
step_num: 9400 | loss: 0.2968 | profit rate:  585.2 | accuracy: 0.21
step_num: 9600 | loss: 0.2729 | profit rate:  904.8 | accuracy: 0.20
step_num: 9800 | loss: 0.2294 | profit rate: 2391.2 | accuracy: 0.20
step_num: 10000 | loss: 0.3481 | profit rate: 2109.3 | accuracy: 0.20
step_num: 10200 | loss: 0.3146 | profit rate: 3110.8 | accuracy: 0.20
step_num: 10400 | loss: 0.2961 | profit rate: 3629.9 | accuracy: 0.21
episode:   3/5,耗时:1.35分/3.78分,训练集: | step: 10569 | average_treward:  138.6 | max_treward: 299.5042 | average profit rate: 2446.717
model saved @ step:10569,performance:7338.090,accuracy:0.20
step_num: 10600 | loss: 0.2164 | profit rate:    1.1 | accuracy: 0.16
step_num: 10800 | loss: 0.2145 | profit rate:    3.0 | accuracy: 0.18
step_num: 11000 | loss: 0.2378 | profit rate:    5.0 | accuracy: 0.22
step_num: 11200 | loss: 0.2538 | profit rate:    4.5 | accuracy: 0.21
step_num: 11400 | loss: 0.2137 | profit rate:   13.9 | accuracy: 0.23
step_num: 11600 | loss: 0.2597 | profit rate:   31.4 | accuracy: 0.24
step_num: 11800 | loss: 0.2235 | profit rate:   30.8 | accuracy: 0.23
step_num: 12000 | loss: 0.2377 | profit rate:   36.2 | accuracy: 0.22
step_num: 12200 | loss: 0.2698 | profit rate:   83.2 | accuracy: 0.22
step_num: 12400 | loss: 0.2438 | profit rate:   91.8 | accuracy: 0.22
step_num: 12600 | loss: 0.2221 | profit rate:  238.9 | accuracy: 0.23
step_num: 12800 | loss: 0.2949 | profit rate:  903.1 | accuracy: 0.24
step_num: 13000 | loss: 0.2746 | profit rate:  607.1 | accuracy: 0.23
step_num: 13200 | loss: 0.2493 | profit rate: 1254.7 | accuracy: 0.23
step_num: 13400 | loss: 0.3663 | profit rate: 1613.7 | accuracy: 0.23
step_num: 13600 | loss: 0.2929 | profit rate: 1687.4 | accuracy: 0.23
step_num: 13800 | loss: 0.2956 | profit rate: 2429.4 | accuracy: 0.23
step_num: 14000 | loss: 0.3188 | profit rate: 4889.4 | accuracy: 0.23
model saved @ step:14092,performance:5889.458,accuracy:0.23
step_num: 14200 | loss: 0.3833 | profit rate:    1.1 | accuracy: 0.38
step_num: 14400 | loss: 0.3811 | profit rate:    1.9 | accuracy: 0.28
step_num: 14600 | loss: 0.4490 | profit rate:    4.1 | accuracy: 0.28
step_num: 14800 | loss: 0.3116 | profit rate:    4.8 | accuracy: 0.25
step_num: 15000 | loss: 0.2908 | profit rate:   11.1 | accuracy: 0.25
step_num: 15200 | loss: 0.2649 | profit rate:   23.6 | accuracy: 0.25
step_num: 15400 | loss: 0.3178 | profit rate:   47.2 | accuracy: 0.24
step_num: 15600 | loss: 0.3433 | profit rate:   39.9 | accuracy: 0.24
step_num: 15800 | loss: 0.2842 | profit rate:   53.1 | accuracy: 0.23
step_num: 16000 | loss: 0.2138 | profit rate:   68.5 | accuracy: 0.24
step_num: 16200 | loss: 0.2728 | profit rate:  484.8 | accuracy: 0.24
step_num: 16400 | loss: 0.2163 | profit rate:  773.3 | accuracy: 0.24
step_num: 16600 | loss: 0.2959 | profit rate:  744.3 | accuracy: 0.24
step_num: 16800 | loss: 0.3185 | profit rate: 1837.5 | accuracy: 0.24
step_num: 17000 | loss: 0.3224 | profit rate: 2937.0 | accuracy: 0.24
step_num: 17200 | loss: 0.2950 | profit rate: 5838.3 | accuracy: 0.24
step_num: 17400 | loss: 0.2957 | profit rate: 34142.0 | accuracy: 0.24
step_num: 17600 | loss: 0.2994 | profit rate: 27376.6 | accuracy: 0.24
episode:   5/5,耗时:1.28分/6.38分,训练集: | step: 17615 | average_treward:  229.9 | max_treward: 371.4046 | average profit rate: 8118.018
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 24%|       | 98/406 [00:00<00:00, 980.00it/s] 49%|     | 199/406 [00:00<00:00, 994.54it/s] 74%|  | 302/406 [00:00<00:00, 1010.66it/s]100%|| 406/406 [00:00<00:00, 1028.75it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1425.80
2023-07-24T12:00:00 | net performance [%] = 42.5796
2023-07-24T12:00:00 | number of trades [#] = 68
==================================================
Trial 49 Complete [00h 06m 26s]
net_wealth: 1425.7960676757452

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 30m 19s

Search: Running Trial #50

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
730               |730               |lookback
False             |True              |MarketFactor
8                 |5                 |lags
0.98              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
512               |64                |memory_size
16                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4311.000000   4315.000000
mean      0.000441    20062.255222  ...   20133.281642  20118.633889
std       0.027818    16039.874230  ...   16077.358923  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7695.614990   7690.540039
50%       0.000642    11554.824463  ...   11741.480469  11715.610352
75%       0.011655    29873.081836  ...   29939.474609  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 0.4155 | profit rate:    0.6 | accuracy: 0.31
step_num: 600 | loss: 0.4658 | profit rate:    0.7 | accuracy: 0.31
step_num: 800 | loss: 0.5731 | profit rate:    0.4 | accuracy: 0.31
step_num: 1000 | loss: 0.5244 | profit rate:    0.5 | accuracy: 0.30
step_num: 1200 | loss: 0.5243 | profit rate:    0.2 | accuracy: 0.31
step_num: 1400 | loss: 0.4405 | profit rate:    0.2 | accuracy: 0.29
step_num: 1600 | loss: 0.4011 | profit rate:    0.2 | accuracy: 0.29
step_num: 1800 | loss: 0.3660 | profit rate:    2.3 | accuracy: 0.30
step_num: 2000 | loss: 0.4877 | profit rate:    1.4 | accuracy: 0.31
step_num: 2200 | loss: 0.4757 | profit rate:    0.8 | accuracy: 0.30
step_num: 2400 | loss: 0.5012 | profit rate:    2.5 | accuracy: 0.31
step_num: 2600 | loss: 0.4091 | profit rate:    6.5 | accuracy: 0.31
step_num: 2800 | loss: 0.4222 | profit rate:    3.4 | accuracy: 0.30
step_num: 3000 | loss: 0.3472 | profit rate:    2.9 | accuracy: 0.30
episode:   1/5,耗时:1.01分/1.01分,训练集: | step: 3169 | average_treward:   16.3 | max_treward: 16.3005 | average profit rate:  5.260
model saved @ step:3169,performance:5.260,accuracy:0.30
step_num: 3200 | loss: 0.3586 | profit rate:    1.6 | accuracy: 0.28
step_num: 3400 | loss: 0.4468 | profit rate:    2.5 | accuracy: 0.28
step_num: 3600 | loss: 0.3613 | profit rate:    1.5 | accuracy: 0.27
step_num: 3800 | loss: 0.3965 | profit rate:    0.2 | accuracy: 0.28
step_num: 4000 | loss: 0.4156 | profit rate:    0.2 | accuracy: 0.25
step_num: 4200 | loss: 0.2933 | profit rate:    0.1 | accuracy: 0.22
step_num: 4400 | loss: 0.1792 | profit rate:    0.2 | accuracy: 0.21
step_num: 4600 | loss: 0.1631 | profit rate:    0.1 | accuracy: 0.19
step_num: 4800 | loss: 0.1278 | profit rate:    0.1 | accuracy: 0.17
step_num: 5000 | loss: 0.2477 | profit rate:    0.2 | accuracy: 0.18
step_num: 5200 | loss: 0.2638 | profit rate:    0.3 | accuracy: 0.18
step_num: 5400 | loss: 0.2842 | profit rate:    0.2 | accuracy: 0.18
step_num: 5600 | loss: 0.3228 | profit rate:    0.3 | accuracy: 0.18
step_num: 5800 | loss: 0.2737 | profit rate:    0.3 | accuracy: 0.19
step_num: 6000 | loss: 0.2712 | profit rate:    1.0 | accuracy: 0.19
step_num: 6200 | loss: 0.1883 | profit rate:    0.9 | accuracy: 0.19
step_num: 6400 | loss: 0.2900 | profit rate:    1.5 | accuracy: 0.22
step_num: 6600 | loss: 0.1798 | profit rate:    1.3 | accuracy: 0.15
step_num: 6800 | loss: 0.1319 | profit rate:    1.3 | accuracy: 0.15
step_num: 7000 | loss: 0.3229 | profit rate:    0.9 | accuracy: 0.19
step_num: 7200 | loss: 0.3274 | profit rate:    0.9 | accuracy: 0.18
step_num: 7400 | loss: 0.2398 | profit rate:    0.6 | accuracy: 0.16
step_num: 7600 | loss: 0.2708 | profit rate:    2.6 | accuracy: 0.19
step_num: 7800 | loss: 0.3328 | profit rate:    1.5 | accuracy: 0.19
step_num: 8000 | loss: 0.4103 | profit rate:    1.2 | accuracy: 0.20
step_num: 8200 | loss: 0.4445 | profit rate:    0.3 | accuracy: 0.20
step_num: 8400 | loss: 0.3489 | profit rate:    0.1 | accuracy: 0.19
step_num: 8600 | loss: 0.2193 | profit rate:    0.3 | accuracy: 0.19
step_num: 8800 | loss: 0.1850 | profit rate:    0.2 | accuracy: 0.19
step_num: 9000 | loss: 0.1914 | profit rate:    0.0 | accuracy: 0.18
step_num: 9200 | loss: 0.3039 | profit rate:    0.1 | accuracy: 0.20
step_num: 9400 | loss: 0.4374 | profit rate:    0.4 | accuracy: 0.21
episode:   3/5,耗时:1.17分/3.37分,训练集: | step: 9507 | average_treward:   11.8 | max_treward: 36.6124 | average profit rate:  2.325
model saved @ step:9507,performance:0.620,accuracy:0.21
step_num: 9600 | loss: 0.4681 | profit rate:    1.1 | accuracy: 0.19
step_num: 9800 | loss: 0.4200 | profit rate:    1.2 | accuracy: 0.26
step_num: 10000 | loss: 0.4235 | profit rate:    0.5 | accuracy: 0.28
step_num: 10200 | loss: 0.6790 | profit rate:    0.4 | accuracy: 0.31
step_num: 10400 | loss: 0.4445 | profit rate:    0.2 | accuracy: 0.29
step_num: 10600 | loss: 0.3880 | profit rate:    0.2 | accuracy: 0.27
step_num: 10800 | loss: 0.3632 | profit rate:    0.2 | accuracy: 0.28
step_num: 11000 | loss: 0.3244 | profit rate:    0.1 | accuracy: 0.27
step_num: 11200 | loss: 0.2344 | profit rate:    0.3 | accuracy: 0.26
step_num: 11400 | loss: 0.4507 | profit rate:    0.1 | accuracy: 0.27
step_num: 11600 | loss: 0.5126 | profit rate:    0.1 | accuracy: 0.27
step_num: 11800 | loss: 0.3981 | profit rate:    0.1 | accuracy: 0.26
step_num: 12000 | loss: 0.2670 | profit rate:    0.2 | accuracy: 0.26
step_num: 12200 | loss: 0.3655 | profit rate:    1.1 | accuracy: 0.27
step_num: 12400 | loss: 0.5176 | profit rate:    2.6 | accuracy: 0.28
step_num: 12600 | loss: 0.4725 | profit rate:   14.1 | accuracy: 0.28
model saved @ step:12676,performance:16.298,accuracy:0.28
step_num: 12800 | loss: 0.5075 | profit rate:    1.6 | accuracy: 0.42
step_num: 13000 | loss: 0.4822 | profit rate:    3.3 | accuracy: 0.37
step_num: 13200 | loss: 0.4883 | profit rate:    0.4 | accuracy: 0.33
step_num: 13400 | loss: 0.3842 | profit rate:    0.4 | accuracy: 0.28
step_num: 13600 | loss: 0.1807 | profit rate:    0.3 | accuracy: 0.23
step_num: 13800 | loss: 0.1017 | profit rate:    0.3 | accuracy: 0.20
step_num: 14000 | loss: 0.1594 | profit rate:    0.6 | accuracy: 0.20
step_num: 14200 | loss: 0.2031 | profit rate:    0.8 | accuracy: 0.19
step_num: 14400 | loss: 0.5109 | profit rate:    2.7 | accuracy: 0.21
step_num: 14600 | loss: 0.4809 | profit rate:    2.9 | accuracy: 0.23
step_num: 14800 | loss: 0.6486 | profit rate:    0.3 | accuracy: 0.24
step_num: 15000 | loss: 0.3838 | profit rate:    0.2 | accuracy: 0.23
step_num: 15200 | loss: 0.2383 | profit rate:    0.2 | accuracy: 0.22
step_num: 15400 | loss: 0.1231 | profit rate:    0.2 | accuracy: 0.21
step_num: 15600 | loss: 0.0647 | profit rate:    0.3 | accuracy: 0.19
step_num: 15800 | loss: 0.0677 | profit rate:    0.3 | accuracy: 0.19
episode:   5/5,耗时:1.12分/5.65分,训练集: | step: 15845 | average_treward:   29.5 | max_treward: 112.9553 | average profit rate:  4.715
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 27%|       | 109/403 [00:00<00:00, 1088.64it/s] 55%|    | 223/403 [00:00<00:00, 1105.13it/s] 83%| | 334/403 [00:00<00:00, 1090.42it/s]==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
100%|| 403/403 [00:00<00:00, 1100.06it/s]
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1031.61
2023-07-24T12:00:00 | net performance [%] = 3.1614
2023-07-24T12:00:00 | number of trades [#] = 22
==================================================
Trial 50 Complete [00h 05m 42s]
net_wealth: 1032.6462915864345

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 36m 01s

Search: Running Trial #51

Value             |Best Value So Far |Hyperparameter
11                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
8                 |5                 |lags
0.92              |0.6               |gamma
0.0001            |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4304.000000   4315.000000
mean      0.000441    20062.255222  ...   20158.552772  20118.633889
std       0.027818    16039.874230  ...   16078.200687  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7720.229858   7690.540039
50%       0.000642    11554.824463  ...   11749.425293  11715.610352
75%       0.011655    29873.081836  ...   29998.575684  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.2683 | profit rate:   10.5 | accuracy: 0.32
step_num: 1200 | loss: 0.6214 | profit rate:   29.0 | accuracy: 0.33
step_num: 1400 | loss: 0.5772 | profit rate:   22.9 | accuracy: 0.33
step_num: 1600 | loss: 0.5437 | profit rate:   76.1 | accuracy: 0.33
step_num: 1800 | loss: 0.5574 | profit rate:    7.2 | accuracy: 0.33
step_num: 2000 | loss: 0.5502 | profit rate:   16.3 | accuracy: 0.34
step_num: 2200 | loss: 0.5451 | profit rate:  327.7 | accuracy: 0.35
step_num: 2400 | loss: 0.5794 | profit rate: 17096772.0 | accuracy: 0.38
step_num: 2600 | loss: 0.6002 | profit rate: 487645.3 | accuracy: 0.38
step_num: 2800 | loss: 0.5841 | profit rate: 2310588.8 | accuracy: 0.39
step_num: 3000 | loss: 0.6364 | profit rate: 1567603.9 | accuracy: 0.39
step_num: 3200 | loss: 0.6343 | profit rate: 1865065.3 | accuracy: 0.39
step_num: 3400 | loss: 0.6494 | profit rate: 195654.8 | accuracy: 0.39
step_num: 3600 | loss: 0.6736 | profit rate: 47770.2 | accuracy: 0.38
episode:   1/5,耗时:1.66分/1.66分,训练集: | step: 3719 | average_treward:  121.9 | max_treward: 121.9173 | average profit rate: 5342.517
model saved @ step:3719,performance:5342.517,accuracy:0.38
step_num: 3800 | loss: 0.6379 | profit rate:   20.4 | accuracy: 0.59
step_num: 4000 | loss: 0.7119 | profit rate:   99.0 | accuracy: 0.40
step_num: 4200 | loss: 0.6918 | profit rate:  583.5 | accuracy: 0.37
step_num: 4400 | loss: 0.6687 | profit rate:  411.5 | accuracy: 0.35
step_num: 4600 | loss: 0.6052 | profit rate:  569.8 | accuracy: 0.33
step_num: 4800 | loss: 0.6060 | profit rate:   31.7 | accuracy: 0.33
step_num: 5000 | loss: 0.6136 | profit rate:    4.2 | accuracy: 0.32
step_num: 5200 | loss: 0.5345 | profit rate:    7.9 | accuracy: 0.30
step_num: 5400 | loss: 0.4857 | profit rate:    1.1 | accuracy: 0.29
step_num: 5600 | loss: 0.4657 | profit rate:    0.8 | accuracy: 0.27
step_num: 5800 | loss: 0.3976 | profit rate:    2.1 | accuracy: 0.26
step_num: 6000 | loss: 0.3946 | profit rate: 6319.2 | accuracy: 0.28
step_num: 6200 | loss: 0.4133 | profit rate: 44191.6 | accuracy: 0.29
step_num: 6400 | loss: 0.3809 | profit rate: 16913.7 | accuracy: 0.28
step_num: 6600 | loss: 0.3962 | profit rate: 114003.8 | accuracy: 0.29
step_num: 6800 | loss: 0.3976 | profit rate: 19633.9 | accuracy: 0.28
step_num: 7000 | loss: 0.3908 | profit rate: 7344.6 | accuracy: 0.28
step_num: 7200 | loss: 0.3977 | profit rate: 2902.7 | accuracy: 0.28
step_num: 7400 | loss: 0.3587 | profit rate: 2311.7 | accuracy: 0.27
step_num: 7600 | loss: 0.4409 | profit rate:   12.7 | accuracy: 0.43
step_num: 7800 | loss: 0.4592 | profit rate:  130.1 | accuracy: 0.30
step_num: 8000 | loss: 0.4337 | profit rate: 1354.4 | accuracy: 0.31
step_num: 8200 | loss: 0.4413 | profit rate: 1376.3 | accuracy: 0.30
step_num: 8400 | loss: 0.4541 | profit rate: 3191.6 | accuracy: 0.30
step_num: 8600 | loss: 0.4596 | profit rate: 65177.9 | accuracy: 0.34
step_num: 8800 | loss: 0.4582 | profit rate: 44018.5 | accuracy: 0.32
step_num: 9000 | loss: 0.4094 | profit rate: 17666.4 | accuracy: 0.31
step_num: 9200 | loss: 0.4389 | profit rate:  350.6 | accuracy: 0.29
step_num: 9400 | loss: 0.4362 | profit rate:  461.1 | accuracy: 0.28
step_num: 9600 | loss: 0.4007 | profit rate: 1911.7 | accuracy: 0.28
step_num: 9800 | loss: 0.4531 | profit rate: 198541122.2 | accuracy: 0.31
step_num: 10000 | loss: 0.4423 | profit rate: 55313908.5 | accuracy: 0.31
step_num: 10200 | loss: 0.4514 | profit rate: 30560054.9 | accuracy: 0.31
step_num: 10400 | loss: 0.4701 | profit rate: 25467200.1 | accuracy: 0.31
step_num: 10600 | loss: 0.4150 | profit rate: 100749471.2 | accuracy: 0.31
step_num: 10800 | loss: 0.4204 | profit rate: 171144438.8 | accuracy: 0.31
step_num: 11000 | loss: 0.4188 | profit rate: 185336099.6 | accuracy: 0.30
episode:   3/5,耗时:2.25分/6.29分,训练集: | step: 11157 | average_treward:  173.3 | max_treward: 279.4356 | average profit rate: 29168354.124
model saved @ step:11157,performance:87497428.468,accuracy:0.30
step_num: 11200 | loss: 0.4628 | profit rate:   26.4 | accuracy: 0.68
step_num: 11400 | loss: 0.4962 | profit rate:  478.9 | accuracy: 0.41
step_num: 11600 | loss: 0.4988 | profit rate:  818.1 | accuracy: 0.31
step_num: 11800 | loss: 0.4581 | profit rate:  314.3 | accuracy: 0.28
step_num: 12000 | loss: 0.4377 | profit rate: 14451.6 | accuracy: 0.30
step_num: 12200 | loss: 0.4613 | profit rate: 22115.4 | accuracy: 0.33
step_num: 12400 | loss: 0.4683 | profit rate: 21350.0 | accuracy: 0.34
step_num: 12600 | loss: 0.4501 | profit rate: 189618.5 | accuracy: 0.33
step_num: 12800 | loss: 0.4544 | profit rate: 43671.7 | accuracy: 0.32
step_num: 13000 | loss: 0.4098 | profit rate: 2313.6 | accuracy: 0.29
step_num: 13200 | loss: 0.4370 | profit rate: 1158.1 | accuracy: 0.29
step_num: 13400 | loss: 0.3988 | profit rate: 322871.6 | accuracy: 0.31
step_num: 13600 | loss: 0.4376 | profit rate: 1160253079.9 | accuracy: 0.32
step_num: 13800 | loss: 0.4534 | profit rate: 2649329311.9 | accuracy: 0.32
step_num: 14000 | loss: 0.4666 | profit rate: 19611012438.5 | accuracy: 0.33
step_num: 14200 | loss: 0.4623 | profit rate: 34905344199.8 | accuracy: 0.32
step_num: 14400 | loss: 0.4533 | profit rate: 19100368054.9 | accuracy: 0.32
step_num: 14600 | loss: 0.4522 | profit rate: 52652352198.4 | accuracy: 0.32
step_num: 14800 | loss: 0.4574 | profit rate: 42573906987.9 | accuracy: 0.32
model saved @ step:14876,performance:42051280694.725,accuracy:0.31
step_num: 15000 | loss: 0.4735 | profit rate:    2.6 | accuracy: 0.44
step_num: 15200 | loss: 0.5131 | profit rate:   22.9 | accuracy: 0.37
step_num: 15400 | loss: 0.5024 | profit rate:   89.5 | accuracy: 0.35
step_num: 15600 | loss: 0.5175 | profit rate: 2463.1 | accuracy: 0.35
step_num: 15800 | loss: 0.5111 | profit rate: 1425.2 | accuracy: 0.36
step_num: 16000 | loss: 0.5246 | profit rate: 3447.2 | accuracy: 0.38
step_num: 16200 | loss: 0.5145 | profit rate: 3453.5 | accuracy: 0.37
step_num: 16400 | loss: 0.4467 | profit rate: 10771.7 | accuracy: 0.36
step_num: 16600 | loss: 0.4594 | profit rate: 1041.0 | accuracy: 0.34
step_num: 16800 | loss: 0.4822 | profit rate:  264.5 | accuracy: 0.33
step_num: 17000 | loss: 0.4401 | profit rate:  226.8 | accuracy: 0.32
step_num: 17200 | loss: 0.4290 | profit rate: 600041.0 | accuracy: 0.34
step_num: 17400 | loss: 0.4848 | profit rate: 8083730.3 | accuracy: 0.34
step_num: 17600 | loss: 0.4258 | profit rate: 65566831.8 | accuracy: 0.34
step_num: 17800 | loss: 0.4517 | profit rate: 181034676.5 | accuracy: 0.34
step_num: 18000 | loss: 0.4423 | profit rate: 450762142.3 | accuracy: 0.34
step_num: 18200 | loss: 0.4412 | profit rate: 144554113.2 | accuracy: 0.33
step_num: 18400 | loss: 0.4391 | profit rate: 1556720543.4 | accuracy: 0.33
episode:   5/5,耗时:2.35分/10.99分,训练集: | step: 18595 | average_treward:  265.8 | max_treward: 425.3108 | average profit rate: 8674824336.739
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 26%|       | 104/403 [00:00<00:00, 1036.37it/s] 54%|    | 216/403 [00:00<00:00, 1082.46it/s] 81%|  | 326/403 [00:00<00:00, 1089.00it/s]100%|| 403/403 [00:00<00:00, 1092.03it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1413.79
2023-07-24T12:00:00 | net performance [%] = 41.3792
2023-07-24T12:00:00 | number of trades [#] = 10
==================================================
Trial 51 Complete [00h 11m 03s]
net_wealth: 1415.207267581065

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 47m 04s

Search: Running Trial #52

Value             |Best Value So Far |Hyperparameter
12                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
10                |5                 |lags
0.8               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
32                |16                |batch_size
10                |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4303.000000   4315.000000
mean      0.000441    20062.255222  ...   20162.113925  20118.633889
std       0.027818    16039.874230  ...   16078.371573  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7724.814941   7690.540039
50%       0.000642    11554.824463  ...   11750.650391  11715.610352
75%       0.011655    29873.081836  ...   30003.260742  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.4600 | profit rate:    1.0 | accuracy: 0.34
step_num: 1200 | loss: 0.6726 | profit rate:    2.4 | accuracy: 0.35
step_num: 1400 | loss: 0.6299 | profit rate:    0.9 | accuracy: 0.35
step_num: 1600 | loss: 0.5951 | profit rate:    0.4 | accuracy: 0.35
step_num: 1800 | loss: 0.6277 | profit rate:    0.1 | accuracy: 0.34
step_num: 2000 | loss: 0.5889 | profit rate:    0.0 | accuracy: 0.33
step_num: 2200 | loss: 0.5513 | profit rate:    0.1 | accuracy: 0.34
step_num: 2400 | loss: 0.5946 | profit rate: 1603.8 | accuracy: 0.36
step_num: 2600 | loss: 0.6259 | profit rate:   50.5 | accuracy: 0.36
step_num: 2800 | loss: 0.6065 | profit rate:  628.9 | accuracy: 0.38
step_num: 3000 | loss: 0.5805 | profit rate:  304.0 | accuracy: 0.38
step_num: 3200 | loss: 0.6375 | profit rate: 4214.2 | accuracy: 0.39
step_num: 3400 | loss: 0.6339 | profit rate:    7.3 | accuracy: 0.38
step_num: 3600 | loss: 0.6277 | profit rate:    0.5 | accuracy: 0.38
episode:   1/5,耗时:1.65分/1.65分,训练集: | step: 3717 | average_treward:  -14.5 | max_treward: 0.0000 | average profit rate:  0.082
step_num: 3800 | loss: 0.6167 | profit rate:    6.9 | accuracy: 0.55
step_num: 4000 | loss: 0.6210 | profit rate:    0.6 | accuracy: 0.29
step_num: 4200 | loss: 0.6062 | profit rate:    1.6 | accuracy: 0.23
step_num: 4400 | loss: 0.5534 | profit rate:    0.2 | accuracy: 0.20
step_num: 4600 | loss: 0.5094 | profit rate:    0.3 | accuracy: 0.21
step_num: 4800 | loss: 0.5295 | profit rate:    0.7 | accuracy: 0.26
step_num: 5000 | loss: 0.5301 | profit rate:    0.0 | accuracy: 0.26
step_num: 5200 | loss: 0.4667 | profit rate:    0.1 | accuracy: 0.25
step_num: 5400 | loss: 0.4123 | profit rate:    0.0 | accuracy: 0.24
step_num: 5600 | loss: 0.3834 | profit rate:    0.0 | accuracy: 0.23
step_num: 5800 | loss: 0.3436 | profit rate:    0.0 | accuracy: 0.23
step_num: 6000 | loss: 0.3701 | profit rate:  171.4 | accuracy: 0.26
step_num: 6200 | loss: 0.4125 | profit rate: 43504.2 | accuracy: 0.28
step_num: 6400 | loss: 0.3986 | profit rate: 58985.2 | accuracy: 0.29
step_num: 6600 | loss: 0.4430 | profit rate: 1336909.6 | accuracy: 0.31
step_num: 6800 | loss: 0.4452 | profit rate: 1252540.0 | accuracy: 0.30
step_num: 7000 | loss: 0.4036 | profit rate: 160028.2 | accuracy: 0.30
step_num: 7200 | loss: 0.4351 | profit rate: 243343.2 | accuracy: 0.30
step_num: 7400 | loss: 0.4249 | profit rate: 127478.3 | accuracy: 0.30
model saved @ step:7434,performance:128539.778,accuracy:0.30
step_num: 7600 | loss: 0.5187 | profit rate:    1.5 | accuracy: 0.46
step_num: 7800 | loss: 0.5183 | profit rate:    0.6 | accuracy: 0.25
step_num: 8000 | loss: 0.5040 | profit rate:    0.2 | accuracy: 0.24
step_num: 8200 | loss: 0.4237 | profit rate:    0.7 | accuracy: 0.22
step_num: 8400 | loss: 0.4213 | profit rate:    2.8 | accuracy: 0.24
step_num: 8600 | loss: 0.4702 | profit rate: 16799.4 | accuracy: 0.30
step_num: 8800 | loss: 0.4109 | profit rate:  897.3 | accuracy: 0.27
step_num: 9000 | loss: 0.4026 | profit rate: 1603.2 | accuracy: 0.27
step_num: 9200 | loss: 0.4227 | profit rate:    0.7 | accuracy: 0.26
step_num: 9400 | loss: 0.3987 | profit rate:    0.8 | accuracy: 0.24
step_num: 9600 | loss: 0.3366 | profit rate:    9.8 | accuracy: 0.26
step_num: 9800 | loss: 0.4013 | profit rate: 2228415.5 | accuracy: 0.29
step_num: 10000 | loss: 0.4211 | profit rate: 24310066.5 | accuracy: 0.30
step_num: 10200 | loss: 0.4369 | profit rate: 23250296.8 | accuracy: 0.31
step_num: 10400 | loss: 0.4576 | profit rate: 17758743.3 | accuracy: 0.31
step_num: 10600 | loss: 0.4249 | profit rate: 55093537.0 | accuracy: 0.31
step_num: 10800 | loss: 0.4057 | profit rate: 51375861.4 | accuracy: 0.31
step_num: 11000 | loss: 0.4586 | profit rate: 72601400.6 | accuracy: 0.30
episode:   3/5,耗时:2.30分/6.33分,训练集: | step: 11151 | average_treward:  184.7 | max_treward: 319.7386 | average profit rate: 25413616.826
model saved @ step:11151,performance:76112310.617,accuracy:0.30
step_num: 11200 | loss: 0.4486 | profit rate:   31.6 | accuracy: 0.68
step_num: 11400 | loss: 0.4813 | profit rate:   21.1 | accuracy: 0.36
step_num: 11600 | loss: 0.4852 | profit rate:   10.7 | accuracy: 0.26
step_num: 11800 | loss: 0.4271 | profit rate:    2.8 | accuracy: 0.24
step_num: 12000 | loss: 0.4354 | profit rate:    3.8 | accuracy: 0.25
step_num: 12200 | loss: 0.4167 | profit rate:  214.5 | accuracy: 0.28
step_num: 12400 | loss: 0.4317 | profit rate: 1397.3 | accuracy: 0.31
step_num: 12600 | loss: 0.4095 | profit rate: 2521.7 | accuracy: 0.30
step_num: 12800 | loss: 0.4200 | profit rate:  315.8 | accuracy: 0.29
step_num: 13000 | loss: 0.4081 | profit rate:   23.9 | accuracy: 0.27
step_num: 13200 | loss: 0.4094 | profit rate:   25.1 | accuracy: 0.28
step_num: 13400 | loss: 0.3822 | profit rate: 47755.0 | accuracy: 0.30
step_num: 13600 | loss: 0.4181 | profit rate: 722612494.5 | accuracy: 0.32
step_num: 13800 | loss: 0.3970 | profit rate: 6384066814.9 | accuracy: 0.32
step_num: 14000 | loss: 0.4697 | profit rate: 23545657143.5 | accuracy: 0.33
step_num: 14200 | loss: 0.4715 | profit rate: 11250542525.5 | accuracy: 0.33
step_num: 14400 | loss: 0.4613 | profit rate: 3291794318.4 | accuracy: 0.32
step_num: 14600 | loss: 0.4043 | profit rate: 26658385465.2 | accuracy: 0.32
step_num: 14800 | loss: 0.3924 | profit rate: 17859759849.6 | accuracy: 0.31
model saved @ step:14868,performance:18560957102.134,accuracy:0.30
step_num: 15000 | loss: 0.4526 | profit rate:    1.5 | accuracy: 0.43
step_num: 15200 | loss: 0.4516 | profit rate:   23.7 | accuracy: 0.28
step_num: 15400 | loss: 0.4365 | profit rate:   23.8 | accuracy: 0.26
step_num: 15600 | loss: 0.3902 | profit rate: 1246.8 | accuracy: 0.27
step_num: 15800 | loss: 0.3934 | profit rate: 3772.5 | accuracy: 0.28
step_num: 16000 | loss: 0.3906 | profit rate: 14773358.0 | accuracy: 0.34
step_num: 16200 | loss: 0.4104 | profit rate: 11692856.2 | accuracy: 0.34
step_num: 16400 | loss: 0.3923 | profit rate: 18296501.8 | accuracy: 0.33
step_num: 16600 | loss: 0.4381 | profit rate: 244524.7 | accuracy: 0.32
step_num: 16800 | loss: 0.4197 | profit rate: 137271.8 | accuracy: 0.30
step_num: 17000 | loss: 0.3712 | profit rate: 149452.9 | accuracy: 0.31
step_num: 17200 | loss: 0.4290 | profit rate: 174242231552.7 | accuracy: 0.35
step_num: 17400 | loss: 0.4674 | profit rate: 5352603443434.6 | accuracy: 0.36
step_num: 17600 | loss: 0.4791 | profit rate: 66895350946095.6 | accuracy: 0.36
step_num: 17800 | loss: 0.4931 | profit rate: 80239186443634.6 | accuracy: 0.36
step_num: 18000 | loss: 0.4885 | profit rate: 394823021926159.6 | accuracy: 0.36
step_num: 18200 | loss: 0.4750 | profit rate: 27181253994799.6 | accuracy: 0.35
step_num: 18400 | loss: 0.4611 | profit rate: 38784949444089.9 | accuracy: 0.34
episode:   5/5,耗时:2.35分/10.96分,训练集: | step: 18585 | average_treward:  298.9 | max_treward: 524.4734 | average profit rate: 9531670571309.424
model saved @ step:18585,performance:47639715658594.508,accuracy:0.33
----------------------------------------finished----------------------------------------
  0%|          | 0/401 [00:00<?, ?it/s] 23%|       | 92/401 [00:00<00:00, 919.09it/s] 52%|    | 208/401 [00:00<00:00, 1058.75it/s] 81%| | 326/401 [00:00<00:00, 1109.22it/s]==================================================
2023-01-05T12:00:00 | *** START BACKTEST ***
2023-01-05T12:00:00 | current balance = 1000.00
==================================================
100%|| 401/401 [00:00<00:00, 1091.53it/s]
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1418.90
2023-07-24T12:00:00 | net performance [%] = 41.8904
2023-07-24T12:00:00 | number of trades [#] = 6
==================================================
Trial 52 Complete [00h 11m 01s]
net_wealth: 1420.3238356993836

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 05h 58m 05s

Search: Running Trial #53

Value             |Best Value So Far |Hyperparameter
11                |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
7                 |5                 |lags
0.95              |0.6               |gamma
0.001             |5e-05             |DQN_lr
512               |64                |memory_size
64                |16                |batch_size
0.1               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4290.000000   4301.000000
mean      0.000435    20113.607657  ...   20209.671704  20169.373185
std       0.027833    16040.642334  ...   16079.448796  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7766.127563   7730.930176
50%       0.000642    11571.842969  ...   11761.109863  11751.469727
75%       0.011590    29894.706152  ...   30046.502930  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 400 | loss: 0.5511 | profit rate:   10.5 | accuracy: 0.31
step_num: 600 | loss: 0.5852 | profit rate:    7.6 | accuracy: 0.30
step_num: 800 | loss: 0.5289 | profit rate:    0.9 | accuracy: 0.30
step_num: 1000 | loss: 0.4994 | profit rate:    0.2 | accuracy: 0.29
step_num: 1200 | loss: 0.4617 | profit rate:    1.7 | accuracy: 0.30
step_num: 1400 | loss: 0.5736 | profit rate:    0.5 | accuracy: 0.32
step_num: 1600 | loss: 0.4786 | profit rate:    0.2 | accuracy: 0.32
step_num: 1800 | loss: 0.5478 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.3631 | profit rate:    0.0 | accuracy: 0.30
step_num: 2200 | loss: 0.3700 | profit rate:    0.0 | accuracy: 0.29
step_num: 2400 | loss: 0.4653 | profit rate:    0.0 | accuracy: 0.29
step_num: 2600 | loss: 0.4837 | profit rate:    0.0 | accuracy: 0.30
step_num: 2800 | loss: 0.4855 | profit rate:    0.0 | accuracy: 0.30
step_num: 3000 | loss: 0.4111 | profit rate:    0.0 | accuracy: 0.30
step_num: 3200 | loss: 0.4526 | profit rate:    0.0 | accuracy: 0.31
step_num: 3400 | loss: 0.5835 | profit rate:    0.0 | accuracy: 0.32
step_num: 3600 | loss: 0.5183 | profit rate:    0.0 | accuracy: 0.32
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3706 | average_treward:    1.7 | max_treward: 1.6907 | average profit rate:  0.014
model saved @ step:3706,performance:0.014,accuracy:0.32
step_num: 3800 | loss: 0.5762 | profit rate:    1.9 | accuracy: 0.40
step_num: 4000 | loss: 0.5266 | profit rate:    8.4 | accuracy: 0.33
step_num: 4200 | loss: 0.5956 | profit rate:  267.5 | accuracy: 0.36
step_num: 4400 | loss: 0.5654 | profit rate: 5289.7 | accuracy: 0.37
step_num: 4600 | loss: 0.5730 | profit rate:  199.0 | accuracy: 0.38
step_num: 4800 | loss: 0.6332 | profit rate:    2.0 | accuracy: 0.34
step_num: 5000 | loss: 0.7992 | profit rate:    8.8 | accuracy: 0.34
step_num: 5200 | loss: 0.4155 | profit rate:    0.7 | accuracy: 0.33
step_num: 5400 | loss: 0.4082 | profit rate:    0.1 | accuracy: 0.32
step_num: 5600 | loss: 0.3472 | profit rate:    0.0 | accuracy: 0.31
step_num: 5800 | loss: 0.2223 | profit rate:    0.0 | accuracy: 0.29
step_num: 6000 | loss: 0.4000 | profit rate:    2.0 | accuracy: 0.30
step_num: 6200 | loss: 0.5520 | profit rate:    0.4 | accuracy: 0.29
step_num: 6400 | loss: 0.3623 | profit rate:    0.3 | accuracy: 0.28
step_num: 6600 | loss: 0.4548 | profit rate:    0.6 | accuracy: 0.29
step_num: 6800 | loss: 0.5104 | profit rate:    0.3 | accuracy: 0.28
step_num: 7000 | loss: 0.4121 | profit rate:    0.1 | accuracy: 0.28
step_num: 7200 | loss: 0.5059 | profit rate:    0.4 | accuracy: 0.29
step_num: 7400 | loss: 0.4588 | profit rate:    5.7 | accuracy: 0.29
model saved @ step:7412,performance:5.959,accuracy:0.29
step_num: 7600 | loss: 0.6404 | profit rate:  244.0 | accuracy: 0.50
step_num: 7800 | loss: 0.6950 | profit rate: 81069.9 | accuracy: 0.52
step_num: 8000 | loss: 0.6878 | profit rate: 1105513.9 | accuracy: 0.48
step_num: 8200 | loss: 0.6967 | profit rate: 515569.5 | accuracy: 0.44
step_num: 8400 | loss: 0.6780 | profit rate: 38718.7 | accuracy: 0.44
step_num: 8600 | loss: 0.5532 | profit rate: 11253.3 | accuracy: 0.40
step_num: 8800 | loss: 0.4702 | profit rate: 12641.4 | accuracy: 0.39
step_num: 9000 | loss: 0.4068 | profit rate: 1194.5 | accuracy: 0.37
step_num: 9200 | loss: 0.3082 | profit rate:  529.1 | accuracy: 0.35
step_num: 9400 | loss: 0.2245 | profit rate:  168.8 | accuracy: 0.33
step_num: 9600 | loss: 0.2034 | profit rate:  521.6 | accuracy: 0.32
step_num: 9800 | loss: 0.5724 | profit rate: 9327.2 | accuracy: 0.32
step_num: 10000 | loss: 0.7379 | profit rate: 1151.7 | accuracy: 0.31
step_num: 10200 | loss: 0.3762 | profit rate: 7560.5 | accuracy: 0.31
step_num: 10400 | loss: 0.3694 | profit rate: 12673.2 | accuracy: 0.31
step_num: 10600 | loss: 0.4278 | profit rate: 180334.9 | accuracy: 0.32
step_num: 10800 | loss: 0.4785 | profit rate: 240260.8 | accuracy: 0.32
step_num: 11000 | loss: 0.5403 | profit rate: 711852.0 | accuracy: 0.32
episode:   3/5,耗时:0.71分/2.06分,训练集: | step: 11118 | average_treward:  135.1 | max_treward: 305.6962 | average profit rate: 1868459.154
model saved @ step:11118,performance:5605371.489,accuracy:0.32
step_num: 11200 | loss: 0.6127 | profit rate:    4.8 | accuracy: 0.42
step_num: 11400 | loss: 0.7119 | profit rate:  242.4 | accuracy: 0.42
step_num: 11600 | loss: 0.6249 | profit rate: 5145.9 | accuracy: 0.41
step_num: 11800 | loss: 0.6173 | profit rate: 57676.5 | accuracy: 0.42
step_num: 12000 | loss: 0.5046 | profit rate: 48305.0 | accuracy: 0.40
step_num: 12200 | loss: 0.5155 | profit rate: 1340.4 | accuracy: 0.37
step_num: 12400 | loss: 0.4271 | profit rate: 16269.6 | accuracy: 0.36
step_num: 12600 | loss: 0.3210 | profit rate: 3830.0 | accuracy: 0.35
step_num: 12800 | loss: 0.4142 | profit rate: 5871.0 | accuracy: 0.35
step_num: 13000 | loss: 0.4568 | profit rate:  794.0 | accuracy: 0.34
step_num: 13200 | loss: 0.3229 | profit rate: 1194.8 | accuracy: 0.33
step_num: 13400 | loss: 0.2963 | profit rate: 30553.1 | accuracy: 0.33
step_num: 13600 | loss: 0.4430 | profit rate: 129073.5 | accuracy: 0.32
step_num: 13800 | loss: 0.4146 | profit rate: 291977.3 | accuracy: 0.32
step_num: 14000 | loss: 0.3966 | profit rate: 4611256.6 | accuracy: 0.33
step_num: 14200 | loss: 0.3227 | profit rate: 2986895.4 | accuracy: 0.32
step_num: 14400 | loss: 0.2663 | profit rate: 6166302.1 | accuracy: 0.31
step_num: 14600 | loss: 0.4394 | profit rate: 17755544.5 | accuracy: 0.31
step_num: 14800 | loss: 0.3763 | profit rate: 338722058.0 | accuracy: 0.31
model saved @ step:14824,performance:342692593.043,accuracy:0.31
step_num: 15000 | loss: 0.6503 | profit rate:  695.1 | accuracy: 0.46
step_num: 15200 | loss: 0.6493 | profit rate: 141364.5 | accuracy: 0.45
step_num: 15400 | loss: 0.6417 | profit rate: 945151.3 | accuracy: 0.40
step_num: 15600 | loss: 0.5490 | profit rate: 962726.0 | accuracy: 0.39
step_num: 15800 | loss: 0.5005 | profit rate: 89176.6 | accuracy: 0.38
step_num: 16000 | loss: 0.4058 | profit rate: 343197.2 | accuracy: 0.36
step_num: 16200 | loss: 0.3580 | profit rate: 1991135.6 | accuracy: 0.36
step_num: 16400 | loss: 0.3700 | profit rate: 2339839.7 | accuracy: 0.35
step_num: 16600 | loss: 0.4935 | profit rate: 911051.6 | accuracy: 0.34
step_num: 16800 | loss: 0.4077 | profit rate: 881892.1 | accuracy: 0.34
step_num: 17000 | loss: 0.3703 | profit rate: 1031284.1 | accuracy: 0.34
step_num: 17200 | loss: 0.5574 | profit rate: 2481562.2 | accuracy: 0.33
step_num: 17400 | loss: 0.6272 | profit rate: 22503933.7 | accuracy: 0.34
step_num: 17600 | loss: 0.4161 | profit rate: 565209380.0 | accuracy: 0.34
step_num: 17800 | loss: 0.4667 | profit rate: 1859119090.5 | accuracy: 0.34
step_num: 18000 | loss: 0.2927 | profit rate: 2453936848.0 | accuracy: 0.33
step_num: 18200 | loss: 0.3967 | profit rate: 45844347363.6 | accuracy: 0.33
step_num: 18400 | loss: 0.4569 | profit rate: 117386095948.4 | accuracy: 0.33
episode:   5/5,耗时:0.72分/3.50分,训练集: | step: 18530 | average_treward:  255.6 | max_treward: 509.2247 | average profit rate: 91194540343.480
model saved @ step:18530,performance:455624403746.894,accuracy:0.33
----------------------------------------finished----------------------------------------
  0%|          | 0/404 [00:00<?, ?it/s] 20%|        | 80/404 [00:00<00:00, 792.08it/s] 44%|     | 178/404 [00:00<00:00, 902.12it/s] 69%|   | 279/404 [00:00<00:00, 946.96it/s] 95%|| 383/404 [00:00<00:00, 983.54it/s]100%|| 404/404 [00:00<00:00, 951.81it/s]
==================================================
2023-01-04T00:00:00 | *** START BACKTEST ***
2023-01-04T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1249.65
2023-07-24T12:00:00 | net performance [%] = 24.9646
2023-07-24T12:00:00 | number of trades [#] = 24
==================================================
Trial 53 Complete [00h 03m 34s]
net_wealth: 1249.6463052651632

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 01m 39s

Search: Running Trial #54

Value             |Best Value So Far |Hyperparameter
10                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
8                 |5                 |lags
0.92              |0.6               |gamma
1e-05             |5e-05             |DQN_lr
512               |64                |memory_size
32                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4305.000000   4315.000000
mean      0.000441    20062.255222  ...   20154.979356  20118.633889
std       0.027818    16039.874230  ...   16078.042379  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7717.890137   7690.540039
50%       0.000642    11554.824463  ...   11748.200195  11715.610352
75%       0.011655    29873.081836  ...   29993.890625  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 400 | loss: 1.2291 | profit rate:    0.6 | accuracy: 0.35
step_num: 600 | loss: 0.8932 | profit rate:    0.7 | accuracy: 0.37
step_num: 800 | loss: 0.7688 | profit rate:    0.0 | accuracy: 0.34
step_num: 1000 | loss: 0.7522 | profit rate:    0.0 | accuracy: 0.35
step_num: 1200 | loss: 1.0160 | profit rate:    0.0 | accuracy: 0.34
step_num: 1400 | loss: 0.8479 | profit rate:    0.0 | accuracy: 0.33
step_num: 1600 | loss: 0.7050 | profit rate:    0.0 | accuracy: 0.35
step_num: 1800 | loss: 0.6759 | profit rate:    0.0 | accuracy: 0.35
step_num: 2000 | loss: 0.5740 | profit rate:    0.0 | accuracy: 0.36
step_num: 2200 | loss: 0.5873 | profit rate:    0.0 | accuracy: 0.36
step_num: 2400 | loss: 0.6824 | profit rate:    0.0 | accuracy: 0.34
step_num: 2600 | loss: 0.6640 | profit rate:    0.0 | accuracy: 0.34
step_num: 2800 | loss: 0.5857 | profit rate:    0.0 | accuracy: 0.34
step_num: 3000 | loss: 0.5561 | profit rate:    0.0 | accuracy: 0.33
step_num: 3200 | loss: 0.5632 | profit rate:    0.0 | accuracy: 0.33
step_num: 3400 | loss: 0.5137 | profit rate:    0.0 | accuracy: 0.33
step_num: 3600 | loss: 0.5472 | profit rate:    0.0 | accuracy: 0.34
episode:   1/5,耗时:0.86分/0.86分,训练集: | step: 3719 | average_treward: -220.7 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 3800 | loss: 0.6632 | profit rate:    0.1 | accuracy: 0.23
step_num: 4000 | loss: 0.6854 | profit rate:    0.1 | accuracy: 0.32
step_num: 4200 | loss: 0.7148 | profit rate:    0.1 | accuracy: 0.38
step_num: 4400 | loss: 0.7012 | profit rate:    0.2 | accuracy: 0.40
step_num: 4600 | loss: 0.6306 | profit rate:    0.0 | accuracy: 0.37
step_num: 4800 | loss: 0.6277 | profit rate:    0.0 | accuracy: 0.34
step_num: 5000 | loss: 0.5484 | profit rate:    0.0 | accuracy: 0.32
step_num: 5200 | loss: 0.5079 | profit rate:    0.0 | accuracy: 0.33
step_num: 5400 | loss: 0.5449 | profit rate:    0.0 | accuracy: 0.34
step_num: 5600 | loss: 0.5686 | profit rate:    0.0 | accuracy: 0.35
step_num: 5800 | loss: 0.4921 | profit rate:    0.0 | accuracy: 0.35
step_num: 6000 | loss: 0.5633 | profit rate:    0.0 | accuracy: 0.35
step_num: 6200 | loss: 0.5225 | profit rate:    0.0 | accuracy: 0.34
step_num: 6400 | loss: 0.5325 | profit rate:    0.0 | accuracy: 0.34
step_num: 6600 | loss: 0.4602 | profit rate:    0.0 | accuracy: 0.33
step_num: 6800 | loss: 0.5323 | profit rate:    0.0 | accuracy: 0.33
step_num: 7000 | loss: 0.4437 | profit rate:    0.0 | accuracy: 0.32
step_num: 7200 | loss: 0.5557 | profit rate:    0.0 | accuracy: 0.33
step_num: 7400 | loss: 0.5980 | profit rate:    0.0 | accuracy: 0.33
step_num: 7600 | loss: 0.6225 | profit rate:    1.8 | accuracy: 0.21
step_num: 7800 | loss: 0.6265 | profit rate:    0.1 | accuracy: 0.31
step_num: 8000 | loss: 0.6341 | profit rate:    0.1 | accuracy: 0.34
step_num: 8200 | loss: 0.5624 | profit rate:    0.0 | accuracy: 0.33
step_num: 8400 | loss: 0.5360 | profit rate:    0.0 | accuracy: 0.32
step_num: 8600 | loss: 0.4921 | profit rate:    0.0 | accuracy: 0.32
step_num: 8800 | loss: 0.4581 | profit rate:    0.0 | accuracy: 0.30
step_num: 9000 | loss: 0.5049 | profit rate:    0.0 | accuracy: 0.31
step_num: 9200 | loss: 0.4561 | profit rate:    0.0 | accuracy: 0.31
step_num: 9400 | loss: 0.5136 | profit rate:    0.6 | accuracy: 0.33
step_num: 9600 | loss: 0.4890 | profit rate:    0.8 | accuracy: 0.34
step_num: 9800 | loss: 0.5292 | profit rate:    0.0 | accuracy: 0.33
step_num: 10000 | loss: 0.5645 | profit rate:    0.0 | accuracy: 0.32
step_num: 10200 | loss: 0.5894 | profit rate:    0.0 | accuracy: 0.32
step_num: 10400 | loss: 0.5181 | profit rate:    0.0 | accuracy: 0.32
step_num: 10600 | loss: 0.5399 | profit rate:    0.0 | accuracy: 0.32
step_num: 10800 | loss: 0.4086 | profit rate:    0.0 | accuracy: 0.31
step_num: 11000 | loss: 0.4921 | profit rate:    0.0 | accuracy: 0.31
episode:   3/5,耗时:0.91分/2.71分,训练集: | step: 11157 | average_treward: -138.8 | max_treward: 0.0000 | average profit rate:  0.000
step_num: 11200 | loss: 0.5931 | profit rate:  411.3 | accuracy: 0.77
step_num: 11400 | loss: 0.5861 | profit rate:   10.3 | accuracy: 0.28
step_num: 11600 | loss: 0.5613 | profit rate:    4.5 | accuracy: 0.29
step_num: 11800 | loss: 0.6299 | profit rate:    4.1 | accuracy: 0.31
step_num: 12000 | loss: 0.4746 | profit rate:    1.2 | accuracy: 0.28
step_num: 12200 | loss: 0.3903 | profit rate:    4.2 | accuracy: 0.28
step_num: 12400 | loss: 0.4742 | profit rate:  131.5 | accuracy: 0.28
step_num: 12600 | loss: 0.4731 | profit rate:   80.8 | accuracy: 0.27
step_num: 12800 | loss: 0.4479 | profit rate:  759.0 | accuracy: 0.28
step_num: 13000 | loss: 0.4768 | profit rate: 1089.1 | accuracy: 0.29
step_num: 13200 | loss: 0.4934 | profit rate: 1205.9 | accuracy: 0.29
step_num: 13400 | loss: 0.5068 | profit rate: 164698.8 | accuracy: 0.31
step_num: 13600 | loss: 0.5929 | profit rate: 5308102.8 | accuracy: 0.32
step_num: 13800 | loss: 0.5338 | profit rate: 295268.5 | accuracy: 0.31
step_num: 14000 | loss: 0.5861 | profit rate: 21943465.1 | accuracy: 0.32
step_num: 14200 | loss: 0.5002 | profit rate: 2260096.2 | accuracy: 0.32
step_num: 14400 | loss: 0.4767 | profit rate: 465992.1 | accuracy: 0.31
step_num: 14600 | loss: 0.3811 | profit rate: 866666.8 | accuracy: 0.31
step_num: 14800 | loss: 0.4179 | profit rate: 40063.2 | accuracy: 0.30
model saved @ step:14876,performance:33178.515,accuracy:0.30
step_num: 15000 | loss: 0.5110 | profit rate:   10.6 | accuracy: 0.30
step_num: 15200 | loss: 0.5036 | profit rate:    0.8 | accuracy: 0.27
step_num: 15400 | loss: 0.5011 | profit rate:    0.1 | accuracy: 0.22
step_num: 15600 | loss: 0.3973 | profit rate:    0.1 | accuracy: 0.22
step_num: 15800 | loss: 0.3673 | profit rate:    0.1 | accuracy: 0.22
step_num: 16000 | loss: 0.4006 | profit rate:   10.9 | accuracy: 0.26
step_num: 16200 | loss: 0.4646 | profit rate:   25.0 | accuracy: 0.25
step_num: 16400 | loss: 0.3238 | profit rate:   13.8 | accuracy: 0.23
step_num: 16600 | loss: 0.3556 | profit rate:    6.3 | accuracy: 0.24
step_num: 16800 | loss: 0.4609 | profit rate:   17.8 | accuracy: 0.26
step_num: 17000 | loss: 0.5403 | profit rate:   62.2 | accuracy: 0.27
step_num: 17200 | loss: 0.5832 | profit rate: 341119.3 | accuracy: 0.30
step_num: 17400 | loss: 0.6662 | profit rate: 417921.8 | accuracy: 0.31
step_num: 17600 | loss: 0.5240 | profit rate: 8766004.1 | accuracy: 0.30
step_num: 17800 | loss: 0.5408 | profit rate: 7076085.9 | accuracy: 0.31
step_num: 18000 | loss: 0.4718 | profit rate: 2141767.3 | accuracy: 0.30
step_num: 18200 | loss: 0.3683 | profit rate: 895437.3 | accuracy: 0.29
step_num: 18400 | loss: 0.3217 | profit rate: 438593.4 | accuracy: 0.29
episode:   5/5,耗时:0.91分/4.53分,训练集: | step: 18595 | average_treward:  -19.0 | max_treward: 172.1359 | average profit rate: 18940.383
model saved @ step:18595,performance:61523.400,accuracy:0.28
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 22%|       | 89/403 [00:00<00:00, 881.26it/s] 51%|     | 204/403 [00:00<00:00, 1038.64it/s] 79%|  | 318/403 [00:00<00:00, 1079.95it/s]100%|| 403/403 [00:00<00:00, 1063.33it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1494.89
2023-07-24T12:00:00 | net performance [%] = 49.4891
2023-07-24T12:00:00 | number of trades [#] = 4
==================================================
Trial 54 Complete [00h 04m 35s]
net_wealth: 1496.3869204913456

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 06m 14s

Search: Running Trial #55

Value             |Best Value So Far |Hyperparameter
10                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
5                 |5                 |lags
0.5               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
0.5               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4305.000000   4315.000000
mean      0.000441    20062.255222  ...   20154.979356  20118.633889
std       0.027818    16039.874230  ...   16078.042379  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7717.890137   7690.540039
50%       0.000642    11554.824463  ...   11748.200195  11715.610352
75%       0.011655    29873.081836  ...   29993.890625  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 0.9288 | profit rate:    1.1 | accuracy: 0.34
step_num: 1200 | loss: 0.8046 | profit rate:    0.3 | accuracy: 0.33
step_num: 1400 | loss: 0.7218 | profit rate:    0.3 | accuracy: 0.33
step_num: 1600 | loss: 0.6883 | profit rate:    0.3 | accuracy: 0.33
step_num: 1800 | loss: 0.6858 | profit rate:    0.3 | accuracy: 0.33
step_num: 2000 | loss: 0.6332 | profit rate:    0.2 | accuracy: 0.32
step_num: 2200 | loss: 0.5802 | profit rate:    0.7 | accuracy: 0.32
step_num: 2400 | loss: 0.5447 | profit rate:   11.3 | accuracy: 0.32
step_num: 2600 | loss: 0.5853 | profit rate:    3.8 | accuracy: 0.32
step_num: 2800 | loss: 0.5535 | profit rate:   23.0 | accuracy: 0.33
step_num: 3000 | loss: 0.5720 | profit rate:   21.8 | accuracy: 0.33
step_num: 3200 | loss: 0.5593 | profit rate:    5.1 | accuracy: 0.33
step_num: 3400 | loss: 0.5931 | profit rate:   20.0 | accuracy: 0.34
step_num: 3600 | loss: 0.5674 | profit rate:    2.1 | accuracy: 0.34
episode:   1/5,耗时:0.96分/0.96分,训练集: | step: 3677 | average_treward:   31.6 | max_treward: 31.6297 | average profit rate:  2.067
model saved @ step:3677,performance:2.067,accuracy:0.35
step_num: 3800 | loss: 0.6069 | profit rate:    0.0 | accuracy: 0.21
step_num: 4000 | loss: 0.6351 | profit rate:    0.0 | accuracy: 0.37
step_num: 4200 | loss: 0.6553 | profit rate:    0.0 | accuracy: 0.37
step_num: 4400 | loss: 0.6282 | profit rate:    0.0 | accuracy: 0.33
step_num: 4600 | loss: 0.6460 | profit rate:    0.0 | accuracy: 0.36
step_num: 4800 | loss: 0.6528 | profit rate:   11.1 | accuracy: 0.41
step_num: 5000 | loss: 0.6710 | profit rate:    0.3 | accuracy: 0.38
step_num: 5200 | loss: 0.6465 | profit rate:    0.5 | accuracy: 0.37
step_num: 5400 | loss: 0.6283 | profit rate:   13.9 | accuracy: 0.38
step_num: 5600 | loss: 0.6264 | profit rate:   24.0 | accuracy: 0.40
step_num: 5800 | loss: 0.6067 | profit rate:  703.0 | accuracy: 0.41
step_num: 6000 | loss: 0.6314 | profit rate: 3950415.6 | accuracy: 0.43
step_num: 6200 | loss: 0.6479 | profit rate: 2338347.2 | accuracy: 0.42
step_num: 6400 | loss: 0.6292 | profit rate: 1317585.5 | accuracy: 0.41
step_num: 6600 | loss: 0.6230 | profit rate: 1515739.2 | accuracy: 0.41
step_num: 6800 | loss: 0.6104 | profit rate: 881955.3 | accuracy: 0.40
step_num: 7000 | loss: 0.6010 | profit rate: 76476.2 | accuracy: 0.39
step_num: 7200 | loss: 0.5842 | profit rate: 44178.2 | accuracy: 0.39
model saved @ step:7354,performance:12220.618,accuracy:0.38
step_num: 7400 | loss: 0.5483 | profit rate:    0.1 | accuracy: 0.26
step_num: 7600 | loss: 0.5681 | profit rate:    0.0 | accuracy: 0.26
step_num: 7800 | loss: 0.5736 | profit rate:    0.0 | accuracy: 0.26
step_num: 8000 | loss: 0.5225 | profit rate:    0.0 | accuracy: 0.26
step_num: 8200 | loss: 0.4868 | profit rate:    0.0 | accuracy: 0.25
step_num: 8400 | loss: 0.4930 | profit rate:    2.7 | accuracy: 0.34
step_num: 8600 | loss: 0.5161 | profit rate:    0.4 | accuracy: 0.33
step_num: 8800 | loss: 0.4845 | profit rate:    0.0 | accuracy: 0.31
step_num: 9000 | loss: 0.5108 | profit rate:    0.2 | accuracy: 0.32
step_num: 9200 | loss: 0.5312 | profit rate:    0.6 | accuracy: 0.32
step_num: 9400 | loss: 0.5171 | profit rate:    0.3 | accuracy: 0.33
step_num: 9600 | loss: 0.5423 | profit rate: 27229.9 | accuracy: 0.37
step_num: 9800 | loss: 0.5613 | profit rate: 141603.7 | accuracy: 0.38
step_num: 10000 | loss: 0.5394 | profit rate: 60523.7 | accuracy: 0.36
step_num: 10200 | loss: 0.5891 | profit rate: 856535.1 | accuracy: 0.38
step_num: 10400 | loss: 0.5721 | profit rate: 35221.4 | accuracy: 0.36
step_num: 10600 | loss: 0.5244 | profit rate: 9943.3 | accuracy: 0.35
step_num: 10800 | loss: 0.5336 | profit rate: 4455.3 | accuracy: 0.35
step_num: 11000 | loss: 0.5095 | profit rate:  322.8 | accuracy: 0.33
episode:   3/5,耗时:1.38分/3.75分,训练集: | step: 11031 | average_treward:   98.5 | max_treward: 138.0544 | average profit rate: 4182.539
step_num: 11200 | loss: 0.5018 | profit rate:    0.0 | accuracy: 0.24
step_num: 11400 | loss: 0.4941 | profit rate:    0.0 | accuracy: 0.22
step_num: 11600 | loss: 0.4479 | profit rate:    0.0 | accuracy: 0.23
step_num: 11800 | loss: 0.4071 | profit rate:    0.0 | accuracy: 0.21
step_num: 12000 | loss: 0.4200 | profit rate:    0.2 | accuracy: 0.26
step_num: 12200 | loss: 0.4010 | profit rate:   27.3 | accuracy: 0.31
step_num: 12400 | loss: 0.4147 | profit rate:    4.3 | accuracy: 0.28
step_num: 12600 | loss: 0.3867 | profit rate:   18.7 | accuracy: 0.28
step_num: 12800 | loss: 0.4101 | profit rate:   20.0 | accuracy: 0.28
step_num: 13000 | loss: 0.4235 | profit rate:   43.6 | accuracy: 0.29
step_num: 13200 | loss: 0.3953 | profit rate: 1972.3 | accuracy: 0.32
step_num: 13400 | loss: 0.4513 | profit rate: 77076045.6 | accuracy: 0.34
step_num: 13600 | loss: 0.4858 | profit rate: 7088782.4 | accuracy: 0.34
step_num: 13800 | loss: 0.4934 | profit rate: 22393475.6 | accuracy: 0.34
step_num: 14000 | loss: 0.5141 | profit rate: 17359074.0 | accuracy: 0.34
step_num: 14200 | loss: 0.4837 | profit rate: 4228297.4 | accuracy: 0.33
step_num: 14400 | loss: 0.4710 | profit rate: 3496110.3 | accuracy: 0.32
step_num: 14600 | loss: 0.4627 | profit rate: 136770.9 | accuracy: 0.31
model saved @ step:14708,performance:173136.205,accuracy:0.30
step_num: 14800 | loss: 0.4716 | profit rate:    0.0 | accuracy: 0.25
step_num: 15000 | loss: 0.4645 | profit rate:    0.0 | accuracy: 0.24
step_num: 15200 | loss: 0.4213 | profit rate:    0.0 | accuracy: 0.21
step_num: 15400 | loss: 0.3725 | profit rate:    0.0 | accuracy: 0.20
step_num: 15600 | loss: 0.3608 | profit rate:    0.0 | accuracy: 0.20
step_num: 15800 | loss: 0.3725 | profit rate:   40.0 | accuracy: 0.28
step_num: 16000 | loss: 0.3665 | profit rate:   11.9 | accuracy: 0.27
step_num: 16200 | loss: 0.3377 | profit rate:    2.6 | accuracy: 0.25
step_num: 16400 | loss: 0.3646 | profit rate:    6.9 | accuracy: 0.25
step_num: 16600 | loss: 0.3826 | profit rate:    4.5 | accuracy: 0.25
step_num: 16800 | loss: 0.3614 | profit rate:    9.8 | accuracy: 0.27
step_num: 17000 | loss: 0.4154 | profit rate: 439303.3 | accuracy: 0.30
step_num: 17200 | loss: 0.4683 | profit rate: 447368.8 | accuracy: 0.31
step_num: 17400 | loss: 0.4288 | profit rate: 1059072.8 | accuracy: 0.31
step_num: 17600 | loss: 0.4836 | profit rate: 726593.2 | accuracy: 0.32
step_num: 17800 | loss: 0.4620 | profit rate: 170954.8 | accuracy: 0.30
step_num: 18000 | loss: 0.4270 | profit rate: 107085.6 | accuracy: 0.29
step_num: 18200 | loss: 0.4139 | profit rate: 60742.9 | accuracy: 0.28
episode:   5/5,耗时:1.32分/6.44分,训练集: | step: 18385 | average_treward:  151.7 | max_treward: 251.3092 | average profit rate: 48202.738
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 26%|       | 104/406 [00:00<00:00, 1039.89it/s] 52%|    | 211/406 [00:00<00:00, 1056.58it/s] 78%|  | 318/406 [00:00<00:00, 1061.80it/s]100%|| 406/406 [00:00<00:00, 1075.89it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1289.36
2023-07-24T12:00:00 | net performance [%] = 28.9361
2023-07-24T12:00:00 | number of trades [#] = 8
==================================================
Trial 55 Complete [00h 06m 29s]
net_wealth: 1290.6517101820175

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 12m 44s

Search: Running Trial #56

Value             |Best Value So Far |Hyperparameter
8                 |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
5                 |5                 |lags
0.85              |0.6               |gamma
0.0005            |5e-05             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
2                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4307.000000   4315.000000
mean      0.000441    20062.255222  ...   20147.798395  20118.633889
std       0.027818    16039.874230  ...   16077.761122  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7714.554932   7690.540039
50%       0.000642    11554.824463  ...   11744.910156  11715.610352
75%       0.011655    29873.081836  ...   29972.419922  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.0384 | profit rate:    0.1 | accuracy: 0.31
step_num: 1200 | loss: 0.5385 | profit rate:    0.2 | accuracy: 0.32
step_num: 1400 | loss: 0.5262 | profit rate:    0.2 | accuracy: 0.32
step_num: 1600 | loss: 0.5191 | profit rate:    0.1 | accuracy: 0.31
step_num: 1800 | loss: 0.4863 | profit rate:    0.0 | accuracy: 0.31
step_num: 2000 | loss: 0.4720 | profit rate:    0.0 | accuracy: 0.31
step_num: 2200 | loss: 0.4418 | profit rate:    1.1 | accuracy: 0.32
step_num: 2400 | loss: 0.4751 | profit rate:  170.1 | accuracy: 0.34
step_num: 2600 | loss: 0.4941 | profit rate:   12.5 | accuracy: 0.34
step_num: 2800 | loss: 0.4877 | profit rate:   89.1 | accuracy: 0.34
step_num: 3000 | loss: 0.4689 | profit rate:   16.2 | accuracy: 0.34
step_num: 3200 | loss: 0.4860 | profit rate:    9.6 | accuracy: 0.33
step_num: 3400 | loss: 0.4718 | profit rate:   16.4 | accuracy: 0.33
step_num: 3600 | loss: 0.4386 | profit rate:   10.1 | accuracy: 0.32
episode:   1/5,耗时:0.99分/0.99分,训练集: | step: 3677 | average_treward:   69.9 | max_treward: 69.8934 | average profit rate: 10.791
model saved @ step:3677,performance:10.791,accuracy:0.32
step_num: 3800 | loss: 0.4411 | profit rate:    0.0 | accuracy: 0.29
step_num: 4000 | loss: 0.4285 | profit rate:    0.1 | accuracy: 0.20
step_num: 4200 | loss: 0.4077 | profit rate:    0.1 | accuracy: 0.20
step_num: 4400 | loss: 0.3947 | profit rate:    0.5 | accuracy: 0.22
step_num: 4600 | loss: 0.3388 | profit rate:    0.3 | accuracy: 0.21
step_num: 4800 | loss: 0.3048 | profit rate:    0.1 | accuracy: 0.20
step_num: 5000 | loss: 0.2816 | profit rate:    0.1 | accuracy: 0.18
step_num: 5200 | loss: 0.2843 | profit rate:    0.1 | accuracy: 0.19
step_num: 5400 | loss: 0.2564 | profit rate:    0.6 | accuracy: 0.19
step_num: 5600 | loss: 0.2492 | profit rate:    1.4 | accuracy: 0.18
step_num: 5800 | loss: 0.2018 | profit rate:    4.4 | accuracy: 0.18
step_num: 6000 | loss: 0.2104 | profit rate:   40.3 | accuracy: 0.18
step_num: 6200 | loss: 0.2051 | profit rate:   31.4 | accuracy: 0.18
step_num: 6400 | loss: 0.1958 | profit rate:  193.1 | accuracy: 0.18
step_num: 6600 | loss: 0.1825 | profit rate:  252.4 | accuracy: 0.18
step_num: 6800 | loss: 0.2106 | profit rate:  332.0 | accuracy: 0.18
step_num: 7000 | loss: 0.2235 | profit rate: 1174.0 | accuracy: 0.19
step_num: 7200 | loss: 0.2415 | profit rate: 7048.1 | accuracy: 0.19
model saved @ step:7354,performance:19522.667,accuracy:0.20
step_num: 7400 | loss: 0.2727 | profit rate:    1.5 | accuracy: 0.28
step_num: 7600 | loss: 0.3224 | profit rate:   11.2 | accuracy: 0.30
step_num: 7800 | loss: 0.3439 | profit rate:   73.3 | accuracy: 0.32
step_num: 8000 | loss: 0.3479 | profit rate:  192.9 | accuracy: 0.32
step_num: 8200 | loss: 0.3687 | profit rate: 1359.0 | accuracy: 0.33
step_num: 8400 | loss: 0.3788 | profit rate:   54.4 | accuracy: 0.30
step_num: 8600 | loss: 0.3730 | profit rate:   23.7 | accuracy: 0.28
step_num: 8800 | loss: 0.3613 | profit rate:   48.3 | accuracy: 0.28
step_num: 9000 | loss: 0.3446 | profit rate:  127.1 | accuracy: 0.27
step_num: 9200 | loss: 0.3370 | profit rate:  689.7 | accuracy: 0.27
step_num: 9400 | loss: 0.3064 | profit rate:  709.9 | accuracy: 0.26
step_num: 9600 | loss: 0.3100 | profit rate: 1655.9 | accuracy: 0.25
step_num: 9800 | loss: 0.2726 | profit rate: 13896.7 | accuracy: 0.24
step_num: 10000 | loss: 0.2548 | profit rate: 50480.7 | accuracy: 0.25
step_num: 10200 | loss: 0.2491 | profit rate: 429814.3 | accuracy: 0.24
step_num: 10400 | loss: 0.2503 | profit rate: 131743.4 | accuracy: 0.24
step_num: 10600 | loss: 0.2534 | profit rate: 302034.5 | accuracy: 0.24
step_num: 10800 | loss: 0.2470 | profit rate: 1199876.6 | accuracy: 0.25
step_num: 11000 | loss: 0.2624 | profit rate: 3347861.3 | accuracy: 0.25
episode:   3/5,耗时:1.39分/3.79分,训练集: | step: 11031 | average_treward:  208.2 | max_treward: 341.2705 | average profit rate: 1156749.109
model saved @ step:11031,performance:3450713.869,accuracy:0.25
step_num: 11200 | loss: 0.2715 | profit rate:    3.7 | accuracy: 0.26
step_num: 11400 | loss: 0.2941 | profit rate:   21.0 | accuracy: 0.29
step_num: 11600 | loss: 0.3071 | profit rate:   23.8 | accuracy: 0.27
step_num: 11800 | loss: 0.3572 | profit rate:  222.8 | accuracy: 0.30
step_num: 12000 | loss: 0.3227 | profit rate:   42.5 | accuracy: 0.27
step_num: 12200 | loss: 0.3076 | profit rate:   35.7 | accuracy: 0.24
step_num: 12400 | loss: 0.2953 | profit rate:   44.1 | accuracy: 0.24
step_num: 12600 | loss: 0.2846 | profit rate:  166.2 | accuracy: 0.24
step_num: 12800 | loss: 0.2803 | profit rate: 2419.8 | accuracy: 0.24
step_num: 13000 | loss: 0.2666 | profit rate: 1942.3 | accuracy: 0.23
step_num: 13200 | loss: 0.2556 | profit rate: 5112.9 | accuracy: 0.23
step_num: 13400 | loss: 0.2219 | profit rate: 55231.0 | accuracy: 0.22
step_num: 13600 | loss: 0.2191 | profit rate: 450154.6 | accuracy: 0.22
step_num: 13800 | loss: 0.2198 | profit rate: 10477847.5 | accuracy: 0.23
step_num: 14000 | loss: 0.2332 | profit rate: 3153061.4 | accuracy: 0.23
step_num: 14200 | loss: 0.2330 | profit rate: 2586291.7 | accuracy: 0.23
step_num: 14400 | loss: 0.2602 | profit rate: 17938318.3 | accuracy: 0.24
step_num: 14600 | loss: 0.2146 | profit rate: 58110609.4 | accuracy: 0.23
model saved @ step:14708,performance:85147303.059,accuracy:0.24
step_num: 14800 | loss: 0.2591 | profit rate:    1.0 | accuracy: 0.24
step_num: 15000 | loss: 0.2817 | profit rate:   54.9 | accuracy: 0.30
step_num: 15200 | loss: 0.3157 | profit rate:   87.2 | accuracy: 0.28
step_num: 15400 | loss: 0.3347 | profit rate:  411.0 | accuracy: 0.27
step_num: 15600 | loss: 0.3141 | profit rate: 2657.8 | accuracy: 0.27
step_num: 15800 | loss: 0.2794 | profit rate:  704.2 | accuracy: 0.24
step_num: 16000 | loss: 0.3010 | profit rate: 1538.2 | accuracy: 0.23
step_num: 16200 | loss: 0.2666 | profit rate: 4924.2 | accuracy: 0.24
step_num: 16400 | loss: 0.2659 | profit rate: 41174.9 | accuracy: 0.25
step_num: 16600 | loss: 0.2684 | profit rate: 102129.5 | accuracy: 0.25
step_num: 16800 | loss: 0.2680 | profit rate: 169725.6 | accuracy: 0.25
step_num: 17000 | loss: 0.2103 | profit rate: 345567.0 | accuracy: 0.24
step_num: 17200 | loss: 0.2179 | profit rate: 1397901.2 | accuracy: 0.23
step_num: 17400 | loss: 0.2271 | profit rate: 41764057.6 | accuracy: 0.24
step_num: 17600 | loss: 0.2380 | profit rate: 41960370.4 | accuracy: 0.24
step_num: 17800 | loss: 0.2354 | profit rate: 106160440.6 | accuracy: 0.24
step_num: 18000 | loss: 0.2585 | profit rate: 217379353.3 | accuracy: 0.24
step_num: 18200 | loss: 0.2737 | profit rate: 1108595638.4 | accuracy: 0.24
episode:   5/5,耗时:1.34分/6.47分,训练集: | step: 18385 | average_treward:  307.5 | max_treward: 504.7802 | average profit rate: 1041325079.629
model saved @ step:18385,performance:5118007847.759,accuracy:0.25
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 25%|       | 101/406 [00:00<00:00, 1000.08it/s] 52%|    | 213/406 [00:00<00:00, 1064.10it/s] 81%|  | 328/406 [00:00<00:00, 1102.63it/s]100%|| 406/406 [00:00<00:00, 1103.00it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1117.58
2023-07-24T12:00:00 | net performance [%] = 11.7578
2023-07-24T12:00:00 | number of trades [#] = 26
==================================================
Trial 56 Complete [00h 06m 31s]
net_wealth: 1118.6962986595

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 19m 15s

Search: Running Trial #57

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
180               |730               |lookback
True              |True              |MarketFactor
3                 |5                 |lags
0.95              |0.6               |gamma
0.001             |5e-05             |DQN_lr
64                |64                |memory_size
16                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4301.000000     4301.000000  ...    4297.000000   4301.000000
mean      0.000435    20113.607657  ...   20184.134484  20169.373185
std       0.027833    16040.642334  ...   16078.780856  16078.584047
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009750     7678.996509  ...    7747.959961   7730.930176
50%       0.000642    11571.842969  ...   11755.309570  11751.469727
75%       0.011590    29894.706152  ...   30016.300781  30012.630859
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 18 columns]
                           log_return  ...        close
2017-09-03 08:00:00+08:00    0.003094  ...  4486.000000
2017-09-03 20:00:00+08:00    0.005132  ...  4509.080078

[2 rows x 18 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 18 columns]
step_num: 200 | loss: 0.8680 | profit rate:    0.3 | accuracy: 0.35
step_num: 400 | loss: 0.4507 | profit rate:    0.2 | accuracy: 0.31
step_num: 600 | loss: 0.4163 | profit rate:    0.3 | accuracy: 0.33
step_num: 800 | loss: 0.8216 | profit rate:    0.3 | accuracy: 0.34
step_num: 1000 | loss: 0.8009 | profit rate:    0.3 | accuracy: 0.35
step_num: 1200 | loss: 0.2098 | profit rate:    0.5 | accuracy: 0.33
step_num: 1400 | loss: 0.5378 | profit rate:    1.2 | accuracy: 0.32
step_num: 1600 | loss: 0.4305 | profit rate:    1.1 | accuracy: 0.33
step_num: 1800 | loss: 0.6342 | profit rate:    0.5 | accuracy: 0.33
step_num: 2000 | loss: 0.1503 | profit rate:    0.8 | accuracy: 0.31
step_num: 2200 | loss: 0.4084 | profit rate:    1.3 | accuracy: 0.31
step_num: 2400 | loss: 0.2583 | profit rate:    4.5 | accuracy: 0.30
step_num: 2600 | loss: 0.6443 | profit rate:    2.0 | accuracy: 0.30
step_num: 2800 | loss: 0.3564 | profit rate:    3.3 | accuracy: 0.29
step_num: 3000 | loss: 0.2863 | profit rate:    1.5 | accuracy: 0.29
step_num: 3200 | loss: 0.0767 | profit rate:    1.3 | accuracy: 0.28
step_num: 3400 | loss: 0.2388 | profit rate:    1.6 | accuracy: 0.28
step_num: 3600 | loss: 0.3644 | profit rate:    3.4 | accuracy: 0.28
episode:   1/5,耗时:0.53分/0.53分,训练集: | step: 3710 | average_treward:  144.4 | max_treward: 144.4282 | average profit rate:  6.591
model saved @ step:3710,performance:6.591,accuracy:0.28
step_num: 3800 | loss: 0.2434 | profit rate:    0.4 | accuracy: 0.15
step_num: 4000 | loss: 0.7173 | profit rate:    1.1 | accuracy: 0.28
step_num: 4200 | loss: 0.3263 | profit rate:    2.3 | accuracy: 0.29
step_num: 4400 | loss: 0.4780 | profit rate:    4.1 | accuracy: 0.30
step_num: 4600 | loss: 0.5263 | profit rate:    5.1 | accuracy: 0.28
step_num: 4800 | loss: 0.2157 | profit rate:    1.9 | accuracy: 0.28
step_num: 5000 | loss: 0.5249 | profit rate:    1.9 | accuracy: 0.28
step_num: 5200 | loss: 0.4668 | profit rate:   11.2 | accuracy: 0.30
step_num: 5400 | loss: 0.6973 | profit rate:    3.6 | accuracy: 0.30
step_num: 5600 | loss: 0.4221 | profit rate:    1.1 | accuracy: 0.29
step_num: 5800 | loss: 0.2234 | profit rate:    1.1 | accuracy: 0.29
step_num: 6000 | loss: 0.8043 | profit rate:   25.0 | accuracy: 0.30
step_num: 6200 | loss: 0.5831 | profit rate:  163.9 | accuracy: 0.32
step_num: 6400 | loss: 0.3417 | profit rate:   48.7 | accuracy: 0.31
step_num: 6600 | loss: 0.5185 | profit rate:   85.6 | accuracy: 0.32
step_num: 6800 | loss: 0.4601 | profit rate:  108.8 | accuracy: 0.32
step_num: 7000 | loss: 0.4777 | profit rate:  116.9 | accuracy: 0.32
step_num: 7200 | loss: 0.1994 | profit rate:  259.7 | accuracy: 0.32
step_num: 7400 | loss: 0.4342 | profit rate:  460.5 | accuracy: 0.33
model saved @ step:7420,performance:492.364,accuracy:0.33
step_num: 7600 | loss: 0.6418 | profit rate:    0.3 | accuracy: 0.22
step_num: 7800 | loss: 0.3602 | profit rate:    2.0 | accuracy: 0.32
step_num: 8000 | loss: 0.3931 | profit rate:    1.6 | accuracy: 0.30
step_num: 8200 | loss: 0.1769 | profit rate:    2.3 | accuracy: 0.30
step_num: 8400 | loss: 0.3604 | profit rate:    1.7 | accuracy: 0.31
step_num: 8600 | loss: 0.6120 | profit rate:   14.8 | accuracy: 0.35
step_num: 8800 | loss: 0.1257 | profit rate:   22.1 | accuracy: 0.35
step_num: 9000 | loss: 0.4571 | profit rate:   19.7 | accuracy: 0.33
step_num: 9200 | loss: 0.4072 | profit rate:    4.2 | accuracy: 0.33
step_num: 9400 | loss: 0.5279 | profit rate:    3.3 | accuracy: 0.35
step_num: 9600 | loss: 0.6276 | profit rate:   11.1 | accuracy: 0.36
step_num: 9800 | loss: 1.0626 | profit rate:  703.5 | accuracy: 0.39
step_num: 10000 | loss: 0.3694 | profit rate:  206.8 | accuracy: 0.38
step_num: 10200 | loss: 0.8213 | profit rate:  221.5 | accuracy: 0.38
step_num: 10400 | loss: 0.4331 | profit rate:  391.9 | accuracy: 0.39
step_num: 10600 | loss: 0.6676 | profit rate:  199.8 | accuracy: 0.38
step_num: 10800 | loss: 0.5625 | profit rate:  286.8 | accuracy: 0.37
step_num: 11000 | loss: 0.7110 | profit rate:  364.9 | accuracy: 0.37
episode:   3/5,耗时:0.57分/1.68分,训练集: | step: 11130 | average_treward:  202.8 | max_treward: 248.9338 | average profit rate: 408.128
model saved @ step:11130,performance:725.430,accuracy:0.38
step_num: 11200 | loss: 0.7352 | profit rate:    3.7 | accuracy: 0.56
step_num: 11400 | loss: 0.6112 | profit rate:    1.7 | accuracy: 0.34
step_num: 11600 | loss: 0.4981 | profit rate:    2.4 | accuracy: 0.34
step_num: 11800 | loss: 0.3231 | profit rate:    3.8 | accuracy: 0.33
step_num: 12000 | loss: 0.4665 | profit rate:    7.0 | accuracy: 0.31
step_num: 12200 | loss: 0.9323 | profit rate:   18.5 | accuracy: 0.34
step_num: 12400 | loss: 0.3957 | profit rate:   23.9 | accuracy: 0.36
step_num: 12600 | loss: 0.0702 | profit rate:   44.8 | accuracy: 0.33
step_num: 12800 | loss: 0.8660 | profit rate:    5.6 | accuracy: 0.34
step_num: 13000 | loss: 0.6033 | profit rate:    6.3 | accuracy: 0.34
step_num: 13200 | loss: 0.3308 | profit rate:    4.5 | accuracy: 0.34
step_num: 13400 | loss: 0.7060 | profit rate:  262.7 | accuracy: 0.36
step_num: 13600 | loss: 0.7794 | profit rate: 1120.6 | accuracy: 0.38
step_num: 13800 | loss: 0.3772 | profit rate:  297.4 | accuracy: 0.37
step_num: 14000 | loss: 0.7363 | profit rate: 1629.8 | accuracy: 0.38
step_num: 14200 | loss: 0.3521 | profit rate:  549.9 | accuracy: 0.37
step_num: 14400 | loss: 0.1035 | profit rate:  328.7 | accuracy: 0.36
step_num: 14600 | loss: 0.0554 | profit rate:  295.3 | accuracy: 0.34
step_num: 14800 | loss: 0.4531 | profit rate:  330.5 | accuracy: 0.34
step_num: 15000 | loss: 0.2977 | profit rate:    0.6 | accuracy: 0.31
step_num: 15200 | loss: 0.1350 | profit rate:    0.5 | accuracy: 0.20
step_num: 15400 | loss: 0.2799 | profit rate:    0.5 | accuracy: 0.21
step_num: 15600 | loss: 0.0807 | profit rate:    0.8 | accuracy: 0.22
step_num: 15800 | loss: 0.4236 | profit rate:    0.8 | accuracy: 0.25
step_num: 16000 | loss: 0.8892 | profit rate:   28.6 | accuracy: 0.32
step_num: 16200 | loss: 0.1896 | profit rate:    6.1 | accuracy: 0.31
step_num: 16400 | loss: 0.4922 | profit rate:    5.0 | accuracy: 0.29
step_num: 16600 | loss: 0.4517 | profit rate:    2.9 | accuracy: 0.30
step_num: 16800 | loss: 0.4061 | profit rate:    2.8 | accuracy: 0.31
step_num: 17000 | loss: 0.5841 | profit rate:    9.6 | accuracy: 0.32
step_num: 17200 | loss: 1.0330 | profit rate:  322.2 | accuracy: 0.35
step_num: 17400 | loss: 0.4840 | profit rate:  511.4 | accuracy: 0.36
step_num: 17600 | loss: 0.7343 | profit rate:  722.2 | accuracy: 0.37
step_num: 17800 | loss: 0.5882 | profit rate:  669.4 | accuracy: 0.37
step_num: 18000 | loss: 0.2671 | profit rate: 1057.3 | accuracy: 0.37
step_num: 18200 | loss: 0.4055 | profit rate:  786.7 | accuracy: 0.36
step_num: 18400 | loss: 0.2381 | profit rate:  750.2 | accuracy: 0.35
episode:   5/5,耗时:0.56分/2.81分,训练集: | step: 18550 | average_treward:  224.9 | max_treward: 274.0896 | average profit rate: 476.713
model saved @ step:18550,performance:748.391,accuracy:0.35
----------------------------------------finished----------------------------------------
  0%|          | 0/408 [00:00<?, ?it/s] 27%|       | 112/408 [00:00<00:00, 1112.03it/s] 55%|    | 224/408 [00:00<00:00, 1097.39it/s] 84%| | 342/408 [00:00<00:00, 1134.47it/s]100%|| 408/408 [00:00<00:00, 1121.62it/s]
==================================================
2023-01-02T00:00:00 | *** START BACKTEST ***
2023-01-02T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1311.55
2023-07-24T12:00:00 | net performance [%] = 31.1550
2023-07-24T12:00:00 | number of trades [#] = 8
==================================================
Trial 57 Complete [00h 02m 52s]
net_wealth: 1312.8629347952021

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 22m 07s

Search: Running Trial #58

Value             |Best Value So Far |Hyperparameter
14                |12                |horizon
180               |730               |lookback
False             |True              |MarketFactor
8                 |5                 |lags
0.8               |0.6               |gamma
5e-05             |5e-05             |DQN_lr
1024              |64                |memory_size
32                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4301.000000   4315.000000
mean      0.000441    20062.255222  ...   20169.373185  20118.633889
std       0.027818    16039.874230  ...   16078.584047  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7730.930176   7690.540039
50%       0.000642    11554.824463  ...   11751.469727  11715.610352
75%       0.011655    29873.081836  ...   30012.630859  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 600 | loss: 0.9056 | profit rate:    0.2 | accuracy: 0.31
step_num: 800 | loss: 0.7423 | profit rate:    0.0 | accuracy: 0.30
step_num: 1000 | loss: 0.6779 | profit rate:    0.0 | accuracy: 0.30
step_num: 1200 | loss: 0.6122 | profit rate:    0.0 | accuracy: 0.31
step_num: 1400 | loss: 0.5305 | profit rate:    0.0 | accuracy: 0.30
step_num: 1600 | loss: 0.4534 | profit rate:    0.0 | accuracy: 0.29
step_num: 1800 | loss: 0.4648 | profit rate:    0.0 | accuracy: 0.27
step_num: 2000 | loss: 0.4724 | profit rate:    0.0 | accuracy: 0.27
step_num: 2200 | loss: 0.4006 | profit rate:    0.0 | accuracy: 0.28
step_num: 2400 | loss: 0.4552 | profit rate: 2682.9 | accuracy: 0.31
step_num: 2600 | loss: 0.5480 | profit rate:   44.2 | accuracy: 0.30
step_num: 2800 | loss: 0.4740 | profit rate:  392.2 | accuracy: 0.30
step_num: 3000 | loss: 0.5212 | profit rate:  695.1 | accuracy: 0.30
step_num: 3200 | loss: 0.5035 | profit rate:  544.4 | accuracy: 0.30
step_num: 3400 | loss: 0.4436 | profit rate:    9.3 | accuracy: 0.29
step_num: 3600 | loss: 0.4063 | profit rate:    1.7 | accuracy: 0.28
episode:   1/5,耗时:1.15分/1.15分,训练集: | step: 3719 | average_treward:  -14.6 | max_treward: 0.0000 | average profit rate:  0.484
step_num: 3800 | loss: 0.4271 | profit rate:   55.0 | accuracy: 0.57
step_num: 4000 | loss: 0.3738 | profit rate:    0.4 | accuracy: 0.20
step_num: 4200 | loss: 0.2710 | profit rate:    1.4 | accuracy: 0.17
step_num: 4400 | loss: 0.2935 | profit rate:    1.2 | accuracy: 0.17
step_num: 4600 | loss: 0.2332 | profit rate:    6.0 | accuracy: 0.14
step_num: 4800 | loss: 0.2874 | profit rate:    0.0 | accuracy: 0.17
step_num: 5000 | loss: 0.3231 | profit rate:    0.0 | accuracy: 0.17
step_num: 5200 | loss: 0.3732 | profit rate:    0.0 | accuracy: 0.19
step_num: 5400 | loss: 0.3779 | profit rate:    0.0 | accuracy: 0.19
step_num: 5600 | loss: 0.3525 | profit rate:    0.0 | accuracy: 0.18
step_num: 5800 | loss: 0.3106 | profit rate:    0.0 | accuracy: 0.17
step_num: 6000 | loss: 0.2973 | profit rate:    0.0 | accuracy: 0.19
step_num: 6200 | loss: 0.2994 | profit rate:    0.0 | accuracy: 0.19
step_num: 6400 | loss: 0.2058 | profit rate:    0.1 | accuracy: 0.18
step_num: 6600 | loss: 0.2393 | profit rate:   23.7 | accuracy: 0.20
step_num: 6800 | loss: 0.2876 | profit rate:    3.7 | accuracy: 0.19
step_num: 7000 | loss: 0.2977 | profit rate:    1.8 | accuracy: 0.19
step_num: 7200 | loss: 0.2876 | profit rate:    0.2 | accuracy: 0.19
step_num: 7400 | loss: 0.2995 | profit rate:    0.0 | accuracy: 0.18
step_num: 7600 | loss: 0.3499 | profit rate:    2.4 | accuracy: 0.23
step_num: 7800 | loss: 0.2759 | profit rate:    3.1 | accuracy: 0.11
step_num: 8000 | loss: 0.2109 | profit rate:    5.7 | accuracy: 0.12
step_num: 8200 | loss: 0.1922 | profit rate:   21.4 | accuracy: 0.13
step_num: 8400 | loss: 0.2673 | profit rate:   17.4 | accuracy: 0.16
step_num: 8600 | loss: 0.2848 | profit rate:   65.8 | accuracy: 0.19
step_num: 8800 | loss: 0.3213 | profit rate:    7.8 | accuracy: 0.18
step_num: 9000 | loss: 0.3763 | profit rate:    1.5 | accuracy: 0.20
step_num: 9200 | loss: 0.4125 | profit rate:    0.1 | accuracy: 0.20
step_num: 9400 | loss: 0.3703 | profit rate:    0.1 | accuracy: 0.19
step_num: 9600 | loss: 0.2938 | profit rate:    5.9 | accuracy: 0.20
step_num: 9800 | loss: 0.3665 | profit rate: 188486.3 | accuracy: 0.23
step_num: 10000 | loss: 0.3636 | profit rate: 100405.2 | accuracy: 0.23
step_num: 10200 | loss: 0.3130 | profit rate: 813355.4 | accuracy: 0.23
step_num: 10400 | loss: 0.3781 | profit rate: 2261854.3 | accuracy: 0.24
step_num: 10600 | loss: 0.4623 | profit rate: 3628998.6 | accuracy: 0.24
step_num: 10800 | loss: 0.4022 | profit rate: 19398.8 | accuracy: 0.23
step_num: 11000 | loss: 0.3815 | profit rate: 10006.6 | accuracy: 0.23
episode:   3/5,耗时:1.39分/3.89分,训练集: | step: 11157 | average_treward:   38.2 | max_treward: 174.0218 | average profit rate: 2221.230
model saved @ step:11157,performance:6663.202,accuracy:0.22
step_num: 11200 | loss: 0.4018 | profit rate:   86.5 | accuracy: 0.73
step_num: 11400 | loss: 0.3311 | profit rate:   12.0 | accuracy: 0.19
step_num: 11600 | loss: 0.2531 | profit rate:   14.1 | accuracy: 0.11
step_num: 11800 | loss: 0.2561 | profit rate:    2.3 | accuracy: 0.10
step_num: 12000 | loss: 0.2482 | profit rate:   91.7 | accuracy: 0.14
step_num: 12200 | loss: 0.2066 | profit rate:  199.0 | accuracy: 0.15
step_num: 12400 | loss: 0.2596 | profit rate:   90.4 | accuracy: 0.17
step_num: 12600 | loss: 0.2767 | profit rate:  173.4 | accuracy: 0.17
step_num: 12800 | loss: 0.2628 | profit rate:   47.4 | accuracy: 0.16
step_num: 13000 | loss: 0.2731 | profit rate:    2.1 | accuracy: 0.16
step_num: 13200 | loss: 0.2298 | profit rate:    3.5 | accuracy: 0.15
step_num: 13400 | loss: 0.2098 | profit rate: 2606.8 | accuracy: 0.18
step_num: 13600 | loss: 0.2865 | profit rate: 35553509.8 | accuracy: 0.20
step_num: 13800 | loss: 0.2929 | profit rate: 23079986.5 | accuracy: 0.19
step_num: 14000 | loss: 0.3541 | profit rate: 45494502965.1 | accuracy: 0.21
step_num: 14200 | loss: 0.4082 | profit rate: 3315362696.5 | accuracy: 0.21
step_num: 14400 | loss: 0.4191 | profit rate: 1775729329.5 | accuracy: 0.21
step_num: 14600 | loss: 0.3406 | profit rate: 495501752.5 | accuracy: 0.21
step_num: 14800 | loss: 0.4061 | profit rate: 843730129.6 | accuracy: 0.21
model saved @ step:14876,performance:728466240.809,accuracy:0.21
step_num: 15000 | loss: 0.4389 | profit rate:    2.9 | accuracy: 0.38
step_num: 15200 | loss: 0.3726 | profit rate:    2.1 | accuracy: 0.18
step_num: 15400 | loss: 0.2910 | profit rate:    1.7 | accuracy: 0.14
step_num: 15600 | loss: 0.2480 | profit rate:    1.7 | accuracy: 0.14
step_num: 15800 | loss: 0.2628 | profit rate:   19.8 | accuracy: 0.15
step_num: 16000 | loss: 0.1949 | profit rate:   21.6 | accuracy: 0.17
step_num: 16200 | loss: 0.2124 | profit rate:    7.8 | accuracy: 0.16
step_num: 16400 | loss: 0.2152 | profit rate:   15.5 | accuracy: 0.16
step_num: 16600 | loss: 0.2128 | profit rate:    1.5 | accuracy: 0.15
step_num: 16800 | loss: 0.1667 | profit rate:    1.6 | accuracy: 0.14
step_num: 17000 | loss: 0.1303 | profit rate:    2.9 | accuracy: 0.14
step_num: 17200 | loss: 0.2372 | profit rate: 307282.8 | accuracy: 0.18
step_num: 17400 | loss: 0.2854 | profit rate: 4682135.4 | accuracy: 0.19
step_num: 17600 | loss: 0.2998 | profit rate: 59951377.1 | accuracy: 0.20
step_num: 17800 | loss: 0.3824 | profit rate: 1135090970.7 | accuracy: 0.21
step_num: 18000 | loss: 0.4659 | profit rate: 338790834.3 | accuracy: 0.21
step_num: 18200 | loss: 0.4313 | profit rate: 2950839.6 | accuracy: 0.21
step_num: 18400 | loss: 0.3999 | profit rate: 6227714.9 | accuracy: 0.21
episode:   5/5,耗时:1.38分/6.66分,训练集: | step: 18595 | average_treward:  140.1 | max_treward: 320.0323 | average profit rate: 147818462.414
----------------------------------------finished----------------------------------------
  0%|          | 0/403 [00:00<?, ?it/s] 23%|       | 91/403 [00:00<00:00, 909.72it/s] 47%|     | 188/403 [00:00<00:00, 944.45it/s] 73%|  | 296/403 [00:00<00:00, 1001.75it/s]100%|| 403/403 [00:00<00:00, 1020.94it/s]
==================================================
2023-01-04T12:00:00 | *** START BACKTEST ***
2023-01-04T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1326.50
2023-07-24T12:00:00 | net performance [%] = 32.6505
2023-07-24T12:00:00 | number of trades [#] = 10
==================================================
Trial 58 Complete [00h 06m 43s]
net_wealth: 1327.8325173583494

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 28m 50s

Search: Running Trial #59

Value             |Best Value So Far |Hyperparameter
4                 |12                |horizon
365               |730               |lookback
False             |True              |MarketFactor
5                 |5                 |lags
0.6               |0.6               |gamma
0.0005            |5e-05             |DQN_lr
2000              |64                |memory_size
64                |16                |batch_size
5                 |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4311.000000   4315.000000
mean      0.000441    20062.255222  ...   20133.281642  20118.633889
std       0.027818    16039.874230  ...   16077.358923  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7695.614990   7690.540039
50%       0.000642    11554.824463  ...   11741.480469  11715.610352
75%       0.011655    29873.081836  ...   29939.474609  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 1000 | loss: 1.2159 | profit rate:    0.3 | accuracy: 0.31
step_num: 1200 | loss: 0.4056 | profit rate:    0.4 | accuracy: 0.31
step_num: 1400 | loss: 0.4012 | profit rate:    0.5 | accuracy: 0.32
step_num: 1600 | loss: 0.4139 | profit rate:    1.4 | accuracy: 0.33
step_num: 1800 | loss: 0.4217 | profit rate:    1.8 | accuracy: 0.34
step_num: 2000 | loss: 0.4196 | profit rate:    3.9 | accuracy: 0.35
step_num: 2200 | loss: 0.4254 | profit rate:   16.4 | accuracy: 0.37
step_num: 2400 | loss: 0.4355 | profit rate:    4.8 | accuracy: 0.37
step_num: 2600 | loss: 0.4665 | profit rate:    5.1 | accuracy: 0.37
step_num: 2800 | loss: 0.4580 | profit rate:    4.4 | accuracy: 0.37
step_num: 3000 | loss: 0.4898 | profit rate:    3.4 | accuracy: 0.36
step_num: 3200 | loss: 0.4883 | profit rate:    4.5 | accuracy: 0.36
step_num: 3400 | loss: 0.4632 | profit rate:    3.1 | accuracy: 0.35
episode:   1/5,耗时:0.92分/0.92分,训练集: | step: 3537 | average_treward:   87.9 | max_treward: 87.9154 | average profit rate:  3.264
model saved @ step:3537,performance:3.264,accuracy:0.34
step_num: 3600 | loss: 0.4093 | profit rate:    0.7 | accuracy: 0.11
step_num: 3800 | loss: 0.3602 | profit rate:    0.7 | accuracy: 0.05
step_num: 4000 | loss: 0.3324 | profit rate:    0.6 | accuracy: 0.06
step_num: 4200 | loss: 0.2972 | profit rate:    0.5 | accuracy: 0.12
step_num: 4400 | loss: 0.2722 | profit rate:    0.3 | accuracy: 0.13
step_num: 4600 | loss: 0.2623 | profit rate:    0.5 | accuracy: 0.17
step_num: 4800 | loss: 0.2358 | profit rate:    0.2 | accuracy: 0.16
step_num: 5000 | loss: 0.1918 | profit rate:    0.2 | accuracy: 0.15
step_num: 5200 | loss: 0.1748 | profit rate:    0.3 | accuracy: 0.15
step_num: 5400 | loss: 0.1706 | profit rate:    0.3 | accuracy: 0.16
step_num: 5600 | loss: 0.1850 | profit rate:    2.1 | accuracy: 0.18
step_num: 5800 | loss: 0.2175 | profit rate:    1.4 | accuracy: 0.19
step_num: 6000 | loss: 0.2438 | profit rate:    0.7 | accuracy: 0.19
step_num: 6200 | loss: 0.2431 | profit rate:    0.9 | accuracy: 0.19
step_num: 6400 | loss: 0.2408 | profit rate:    0.3 | accuracy: 0.19
step_num: 6600 | loss: 0.2043 | profit rate:    0.5 | accuracy: 0.19
step_num: 6800 | loss: 0.2251 | profit rate:    1.7 | accuracy: 0.19
step_num: 7000 | loss: 0.2243 | profit rate:    2.7 | accuracy: 0.19
model saved @ step:7074,performance:2.813,accuracy:0.19
step_num: 7200 | loss: 0.2115 | profit rate:    0.7 | accuracy: 0.16
step_num: 7400 | loss: 0.2101 | profit rate:    0.7 | accuracy: 0.15
step_num: 7600 | loss: 0.1928 | profit rate:    0.8 | accuracy: 0.15
step_num: 7800 | loss: 0.1841 | profit rate:    1.9 | accuracy: 0.19
step_num: 8000 | loss: 0.1668 | profit rate:    2.4 | accuracy: 0.18
step_num: 8200 | loss: 0.1628 | profit rate:    3.7 | accuracy: 0.18
step_num: 8400 | loss: 0.1439 | profit rate:    2.0 | accuracy: 0.17
step_num: 8600 | loss: 0.1699 | profit rate:    1.0 | accuracy: 0.17
step_num: 8800 | loss: 0.1628 | profit rate:    0.8 | accuracy: 0.16
step_num: 9000 | loss: 0.1444 | profit rate:    0.9 | accuracy: 0.16
step_num: 9200 | loss: 0.1605 | profit rate:    1.7 | accuracy: 0.16
step_num: 9400 | loss: 0.1570 | profit rate:    3.9 | accuracy: 0.16
step_num: 9600 | loss: 0.1554 | profit rate:    7.7 | accuracy: 0.16
step_num: 9800 | loss: 0.1328 | profit rate:   13.3 | accuracy: 0.16
step_num: 10000 | loss: 0.1442 | profit rate:    8.3 | accuracy: 0.16
step_num: 10200 | loss: 0.1334 | profit rate:   13.3 | accuracy: 0.16
step_num: 10400 | loss: 0.1442 | profit rate:   24.9 | accuracy: 0.16
step_num: 10600 | loss: 0.1262 | profit rate:   37.3 | accuracy: 0.16
episode:   3/5,耗时:1.35分/3.56分,训练集: | step: 10611 | average_treward:  135.1 | max_treward: 179.0698 | average profit rate: 14.397
model saved @ step:10611,performance:37.113,accuracy:0.16
step_num: 10800 | loss: 0.1276 | profit rate:    1.0 | accuracy: 0.11
step_num: 11000 | loss: 0.1333 | profit rate:    1.0 | accuracy: 0.11
step_num: 11200 | loss: 0.1464 | profit rate:    2.8 | accuracy: 0.15
step_num: 11400 | loss: 0.1237 | profit rate:    4.4 | accuracy: 0.16
step_num: 11600 | loss: 0.1261 | profit rate:   16.6 | accuracy: 0.17
step_num: 11800 | loss: 0.1241 | profit rate:   18.5 | accuracy: 0.17
step_num: 12000 | loss: 0.1260 | profit rate:   10.6 | accuracy: 0.16
step_num: 12200 | loss: 0.1447 | profit rate:   11.7 | accuracy: 0.17
step_num: 12400 | loss: 0.1429 | profit rate:   21.9 | accuracy: 0.18
step_num: 12600 | loss: 0.1478 | profit rate:   37.5 | accuracy: 0.19
step_num: 12800 | loss: 0.1639 | profit rate:  194.3 | accuracy: 0.19
step_num: 13000 | loss: 0.1969 | profit rate:  251.6 | accuracy: 0.20
step_num: 13200 | loss: 0.1959 | profit rate:  483.4 | accuracy: 0.20
step_num: 13400 | loss: 0.1935 | profit rate:  836.4 | accuracy: 0.20
step_num: 13600 | loss: 0.1832 | profit rate: 1373.9 | accuracy: 0.20
step_num: 13800 | loss: 0.1852 | profit rate: 3059.3 | accuracy: 0.20
step_num: 14000 | loss: 0.1969 | profit rate: 4534.5 | accuracy: 0.19
model saved @ step:14148,performance:6268.400,accuracy:0.19
step_num: 14200 | loss: 0.1966 | profit rate:    0.9 | accuracy: 0.17
step_num: 14400 | loss: 0.1677 | profit rate:    1.3 | accuracy: 0.09
step_num: 14600 | loss: 0.1433 | profit rate:    1.4 | accuracy: 0.10
step_num: 14800 | loss: 0.1448 | profit rate:    9.4 | accuracy: 0.17
step_num: 15000 | loss: 0.1210 | profit rate:   10.9 | accuracy: 0.16
step_num: 15200 | loss: 0.1260 | profit rate:   40.2 | accuracy: 0.18
step_num: 15400 | loss: 0.1276 | profit rate:   15.5 | accuracy: 0.17
step_num: 15600 | loss: 0.1203 | profit rate:   14.6 | accuracy: 0.17
step_num: 15800 | loss: 0.1415 | profit rate:   61.8 | accuracy: 0.18
step_num: 16000 | loss: 0.1363 | profit rate:   79.7 | accuracy: 0.18
step_num: 16200 | loss: 0.1415 | profit rate:  219.6 | accuracy: 0.18
step_num: 16400 | loss: 0.1444 | profit rate:  788.3 | accuracy: 0.19
step_num: 16600 | loss: 0.1635 | profit rate: 1947.8 | accuracy: 0.19
step_num: 16800 | loss: 0.1505 | profit rate: 3219.5 | accuracy: 0.19
step_num: 17000 | loss: 0.1727 | profit rate: 2260.2 | accuracy: 0.19
step_num: 17200 | loss: 0.1609 | profit rate: 3554.0 | accuracy: 0.19
step_num: 17400 | loss: 0.1561 | profit rate: 7799.9 | accuracy: 0.19
step_num: 17600 | loss: 0.1608 | profit rate: 16474.6 | accuracy: 0.19
episode:   5/5,耗时:1.32分/6.23分,训练集: | step: 17685 | average_treward:  212.0 | max_treward: 339.3358 | average profit rate: 5119.599
model saved @ step:17685,performance:19286.406,accuracy:0.19
----------------------------------------finished----------------------------------------
  0%|          | 0/406 [00:00<?, ?it/s] 24%|       | 96/406 [00:00<00:00, 957.46it/s] 53%|    | 217/406 [00:00<00:00, 1104.42it/s] 82%| | 333/406 [00:00<00:00, 1125.11it/s]100%|| 406/406 [00:00<00:00, 1120.33it/s]
==================================================
2023-01-03T00:00:00 | *** START BACKTEST ***
2023-01-03T00:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1279.10
2023-07-24T12:00:00 | net performance [%] = 27.9097
2023-07-24T12:00:00 | number of trades [#] = 20
==================================================
Trial 59 Complete [00h 06m 17s]
net_wealth: 1280.377582361775

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 35m 07s

Search: Running Trial #60

Value             |Best Value So Far |Hyperparameter
13                |12                |horizon
225               |730               |lookback
False             |True              |MarketFactor
20                |5                 |lags
0.8               |0.6               |gamma
1e-05             |5e-05             |DQN_lr
256               |64                |memory_size
32                |16                |batch_size
0.2               |10                |gradient_clip_norm

<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 4335 entries, 2017-08-17 00:00:00+00:00 to 2023-07-24 12:00:00+00:00
Data columns (total 9 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   open        4335 non-null   float64
 1   high        4335 non-null   float64
 2   low         4335 non-null   float64
 3   close       4335 non-null   float64
 4   volume      4335 non-null   float64
 5   amount      4335 non-null   float64
 6   num_trades  4335 non-null   int64  
 7   bid_volume  4335 non-null   float64
 8   bid_amount  4335 non-null   float64
dtypes: float64(8), int64(1)
memory usage: 338.7 KB
从json中读出Data.info:None
        log_return  Roll_price_sma  ...  horizon_price         close
count  4315.000000     4315.000000  ...    4302.000000   4315.000000
mean      0.000441    20062.255222  ...   20165.724363  20118.633889
std       0.027818    16039.874230  ...   16078.496018  16077.098476
min      -0.268357     3359.310486  ...    2919.000000   2919.000000
25%      -0.009736     7609.090466  ...    7729.197632   7690.540039
50%       0.000642    11554.824463  ...   11751.060059  11715.610352
75%       0.011655    29873.081836  ...   30007.945801  29923.605469
max       0.237092    64595.437500  ...   67594.976562  67594.976562

[8 rows x 8 columns]
                           log_return  ...        close
2017-08-27 08:00:00+08:00   -0.003249  ...  4323.370117
2017-08-27 20:00:00+08:00   -0.003095  ...  4310.009766

[2 rows x 8 columns]
                           log_return  ...         close
2023-07-24 08:00:00+08:00   -0.027422  ...  29269.990234
2023-07-24 20:00:00+08:00   -0.005706  ...  29103.449219

[2 rows x 8 columns]
step_num: 200 | loss: 1.1143 | profit rate:    0.7 | accuracy: 0.29
step_num: 400 | loss: 0.9183 | profit rate:    0.4 | accuracy: 0.31
step_num: 600 | loss: 0.8555 | profit rate:    0.5 | accuracy: 0.34
step_num: 800 | loss: 0.7646 | profit rate:    4.4 | accuracy: 0.36
step_num: 1000 | loss: 0.7367 | profit rate:  725.9 | accuracy: 0.39
step_num: 1200 | loss: 1.0220 | profit rate: 6270.2 | accuracy: 0.40
step_num: 1400 | loss: 0.6901 | profit rate: 2632.5 | accuracy: 0.40
step_num: 1600 | loss: 0.7694 | profit rate:   50.8 | accuracy: 0.39
step_num: 1800 | loss: 0.8114 | profit rate:    0.1 | accuracy: 0.38
step_num: 2000 | loss: 0.6730 | profit rate:    0.2 | accuracy: 0.39
step_num: 2200 | loss: 0.7162 | profit rate: 19382.6 | accuracy: 0.41
step_num: 2400 | loss: 0.8321 | profit rate: 17328398.7 | accuracy: 0.43
step_num: 2600 | loss: 0.7864 | profit rate: 1103768.3 | accuracy: 0.42
step_num: 2800 | loss: 0.9125 | profit rate: 54779.1 | accuracy: 0.43
step_num: 3000 | loss: 0.7237 | profit rate: 53891.3 | accuracy: 0.42
step_num: 3200 | loss: 0.6504 | profit rate: 908167.2 | accuracy: 0.42
step_num: 3400 | loss: 0.7081 | profit rate: 94197101.7 | accuracy: 0.43
step_num: 3600 | loss: 0.6386 | profit rate: 573197816.9 | accuracy: 0.42
episode:   1/5,耗时:0.63分/0.63分,训练集: | step: 3662 | average_treward:  261.2 | max_treward: 261.1653 | average profit rate: 748111402.065
model saved @ step:3662,performance:748111402.065,accuracy:0.42
step_num: 3800 | loss: 0.7157 | profit rate:    0.0 | accuracy: 0.28
step_num: 4000 | loss: 0.7672 | profit rate:    0.2 | accuracy: 0.35
step_num: 4200 | loss: 0.6596 | profit rate:    0.1 | accuracy: 0.33
step_num: 4400 | loss: 0.7479 | profit rate:    3.5 | accuracy: 0.37
step_num: 4600 | loss: 0.7283 | profit rate:   74.6 | accuracy: 0.40
step_num: 4800 | loss: 0.8569 | profit rate: 367072.7 | accuracy: 0.45
step_num: 5000 | loss: 0.7866 | profit rate: 26538.9 | accuracy: 0.43
step_num: 5200 | loss: 0.5897 | profit rate: 100139.4 | accuracy: 0.43
step_num: 5400 | loss: 0.8525 | profit rate:    4.4 | accuracy: 0.41
step_num: 5600 | loss: 0.7590 | profit rate:   18.9 | accuracy: 0.42
step_num: 5800 | loss: 0.6590 | profit rate: 2451.8 | accuracy: 0.44
step_num: 6000 | loss: 0.8686 | profit rate: 1192174092.0 | accuracy: 0.46
step_num: 6200 | loss: 0.8694 | profit rate: 18319726.3 | accuracy: 0.45
step_num: 6400 | loss: 0.7453 | profit rate: 341231.4 | accuracy: 0.45
step_num: 6600 | loss: 0.7116 | profit rate: 2407897.3 | accuracy: 0.45
step_num: 6800 | loss: 0.6587 | profit rate: 5912011.7 | accuracy: 0.44
step_num: 7000 | loss: 0.6162 | profit rate: 858353512.4 | accuracy: 0.44
step_num: 7200 | loss: 0.7114 | profit rate: 1954457817.9 | accuracy: 0.44
model saved @ step:7324,performance:23583233342.072,accuracy:0.44
step_num: 7400 | loss: 0.7939 | profit rate:    0.0 | accuracy: 0.23
step_num: 7600 | loss: 0.8643 | profit rate:    0.0 | accuracy: 0.31
step_num: 7800 | loss: 0.6292 | profit rate:    0.1 | accuracy: 0.31
step_num: 8000 | loss: 0.5117 | profit rate:    4.8 | accuracy: 0.31
step_num: 8200 | loss: 0.5048 | profit rate:    3.2 | accuracy: 0.32
step_num: 8400 | loss: 0.7006 | profit rate: 305130.6 | accuracy: 0.40
step_num: 8600 | loss: 0.8058 | profit rate: 251036.0 | accuracy: 0.40
step_num: 8800 | loss: 0.5497 | profit rate: 328524.3 | accuracy: 0.39
step_num: 9000 | loss: 0.7527 | profit rate:  157.7 | accuracy: 0.38
step_num: 9200 | loss: 0.6480 | profit rate:   25.9 | accuracy: 0.38
step_num: 9400 | loss: 0.7027 | profit rate:  215.1 | accuracy: 0.40
step_num: 9600 | loss: 0.8127 | profit rate: 823811225.8 | accuracy: 0.43
step_num: 9800 | loss: 0.9086 | profit rate: 202711325.0 | accuracy: 0.44
step_num: 10000 | loss: 0.6524 | profit rate: 64829130.5 | accuracy: 0.42
step_num: 10200 | loss: 0.7994 | profit rate: 104391118.9 | accuracy: 0.43
step_num: 10400 | loss: 0.5060 | profit rate: 575783982.3 | accuracy: 0.42
step_num: 10600 | loss: 0.5398 | profit rate: 10989335312.6 | accuracy: 0.41
step_num: 10800 | loss: 0.4629 | profit rate: 12634174806.3 | accuracy: 0.40
episode:   3/5,耗时:0.68分/1.99分,训练集: | step: 10986 | average_treward:  293.4 | max_treward: 328.6602 | average profit rate: 30535340989.165
model saved @ step:10986,performance:67274678223.358,accuracy:0.40
step_num: 11000 | loss: 0.4247 | profit rate:    4.3 | accuracy: 0.80
step_num: 11200 | loss: 0.7006 | profit rate:    0.0 | accuracy: 0.24
step_num: 11400 | loss: 0.4409 | profit rate:    0.0 | accuracy: 0.24
step_num: 11600 | loss: 0.4810 | profit rate:    0.0 | accuracy: 0.26
step_num: 11800 | loss: 0.3956 | profit rate:    0.5 | accuracy: 0.25
step_num: 12000 | loss: 0.5687 | profit rate: 2006.1 | accuracy: 0.32
step_num: 12200 | loss: 0.8703 | profit rate: 36117.6 | accuracy: 0.35
step_num: 12400 | loss: 0.5145 | profit rate: 882901.4 | accuracy: 0.34
step_num: 12600 | loss: 0.6372 | profit rate:  460.5 | accuracy: 0.34
step_num: 12800 | loss: 0.7420 | profit rate:  197.9 | accuracy: 0.33
step_num: 13000 | loss: 0.7104 | profit rate:  249.8 | accuracy: 0.35
step_num: 13200 | loss: 0.7401 | profit rate: 762702199.8 | accuracy: 0.39
step_num: 13400 | loss: 0.9457 | profit rate: 64383236613.0 | accuracy: 0.41
step_num: 13600 | loss: 0.5504 | profit rate: 1876054865.0 | accuracy: 0.39
step_num: 13800 | loss: 0.6443 | profit rate: 18453847826.3 | accuracy: 0.40
step_num: 14000 | loss: 0.5751 | profit rate: 957022750.5 | accuracy: 0.39
step_num: 14200 | loss: 0.3646 | profit rate: 13572355878.7 | accuracy: 0.38
step_num: 14400 | loss: 0.3432 | profit rate: 94543472617.8 | accuracy: 0.37
step_num: 14600 | loss: 0.3979 | profit rate: 316806874302.7 | accuracy: 0.36
model saved @ step:14648,performance:406687370883.682,accuracy:0.36
step_num: 14800 | loss: 0.6408 | profit rate:    0.0 | accuracy: 0.29
step_num: 15000 | loss: 0.4890 | profit rate:    0.1 | accuracy: 0.27
step_num: 15200 | loss: 0.3845 | profit rate:    0.0 | accuracy: 0.24
step_num: 15400 | loss: 0.3236 | profit rate:    1.0 | accuracy: 0.24
step_num: 15600 | loss: 0.3774 | profit rate:   21.5 | accuracy: 0.28
step_num: 15800 | loss: 0.8045 | profit rate: 46275.2 | accuracy: 0.34
step_num: 16000 | loss: 0.6862 | profit rate: 1408443.7 | accuracy: 0.35
step_num: 16200 | loss: 0.2654 | profit rate: 9012988.5 | accuracy: 0.34
step_num: 16400 | loss: 0.7498 | profit rate: 2223.3 | accuracy: 0.32
step_num: 16600 | loss: 0.7177 | profit rate: 2785.6 | accuracy: 0.34
step_num: 16800 | loss: 0.6903 | profit rate: 433649.4 | accuracy: 0.37
step_num: 17000 | loss: 0.8740 | profit rate: 736177983002.8 | accuracy: 0.40
step_num: 17200 | loss: 0.7161 | profit rate: 11325971926.7 | accuracy: 0.39
step_num: 17400 | loss: 0.4451 | profit rate: 11036141448.2 | accuracy: 0.39
step_num: 17600 | loss: 0.6966 | profit rate: 4486695273.4 | accuracy: 0.39
step_num: 17800 | loss: 0.2556 | profit rate: 9066273870.2 | accuracy: 0.38
step_num: 18000 | loss: 0.3285 | profit rate: 114461218594.9 | accuracy: 0.36
step_num: 18200 | loss: 0.3159 | profit rate: 1306494625796.0 | accuracy: 0.36
episode:   5/5,耗时:0.70分/3.40分,训练集: | step: 18310 | average_treward:  331.7 | max_treward: 396.8153 | average profit rate: 378419593039.058
model saved @ step:18310,performance:1393804571344.115,accuracy:0.35
----------------------------------------finished----------------------------------------
  0%|          | 0/391 [00:00<?, ?it/s] 26%|       | 103/391 [00:00<00:00, 1019.83it/s] 54%|    | 211/391 [00:00<00:00, 1055.08it/s] 81%|  | 317/391 [00:00<00:00, 1044.29it/s]100%|| 391/391 [00:00<00:00, 1049.00it/s]
==================================================
2023-01-10T12:00:00 | *** START BACKTEST ***
2023-01-10T12:00:00 | current balance = 1000.00
==================================================
==================================================
2023-07-24T12:00:00 | *** CLOSING OUT ***
2023-07-24T12:00:00 | current balance = 1084.53
2023-07-24T12:00:00 | net performance [%] = 8.4532
2023-07-24T12:00:00 | number of trades [#] = 42
==================================================
Trial 60 Complete [00h 03m 28s]
net_wealth: 1085.6175868267558

Best net_wealth So Far: 1677.8592230189117
Total elapsed time: 06h 38m 35s
Results summary
Results in saved_model\keras_tuner
Showing 10 best trials
Objective(name="net_wealth", direction="max")

Trial 06 summary
Hyperparameters:
horizon: 12
lookback: 730
MarketFactor: True
lags: 5
gamma: 0.6
DQN_lr: 5e-05
memory_size: 64
batch_size: 16
gradient_clip_norm: 10.0
Score: 1677.8592230189117

Trial 18 summary
Hyperparameters:
horizon: 4
lookback: 225
MarketFactor: False
lags: 10
gamma: 0.5
DQN_lr: 1e-05
memory_size: 256
batch_size: 32
gradient_clip_norm: 10.0
Score: 1539.063728716439

Trial 39 summary
Hyperparameters:
horizon: 1
lookback: 730
MarketFactor: True
lags: 3
gamma: 0.92
DQN_lr: 1e-05
memory_size: 2000
batch_size: 64
gradient_clip_norm: 1.0
Score: 1498.402520593829

Trial 53 summary
Hyperparameters:
horizon: 10
lookback: 180
MarketFactor: False
lags: 8
gamma: 0.92
DQN_lr: 1e-05
memory_size: 512
batch_size: 32
gradient_clip_norm: 5.0
Score: 1496.3869204913456

Trial 10 summary
Hyperparameters:
horizon: 12
lookback: 730
MarketFactor: True
lags: 8
gamma: 0.98
DQN_lr: 0.001
memory_size: 2000
batch_size: 32
gradient_clip_norm: 5.0
Score: 1452.0049116992454

Trial 48 summary
Hyperparameters:
horizon: 4
lookback: 365
MarketFactor: True
lags: 5
gamma: 0.98
DQN_lr: 0.001
memory_size: 1024
batch_size: 32
gradient_clip_norm: 5.0
Score: 1425.7960676757452

Trial 51 summary
Hyperparameters:
horizon: 12
lookback: 180
MarketFactor: False
lags: 10
gamma: 0.8
DQN_lr: 5e-05
memory_size: 2000
batch_size: 32
gradient_clip_norm: 10.0
Score: 1420.3238356993836

Trial 50 summary
Hyperparameters:
horizon: 11
lookback: 180
MarketFactor: False
lags: 8
gamma: 0.92
DQN_lr: 0.0001
memory_size: 2000
batch_size: 32
gradient_clip_norm: 0.1
Score: 1415.207267581065

Trial 25 summary
Hyperparameters:
horizon: 11
lookback: 180
MarketFactor: False
lags: 3
gamma: 0.8
DQN_lr: 1e-05
memory_size: 1024
batch_size: 16
gradient_clip_norm: 5.0
Score: 1411.424261415541

Trial 36 summary
Hyperparameters:
horizon: 13
lookback: 180
MarketFactor: True
lags: 5
gamma: 0.7
DQN_lr: 5e-05
memory_size: 1024
batch_size: 16
gradient_clip_norm: 0.2
Score: 1389.7000528138942
None
   horizon  lookback  MarketFactor  ...  batch_size  gradient_clip_norm        score
0       12       730          True  ...          16                10.0  1677.859223
1        4       225         False  ...          32                10.0  1539.063729
2        1       730          True  ...          64                 1.0  1498.402521
3       10       180         False  ...          32                 5.0  1496.386920
4       12       730          True  ...          32                 5.0  1452.004912
5        4       365          True  ...          32                 5.0  1425.796068
6       12       180         False  ...          32                10.0  1420.323836
7       11       180         False  ...          32                 0.1  1415.207268
8       11       180         False  ...          16                 5.0  1411.424261
9       13       180          True  ...          16                 0.2  1389.700053

[10 rows x 10 columns]
horizon=12
lookback=730
MarketFactor=True
lags=5
gamma=0.6
DQN_lr=5e-05
memory_size=64
batch_size=16
gradient_clip_norm=10.0
